[{"_path":"/cloud-gcp/_dir","_dir":"cloud-gcp","_draft":false,"_partial":true,"_locale":"","title":"Cloud-GCP","icon":"ğŸ›¢ï¸","_id":"content:3.cloud-gcp:_dir.yml","_type":"yaml","_source":"content","_file":"3.cloud-gcp/_dir.yml","_extension":"yml"},{"_path":"/database/ef-query","_dir":"database","_draft":false,"_partial":false,"_locale":"","title":"å¤§æ‰¹é‡Createè™•ç†æ™‚é–“è­°é¡Œèˆ‡Queryè¿½è¹¤è­°é¡Œ","description":"","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"å¤§æ‰¹é‡createè™•ç†æ™‚é–“è­°é¡Œèˆ‡queryè¿½è¹¤è­°é¡Œ"},"children":[{"type":"text","value":"å¤§æ‰¹é‡Createè™•ç†æ™‚é–“è­°é¡Œèˆ‡Queryè¿½è¹¤è­°é¡Œ"}]},{"type":"element","tag":"h2","props":{"id":"ä¸€å¤§æ‰¹é‡createè™•ç†æ™‚é–“è­°é¡Œ"},"children":[{"type":"text","value":"ä¸€ã€å¤§æ‰¹é‡Createè™•ç†æ™‚é–“è­°é¡Œ"}]},{"type":"element","tag":"h3","props":{"id":"aæƒ…å¢ƒ"},"children":[{"type":"text","value":"a.æƒ…å¢ƒ"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"è¿‘æœŸåœ¨ä½¿ç”¨EFæ–°å¢è³‡æ–™æ™‚é‡åˆ°ä¸€æ¬¡è¦æ’å…¥å¤§é‡è³‡æ–™æ™‚çš„éœ€æ±‚(ä¸€æ¬¡ç´„å¿«1w5åƒç­†)ã€‚å› ç‚ºEF Bulk Insertè¦éŒ¢(ç¬¬ä¸‰æ–¹å¥—ä»¶)ï¼Œé¡§å¾ˆå–®ç´”ä½¿ç”¨DbContext Addï¼Œæ’å…¥æ™‚é–“è¦å°‡è¿‘30ç§’ã€‚"}]},{"type":"element","tag":"h3","props":{"id":"root-casue"},"children":[{"type":"element","tag":"a","props":{"href":"https://docs.microsoft.com/zh-tw/ef/ef6/saving/change-tracking/auto-detect-changes","rel":["nofollow"]},"children":[{"type":"text","value":"Root Casue"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"EF POCOåœ¨åšç•°å‹•æ™‚ï¼Œæœƒå‘¼å«DetectChanges()æ¯”å°æ‰€æœ‰entryé›†åˆä¸­æ¯ä¸€å€‹Propertyçš„æ–°å°±å€¼ï¼Œé¡§æœƒé€ æˆåœ¨å¤§é‡æ“ä½œæ™‚æ‹‰é•·æ™‚é–“ã€‚ä»¥ä¸‹ç‚ºæœƒå‘¼å«DetectChanges()çš„æ–¹æ³•"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"DbSet.Find"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"DbSet.Local"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"DbSet.Add"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"DbSet.AddRange"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"DbSet.Remove"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"DbSet.RemoveRange"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"DbSet.Attach"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"DbContext.SaveChanges"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"DbCoNtext.GetValidationErrors"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"DbContext.Entry"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"DbChangeTracker.Entries"}]}]},{"type":"element","tag":"h3","props":{"id":"bè§£æ³•"},"children":[{"type":"text","value":"b.è§£æ³•"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"æ ¹æ“šä¸Šè¿°åŸå› ï¼Œè‹¥è¦ç¸®çŸ­å¤§é‡è³‡æ–™å»ºç«‹æ™‚é–“æœ‰å…©ç¨®æ–¹æ³•"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"ä½¿ç”¨AddRange\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"ç›´æ¥ä½¿ç”¨AddRangeä¸€æ¬¡æ€§åŠ å…¥æ‰€æœ‰è³‡æ–™ï¼Œæœƒæ¯”èµ·æ¯æ¬¡Addéƒ½è¦å‘¼å«ä¸€æ¬¡DetectChanges()æ™‚é–“ä¾†çš„çŸ­ã€‚"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Configuration.AutoDetectChangesEnabledå±¬æ€§è¨­ç½®æˆfalse\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"ç›´æ¥å°‡AutoDetectChangesEnabledè¨­æˆfalseï¼ŒAddå®Œå¾Œå†è¨­ç‚ºtrueã€‚"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"cæ¸¬è©¦çµæœ"},"children":[{"type":"text","value":"c.æ¸¬è©¦çµæœ"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"å¯¦æ¸¬çµæœå¦‚ä¸‹ï¼Œ12544ç­†è³‡æ–™å­˜å–æ™‚é–“"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Add : 34s"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"AddRange : 13s"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"AutoDetectChangesEnabled fasle : 13s"}]}]},{"type":"element","tag":"h2","props":{"id":"äºŒqueryè¿½è¹¤è­°é¡Œ"},"children":[{"type":"text","value":"äºŒã€"},{"type":"element","tag":"a","props":{"href":"https://docs.microsoft.com/zh-tw/ef/core/querying/tracking#tracking-queries","rel":["nofollow"]},"children":[{"type":"text","value":"Queryè¿½è¹¤è­°é¡Œ"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Forè™•ç†å¤§æ‰¹é‡Createè™•ç†æ™‚é–“è­°é¡Œä¹Ÿç¨å¾®æŸ¥ä¸€ä¸‹Queryéƒ¨åˆ†ï¼Œç™¼ç¾EFæŸ¥è©¢é è¨­æœ‰Trackingçš„è¨­è¨ˆã€‚ç¨å¾®å¯«ä¸€ä¸‹Testing Codeå¦‚ä¸‹"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Testing Code","src":"/blog/images/03/02/001.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"æ“ä½œæ­¥é©Ÿç‚º"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Step1: Context1 ç´¢å–Marioè³‡æ–™"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Step2: Context2 æ–°å¢ä¸€ç­†Testè³‡æ–™"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Step3: Context1 ä¿®æ”¹Marioè³‡æ–™ç‚ºJack"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"çµæœå¦‚ä¸‹"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Result","src":"/blog/images/03/02/002.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"å¯ä»¥ç™¼ç¾Context1æŸ¥è¦ºåˆ°ç­†æ•¸æœ‰å¢åŠ ï¼Œä½†Context2ç¨åˆ°çš„Nameèƒ½ç„¶ç‚ºèˆŠå€¼ã€‚"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"å› ç‚ºContext2æ‹¿å–äº†Cacheè³‡æ–™å…§å®¹ï¼Œç¬¬äºŒæ¬¡Queryä¸¦æ²’å¾DBè®€å–ã€‚æ‰€ä»¥è®€åˆ°çš„å€¼ä»ç‚ºèˆŠå€¼ã€‚æ­¤æ™‚å¦‚æœæˆ‘å€‘å°‡Context2ç¬¬äºŒæŸ¥è©¢æ”¹ç‚º"}]},{"type":"element","tag":"pre","props":{"className":"language-= github-light_github-dark","code":"dbContext2.TestRecord.AsNoTracking().SingleOrDefault(x => x.Id == 1).Name\n","language":"=","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"dbContext2.TestRecord.AsNoTracking().SingleOrDefault(x => x.Id == 1).Name"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"æ­¤æ™‚è®€åˆ°çš„å€¼å‰‡å°±æœƒæ˜¯Context1æ”¹éçš„Nameå€¼Jackï¼Œå› æ­¤å¦‚æœåœ¨å”¯è®€çš„ä½¿ç”¨æƒ…å¢ƒä¸‹ï¼Œä½¿ç”¨ä¸è¿½è¹¤æŸ¥è©¢å¯ä»¥åŠ å¿«æŸ¥è©¢é€Ÿåº¦ã€‚(å¾…å¯¦æ¸¬)"}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":".github-light_github-dark{color:#24292e;background:#fff;}.dark .github-light_github-dark{color:#e1e4e8;background:#24292e;}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"ä¸€å¤§æ‰¹é‡createè™•ç†æ™‚é–“è­°é¡Œ","depth":2,"text":"ä¸€ã€å¤§æ‰¹é‡Createè™•ç†æ™‚é–“è­°é¡Œ","children":[{"id":"aæƒ…å¢ƒ","depth":3,"text":"a.æƒ…å¢ƒ"},{"id":"root-casue","depth":3,"text":"Root Casue"},{"id":"bè§£æ³•","depth":3,"text":"b.è§£æ³•"},{"id":"cæ¸¬è©¦çµæœ","depth":3,"text":"c.æ¸¬è©¦çµæœ"}]},{"id":"äºŒqueryè¿½è¹¤è­°é¡Œ","depth":2,"text":"äºŒã€Queryè¿½è¹¤è­°é¡Œ"}]}},"_type":"markdown","_id":"content:4.database:2.EF Queryè¿½è¹¤è­°é¡Œ.md","_source":"content","_file":"4.database/2.EF Queryè¿½è¹¤è­°é¡Œ.md","_extension":"md"}]