[{"_path":"/keycloak/keycloak","_dir":"keycloak","_draft":false,"_partial":false,"_locale":"","title":"身份驗證與授權與Keycloak","description":"","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"身份驗證與授權與keycloak"},"children":[{"type":"text","value":"身份驗證與授權與Keycloak"}]},{"type":"element","tag":"h2","props":{"id":"一關於身份驗證與授權"},"children":[{"type":"text","value":"一、關於身份驗證與授權"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"身份驗證和授權是系統安全性非常重要的環節。身份驗證用於識別使用者是誰，而授權則賦予使用者某些特定權限。更具體來說，這整個過程可以分為四個部分："}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"身分識別 (Identification)：這是一個讓系統知道你是誰的過程。例如，當你使用用戶名或電子郵件地址登入系統時，就是進行身分識別。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"身分驗證 (Authentication)：這個過程讓系統確認你確實是你聲稱的那個人。通常是通過輸入密碼、使用FaceID或OTP來完成的。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"授權 (Authorization)：這涉及到角色分配。根據你的角色，系統會賦予你不同的權限。例如，一個“編輯者”角色可能有編輯內容的權限，而一個“閱讀者”角色則只能閱讀。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"存取控制 (Access Control)：這涉及到具體的操作權限。比如，在一個IT管理系統中，一個普通使用者可能可以重啟伺服器和查看系統日誌，但不能部署新的程式碼。然而，一個開發者則可能有這樣的權限。"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在你登入系統，輸入帳號密碼為身分識別與身分驗證，系統驗證完後，會根據身分授予角色。至於此角色權限則可以在後台系統上設置。至於這部分的詳細實做概念牽扯還是蠻多的...會再找時間針對這部分做一個細部講解。"}]},{"type":"element","tag":"h3","props":{"id":"_1-身分識別驗證與授權簡易實作"},"children":[{"type":"text","value":"1. 身分識別驗證與授權簡易實作"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"了解這些基礎概念後，我們可以考慮如何手動實現這四個部分。"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"身分識別 (Identification) : 最常見的實現方式是透過一個使用者註冊頁面，讓使用者輸入基本資料，例如用戶名和密碼。這些信息會被存儲在後端的資料庫中（密碼會被加密）。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"身分驗證 (Authentication) : 驗證的方法有多種。"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"密碼驗證 : 簡單地說，就是將輸入的密碼與資料庫中存儲的密碼進行比對。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"多因素驗證 : 二次驗證，例如OTP、FaceID，或是手機&Mail驗證"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Session/Token管理 : 用戶登入後，系統會生成一個session或token並發送給用戶。後續的所有請求都需要這個token以確認身份。"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"授權 (Authorization) : 這部分簡易實作基本上會有三部份"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"角色管理：在資料庫中設計一個角色和權限的模型。例如，每個使用者可以有一個或多個角色，每個角色有不同的權限。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"權限檢查：每次使用者請求某個資源或操作時，檢查他們的角色是否有相應的權限。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"API設計：設計API時，確保每個API端點都有適當的授權檢查。"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"存取控制 (Access Control)"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"基於角色的存取控制 (RBAC)：根據使用者的角色決定他們可以訪問的資源。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"細緻的權限設定：允許系統管理者為每個角色定制細緻的權限，例如某角色只能讀取資料但不能編輯。"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"其他考慮"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"日誌和監控：記錄所有的登錄嘗試、授權請求等，以便日後分析和審計。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"資料庫安全性：確保資料庫有適當的加密和備份策略。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"定期檢查和更新：隨著時間的推移，可能會出現新的安全威脅。定期檢查和更新你的身份驗證和授權策略，以確保它們始終是安全的。"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"_2-身分識別驗證授權與keycloak"},"children":[{"type":"text","value":"2. 身分識別驗證、授權與Keycloak"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"通過使用Keycloak，我們能夠更為高效地實現身分識別、身分驗證、授權，以及存取控制等功能。"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"身分識別 (Identification)"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"不僅提供使用者註冊功能，讓使用者可以用基本資訊，比如用戶名或電子郵件進行註冊，還支持多種社交登入方式，如Google或Facebook。"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"身分驗證 (Authentication"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"支援多種身分驗證方法，包括密碼、OTP、FaceID等，也提供Token管理，當使用者成功登入後，Keycloak 會發放一個 token，使用者可以使用此 token 來存取其他受保護的資源。"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"授權 (Authorization)"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"可以定義多個角色，並為每個角色分配不同的權限，使用者可以被分配到一個或多個角色，這些角色決定了使用者可以訪問哪些資源。"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"存取控制 (Access Control)"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"支援基於角色的存取控制 (RBAC)。你可以設定哪些角色可以訪問哪些資源。"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"一般來說，要全面實施這四大功能通常需要大量的時間和資源。開發者不只需要寫大量的程式碼，還必須維護系統的安全性、效能，並確保與其他系統的良好整合。有了Keycloak，這一切都變得相對簡單。"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"一關於身份驗證與授權","depth":2,"text":"一、關於身份驗證與授權","children":[{"id":"_1-身分識別驗證與授權簡易實作","depth":3,"text":"1. 身分識別驗證與授權簡易實作"},{"id":"_2-身分識別驗證授權與keycloak","depth":3,"text":"2. 身分識別驗證、授權與Keycloak"}]}]}},"_type":"markdown","_id":"content:5.keycloak:1.身份驗證與授權與Keycloak.md","_source":"content","_file":"5.keycloak/1.身份驗證與授權與Keycloak.md","_extension":"md"},{"_path":"/keycloak/sso","_dir":"keycloak","_draft":false,"_partial":false,"_locale":"","title":"關於SSO","description":"","body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"三sso-簡述"},"children":[{"type":"text","value":"三、SSO 簡述"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"OIDC和SAML討論完後，我們來聊聊單一登入（SSO）。SSO是一個身份驗證方案，它讓使用者能透過一次登入就可訪問多個應用程式和網站。簡而言之："}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"透過單一的登入窗口，進行單一的身分驗證，就可以讓許多的服務共同來使用這個驗證結果"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"OIDC和SAML都可以實現這樣的SSO功能。舉例來說，假設你在工作中要使用三個不同的平台："}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"郵件系統（Email System）"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"公司內部網站（Intranet）"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"報表和數據分析平台（Analytics Platform）"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"通常你得記住這三個系統各自的帳號和密碼。但有了SSO，你只需透過一個統一的登入界面（比如由Keycloak管理）登入一次，然後就能自由地訪問這三個不同的平台，無需再逐一輸入帳號和密碼。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"總之，SSO幫你將多個獨立的系統集成為單一的入口點。這樣不僅減少了你需要記住多組密碼的困擾，還降低了由於多個系統各自存儧行密碼所帶來的安全風險。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"流程範例大致如下："}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Step1(箭頭1) : 用者首先訪問「Application 01」的 URL 並按下登入按鈕，然後會被引導到 Keycloak 登入頁面。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Step2: 用戶在 Keycloak 成功登入後，將被重新導向回「Application 01」的主頁。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Step3(箭頭3): 如果用戶在合理的時間內再次訪問「Application 02」，則不需要重新登入。"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"箭頭2實際上是指示用戶從「應用程式01」被引導到Keycloak的登入頁面這一過程。簡單來說，當用戶嘗試在「應用程式01」登入（箭頭1）後，他們會被重定向到Keycloak以完成身份驗證（箭頭2）。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Flow","src":"/blog/images/04/03/001.png"},"children":[]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"三sso-簡述","depth":2,"text":"三、SSO 簡述"}]}},"_type":"markdown","_id":"content:5.keycloak:3.關於SSO.md","_source":"content","_file":"5.keycloak/3.關於SSO.md","_extension":"md"}]