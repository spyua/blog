<!DOCTYPE html>
<html  lang="en">
<head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>DDD實戰-Module · Spyua Blog</title>
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="twitter:card" content="summary_large_image">
<meta name="description" content="The best place to start your documentation.">
<meta property="og:description" content="The best place to start your documentation.">
<meta property="og:image" content="https://user-images.githubusercontent.com/904724/185365452-87b7ca7b-6030-4813-a2db-5e65c785bf88.png">
<meta property="og:title" content="DDD實戰-Module">
<link rel="stylesheet" href="/blog/_nuxt/entry.1b0101cf.css">
<link rel="stylesheet" href="/blog/_nuxt/DocumentDrivenNotFound.7238633c.css">
<link rel="stylesheet" href="/blog/_nuxt/ButtonLink.c4905621.css">
<link rel="stylesheet" href="/blog/_nuxt/DocsPageLayout.2ba2acb9.css">
<link rel="stylesheet" href="/blog/_nuxt/DocsAside.7397caed.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseCodeInline.21ce328c.css">
<link rel="stylesheet" href="/blog/_nuxt/Alert.408d0512.css">
<link rel="stylesheet" href="/blog/_nuxt/DocsPageBottom.9f7ccbf0.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseA.e2976377.css">
<link rel="stylesheet" href="/blog/_nuxt/DocsPrevNext.0d80e373.css">
<link rel="stylesheet" href="/blog/_nuxt/DocsToc.855ff635.css">
<link rel="stylesheet" href="/blog/_nuxt/DocsTocLinks.310b9647.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseH1.4070ea3e.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseH3.88c2d983.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseP.945916cd.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseImg.018721e2.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseStrong.263d77e1.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseBlockquote.87ef1443.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseHr.c7c78bbe.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseUl.c9c63ec7.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseLi.ac05b421.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseH4.5b64d6f8.css">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/entry.a772b460.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/document-driven.ac34d019.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/DocumentDrivenEmpty.801fc40f.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ContentRenderer.aed2ed72.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ContentRendererMarkdown.vue.e32f89c0.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/DocumentDrivenNotFound.a5683644.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ButtonLink.f1a8b3dd.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/slot.e1e48d51.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/node.80739779.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/IconDocus.1e448907.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/default.1b85cf07.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/DocsPageLayout.2a05edbb.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/DocsAside.4d7e93a6.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseCodeInline.dda248a1.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/Alert.7f4970d9.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/DocsPageBottom.fac2beee.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseA.1e795e29.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/EditOnLink.vue.60dbcf44.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/DocsPrevNext.f329e89b.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/DocsToc.50b7cb92.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/DocsTocLinks.4cac430f.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ContentRendererMarkdown.fcfe3906.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseH1.0284e752.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseH3.8425b940.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseP.e282d181.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseImg.af003540.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseStrong.09d25272.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseBlockquote.b0c0ac63.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseHr.2727f7ef.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseUl.3476aeee.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseLi.0a863029.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseH4.c673788e.js">
<link rel="prefetch" as="style" href="/blog/_nuxt/page.70291227.css">
<link rel="prefetch" as="script" crossorigin href="/blog/_nuxt/page.ceaf1893.js">
<link rel="prefetch" as="script" crossorigin href="/blog/_nuxt/client-db.c08406d8.js">
<link rel="prefetch" as="style" href="/blog/_nuxt/useStudio.37ff8fdd.css">
<link rel="prefetch" as="script" crossorigin href="/blog/_nuxt/useStudio.633543e7.js">
<link rel="prefetch" as="script" crossorigin href="/blog/_nuxt/debug.17344811.js">
<link rel="prefetch" as="style" href="/blog/_nuxt/error-404.e7689c2d.css">
<link rel="prefetch" as="script" crossorigin href="/blog/_nuxt/error-404.08f87510.js">
<link rel="prefetch" as="style" href="/blog/_nuxt/error-500.92b46a75.css">
<link rel="prefetch" as="script" crossorigin href="/blog/_nuxt/error-500.188bc59b.js">
<script type="module" src="/blog/_nuxt/entry.a772b460.js" crossorigin></script><style id="pinceau-runtime-hydratable">@media{.phy[--]{--puid:OmZdVk-v;}.pv-7T26Fq{padding-left:var(--elements-container-padding-mobile);padding-right:var(--elements-container-padding-mobile);}@media (min-width: 475px){.pv-7T26Fq{padding-left:var(--elements-container-padding-xs);padding-right:var(--elements-container-padding-xs);}}@media (min-width: 640px){.pv-7T26Fq{padding-left:var(--elements-container-padding-sm);padding-right:var(--elements-container-padding-sm);}}@media (min-width: 768px){.pv-7T26Fq{padding-left:var(--elements-container-padding-md);padding-right:var(--elements-container-padding-md);}}} @media{.phy[--]{--puid:enNCWj-v;}.pv-KgShtt{max-width:var(--elements-container-maxWidth);padding-left:var(--elements-container-padding-mobile);padding-right:var(--elements-container-padding-mobile);}@media (min-width: 475px){.pv-KgShtt{padding-left:var(--elements-container-padding-xs);padding-right:var(--elements-container-padding-xs);}}@media (min-width: 640px){.pv-KgShtt{padding-left:var(--elements-container-padding-sm);padding-right:var(--elements-container-padding-sm);}}@media (min-width: 768px){.pv-KgShtt{padding-left:var(--elements-container-padding-md);padding-right:var(--elements-container-padding-md);}}} </style><style id="pinceau-theme">@media { :root {--pinceau-mq: initial; --docus-search-results-highlight-color: white;--docus-search-results-window-maxHeight: 100%;--docus-search-results-window-maxWidth: 640px;--docus-search-results-window-marginTop: 0;--docus-search-input-borderStyle: solid;--docus-search-input-borderWidth: 1px;--docus-search-backdropFilter: blur(24px);--docus-loadingBar-gradientColorStop3: #0047e1;--docus-loadingBar-gradientColorStop2: #34cdfe;--docus-loadingBar-gradientColorStop1: #00dc82;--docus-loadingBar-height: 3px;--docus-readableLine: 78ch;--docus-footer-height: 145px;--docus-header-height: 64px;--prose-code-inline-padding: 0.2rem 0.375rem 0.2rem 0.375rem;--prose-code-block-backdropFilter: contrast(1);--prose-code-block-border-style: solid;--prose-code-block-border-width: 1px;--prose-tbody-tr-borderBottom-style: dashed;--prose-tbody-tr-borderBottom-width: 1px;--prose-th-textAlign: inherit;--prose-thead-borderBottom-style: solid;--prose-thead-borderBottom-width: 1px;--prose-thead-border-style: solid;--prose-thead-border-width: 0px;--prose-table-textAlign: start;--prose-hr-width: 1px;--prose-hr-style: solid;--prose-li-listStylePosition: outside;--prose-ol-li-markerColor: currentColor;--prose-ol-paddingInlineStart: 21px;--prose-ol-listStyleType: decimal;--prose-ul-li-markerColor: currentColor;--prose-ul-paddingInlineStart: 21px;--prose-ul-listStyleType: disc;--prose-blockquote-border-style: solid;--prose-blockquote-border-width: 4px;--prose-blockquote-quotes: '201C' '201D' '2018' '2019';--prose-blockquote-paddingInlineStart: 24px;--prose-a-code-color-hover: currentColor;--prose-a-code-color-static: currentColor;--prose-a-hasCode-borderBottom: none;--prose-a-border-distance: 2px;--prose-a-border-color-hover: currentColor;--prose-a-border-color-static: currentColor;--prose-a-border-style-hover: solid;--prose-a-border-style-static: dashed;--prose-a-border-width: 1px;--prose-a-color-static: inherit;--prose-a-textDecoration: none;--prose-h6-margin: 3rem 0 2rem;--prose-h5-margin: 3rem 0 2rem;--prose-h4-margin: 3rem 0 2rem;--prose-h3-margin: 3rem 0 2rem;--prose-h2-margin: 3rem 0 2rem;--prose-h1-margin: 0 0 2rem;--typography-lead-loose: 2;--typography-lead-relaxed: 1.625;--typography-lead-normal: 1.5;--typography-lead-snug: 1.375;--typography-lead-tight: 1.25;--typography-lead-none: 1;--typography-lead-10: 2.5rem;--typography-lead-9: 2.25rem;--typography-lead-8: 2rem;--typography-lead-7: 1.75rem;--typography-lead-6: 1.5rem;--typography-lead-5: 1.25rem;--typography-lead-4: 1rem;--typography-lead-3: .75rem;--typography-lead-2: .5rem;--typography-lead-1: .025rem;--typography-fontWeight-black: 900;--typography-fontWeight-extrabold: 800;--typography-fontWeight-bold: 700;--typography-fontWeight-semibold: 600;--typography-fontWeight-medium: 500;--typography-fontWeight-normal: 400;--typography-fontWeight-light: 300;--typography-fontWeight-extralight: 200;--typography-fontWeight-thin: 100;--typography-fontSize-9xl: 128px;--typography-fontSize-8xl: 96px;--typography-fontSize-7xl: 72px;--typography-fontSize-6xl: 60px;--typography-fontSize-5xl: 48px;--typography-fontSize-4xl: 36px;--typography-fontSize-3xl: 30px;--typography-fontSize-2xl: 24px;--typography-fontSize-xl: 20px;--typography-fontSize-lg: 18px;--typography-fontSize-base: 16px;--typography-fontSize-sm: 14px;--typography-fontSize-xs: 12px;--typography-letterSpacing-wide: 0.025em;--typography-letterSpacing-tight: -0.025em;--typography-verticalMargin-base: 24px;--typography-verticalMargin-sm: 16px;--elements-border-secondary-hover: [object Object];--elements-backdrop-background: #fffc;--elements-backdrop-filter: saturate(200%) blur(20px);--elements-container-maxWidth: 80rem;--lead-loose: 2;--lead-relaxed: 1.625;--lead-normal: 1.5;--lead-snug: 1.375;--lead-tight: 1.25;--lead-none: 1;--lead-10: 2.5rem;--lead-9: 2.25rem;--lead-8: 2rem;--lead-7: 1.75rem;--lead-6: 1.5rem;--lead-5: 1.25rem;--lead-4: 1rem;--lead-3: .75rem;--lead-2: .5rem;--lead-1: .025rem;--letterSpacing-widest: 0.1em;--letterSpacing-wider: 0.05em;--letterSpacing-wide: 0.025em;--letterSpacing-normal: 0em;--letterSpacing-tight: -0.025em;--letterSpacing-tighter: -0.05em;--fontSize-9xl: 8rem;--fontSize-8xl: 6rem;--fontSize-7xl: 4.5rem;--fontSize-6xl: 3.75rem;--fontSize-5xl: 3rem;--fontSize-4xl: 2.25rem;--fontSize-3xl: 1.875rem;--fontSize-2xl: 1.5rem;--fontSize-xl: 1.25rem;--fontSize-lg: 1.125rem;--fontSize-base: 1rem;--fontSize-sm: 0.875rem;--fontSize-xs: 0.75rem;--fontWeight-black: 900;--fontWeight-extrabold: 800;--fontWeight-bold: 700;--fontWeight-semibold: 600;--fontWeight-medium: 500;--fontWeight-normal: 400;--fontWeight-light: 300;--fontWeight-extralight: 200;--fontWeight-thin: 100;--font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace;--font-serif: ui-serif, Georgia, Cambria, Times New Roman, Times, serif;--font-sans: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Arial, Noto Sans, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji;--opacity-total: 1;--opacity-high: 0.8;--opacity-medium: 0.5;--opacity-soft: 0.3;--opacity-light: 0.15;--opacity-bright: 0.1;--opacity-noOpacity: 0;--borderWidth-lg: 3px;--borderWidth-md: 2px;--borderWidth-sm: 1px;--borderWidth-noBorder: 0;--space-rem-875: 0.875rem;--space-rem-625: 0.625rem;--space-rem-375: 0.375rem;--space-rem-125: 0.125rem;--space-px: 1px;--space-128: 32rem;--space-96: 24rem;--space-80: 20rem;--space-72: 18rem;--space-64: 16rem;--space-60: 15rem;--space-56: 14rem;--space-52: 13rem;--space-48: 12rem;--space-44: 11rem;--space-40: 10rem;--space-36: 9rem;--space-32: 8rem;--space-28: 7rem;--space-24: 6rem;--space-20: 5rem;--space-16: 4rem;--space-14: 3.5rem;--space-12: 3rem;--space-11: 2.75rem;--space-10: 2.5rem;--space-9: 2.25rem;--space-8: 2rem;--space-7: 1.75rem;--space-6: 1.5rem;--space-5: 1.25rem;--space-4: 1rem;--space-3: 0.75rem;--space-2: 0.5rem;--space-1: 0.25rem;--space-0: 0px;--size-full: 100%;--size-7xl: 80rem;--size-6xl: 72rem;--size-5xl: 64rem;--size-4xl: 56rem;--size-3xl: 48rem;--size-2xl: 42rem;--size-xl: 36rem;--size-lg: 32rem;--size-md: 28rem;--size-sm: 24rem;--size-xs: 20rem;--size-200: 200px;--size-104: 104px;--size-80: 80px;--size-64: 64px;--size-56: 56px;--size-48: 48px;--size-40: 40px;--size-32: 32px;--size-24: 24px;--size-20: 20px;--size-16: 16px;--size-12: 12px;--size-8: 8px;--size-6: 6px;--size-4: 4px;--size-2: 2px;--size-0: 0px;--radii-full: 9999px;--radii-3xl: 1.75rem;--radii-2xl: 1.5rem;--radii-xl: 1rem;--radii-lg: 0.75rem;--radii-md: 0.5rem;--radii-sm: 0.375rem;--radii-xs: 0.25rem;--radii-2xs: 0.125rem;--radii-none: 0px;--shadow-none: 0px 0px 0px 0px transparent;--height-screen: 100vh;--width-screen: 100vw;--color-primary-900: #001A1F;--color-primary-800: #00232B;--color-primary-700: #024757;--color-primary-600: #09A0C1;--color-primary-500: #1AD6FF;--color-primary-400: #55E1FF;--color-primary-300: #82E3FF;--color-primary-200: #C5F2FF;--color-primary-100: #DCF7FF;--color-primary-50: #F1FCFF;--color-ruby-900: #380011;--color-ruby-800: #700021;--color-ruby-700: #a90032;--color-ruby-600: #e10043;--color-ruby-500: #ff1a5e;--color-ruby-400: #ff4079;--color-ruby-300: #ff6694;--color-ruby-200: #ff8dae;--color-ruby-100: #ffb3c9;--color-ruby-50: #ffd9e4;--color-pink-900: #380025;--color-pink-800: #70004b;--color-pink-700: #a90070;--color-pink-600: #e10095;--color-pink-500: #ff1ab2;--color-pink-400: #ff40bf;--color-pink-300: #ff66cc;--color-pink-200: #ff8dd8;--color-pink-100: #ffb3e5;--color-pink-50: #ffd9f2;--color-purple-900: #190038;--color-purple-800: #330070;--color-purple-700: #4c00a9;--color-purple-600: #6500e1;--color-purple-500: #811aff;--color-purple-400: #9640ff;--color-purple-300: #ab66ff;--color-purple-200: #c08dff;--color-purple-100: #d5b3ff;--color-purple-50: #ead9ff;--color-royalblue-900: #0b0531;--color-royalblue-800: #160a62;--color-royalblue-700: #211093;--color-royalblue-600: #2c15c4;--color-royalblue-500: #4127e8;--color-royalblue-400: #614bec;--color-royalblue-300: #806ff0;--color-royalblue-200: #a093f3;--color-royalblue-100: #c0b7f7;--color-royalblue-50: #dfdbfb;--color-indigoblue-900: #001238;--color-indigoblue-800: #002370;--color-indigoblue-700: #0035a9;--color-indigoblue-600: #0047e1;--color-indigoblue-500: #1a62ff;--color-indigoblue-400: #407cff;--color-indigoblue-300: #6696ff;--color-indigoblue-200: #8db0ff;--color-indigoblue-100: #b3cbff;--color-indigoblue-50: #d9e5ff;--color-blue-900: #00131D;--color-blue-800: #002235;--color-blue-700: #014267;--color-blue-600: #0069A6;--color-blue-500: #1AADFF;--color-blue-400: #64C7FF;--color-blue-300: #A1DDFF;--color-blue-200: #C6EAFF;--color-blue-100: #DFF3FF;--color-blue-50: #F2FAFF;--color-lightblue-900: #002e38;--color-lightblue-800: #005c70;--color-lightblue-700: #008aa9;--color-lightblue-600: #00b9e1;--color-lightblue-500: #1ad6ff;--color-lightblue-400: #40ddff;--color-lightblue-300: #66e4ff;--color-lightblue-200: #8deaff;--color-lightblue-100: #b3f1ff;--color-lightblue-50: #d9f8ff;--color-teal-900: #062a28;--color-teal-800: #0b544f;--color-teal-700: #117d77;--color-teal-600: #16a79e;--color-teal-500: #1cd1c6;--color-teal-400: #36e4da;--color-teal-300: #5fe9e1;--color-teal-200: #87efe9;--color-teal-100: #aff4f0;--color-teal-50: #d7faf8;--color-pear-900: #2a2b09;--color-pear-800: #545512;--color-pear-700: #7e801b;--color-pear-600: #a8aa24;--color-pear-500: #d0d32f;--color-pear-400: #d8da52;--color-pear-300: #e0e274;--color-pear-200: #e8e997;--color-pear-100: #eff0ba;--color-pear-50: #f7f8dc;--color-red-900: #1C0301;--color-red-800: #340A01;--color-red-700: #701704;--color-red-600: #BB2402;--color-red-500: #FF3B10;--color-red-400: #FF7353;--color-red-300: #FFA692;--color-red-200: #FFDED7;--color-red-100: #FFF3F0;--color-red-50: #FFF9F8;--color-orange-900: #381800;--color-orange-800: #702f00;--color-orange-700: #a94700;--color-orange-600: #e15e00;--color-orange-500: #ff7a1a;--color-orange-400: #ff9040;--color-orange-300: #ffa666;--color-orange-200: #ffbd8d;--color-orange-100: #ffd3b3;--color-orange-50: #ffe9d9;--color-yellow-900: #1B1500;--color-yellow-800: #292100;--color-yellow-700: #614E02;--color-yellow-600: #CBA408;--color-yellow-500: #FBCA05;--color-yellow-400: #FFDC4E;--color-yellow-300: #FFE372;--color-yellow-200: #FFF0B1;--color-yellow-100: #FFF6D3;--color-yellow-50: #FFFCEE;--color-green-900: #00190F;--color-green-800: #002817;--color-green-700: #006037;--color-green-600: #00B467;--color-green-500: #0DD885;--color-green-400: #3CEEA5;--color-green-300: #86FBCB;--color-green-200: #C3FFE6;--color-green-100: #DEFFF1;--color-green-50: #ECFFF7;--color-gray-900: #121110;--color-gray-800: #201E1B;--color-gray-700: #36332E;--color-gray-600: #67635D;--color-gray-500: #97948F;--color-gray-400: #ADA9A4;--color-gray-300: #DBD9D3;--color-gray-200: #ECEBE8;--color-gray-100: #F6F5F4;--color-gray-50: #FBFBFB;--color-black: #0B0A0A;--color-white: #ffffff;--media-portrait: only screen and (orientation: portrait);--media-landscape: only screen and (orientation: landscape);--media-rm: (prefers-reduced-motion: reduce);--media-2xl: (min-width: 1536px);--media-xl: (min-width: 1280px);--media-lg: (min-width: 1024px);--media-md: (min-width: 768px);--media-sm: (min-width: 640px);--media-xs: (min-width: 475px);--docus-search-results-highlight-backgroundColor: var(--color-primary-500);--docus-search-results-selected-backgroundColor: var(--color-gray-300);--docus-search-results-window-borderRadius: none;--docus-search-results-window-marginX: 0;--docus-search-input-backgroundColor: var(--color-gray-200);--docus-search-input-padding: var(--space-2) var(--space-4);--docus-search-input-gap: var(--space-2);--docus-search-input-fontSize: var(--fontSize-sm);--docus-search-input-borderColor: var(--color-gray-200);--docus-search-input-borderRadius: var(--radii-2xs);--docus-footer-padding: var(--space-4) 0;--docus-header-title-color-hover: var(--color-primary-500);--docus-header-title-color-static: var(--color-gray-900);--docus-header-title-fontWeight: var(--fontWeight-bold);--docus-header-title-fontSize: var(--fontSize-2xl);--docus-header-logo-height: var(--space-6);--docus-body-fontFamily: var(--font-sans);--docus-body-color: var(--color-gray-800);--docus-body-backgroundColor: var(--color-white);--prose-code-inline-fontWeight: var(--typography-fontWeight-normal);--prose-code-inline-fontSize: var(--typography-fontSize-sm);--prose-code-inline-borderRadius: var(--radii-xs);--prose-code-block-pre-padding: var(--typography-verticalMargin-sm);--prose-code-block-margin: var(--typography-verticalMargin-base) 0;--prose-code-block-fontSize: var(--typography-fontSize-sm);--prose-tbody-code-inline-fontSize: var(--typography-fontSize-sm);--prose-tbody-td-padding: var(--typography-verticalMargin-sm);--prose-th-fontWeight: var(--typography-fontWeight-semibold);--prose-th-padding: 0 var(--typography-verticalMargin-sm) var(--typography-verticalMargin-sm) var(--typography-verticalMargin-sm);--prose-table-lineHeight: var(--typography-lead-6);--prose-table-fontSize: var(--typography-fontSize-sm);--prose-table-margin: var(--typography-verticalMargin-base) 0;--prose-hr-margin: var(--typography-verticalMargin-base) 0;--prose-li-margin: var(--typography-verticalMargin-sm) 0;--prose-ol-margin: var(--typography-verticalMargin-base) 0;--prose-ul-margin: var(--typography-verticalMargin-base) 0;--prose-blockquote-margin: var(--typography-verticalMargin-base) 0;--prose-a-code-border-style: var(--prose-a-border-style-static);--prose-a-code-border-width: var(--prose-a-border-width);--prose-a-fontWeight: var(--typography-fontWeight-medium);--prose-img-margin: var(--typography-verticalMargin-base) 0;--prose-strong-fontWeight: var(--typography-fontWeight-semibold);--prose-h6-iconSize: var(--typography-fontSize-base);--prose-h6-fontWeight: var(--typography-fontWeight-semibold);--prose-h6-lineHeight: var(--typography-lead-normal);--prose-h6-fontSize: var(--typography-fontSize-lg);--prose-h5-iconSize: var(--typography-fontSize-lg);--prose-h5-fontWeight: var(--typography-fontWeight-semibold);--prose-h5-lineHeight: var(--typography-lead-snug);--prose-h5-fontSize: var(--typography-fontSize-xl);--prose-h4-iconSize: var(--typography-fontSize-lg);--prose-h4-letterSpacing: var(--typography-letterSpacing-tight);--prose-h4-fontWeight: var(--typography-fontWeight-semibold);--prose-h4-lineHeight: var(--typography-lead-snug);--prose-h4-fontSize: var(--typography-fontSize-2xl);--prose-h3-iconSize: var(--typography-fontSize-xl);--prose-h3-letterSpacing: var(--typography-letterSpacing-tight);--prose-h3-fontWeight: var(--typography-fontWeight-semibold);--prose-h3-lineHeight: var(--typography-lead-snug);--prose-h3-fontSize: var(--typography-fontSize-3xl);--prose-h2-iconSize: var(--typography-fontSize-2xl);--prose-h2-letterSpacing: var(--typography-letterSpacing-tight);--prose-h2-fontWeight: var(--typography-fontWeight-semibold);--prose-h2-lineHeight: var(--typography-lead-tight);--prose-h2-fontSize: var(--typography-fontSize-4xl);--prose-h1-iconSize: var(--typography-fontSize-3xl);--prose-h1-letterSpacing: var(--typography-letterSpacing-tight);--prose-h1-fontWeight: var(--typography-fontWeight-bold);--prose-h1-lineHeight: var(--typography-lead-tight);--prose-h1-fontSize: var(--typography-fontSize-5xl);--prose-p-br-margin: var(--typography-verticalMargin-base) 0 0 0;--prose-p-margin: var(--typography-verticalMargin-base) 0;--prose-p-lineHeight: var(--typography-lead-normal);--prose-p-fontSize: var(--typography-fontSize-base);--typography-color-secondary-900: var(--color-gray-900);--typography-color-secondary-800: var(--color-gray-800);--typography-color-secondary-700: var(--color-gray-700);--typography-color-secondary-600: var(--color-gray-600);--typography-color-secondary-500: var(--color-gray-500);--typography-color-secondary-400: var(--color-gray-400);--typography-color-secondary-300: var(--color-gray-300);--typography-color-secondary-200: var(--color-gray-200);--typography-color-secondary-100: var(--color-gray-100);--typography-color-secondary-50: var(--color-gray-50);--typography-color-primary-900: var(--color-primary-900);--typography-color-primary-800: var(--color-primary-800);--typography-color-primary-700: var(--color-primary-700);--typography-color-primary-600: var(--color-primary-600);--typography-color-primary-500: var(--color-primary-500);--typography-color-primary-400: var(--color-primary-400);--typography-color-primary-300: var(--color-primary-300);--typography-color-primary-200: var(--color-primary-200);--typography-color-primary-100: var(--color-primary-100);--typography-color-primary-50: var(--color-primary-50);--typography-font-code: var(--font-mono);--typography-font-body: var(--font-sans);--typography-font-display: var(--font-sans);--typography-body-backgroundColor: var(--color-white);--typography-body-color: var(--color-black);--elements-state-danger-borderColor-secondary: var(--color-red-200);--elements-state-danger-borderColor-primary: var(--color-red-100);--elements-state-danger-backgroundColor-secondary: var(--color-red-100);--elements-state-danger-backgroundColor-primary: var(--color-red-50);--elements-state-danger-color-secondary: var(--color-red-600);--elements-state-danger-color-primary: var(--color-red-500);--elements-state-warning-borderColor-secondary: var(--color-yellow-200);--elements-state-warning-borderColor-primary: var(--color-yellow-100);--elements-state-warning-backgroundColor-secondary: var(--color-yellow-100);--elements-state-warning-backgroundColor-primary: var(--color-yellow-50);--elements-state-warning-color-secondary: var(--color-yellow-700);--elements-state-warning-color-primary: var(--color-yellow-600);--elements-state-success-borderColor-secondary: var(--color-green-200);--elements-state-success-borderColor-primary: var(--color-green-100);--elements-state-success-backgroundColor-secondary: var(--color-green-100);--elements-state-success-backgroundColor-primary: var(--color-green-50);--elements-state-success-color-secondary: var(--color-green-600);--elements-state-success-color-primary: var(--color-green-500);--elements-state-info-borderColor-secondary: var(--color-blue-200);--elements-state-info-borderColor-primary: var(--color-blue-100);--elements-state-info-backgroundColor-secondary: var(--color-blue-100);--elements-state-info-backgroundColor-primary: var(--color-blue-50);--elements-state-info-color-secondary: var(--color-blue-600);--elements-state-info-color-primary: var(--color-blue-500);--elements-state-primary-borderColor-secondary: var(--color-primary-200);--elements-state-primary-borderColor-primary: var(--color-primary-100);--elements-state-primary-backgroundColor-secondary: var(--color-primary-100);--elements-state-primary-backgroundColor-primary: var(--color-primary-50);--elements-state-primary-color-secondary: var(--color-primary-700);--elements-state-primary-color-primary: var(--color-primary-600);--elements-surface-secondary-backgroundColor: var(--color-gray-200);--elements-surface-primary-backgroundColor: var(--color-gray-100);--elements-surface-background-base: var(--color-gray-100);--elements-border-secondary-static: var(--color-gray-200);--elements-border-primary-hover: var(--color-gray-200);--elements-border-primary-static: var(--color-gray-100);--elements-container-padding-md: var(--space-6);--elements-container-padding-sm: var(--space-6);--elements-container-padding-xs: var(--space-4);--elements-container-padding-mobile: var(--space-4);--elements-text-secondary-color-hover: var(--color-gray-700);--elements-text-secondary-color-static: var(--color-gray-500);--elements-text-primary-color-static: var(--color-gray-900);--text-6xl-lineHeight: var(--lead-none);--text-6xl-fontSize: var(--fontSize-6xl);--text-5xl-lineHeight: var(--lead-none);--text-5xl-fontSize: var(--fontSize-5xl);--text-4xl-lineHeight: var(--lead-10);--text-4xl-fontSize: var(--fontSize-4xl);--text-3xl-lineHeight: var(--lead-9);--text-3xl-fontSize: var(--fontSize-3xl);--text-2xl-lineHeight: var(--lead-8);--text-2xl-fontSize: var(--fontSize-2xl);--text-xl-lineHeight: var(--lead-7);--text-xl-fontSize: var(--fontSize-xl);--text-lg-lineHeight: var(--lead-7);--text-lg-fontSize: var(--fontSize-lg);--text-base-lineHeight: var(--lead-6);--text-base-fontSize: var(--fontSize-base);--text-sm-lineHeight: var(--lead-5);--text-sm-fontSize: var(--fontSize-sm);--text-xs-lineHeight: var(--lead-4);--text-xs-fontSize: var(--fontSize-xs);--color-shadow: var(--color-gray-400);--color-secondary-900: var(--color-gray-900);--color-secondary-800: var(--color-gray-800);--color-secondary-700: var(--color-gray-700);--color-secondary-600: var(--color-gray-600);--color-secondary-500: var(--color-gray-500);--color-secondary-400: var(--color-gray-400);--color-secondary-300: var(--color-gray-300);--color-secondary-200: var(--color-gray-200);--color-secondary-100: var(--color-gray-100);--color-secondary-50: var(--color-gray-50);--prose-code-inline-backgroundColor: var(--typography-color-secondary-100);--prose-code-inline-color: var(--typography-color-secondary-700);--prose-code-block-backgroundColor: var(--typography-color-secondary-100);--prose-code-block-color: var(--typography-color-secondary-700);--prose-code-block-border-color: var(--typography-color-secondary-200);--prose-tbody-tr-borderBottom-color: var(--typography-color-secondary-200);--prose-th-color: var(--typography-color-secondary-600);--prose-thead-borderBottom-color: var(--typography-color-secondary-200);--prose-thead-border-color: var(--typography-color-secondary-300);--prose-hr-color: var(--typography-color-secondary-200);--prose-blockquote-border-color: var(--typography-color-secondary-200);--prose-blockquote-color: var(--typography-color-secondary-500);--prose-a-code-background-hover: var(--typography-color-primary-50);--prose-a-code-border-color-hover: var(--typography-color-primary-500);--prose-a-code-border-color-static: var(--typography-color-secondary-400);--prose-a-color-hover: var(--typography-color-primary-500);--shadow-2xl: 0px 25px 50px -12px var(--color-shadow);--shadow-xl: 0px 20px 25px -5px var(--color-shadow), 0px 8px 10px -6px var(--color-shadow);--shadow-lg: 0px 10px 15px -3px var(--color-shadow), 0px 4px 6px -4px var(--color-shadow);--shadow-md: 0px 4px 6px -1px var(--color-shadow), 0px 2px 4px -2px var(--color-shadow);--shadow-sm: 0px 1px 3px 0px var(--color-shadow), 0px 1px 2px -1px var(--color-shadow);--shadow-xs: 0px 1px 2px 0px var(--color-shadow); } }@media { :root.dark {--pinceau-mq: dark; --prose-code-block-backdropFilter: contrast(1);--prose-ol-li-markerColor: currentColor;--prose-ul-li-markerColor: currentColor;--prose-a-code-color-hover: currentColor;--prose-a-code-color-static: currentColor;--prose-a-border-color-hover: currentColor;--prose-a-border-color-static: currentColor;--prose-a-color-static: inherit;--elements-backdrop-background: #0c0d0ccc;--docus-search-results-selected-backgroundColor: var(--color-gray-700);--docus-search-input-backgroundColor: var(--color-gray-800);--docus-search-input-borderColor: transparent;--docus-header-title-color-static: var(--color-gray-100);--docus-body-color: var(--color-gray-200);--docus-body-backgroundColor: var(--color-black);--typography-body-backgroundColor: var(--color-black);--typography-body-color: var(--color-white);--elements-state-danger-borderColor-secondary: var(--color-red-700);--elements-state-danger-borderColor-primary: var(--color-red-800);--elements-state-danger-backgroundColor-secondary: var(--color-red-800);--elements-state-danger-backgroundColor-primary: var(--color-red-900);--elements-state-danger-color-secondary: var(--color-red-200);--elements-state-danger-color-primary: var(--color-red-300);--elements-state-warning-borderColor-secondary: var(--color-yellow-700);--elements-state-warning-borderColor-primary: var(--color-yellow-800);--elements-state-warning-backgroundColor-secondary: var(--color-yellow-800);--elements-state-warning-backgroundColor-primary: var(--color-yellow-900);--elements-state-warning-color-secondary: var(--color-yellow-200);--elements-state-warning-color-primary: var(--color-yellow-400);--elements-state-success-borderColor-secondary: var(--color-green-700);--elements-state-success-borderColor-primary: var(--color-green-800);--elements-state-success-backgroundColor-secondary: var(--color-green-800);--elements-state-success-backgroundColor-primary: var(--color-green-900);--elements-state-success-color-secondary: var(--color-green-200);--elements-state-success-color-primary: var(--color-green-400);--elements-state-info-borderColor-secondary: var(--color-blue-700);--elements-state-info-borderColor-primary: var(--color-blue-800);--elements-state-info-backgroundColor-secondary: var(--color-blue-800);--elements-state-info-backgroundColor-primary: var(--color-blue-900);--elements-state-info-color-secondary: var(--color-blue-200);--elements-state-info-color-primary: var(--color-blue-400);--elements-state-primary-borderColor-secondary: var(--color-primary-700);--elements-state-primary-borderColor-primary: var(--color-primary-800);--elements-state-primary-backgroundColor-secondary: var(--color-primary-800);--elements-state-primary-backgroundColor-primary: var(--color-primary-900);--elements-state-primary-color-secondary: var(--color-primary-200);--elements-state-primary-color-primary: var(--color-primary-400);--elements-surface-secondary-backgroundColor: var(--color-gray-800);--elements-surface-primary-backgroundColor: var(--color-gray-900);--elements-surface-background-base: var(--color-gray-900);--elements-border-secondary-static: var(--color-gray-800);--elements-border-primary-hover: var(--color-gray-800);--elements-border-primary-static: var(--color-gray-900);--elements-text-secondary-color-hover: var(--color-gray-200);--elements-text-secondary-color-static: var(--color-gray-400);--elements-text-primary-color-static: var(--color-gray-50);--color-shadow: var(--color-gray-800);--prose-code-inline-backgroundColor: var(--typography-color-secondary-800);--prose-code-inline-color: var(--typography-color-secondary-200);--prose-code-block-backgroundColor: var(--typography-color-secondary-900);--prose-code-block-color: var(--typography-color-secondary-200);--prose-code-block-border-color: var(--typography-color-secondary-800);--prose-tbody-tr-borderBottom-color: var(--typography-color-secondary-800);--prose-th-color: var(--typography-color-secondary-400);--prose-thead-borderBottom-color: var(--typography-color-secondary-800);--prose-thead-border-color: var(--typography-color-secondary-600);--prose-hr-color: var(--typography-color-secondary-800);--prose-blockquote-border-color: var(--typography-color-secondary-700);--prose-blockquote-color: var(--typography-color-secondary-400);--prose-a-code-background-hover: var(--typography-color-primary-900);--prose-a-code-border-color-hover: var(--typography-color-primary-600);--prose-a-code-border-color-static: var(--typography-color-secondary-600);--prose-a-color-hover: var(--typography-color-primary-400); } }@media (min-width: 640px) { :root {--pinceau-mq: sm; --docus-search-results-window-maxHeight: 320px;--docus-search-results-window-marginTop: 20vh;--docus-footer-height: 100px;--docus-search-results-window-borderRadius: var(--radii-xs);--docus-search-results-window-marginX: var(--space-4);--docus-header-logo-height: var(--space-7); } }</style><script>"use strict";(()=>{const a=window,e=document.documentElement,m=["dark","light"],c=window.localStorage.getItem("nuxt-color-mode")||"system";let n=c==="system"?f():c;const l=e.getAttribute("data-color-mode-forced");l&&(n=l),i(n),a["__NUXT_COLOR_MODE__"]={preference:c,value:n,getColorScheme:f,addColorScheme:i,removeColorScheme:d};function i(o){const t=""+o+"",s="theme";e.classList?e.classList.add(t):e.className+=" "+t,s&&e.setAttribute("data-"+s,o)}function d(o){const t=""+o+"",s="theme";e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp(t,"g"),""),s&&e.removeAttribute("data-"+s)}function r(o){return a.matchMedia("(prefers-color-scheme"+o+")")}function f(){if(a.matchMedia&&r("").media!=="not all"){for(const o of m)if(r(":"+o).matches)return o}return"light"}})();
</script></head>
<body ><!----><!--teleport anchor--><!----><!--teleport anchor--><div id="__nuxt"><div class="app-layout" data-v-5c2f7786><div class="nuxt-progress" style="width:0%;opacity:0;background-size:Infinity% auto;" data-v-5c2f7786></div><header class="has-dialog" data-v-5c2f7786 data-v-f465a985><div class="container pv-7T26Fq pc-OmZdVk" data-v-f465a985 data-v-a8d7e2a7><!--[--><div class="section left" data-v-f465a985><!--[--><button aria-label="Menu" data-v-8fd30205><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" role="img" class="icon" data-v-8fd30205 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg></button><!--teleport start--><!--teleport end--><!--]--><a href="/blog/" class="navbar-logo" aria-label="Spyua Blog" data-v-f465a985 data-v-58a8631e><span class="title" data-v-58a8631e>Spyua Blog</span></a></div><div class="section center" data-v-f465a985><a href="/blog/" class="navbar-logo" aria-label="Spyua Blog" data-v-f465a985 data-v-58a8631e><span class="title" data-v-58a8631e>Spyua Blog</span></a><!----></div><div class="section right" data-v-f465a985><!--[--><button type="button" aria-label="Search" data-v-42bfc035><span class="content" data-v-42bfc035><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-42bfc035 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21l-6-6m2-5a7 7 0 1 1-14 0a7 7 0 0 1 14 0"/></svg><span data-v-42bfc035>Search</span><span data-v-42bfc035><kbd data-v-42bfc035>⌘</kbd><kbd data-v-42bfc035>K</kbd></span></span></button><!--teleport start--><!--teleport end--><!--]--><button aria-label="Color Mode" data-v-f465a985 data-v-87324333><span data-v-87324333>...</span></button><div class="social-icons" data-v-f465a985><!--[--><a href="https://github.com/spyua" rel="noopener noreferrer" target="_blank" title="https://github.com/spyua" aria-label="https://github.com/spyua" data-v-22569e45><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-22569e45 style="" width="1em" height="1em" viewBox="0 0 496 512" data-v-e610b8e3><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9c1.6 2.3 4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2"/></svg></a><!--]--></div></div><!--]--></div></header><main data-v-5c2f7786><!--[--><div class="document-driven-page"><div class="container pv-7T26Fq pc-O56YsI docs-page-content fluid has-toc has-aside" data-v-73d798d2 data-v-a8d7e2a7><!--[--><aside class="aside-nav" data-v-73d798d2><nav class="app-aside" data-v-73d798d2 data-v-89fb8999><ul class="docs-aside-tree" data-v-89fb8999 data-v-d42239fd><!--[--><li class="" data-v-d42239fd><button class="title-collapsible-button" data-v-d42239fd><span class="content" data-v-d42239fd><span class="icon" style="font-size:1em;line-height:1em;width:1em;height:1em;" data-v-d42239fd data-v-e610b8e3>🧑‍💻</span><span data-v-d42239fd>Codesnese</span></span><span data-v-d42239fd><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-d42239fd style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-d42239fd data-v-d42239fd><!--[--><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/code/refcotr" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>重構筆記</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/code/(di)" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>依賴注入(DI)</span></span></a><!----></li><!--]--></ul></li><li class="" data-v-d42239fd><button class="title-collapsible-button" data-v-d42239fd><span class="content" data-v-d42239fd><span class="icon" style="font-size:1em;line-height:1em;width:1em;height:1em;" data-v-d42239fd data-v-e610b8e3>🧑‍💻</span><span data-v-d42239fd>Architecture</span></span><span data-v-d42239fd><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-d42239fd style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-d42239fd data-v-d42239fd><!--[--><li class="has-parent-icon bordered active" data-v-d42239fd><a aria-current="page" href="/blog/architecture/ddd-module" class="router-link-active router-link-exact-active link padded active" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>DDD實戰-Module</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/architecture/ddd" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>DDD實戰-簡易整理</span></span></a><!----></li><!--]--></ul></li><li class="" data-v-d42239fd><button class="title-collapsible-button" data-v-d42239fd><span class="content" data-v-d42239fd><span class="icon" style="font-size:1em;line-height:1em;width:1em;height:1em;" data-v-d42239fd data-v-e610b8e3>🖥️</span><span data-v-d42239fd>Desktop</span></span><span data-v-d42239fd><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-d42239fd style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-d42239fd data-v-d42239fd><!--[--><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/desktop/windowsformxxxx" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>WindowsForm找不到類型xxxx上的建構涵式</span></span></a><!----></li><!--]--></ul></li><li class="" data-v-d42239fd><button class="title-collapsible-button" data-v-d42239fd><span class="content" data-v-d42239fd><span class="icon" style="font-size:1em;line-height:1em;width:1em;height:1em;" data-v-d42239fd data-v-e610b8e3>🛢️</span><span data-v-d42239fd>Cloud-GCP</span></span><span data-v-d42239fd><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-d42239fd style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-d42239fd data-v-d42239fd><!--[--><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/cloud-gcp/gke" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>GKE</span></span></a><!----></li><!--]--></ul></li><li class="" data-v-d42239fd><button class="title-collapsible-button" data-v-d42239fd><span class="content" data-v-d42239fd><span class="icon" style="font-size:1em;line-height:1em;width:1em;height:1em;" data-v-d42239fd data-v-e610b8e3>🛢️</span><span data-v-d42239fd>Database</span></span><span data-v-d42239fd><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-d42239fd style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-d42239fd data-v-d42239fd><!--[--><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/database/mssqlserver" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>MSSQL使用指令測試Server硬碟速度小技巧</span></span></a><!----></li><!--]--></ul></li><li class="" data-v-d42239fd><button class="title-collapsible-button" data-v-d42239fd><span class="content" data-v-d42239fd><span class="icon" style="font-size:1em;line-height:1em;width:1em;height:1em;" data-v-d42239fd data-v-e610b8e3>🔒</span><span data-v-d42239fd>Keycloak</span></span><span data-v-d42239fd><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-d42239fd style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-d42239fd data-v-d42239fd><!--[--><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/keycloak/keycloak" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>身份驗證與授權與Keycloak</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/keycloak/oidcsaml" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>OIDC vs SAML</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/keycloak/sso" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>關於SSO</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/keycloak/keycloak" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>Keycloak介紹</span></span></a><!----></li><!--]--></ul></li><li class="" data-v-d42239fd><button class="title-collapsible-button" data-v-d42239fd><span class="content" data-v-d42239fd><span class="icon" style="font-size:1em;line-height:1em;width:1em;height:1em;" data-v-d42239fd data-v-e610b8e3>🦸🏻</span><span data-v-d42239fd>Iron Man - 雲端之路養成</span></span><span data-v-d42239fd><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-d42239fd style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-d42239fd data-v-d42239fd><!--[--><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/ironman-gcp/cloud" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>Cloud</span></span></a><!----></li><!--]--></ul></li><!--]--></ul></nav></aside><article class="page-body" data-v-73d798d2><!--[--><!--[--><div><h1 id="ddd實戰-module" data-v-2001208a><a aria-current="page" href="/blog/architecture/ddd-module#ddd實戰-module" class="router-link-active router-link-exact-active" data-v-2001208a><!--[-->DDD實戰-Module<!--]--><!----></a></h1><h3 id="一關於module" data-v-4cf5bb93><a aria-current="page" href="/blog/architecture/ddd-module#一關於module" class="router-link-active router-link-exact-active" data-v-4cf5bb93><!--[-->一、關於Module<!--]--><!----></a></h3><p data-v-9dc9c102><!--[-->在闡述Module前，讓我們先來比對非物件化設計與物件化設計的差異性。看到下圖左，在非物件化的傳統設計，資料與方法操作上是整個拆開設計，在資料流複雜外我們可以看相依性高，偶合的狀況也較高。<!--]--></p><p data-v-9dc9c102><!--[-->接著討論物件化設計部分，先不論封裝等物件操作技巧，單純根據資料與方法關係設計出物件(物件特性:資料(Data) 物件行為:方法(Function))，我們可以看到原本互相依賴的Fun關係可各自獨立使用，在資料流上也較為單純。<!--]--></p><p data-v-9dc9c102><!--[--><img src="/blog/images/01/01/001.png" alt="Data Fun vs Obj" data-v-2ef15301><!--]--></p><p data-v-9dc9c102><!--[-->物件化後，雖然在資料操作面上簡化許多，但隨著專案功能性逐漸增加，物件與功能處理流程上會趨近越複雜，如下圖為一個簡易的系統，此系統根據外部Sensor系統獲取、過濾與計算資料，在沒模組化的設計前提，可以看到Control與Data Flow呈現一個較零散的關係狀態<!--]--></p><p data-v-9dc9c102><!--[--><img src="/blog/images/01/01/002.png" alt="Control &amp;&amp; Data Flow" data-v-2ef15301><!--]--></p><p data-v-9dc9c102><!--[-->此時我們根據Sensor功能額外設計一個Sensor模組如下，此時我們就可以針對Sensor相對應的資料模組將之封裝在模組內，此模組對外則就單純開放運算(calculation)與過濾(filtering)的功能。<!--]--></p><p data-v-9dc9c102><!--[-->模組化後可以明顯看出控制與資料流的彼此相依性值，因此降低了修改與擴充狀況的互相影響性值。<!--]--></p><p data-v-9dc9c102><!--[--><img src="/blog/images/01/01/003.png" alt="Control &amp;&amp; Data Flow 2" data-v-2ef15301><!--]--></p><p data-v-9dc9c102><!--[-->模組化指是將<strong data-v-84b57b07><!--[-->系統功能程序作分離獨立(特定功能class的容器)<!--]--></strong>，除了功能獨立外，也強調設計上可以根據功能隨意抽換模組。達到高內聚、低耦合的目的，進而提高開發者的生產力(將複雜的功能拆分管理)。並讓程式碼能夠透過引用的方式來重複使用，提升重用性(Reusable)<!--]--></p><blockquote data-v-96397147><!--[--><p data-v-9dc9c102><!--[-->Modular design allows code to remain agile in the face of ever-changing requirements.<!--]--></p><!--]--></blockquote><hr id data-v-89dedb08><h3 id="二構成module考量五要素" data-v-4cf5bb93><a aria-current="page" href="/blog/architecture/ddd-module#二構成module考量五要素" class="router-link-active router-link-exact-active" data-v-4cf5bb93><!--[-->二、構成Module考量五要素<!--]--><!----></a></h3><ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->Propose:Module功能目標單一職責，盡量不要與其他模組設計有太多相依關係。<!--]--></li><li data-v-4c2f5fb9><!--[-->Interface:模組功能API所提供使用方式要簡潔易懂，通常User不需要去了解實際內部的實作方式，只需專注在確定輸入什麼，會輸出什麼可達到什麼功能。<!--]--></li><li data-v-4c2f5fb9><!--[-->Encapsulation:封裝模組，除了讓不暴露資料結構讓使用者亂使用外，對於在修改細節上也能較不容易直接影響使用端。另外再使用抽象實作上，物件抽象化多少還是難以避免Leaky Abstractions的問題。<!--]--></li><li data-v-4c2f5fb9><!--[-->Implementation:實作上除了考量功能正確性外還需考慮效能、測試與功能架構程式碼最小化。<!--]--></li><li data-v-4c2f5fb9><!--[-->Connection(關聯性):呼應Propose功能單一職責，將與其他模組相依性最小化。<!--]--></li><!--]--></ul><hr id="_1" data-v-89dedb08><h3 id="三package-vs-module" data-v-4cf5bb93><a aria-current="page" href="/blog/architecture/ddd-module#三package-vs-module" class="router-link-active router-link-exact-active" data-v-4cf5bb93><!--[-->三、Package Vs Module<!--]--><!----></a></h3><p data-v-9dc9c102><!--[-->在了解Module構成要素後~隨著專案模組(Module)的增加，將難以管理及問題的追蹤，這時候就能將模組(Module)打包成套件(Package)，利用其階層式的結構來彈性規劃模組(Module)。<!--]--></p><ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->Module:單一功能模組<!--]--></li><li data-v-4c2f5fb9><!--[-->Package:多Module組成<!--]--></li><!--]--></ul><h3 id="四一般module設計方法" data-v-4cf5bb93><a aria-current="page" href="/blog/architecture/ddd-module#四一般module設計方法" class="router-link-active router-link-exact-active" data-v-4cf5bb93><!--[-->四、一般Module設計方法<!--]--><!----></a></h3><p data-v-9dc9c102><!--[-->在非以領域事件為出發點的設計上，大部分狀況會根據功能設計成物件與介面使用。下圖為Zebra SDK Package的Module列項，我們可以大致分得出，他的Module設計就是根據功能性值去區分(graphics, certificate...)<!--]--></p><p data-v-9dc9c102><!--[--><img src="/blog/images/01/01/004.png" alt="由功能性區分" data-v-2ef15301><!--]--></p><p data-v-9dc9c102><!--[-->接著我們點近discovery看提供什麼API功能，可以看到可以使用的介面功能以及相關功能可使用的功能物件。<!--]--></p><p data-v-9dc9c102><!--[--><img src="/blog/images/01/01/005.png" alt="由功能性區分2" data-v-2ef15301><!--]--></p><p data-v-9dc9c102><!--[-->在點進個別更詳細功能介紹，我們就會看到這物件功能具有什麼資料特質、物件實體化須提供什麼參數以及此物件可使用哪些方法。<!--]--></p><ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->Field: address，IP or Mac Adress<!--]--></li><li data-v-4c2f5fb9><!--[-->Constructor:物件實體化須提供印表機的IP or Mac Adress<!--]--></li><li data-v-4c2f5fb9><!--[-->Method:可使用的物件功能，在此例看起來需實作getConnection功能<!--]--></li><!--]--></ul><p data-v-9dc9c102><!--[--><img src="/blog/images/01/01/006.png" alt="由功能性區分3" data-v-2ef15301><!--]--></p><p data-v-9dc9c102><!--[-->上述為印表機找到印表機裝置功能的模組化介紹<!--]--></p><hr id="_2" data-v-89dedb08><h3 id="五未使用ddd的一般service服務設計" data-v-4cf5bb93><a aria-current="page" href="/blog/architecture/ddd-module#五未使用ddd的一般service服務設計" class="router-link-active router-link-exact-active" data-v-4cf5bb93><!--[-->五、未使用DDD的一般Service服務設計<!--]--><!----></a></h3><p data-v-9dc9c102><!--[-->上述一般Module設計概念聊完，在聊DDD Module設計之前先來聊一下在一般未使用DDD領域設計的服務系統會如何設計。<!--]--></p><p data-v-9dc9c102><!--[-->在對大部分的開發者，一開始習慣設計都以數據為考量的集中式設計架構。設計架構上會出現比較常見到的分層式設計，大致分成Controller, Service, Repositories, Models<!--]--></p><ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->xxx/Model
<ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->數據庫Model、Request Model, Response Model<!--]--></li><!--]--></ul><!--]--></li><li data-v-4c2f5fb9><!--[-->xxx/Controller
<ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->給Client端的API第一時間接口，提供Get,Post,Delete,Update API。除了此在此層一般都會安插屬性驗證Client第一時間傳過來的資料是否正確。並作實際的DTO(Object 與DB Model Mapping)轉換。<!--]--></li><!--]--></ul><!--]--></li><li data-v-4c2f5fb9><!--[-->xxx/Service
<ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->這層基本上就是作商業邏輯的處哩，進到此層的資料基本上都是做完DTO轉換，在此層通常會作實際的資料邏輯處理處理完後再往DB方向送。<!--]--></li><!--]--></ul><!--]--></li><li data-v-4c2f5fb9><!--[-->xxx/Repositorie
<ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->DataSource(DBContext)上一層，一般會除了實際面DataSource讀寫變更操作外，Source 資料Join處理也會在此層處理。一般多這一層都是為了隔開DataSource的來源切換，不管置換不同的DB系統，或是Source改成Shared Prefs，都可快速置換資料來源。<!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><p data-v-9dc9c102><!--[--><img src="/blog/images/01/01/007.png" alt="一般單體架構" data-v-2ef15301><!--]--></p><hr id="_3" data-v-89dedb08><h3 id="六在ddd世界中的module設計" data-v-4cf5bb93><a aria-current="page" href="/blog/architecture/ddd-module#六在ddd世界中的module設計" class="router-link-active router-link-exact-active" data-v-4cf5bb93><!--[-->六、在DDD世界中的Module設計<!--]--><!----></a></h3><p data-v-9dc9c102><!--[-->上述稍微帶過Module的設計概念後，接著探討在DDD世界裡，Module的設計概念如何~大致分成幾個探討議題<!--]--></p><h4 id="_1ddd設計步驟流程" data-v-57e8d291><a aria-current="page" href="/blog/architecture/ddd-module#_1ddd設計步驟流程" class="router-link-active router-link-exact-active" data-v-57e8d291><!--[-->1.DDD設計步驟流程<!--]--><!----></a></h4><p data-v-9dc9c102><!--[--><img src="/blog/images/01/01/008.png" alt="事件風暴" data-v-2ef15301><!--]--></p><ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->在探討需求架構DDD設計的第一步，就是根據需求情境列出事件風暴(Event storming)，並在事件風暴中的用戶操作、事件、以及依賴關係根據這些要素設計歸納出領域與實體。<!--]--></li><li data-v-4c2f5fb9><!--[-->接著第二步在領域實體之間找尋彼此務的關聯性，將具有相關的實體組合成聚合(Aggregate)，同時確定聚合根(Aggregate Root)。在聚合根行程時，基本上第一層邊界(邏輯邊界-虛線)也會跟著產生，他們會在同一個服務器中運行。<!--]--></li><li data-v-4c2f5fb9><!--[-->當聚合規劃好後~會根據業務及語意邊界等因素，將一個或多個聚合規劃訂製在一個限界上下文內(服務邊界)，形成領域模型。<!--]--></li><!--]--></ul><p data-v-9dc9c102><!--[--><img src="/blog/images/01/01/009.png" alt="聚合" data-v-2ef15301><!--]--></p><h4 id="_2程式碼一級目錄架構" data-v-57e8d291><a aria-current="page" href="/blog/architecture/ddd-module#_2程式碼一級目錄架構" class="router-link-active router-link-exact-active" data-v-57e8d291><!--[-->2.程式碼一級目錄架構<!--]--><!----></a></h4><p data-v-9dc9c102><!--[--><img src="/blog/images/01/01/010.png" alt="一級目錄架構" data-v-2ef15301><!--]--></p><ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->Interface(API Interface)
<ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->給使用者API介面，使用者透過Restful請求，將資料傳到此層，解析用戶傳送的請求資訊，資料的組裝、資料傳輸格式以及 Facade 介面等代碼都會放在這一層目錄裡。<!--]--></li><!--]--></ul><!--]--></li><li data-v-4c2f5fb9><!--[-->Application
<ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->他有點像是原先集中式設計Service的功能，實作所有相依於指定前端之使用案例的地方。 例如，與 Web API 服務相關的實作。若使用的是 CQRS 方法，它便會包含查詢、微服務接受的命令，甚至是微服務之間的事件驅動通訊 (整合事件)。<!--]--></li><!--]--></ul><!--]--></li><li data-v-4c2f5fb9><!--[-->Domain
<ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->它主要存放領域層核心業務邏輯相關的代碼。領域層可以包含多個聚合代碼包，它們共同實現領域模型的核心業務邏輯。聚合以及聚合內的實體、方法、領域服務和事件等代碼會放在這一層目錄裡。<!--]--></li><!--]--></ul><!--]--></li><li data-v-4c2f5fb9><!--[-->Infrastructure
<ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->它主要存放基礎資源服務相關的代碼，為其它各層提供的通用技術能力、三方套裝軟體、資料庫服務、配置和基礎資源服務的代碼都會放在這一層目錄裡。<!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><h4 id="_3在ddd-module準則" data-v-57e8d291><a aria-current="page" href="/blog/architecture/ddd-module#_3在ddd-module準則" class="router-link-active router-link-exact-active" data-v-57e8d291><!--[-->3.在DDD Module準則<!--]--><!----></a></h4><p data-v-9dc9c102><!--[-->例子:如何對電商平台上的顧客進行模塊設計<!--]--></p><p data-v-9dc9c102><!--[-->對於顧客來說，一般須要維護顧客的<!--]--></p><ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->個人訊息<!--]--></li><li data-v-4c2f5fb9><!--[-->收穫地址<!--]--></li><li data-v-4c2f5fb9><!--[-->付款方法<!--]--></li><!--]--></ul><p data-v-9dc9c102><!--[-->這三個之間的關係是緊密相關，不可獨立存在，我們根據這三點抽象出三個Aggregate<!--]--></p><ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->Customer 個人訊息<!--]--></li><li data-v-4c2f5fb9><!--[-->AddressBook 收穫地址<!--]--></li><li data-v-4c2f5fb9><!--[-->Wallet 付款方法<!--]--></li><!--]--></ul><p data-v-9dc9c102><!--[-->那該如何去放置這些Aggregate，是針對每一個Aggregate作資料夾分類還是這三個Aggregate放同一格資料夾?基本上這三個Aggregate就是一個Custer Module，所以都會放到Custer Module資料夾內。<!--]--></p><p data-v-9dc9c102><!--[--><img src="/blog/images/01/01/011.png" alt="Custer Module資料夾" data-v-2ef15301><!--]--></p><p data-v-9dc9c102><!--[-->當整理出Aggregate與Module後，接著會開始根據各Module去實作事件應用處理<!--]--></p><p data-v-9dc9c102><!--[-->基本上我們在DDD模塊的設計上有幾個注意要點<!--]--></p><ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->Module應該要和Domain概念一致:一般一組聚合集成(領域)，我們會相對應建立一個Module。<!--]--></li><li data-v-4c2f5fb9><!--[-->根據通用語言來命名:模組命名要一眼就看出這是在做什麼的。<!--]--></li><li data-v-4c2f5fb9><!--[-->模組設計盡量鬆偶合:盡量與其他模組不要有太多的偶合，若有也許在領域設計上還沒切得很乾淨。<!--]--></li><li data-v-4c2f5fb9><!--[-->如果有PeerModule或父子Module出現，盡量避免循環相依。<!--]--></li><!--]--></ul><h4 id="_4關於module命名" data-v-57e8d291><a aria-current="page" href="/blog/architecture/ddd-module#_4關於module命名" class="router-link-active router-link-exact-active" data-v-57e8d291><!--[-->4.關於Module命名<!--]--><!----></a></h4><p data-v-9dc9c102><!--[--><img src="/blog/images/01/01/012.png" alt="Module命名" data-v-2ef15301><!--]--></p><h4 id="_5module界線與限界上下文不同" data-v-57e8d291><a aria-current="page" href="/blog/architecture/ddd-module#_5module界線與限界上下文不同" class="router-link-active router-link-exact-active" data-v-57e8d291><!--[-->5.Module界線與限界上下文不同<!--]--><!----></a></h4><p data-v-9dc9c102><!--[-->為了對領域模型中進行準確建模，需要將領域模型劃分成多個子域，每個子域對應一個或多個限界區域。 模塊。所以，從子域到限界某些再到模塊，應該是依次包含關係。<!--]--></p><h3 id="補充" data-v-4cf5bb93><a aria-current="page" href="/blog/architecture/ddd-module#補充" class="router-link-active router-link-exact-active" data-v-4cf5bb93><!--[-->補充<!--]--><!----></a></h3><h4 id="補充一" data-v-57e8d291><a aria-current="page" href="/blog/architecture/ddd-module#補充一" class="router-link-active router-link-exact-active" data-v-57e8d291><!--[-->補充一<!--]--><!----></a></h4><ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->Abstracion:
<ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->將真實世界物體與事件的大量資訊縮減一個概念或是一個現象的資訊含量來將其廣義化，保存和一特定目的有關的資訊。例如，將一個皮製的足球抽象化成一個球，只保留一般球的屬性(形狀)和行為(滾)等資訊。<!--]--></li><!--]--></ul><!--]--></li><li data-v-4c2f5fb9><!--[-->Leaky Abstractions
<ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->所有非不證自明的抽象概念，都有某種程度的疏漏。例如TCP雖簡化(抽象化)網路行為，設計上也保證網路傳送過程中不遺漏資訊，但不保證就真的能完整傳到資訊，例如我們無法避開海底電纜被魚咬斷因此斷訊的狀況。<!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><h3 id="參考" data-v-4cf5bb93><a aria-current="page" href="/blog/architecture/ddd-module#參考" class="router-link-active router-link-exact-active" data-v-4cf5bb93><!--[-->參考<!--]--><!----></a></h3><p data-v-9dc9c102><!--[--><a href="https://github.com/kgrzybek/modular-monolith-with-ddd#32-module-level-view" rel="nofollow" data-v-692834dd><!--[-->範例<!--]--></a><a href="https://shanebdavis.medium.com/the-5-essential-elements-of-modular-software-design-6b333918e543" rel="nofollow" data-v-692834dd><!--[-->The 5 Essential Elements of Modular Software Design<!--]--></a><a href="https://www.joelonsoftware.com/2002/11/11/the-law-of-leaky-abstractions/" rel="nofollow" data-v-692834dd><!--[-->The Law of Leaky Abstractions<!--]--></a><a href="https://nordicapis.com/the-three-principles-of-excellent-api-design/" rel="nofollow" data-v-692834dd><!--[-->The Three Principles of Excellent API Design<!--]--></a><a href="https://www.learncodewithmike.com/2020/01/python-module-and-package.html" rel="nofollow" data-v-692834dd><!--[-->解析Python模組(Module)和套件(Package)的概念<!--]--></a><a href="http://www.the-software-experts.com/e_dta-sw-design-module.php" rel="nofollow" data-v-692834dd><!--[-->Module Design<!--]--></a><!--]--></p><p data-v-9dc9c102><!--[--><a href="https://devblogs.microsoft.com/cesardelatorre/domain-events-vs-integration-events-in-domain-driven-design-and-microservices-architectures/" rel="nofollow" data-v-692834dd><!--[-->Domain Events vs. Integration Events in Domain-Driven Design and microservices architectures<!--]--></a><!--]--></p><p data-v-9dc9c102><!--[--><a href="https://www.cnblogs.com/sheng-jie/p/7266557.html" rel="nofollow" data-v-692834dd><!--[-->DDD理论学习系列（13）-- 模块<!--]--></a><!--]--></p><p data-v-9dc9c102><!--[--><a href="https://www.cnblogs.com/sheng-jie/p/6931646.html" rel="nofollow" data-v-692834dd><!--[-->DDD理论学习系列——案例及目录<!--]--></a><!--]--></p></div><!--]--><!--]--><!--[--><div class="docs-page-bottom" data-v-73d798d2 data-v-346454d4><!----><!----></div><div class="docs-prev-next" data-v-73d798d2 data-v-30e1aea1><a href="/blog/code/_dir" class="prev" data-v-30e1aea1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-30e1aea1 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m11 17l-5-5m0 0l5-5m-5 5h12"/></svg><div class="wrapper" data-v-30e1aea1><span class="directory" data-v-30e1aea1>Code</span><span class="title" data-v-30e1aea1>Codesnese</span></div></a><a href="/blog/architecture/ddd" class="next" data-v-30e1aea1><div class="wrapper" data-v-30e1aea1><span class="directory" data-v-30e1aea1>Architecture</span><span class="title" data-v-30e1aea1>DDD實戰-簡易整理</span></div><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-30e1aea1 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m13 7l5 5m0 0l-5 5m5-5H6"/></svg></a></div><!--]--></article><div class="toc" data-v-73d798d2><div class="toc-wrapper" data-v-73d798d2><button data-v-73d798d2><span class="title" data-v-73d798d2>Table of Contents</span><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-73d798d2 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 5l7 7l-7 7"/></svg></button><div class="docs-toc-wrapper" data-v-73d798d2><div class="docs-toc" data-v-73d798d2 data-v-ebd2b6b2><!--[--><div class="docs-toc-title" data-v-ebd2b6b2><span data-v-ebd2b6b2>Table of Contents</span></div><ul class="docs-toc-links" data-v-ebd2b6b2 data-v-a97df893><!--[--><li class="depth-3" data-v-a97df893><a href="#一關於module" class="" data-v-a97df893>一、關於Module</a><!----></li><li class="depth-3" data-v-a97df893><a href="#二構成module考量五要素" class="" data-v-a97df893>二、構成Module考量五要素</a><!----></li><li class="depth-3" data-v-a97df893><a href="#三package-vs-module" class="" data-v-a97df893>三、Package Vs Module</a><!----></li><li class="depth-3" data-v-a97df893><a href="#四一般module設計方法" class="" data-v-a97df893>四、一般Module設計方法</a><!----></li><li class="depth-3" data-v-a97df893><a href="#五未使用ddd的一般service服務設計" class="" data-v-a97df893>五、未使用DDD的一般Service服務設計</a><!----></li><li class="depth-3" data-v-a97df893><a href="#六在ddd世界中的module設計" class="" data-v-a97df893>六、在DDD世界中的Module設計</a><!----></li><li class="depth-3" data-v-a97df893><a href="#補充" class="" data-v-a97df893>補充</a><!----></li><li class="depth-3" data-v-a97df893><a href="#參考" class="" data-v-a97df893>參考</a><!----></li><!--]--></ul><!--]--></div></div></div></div><!--]--></div></div><!--]--></main><footer data-v-5c2f7786 data-v-39bdaab3><div class="container pv-KgShtt pc-enNCWj footer-container" data-v-39bdaab3 data-v-a8d7e2a7><!--[--><div class="left" data-v-39bdaab3><a href="https://docus.dev" rel="noopener" target="_blank" data-v-39bdaab3><svg viewbox="0 0 57 57" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon left-icon" width="1em" height="1em" data-v-39bdaab3 data-v-e610b8e3><path fill-rule="evenodd" clip-rule="evenodd" d="M28.5445 0C12.8044 0 0 12.7599 0 28.5v25.4549c0 1.5835 1.28368 2.8672 2.86718 2.8672H28.5889C44.2799 56.8221 57 44.102 57 28.4111 57 12.7201 44.2355 0 28.5445 0Zm15.4963 34.452c3.3649 0 6.0927-2.7278 6.0927-6.0928 0-3.3649-2.7278-6.0927-6.0927-6.0927-3.365 0-6.0928 2.7278-6.0928 6.0927 0 3.365 2.7278 6.0928 6.0928 6.0928Zm-18.0833.0003c3.3649 0 6.0927-2.7278 6.0927-6.0927s-2.7278-6.0928-6.0927-6.0928-6.0928 2.7279-6.0928 6.0928c0 3.3649 2.7279 6.0927 6.0928 6.0927Z" fill="currentColor"></path></svg><p data-v-39bdaab3>Powered by Docus</p></a></div><div class="center" data-v-39bdaab3><!--[--><!--]--></div><div class="right" data-v-39bdaab3><!--[--><!--]--><!--[--><a href="https://github.com/spyua" rel="noopener noreferrer" target="_blank" title="https://github.com/spyua" aria-label="https://github.com/spyua" data-v-22569e45><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-22569e45 style="" width="1em" height="1em" viewBox="0 0 496 512" data-v-e610b8e3><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9c1.6 2.3 4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2"/></svg></a><!--]--></div><!--]--></div></footer></div></div><script type="application/json" id="__NUXT_DATA__" data-ssr="true">[["Reactive",1],{"data":2,"state":118,"_errors":1384,"serverRendered":823,"path":32},{"search-api":3},[4,13,24,30,45,56,66,74,83,91,99,106,112],{"id":5,"path":6,"dir":7,"title":8,"description":9,"keywords":10,"body":12},"content:0.code:1.Refcotr閱讀.md","/code/refcotr","code","重構筆記","",[11],"2019/11/13","  重構筆記  2019/11/13   Lazy Class   別開創無所謂的Class(Ex 指宣告一個變數, Inline Class),邏輯資料相同可以使用繼承延伸,Super Class。要設計Class仙藥思考它的合理性。  Speculative Generality   在設計時，預留太多未來可能會用的擴充點。彈性使用Template模式，然後寫成介面，ConcreateClass去設計跟Imp。  遇到不能關閉的程式，要考慮好資源回收與OOM問題。\n   1.Collapse Hierachy  2.Inline Class  3.Remove Parameter  4.Remove Method  Temporay Field   Class欄位過多，在替代變數命名尚不清楚會讓開發者混淆，這是在開發過程中在需求還不清楚會常遇到，盡量避免這種狀況發生。  Message Chains(過度耦合訊息練)   Fun串Fun太多得意思....使用垂直折疊、提取或是使用委託與封裝，使用注入。  Middle Man(中間轉手人)   Class放與這個Class不相干的內容，邏輯提煉出來其他模組，或使用把功能寫成父類別繼承，或用注入盡量避免這件事情  Inappropriate Intimacy(互相依賴)   過度互相依賴，或是沒邏輯性的互相依賴(亂使用繼承)。 讀卡機讀取票卡例子(讀卡機，票卡自己也需判斷黑名單)。\n   1.可以定義一個卡片Interface(鎖卡，解卡，判斷)。此Interface讓讀卡機繼承，讓讀卡機注入...(依賴注入,RW定義一個介面，再去實作)  2.使用委託註冊介面. Call Back方式把有註冊過的方式拉進Class做處理。  Alternative Class with different Interface(異曲同工的類別)   做Extract SuperClass   Incomplete Libary Class(不完美程式庫類別)   如果要改一點類別庫直接修改，大改套模式..EX:套裝飾者模式,或使用繼承~~~ New程式碼直接延接  Data Class(純稚資料類別)   如果你有資料結構Class專門存取，很多Class會使用他，建議寫Get Set(c#直接產生)。  Refuesed Bequest(被拒絕的遺贈)   繼承錯誤.  Comments(過多的註釋)   包Package或好的命名可以避免",{"id":14,"path":15,"dir":7,"title":16,"description":17,"keywords":18,"body":23},"content:0.code:2.依賴注入(DI).md","/code/(di)","依賴注入(DI)","DI在目前許多軟體架構中是不可或缺的設計架構功能之一，此章節會闡述DI精神及介紹.Net的DI使用。",[19,20,21,22],"A. 依賴注入(Dependency Injection)","B. 容器概念","C. Ioc(Inversion of Control)控制反轉","D. C# DI 框架 [範例請點我]","  DI在目前許多軟體架構中是不可或缺的設計架構功能之一，此章節會闡述DI精神及介紹.Net的DI使用。  A. 依賴注入(Dependency Injection)  先來講依賴跟注入的概念  a. Dependency  依賴如字面上所述，在軟體中，我們很常遇到物件彼此相依的狀況。如下圖，在做計算時需做Printer輸出資訊，因此Calculator物件會相依Printer物件，則在Instance Calculator物件時則就需要同步Instance Printer物件並帶入Calculator物件中。       public     class     Calculator\n   {\n         public     Printer     Printer   {  get  ;  private     set  }\n         public     Add  (  int     a  ,   int     b  ){\n             var     sum     =   a  +  b;\n           Printer.  ConsoleOut  (sum);\n       }\n         public     Calculator  (  Printer     printer  ){\n           Printer   =   printer;\n       }\n   }\n   public     class     Printer\n   {\n         public     void     ConsoleOut  (  string     txt  ) \n       {\n           Console.  WriteLine  (txt);\n       }\n   }\n   static     class     Program\n   {\n         static     void     Main  ()\n       {\n             var     printer     =     new     Printer  ();\n             var     calculator     =     new     Calculator  (printer);\n           calculator.  Add  (  1  +  1  ); \n       }\n   }  這例子為Calculator依賴Printer，所以控制權不是在Printer身上。什麼意思? 簡單來說當Printer有異動時，會有一定程度是影響到Calculator的。  對於物件依賴這件事情我在網上看到一個例子描述還蠻貼切的，今天有一名8+9在吸食毒品如下。8+9 以為自己吸食毒品只是滿足自己的快感，他還以為他自己的意志行為是被自己所掌控  錯!!!  其實8+9這時候所有的行為已經被毒品所控制，再也離不開毒品了。    b. Dependency With Interface  那我們該如何解除依賴關係? 一般來說，在實作方法時，我們會讓物件去相依介面，讓物件彼此因介面而解偶，如下圖       public     class     Calculator\n   {\n         public     IPrinter     Printer   {  get  ;  private     set  }\n         public     Add  (  int     a  ,   int     b  ){\n             var     sum     =   a  +  b;\n           Printer.  ConsoleOut  (sum);\n       }\n         public     Calculator  (  IPrinter     printer  ){\n           Printer   =   printer;\n       }\n   }\n   public     class     Printer  :  IPrinter\n   {\n         public     void     ConsoleOut  (  string     txt  ) \n       {\n           Console.  WriteLine  (txt);\n       }\n   }\n     public     interface     IPrinter  {\n         void     ConsoleOut  (  string     txt  );\n   }\n     static     class     Program\n   {\n         static     void     Main  ()\n       {\n             IPrinter     printer     =     new     Printer  ();\n             var     calculator     =     new     Calculator  (printer);\n           calculator.  Add  (  1  +  1  ); \n       }\n   }  因相依介面，若我們要抽換功能，例如原本的Console輸出改成輸出至記事本。只需要在新增一個記事本輸出方法，替換掉原本的28行的printer即可。而這狀況我們稱為Dependency Inversion Principle(DIP)，依賴倒轉原則。簡單來說就是解除高階模組和低階模組的依賴關係。   高低階模組定義   高階模組指的是呼叫者(Caller)-Calculator   低階模組就是被呼叫者(Callee)-Printer  我們再回到8+9例子，今天想要讓8+9改過向上，戒毒成為奮發向上的好青年。因為現在8+9直接依賴著毒品，我們讓8+9改成依賴藥品這個介面。    現在我們成功讓8+9依賴藥品而不是毒品。然後再將做一個健康食品的類別實作藥品，然後偷偷把毒品換成健康食品。這樣子8+9以為自己吃的藥品是毒品，實際上卻是每天吃健康食品，於是8+9頭腦變好了 走路也不晃了 考試也考100分成為國家的棟樑。  c. Injection  接著講注入，上述Calculator例子注入方式稱為建構子注入，其實注入平常我們就有在使用。一般人比較不會注意到這些行為其實就是一種注入。常見的注入模式有三種   建構子注入(Constructor Injection)  屬性注入(Property Injection)  方法注入(Method Injection)  建構子注入(Constructor Injection)     // 汽車的抽象介面\n   public     interface     ICar   {\n         // 行駛汽車\n         void     run  ();\n   }\n     // 司機的抽象介面\n   public     interface     IDriver   {\n         // 司機駕駛汽車\n         void     drive  ();\n   }\n     // 實作司機的抽象類別\n   public     class     Driver     implements     IDriver   {\n         private   ICar car;\n         // 建構子方式注入抽象類別\n         public     Driver  (ICar   car  ){\n             this  .car   =   car;\n       }    \n       @  Override\n         public     void     drive  () {\n           car.  run  ();\n       }\n   }  屬性注入(Property Injection)     // 汽車的抽象介面\n   public     interface     ICar   {\n         // 行駛汽車\n         void     run  ();\n   }\n     // 司機的抽象介面\n   public     interface     IDriver   {\n         // 司機駕駛汽車\n         void     drive  ();\n   }\n     // 實作司機的抽象類別\n   public     class     Driver     implements     IDriver   {\n         private   ICar car;\n         // 使用setter來傳遞物件 (c# get set)\n         public     setCar  (ICar   car  ){\n             this  .car   =   car;\n       }\n         \n       @  Override\n         public     void     drive  () {\n           car.  run  ();\n       }\n   }  方法注入(Property Injection)     // 汽車的抽象介面\n   public     interface     ICar   {\n         // 行駛汽車\n         void     run  ();\n   }\n    \n   // 司機的抽象介面\n   public     interface     IDriver   {\n         // 司機駕駛汽車\n         void     drive  (ICar   car  );\n   }\n       // 實作司機的抽象類別\n   public     class     Driver     implements     IDriver   {\n          // 使用介面來傳遞物件\n       @  Override\n         public     void     drive  (ICar   car  ) {\n           car.  run  ();\n       }\n   }   在了解Dependency與Injection後，應該就可以理解相依注入動作就在於在Instance物件後放置對應的相應物件中  B. 容器概念  上述DI概念講完後，接著我們要述說容器的概念。A章節提到關於相依的問題，雖然我們可以透過介面去作解偶。但一般在大型專案物件複雜度及數量一定會是更複雜的狀態。因此有了容器的機制設計產生。  容器的概念在於把物件全都收到一個盒子中，當要使用物件時再去盒子拿資料。有點像是打高爾夫球人員要打高爾夫時都會準備一個球袋把要用的球桿放進球袋中，並帶一個球僮陪伴在旁。當要使用哪一支高爾夫球桿時直接告訴球童即可。  a. 窮人與有錢人的依賴注入方式  上述講解完後，相信目前對相依注入及容器有一定的概念。而注入部分一般分成窮人注入與有錢人注入。   我們一般稱為Poor DI(Dependency Injection)，由使用者手動創建以new物件的方式，各自注入，除了麻煩外而且會有傳遞注入等等的問題。  有錢人的注入方式，我們一般都會使用DI容器來完成，由框架或類別庫撰寫的容器，提供物件給予使用者使用，猶如上述所講的球童跟高爾夫球員關係一樣。使用者只需要在撰寫程式前設定好物件後，就不需要在手動注入。  C. Ioc(Inversion of Control)控制反轉  窮人跟有錢人，我們當然選擇當有錢人!(使用DI容器)。若我們使用DI容器去管理我們物件時，此時我們即可達到控制反轉的設計。  簡單來說A物件程式內部需要使用B物件，程序需自行在A物件去new B物件。由程序主動去控制，有了容器，這一切交給容器去控制(新增物件流程)即可。  如果說DIP 是解偶物件之間的依賴，IOC 就是對物件依賴流程控制的反轉。以常見的web框架而言，將監聽http 請求，解析請求等，包裝進框架，一般使用者並不用主動去處理解析請求，處理http請求的流程，由主動處理轉交給了框架，因此，所以框架其實也是一種IoC的設計。   你可以將IOC是一種設計模式，將流程控制重定向到外部處理程序或控制器來提供控制結果，而不是透過控制項(大多情境就是程序)來直接得到結果  D. C# DI 框架   [範例請點我]  上述聊完後，相信對於DI、容器、DIP與IOC有一定認知。接著就需要進入實作部分。在.NET中最常見的DI有兩套如下   Microsoft.Extensions.DependencyInjection  Autofac  上述提到注入三種方式(建構子、屬性與方法)，Autofac都有提供，而ASP.NET DI的目前只有建構子注入方式。網上大多是Web範例，在此使用這兩套DI工具使用在DeskTop Windows From。  Microsoft.Extensions.DependencyInjection  範例DI設定在DIServiceConfigure.cs  注入服務生命週期型態  服務生命週期指：透過 DI 取得某個元件時，是每次要求得建立一顆新物件，還是從頭到尾共用一個 Instance (執行個體-物件)。   1.AddSingleton (單一性)  2.AddTransient (暫時性)  3.AddScoped (範圍性)  1. AddSingleton (單一性)  整個程序只建立一個 Instance，任何時候都共用它。簡單來說就是程序中不同流程使用此物件時，他都為同一份物件，有點像是Static，差在於使用DI可做物件設計及抽換。  下圖為Asp.Net DI生命週期圖示，物件相依關係由左至右。    而在範例模擬中設計，物件對應可視為   Rqeuest : Button_Singleton_Click 按下  第一個圈 : Call LogController  第二個圈 : Call LogController2  Instance : SingletonLogRepository  Repository注入部分我們使用AddSingleton，而物件在Instance時，我們會建置Guid去觀察他是否為同一個物件。         // 系統單一物件定義使用，或沒有異部與大量Request問題，可直接用Singleton\n   collection.  AddSingleton  \u003C  ISingletonLogRepository  ,   LogRepository  >();  當我們按下Button_Singleton_Click時，會去呼叫LogController及LogController2裡的SingletonLogRepository物件。並印出Guid。     private     void     Button_Singleton_Click  (  object     sender  ,   EventArgs     e  )\n   {\n         //var provider = DIServiceConfigure.GetProvider();\n         //var logController = provider.GetRequiredService\u003CILogController>();\n         var     log     =     \"Log1(Singleton):\"  +  \"UUID-\"  +  LogController.  OperationId  (  \"Singleton\"  );\n         var     log2     =     \"Log2(Singleton):\"     +     \"UUID-\"     +   LogController2.  OperationId  (  \"Singleton\"  );\n       richTextBox_Info.  AppendText  (log  +  \"  \\n  \"  );\n       richTextBox_Info.  AppendText  (log2   +     \"  \\n  \"  );\n       richTextBox_Info.  AppendText  (LogController.  QueryLogCount  ());\n   }  此時我們可以看到兩個印出來的UUID會完全相同。代表在SingletonLogRepository在Controller與Controller2中為同一個物件。    2. AddTransient (暫時性)  定義上為程序中每次要求物件(包含物件要其他相依物件)時就建立一個新的，永不共用。  下圖為 Asp.Net DI生命週期圖示，物件相依關係由左至右。    而在範例模擬中設計，物件對應可視為   Rqeuest : Button_Transient_Click 按下  第一個圈 : Call LogController  第二個圈 : Call LogController2  Instance : TransientLogRepository  Repository注入部分我們使用AddTransient，而物件在Instance時，我們會建置Guid去觀察他是否為同一個物件。     // 異步，且須大量Request的建議使用Transient (WundowsForm簡易Sample較難模擬)\n   collection.  AddTransient  \u003C  ITransientLogRepository  ,   LogRepository  >();  當我們按下Button_Transient_Click時，會去呼叫LogController及LogController2裡的SingletonLogRepository物件。並印出Guid。     private     void     Button_Transient_Click  (  object     sender  ,   EventArgs     e  )\n   {\n        // 模擬多次Request\n        //var provider = DIServiceConfigure.GetProvider();\n        //var logController = provider.GetRequiredService\u003CLogController>();\n        //var log = \"Log1(Transient):\" + \"UUID-\" + logController.GUID.ToString();\n        //richTextBox_Info.AppendText(log + \"\\n\");\n              // 單次Request\n        var     log     =     \"Log1(Transient):\"     +     \"UUID-\"     +   LogController.  OperationId  (  \"Transient\"  );\n        var     log2     =     \"Log2(Transient):\"     +     \"UUID-\"     +   LogController2.  OperationId  (  \"Transient\"  );\n      richTextBox_Info.  AppendText  (log   +     \"  \\n  \"  );\n      richTextBox_Info.  AppendText  (log2   +     \"  \\n  \"  );\n          //richTextBox_Info.AppendText(LogController.QueryLogCount());\n   }  此時我們可以看到兩個印出來的UUID會不相同。代表在TransientLogRepository在Controller與Controller2中為不同物件。    上述模擬範例其實只模擬一個Request1的狀況。根據定義，程序中每次要求元件時就建立一個新的物件，對此我們已再按多次Button來做模擬。要模擬這狀況，就需要再跟Container拿取Controller物件，在範例中Controller與Controller2都是注入AddTransient，我們將模擬多次Request區塊註解打開，並註解單次Request程式碼     private     void     Button_Transient_Click  (  object     sender  ,   EventArgs     e  )\n   {\n         // 模擬多次Request\n         var     provider     =   DIServiceConfigure.  GetProvider  ();\n         var     logController     =   provider.  GetRequiredService  \u003C  LogController  >();\n         var     log     =     \"Log1(Transient):\"     +     \"UUID-\"     +   logController.GUID.  ToString  ();\n       richTextBox_Info.  AppendText  (log   +     \"  \\n  \"  );\n           // 模擬單次Request\n         //var log = \"Log1(Transient):\" + \"UUID-\" + LogController.OperationId(\"Transient\");\n         //var log2 = \"Log2(Transient):\" + \"UUID-\" + LogController2.OperationId(\"Transient\");\n         //richTextBox_Info.AppendText(log + \"\\n\");\n         //richTextBox_Info.AppendText(log2 + \"\\n\");\n           //richTextBox_Info.AppendText(LogController.QueryLogCount());\n   }  此時我們可以看到每次的UUID就會不相同，代表在Controller在每次跟Container拿取時都為不同物件。相對的，注入其他物件時也是同一個狀況。    3. AddScope  (範圍性)  Scope我覺得是最難了解的，直接看 Asp.Net DI生命週期圖示，物件相依一樣關係由左至右。如圖所示，程序中要求物件(包含物件要其他相依物件)時，這個Flow處理過程中用到的物件則為同一個物件。而第二次再次要物件時，則會跟第一次的物件是不一樣的物件。    我們已Call Dialog方式去模擬多次Request，程式碼這邊不多做解釋，結果與物件對照如下圖，觀察Instance部分物件分別為   SingletonLogRepository  TransientLogRepository  ScopedLogRepository  可以看到ScopedLogRepository，在同一次的Request Flow，LogController與LogService的LogRepository UUID為一樣的，但在第二次打開Dialog時，則UUID會與第一次的不同。這點會跟Singleton有很大的不同。  在此我們也可以看到Transaction則是在每個物件中，及每次Request都為不同UUID。    其實Scoped跟Transaction之間有時候蠻容易混淆的。對我來說比較好懂得在於Scoped在跟Container要物件時，若前一個物件還未dispose(生命週期還未結束)，則都是同一個物件。物件結束生命週期後在新的Request後才會在新增新的物件。而Transaction就無生命週期概念，在每一次要求物件時，都會New一個新的給他，有點像平常我們想用物件就New Instance的概念。  生命週期小結論  上述描述完後，沒意外應該會對注入的生命週期會有所了解。而在Web的世界中，這三種注入方式會很常被使用到。在每一次Http Request情境，Request具有連線即結束，在這狀況下的連線相關物件基本上就會使用Scoped，因此在Web情境，大多數物件都會使用Scoped注入。  但WindowsForm App下，其實我們最常使用的會是Singleton居多，其次是Transaction，Scoped狀況就比較少，因為WindowsForm一開始畫面就那些就載入到 memory中，除非我們將畫面dispose掉，然後再重新開啟畫面，此時就會建議使用Scoped注入。  Transaction使用場景比較會偏向用後就直接dispose，不過這種應用場景，我們很常直接手動去new物件.實際架構應用上目前我也沒太多經驗。  注入抽換  生命週期講完後，接著就是闡述關於抽換實體物件。範例中我們使用IPrinter注入抽換PrinterMethodA與PrinterMethodB。  在一開始我們IPrinter注入為PrinterMethodA，在按下button_Printer_Click按鈕時，Console則會印出MethodA Print:Prionter Out    此時我們將PrinterMethodA改成PrinterMethodB     collection.  AddTransient  \u003C  IPrinter  ,   PrinterMethodB  >();  此時在按下button_Printer_Click按鈕時，Console則會印出MethodB Print:Prionter Out    另外我們也可以注入IPrinter List，只要注入多Concreate實體     collection.  AddTransient  \u003C  IPrinter  ,   PrinterMethodA  >();\n   collection.  AddTransient  \u003C  IPrinter  ,   PrinterMethodB  >();  就可注入多PrinterMethod方法     private     LogController     LogController  ;\n   private     LogController2     LogController2  ;\n     // 多重注入\n   private     IEnumerable  \u003C  IPrinter  >   Printer  ;\n     public     Form1  (  IEnumerable  \u003C  IPrinter  >   printer  ,\n                  LogController     logController  , \n                  LogController2     logController2  )\n   {\n         InitializeComponent  ();\n       LogController   =   logController;\n       LogController2   =   logController2;\n         // 多重注入\n       Printer   =   printer;\n   }    我們只須改Container設定，主程式都不用更動，即可抽換程式中所有物件用到IPrinter的地方。  AutoFac  範例DI設定在AutofacConfig.cs  AutoFac與 ASP.NET DI 注入生命週期概念其實大同小異，下圖為對應表  出處    根據對應表，在範例程式要換成Autofac範例，只需將Bootstrapper與Form.cs裡Button_Scoped_Click的Net DI程式碼註解掉，並解開Autofac註解相關程式碼。即可觀察注入物件生命週期的不同。  .github-light_github-dark{color:#24292e;background:#fff;}.dark .github-light_github-dark{color:#e1e4e8;background:#24292e;}.ct-149352{color:#D73A49;}.dark .ct-149352{color:#F97583;}.ct-553616{color:#24292E;}.dark .ct-553616{color:#E1E4E8;}.ct-762058{color:#6F42C1;}.dark .ct-762058{color:#B392F0;}.ct-617022{color:#005CC5;}.dark .ct-617022{color:#79B8FF;}.ct-086898{color:#6A737D;}.ct-157101{color:#E36209;}.dark .ct-157101{color:#FFAB70;}.ct-952708{color:#032F62;}.dark .ct-952708{color:#9ECBFF;}",{"id":25,"path":26,"dir":9,"title":27,"description":9,"keywords":28,"body":29},"content:0.index.md","/","Home",[],"     Hakuna Matata.   I am a dedicated learner, and together with my friend, we have formed a team called Code Sense in Kaohsiung. We engage in research and study on a weekly basis, with a passion for learning new technologies and skills.Continual learning is the driving force of my life.     8-9 years of software development and maintenance experience  3-4 years of experience in automation domain development  1-2 years of experience in department software training and management  Familiar with integration and connection of various factory systems (  MES ,   WMS ,   PLC )  Proficient in web system front-end and back-end development and database design  Well-versed in measurement instrument and motor PC Base control (  RS232 ,   ModBusTCP ,   EtherCAT )      My Personal Moments.      Reading Blog   Regular Reading and Public Journal of Thoughts and Moods.[  Medium ]    Code Sense Trello   Regular Study and Discussion Sessions with Friends.\n[  Code Sense Trello ]    Slider   My Presentation Slides.[  Slider Link ]    Technical Documentation   Regular document writing and temporary storage.[  Hackmd ]",{"id":31,"path":32,"dir":33,"title":34,"description":9,"keywords":35,"body":44},"content:1.architecture:1.DDD實戰-Module.md","/architecture/ddd-module","architecture","DDD實戰-Module",[36,37,38,39,40,41,42,43],"一、關於Module","二、構成Module考量五要素","三、Package Vs Module","四、一般Module設計方法","五、未使用DDD的一般Service服務設計","六、在DDD世界中的Module設計","補充","參考","  DDD實戰-Module  一、關於Module  在闡述Module前，讓我們先來比對非物件化設計與物件化設計的差異性。看到下圖左，在非物件化的傳統設計，資料與方法操作上是整個拆開設計，在資料流複雜外我們可以看相依性高，偶合的狀況也較高。  接著討論物件化設計部分，先不論封裝等物件操作技巧，單純根據資料與方法關係設計出物件(物件特性:資料(Data) 物件行為:方法(Function))，我們可以看到原本互相依賴的Fun關係可各自獨立使用，在資料流上也較為單純。    物件化後，雖然在資料操作面上簡化許多，但隨著專案功能性逐漸增加，物件與功能處理流程上會趨近越複雜，如下圖為一個簡易的系統，此系統根據外部Sensor系統獲取、過濾與計算資料，在沒模組化的設計前提，可以看到Control與Data Flow呈現一個較零散的關係狀態    此時我們根據Sensor功能額外設計一個Sensor模組如下，此時我們就可以針對Sensor相對應的資料模組將之封裝在模組內，此模組對外則就單純開放運算(calculation)與過濾(filtering)的功能。  模組化後可以明顯看出控制與資料流的彼此相依性值，因此降低了修改與擴充狀況的互相影響性值。    模組化指是將  系統功能程序作分離獨立(特定功能class的容器) ，除了功能獨立外，也強調設計上可以根據功能隨意抽換模組。達到高內聚、低耦合的目的，進而提高開發者的生產力(將複雜的功能拆分管理)。並讓程式碼能夠透過引用的方式來重複使用，提升重用性(Reusable)   Modular design allows code to remain agile in the face of ever-changing requirements.   二、構成Module考量五要素   Propose:Module功能目標單一職責，盡量不要與其他模組設計有太多相依關係。  Interface:模組功能API所提供使用方式要簡潔易懂，通常User不需要去了解實際內部的實作方式，只需專注在確定輸入什麼，會輸出什麼可達到什麼功能。  Encapsulation:封裝模組，除了讓不暴露資料結構讓使用者亂使用外，對於在修改細節上也能較不容易直接影響使用端。另外再使用抽象實作上，物件抽象化多少還是難以避免Leaky Abstractions的問題。  Implementation:實作上除了考量功能正確性外還需考慮效能、測試與功能架構程式碼最小化。  Connection(關聯性):呼應Propose功能單一職責，將與其他模組相依性最小化。   三、Package Vs Module  在了解Module構成要素後~隨著專案模組(Module)的增加，將難以管理及問題的追蹤，這時候就能將模組(Module)打包成套件(Package)，利用其階層式的結構來彈性規劃模組(Module)。   Module:單一功能模組  Package:多Module組成  四、一般Module設計方法  在非以領域事件為出發點的設計上，大部分狀況會根據功能設計成物件與介面使用。下圖為Zebra SDK Package的Module列項，我們可以大致分得出，他的Module設計就是根據功能性值去區分(graphics, certificate...)    接著我們點近discovery看提供什麼API功能，可以看到可以使用的介面功能以及相關功能可使用的功能物件。    在點進個別更詳細功能介紹，我們就會看到這物件功能具有什麼資料特質、物件實體化須提供什麼參數以及此物件可使用哪些方法。   Field: address，IP or Mac Adress  Constructor:物件實體化須提供印表機的IP or Mac Adress  Method:可使用的物件功能，在此例看起來需實作getConnection功能    上述為印表機找到印表機裝置功能的模組化介紹   五、未使用DDD的一般Service服務設計  上述一般Module設計概念聊完，在聊DDD Module設計之前先來聊一下在一般未使用DDD領域設計的服務系統會如何設計。  在對大部分的開發者，一開始習慣設計都以數據為考量的集中式設計架構。設計架構上會出現比較常見到的分層式設計，大致分成Controller, Service, Repositories, Models   xxx/Model\n   數據庫Model、Request Model, Response Model  xxx/Controller\n   給Client端的API第一時間接口，提供Get,Post,Delete,Update API。除了此在此層一般都會安插屬性驗證Client第一時間傳過來的資料是否正確。並作實際的DTO(Object 與DB Model Mapping)轉換。  xxx/Service\n   這層基本上就是作商業邏輯的處哩，進到此層的資料基本上都是做完DTO轉換，在此層通常會作實際的資料邏輯處理處理完後再往DB方向送。  xxx/Repositorie\n   DataSource(DBContext)上一層，一般會除了實際面DataSource讀寫變更操作外，Source 資料Join處理也會在此層處理。一般多這一層都是為了隔開DataSource的來源切換，不管置換不同的DB系統，或是Source改成Shared Prefs，都可快速置換資料來源。     六、在DDD世界中的Module設計  上述稍微帶過Module的設計概念後，接著探討在DDD世界裡，Module的設計概念如何~大致分成幾個探討議題  1.DDD設計步驟流程     在探討需求架構DDD設計的第一步，就是根據需求情境列出事件風暴(Event storming)，並在事件風暴中的用戶操作、事件、以及依賴關係根據這些要素設計歸納出領域與實體。  接著第二步在領域實體之間找尋彼此務的關聯性，將具有相關的實體組合成聚合(Aggregate)，同時確定聚合根(Aggregate Root)。在聚合根行程時，基本上第一層邊界(邏輯邊界-虛線)也會跟著產生，他們會在同一個服務器中運行。  當聚合規劃好後~會根據業務及語意邊界等因素，將一個或多個聚合規劃訂製在一個限界上下文內(服務邊界)，形成領域模型。    2.程式碼一級目錄架構     Interface(API Interface)\n   給使用者API介面，使用者透過Restful請求，將資料傳到此層，解析用戶傳送的請求資訊，資料的組裝、資料傳輸格式以及 Facade 介面等代碼都會放在這一層目錄裡。  Application\n   他有點像是原先集中式設計Service的功能，實作所有相依於指定前端之使用案例的地方。 例如，與 Web API 服務相關的實作。若使用的是 CQRS 方法，它便會包含查詢、微服務接受的命令，甚至是微服務之間的事件驅動通訊 (整合事件)。  Domain\n   它主要存放領域層核心業務邏輯相關的代碼。領域層可以包含多個聚合代碼包，它們共同實現領域模型的核心業務邏輯。聚合以及聚合內的實體、方法、領域服務和事件等代碼會放在這一層目錄裡。  Infrastructure\n   它主要存放基礎資源服務相關的代碼，為其它各層提供的通用技術能力、三方套裝軟體、資料庫服務、配置和基礎資源服務的代碼都會放在這一層目錄裡。  3.在DDD Module準則  例子:如何對電商平台上的顧客進行模塊設計  對於顧客來說，一般須要維護顧客的   個人訊息  收穫地址  付款方法  這三個之間的關係是緊密相關，不可獨立存在，我們根據這三點抽象出三個Aggregate   Customer 個人訊息  AddressBook 收穫地址  Wallet 付款方法  那該如何去放置這些Aggregate，是針對每一個Aggregate作資料夾分類還是這三個Aggregate放同一格資料夾?基本上這三個Aggregate就是一個Custer Module，所以都會放到Custer Module資料夾內。    當整理出Aggregate與Module後，接著會開始根據各Module去實作事件應用處理  基本上我們在DDD模塊的設計上有幾個注意要點   Module應該要和Domain概念一致:一般一組聚合集成(領域)，我們會相對應建立一個Module。  根據通用語言來命名:模組命名要一眼就看出這是在做什麼的。  模組設計盡量鬆偶合:盡量與其他模組不要有太多的偶合，若有也許在領域設計上還沒切得很乾淨。  如果有PeerModule或父子Module出現，盡量避免循環相依。  4.關於Module命名    5.Module界線與限界上下文不同  為了對領域模型中進行準確建模，需要將領域模型劃分成多個子域，每個子域對應一個或多個限界區域。 模塊。所以，從子域到限界某些再到模塊，應該是依次包含關係。  補充  補充一   Abstracion:\n   將真實世界物體與事件的大量資訊縮減一個概念或是一個現象的資訊含量來將其廣義化，保存和一特定目的有關的資訊。例如，將一個皮製的足球抽象化成一個球，只保留一般球的屬性(形狀)和行為(滾)等資訊。  Leaky Abstractions\n   所有非不證自明的抽象概念，都有某種程度的疏漏。例如TCP雖簡化(抽象化)網路行為，設計上也保證網路傳送過程中不遺漏資訊，但不保證就真的能完整傳到資訊，例如我們無法避開海底電纜被魚咬斷因此斷訊的狀況。  參考   範例  The 5 Essential Elements of Modular Software Design  The Law of Leaky Abstractions  The Three Principles of Excellent API Design  解析Python模組(Module)和套件(Package)的概念  Module Design   Domain Events vs. Integration Events in Domain-Driven Design and microservices architectures   DDD理论学习系列（13）-- 模块   DDD理论学习系列——案例及目录",{"id":46,"path":47,"dir":33,"title":48,"description":9,"keywords":49,"body":55},"content:1.architecture:2.DDD-簡易整理.md","/architecture/ddd","DDD實戰-簡易整理",[50,51,52,53,54],"一、回顧","二、何謂Entity,如何定義他","三、跟ValueObject有何不同","四、如何產出 Entity Id?","五、.NET Core 實作微服務領域模型","  DDD實戰-簡易整理  一、回顧  (DDD) 重點在於協助您在使用案例相關的商務實際情況下建立模型，然後根據Domain定義後續不同的Context與彼此的對應關係，再與事件驅動方式實際實現。  書中所提例子 : 電商系統，人員瀏覽商並下訂後交易。   定義Domain\n   根據問題空間與解決方法定義出Domain\n   Core Domain :產品最有價值部分 (Ex AI 推薦購買商品需求)  Supporting Subdomain : 未提供核心競爭力，但支援核心所需功能 (Ex 購物需求)  Generic Subdomain : 未提供核心競爭力，但整個系統都可能會用到它 (Ex 身份認證需求、金流串接)      根據語意(Linguistic)與業務能力(Business Capability)定義BoundContext   重點一、通常識別 Bounded Context 會由兩點下手：語意(Linguistic)與業務能力(Business Capability)。  電商例子(語意-業務能力)   登入-帳號管理 => 身分管理Context (Identity)  商品-商品選擇 => 商品目錄Context (Catalog)  下購-購買功能 => 選購Context (Purchase)  重點二、注重業務能力勝過資料分類 (習慣性地用資料表去起始設計系統，甚至把業務邏輯與 ORM 框架綁在一起。這麼一來容易造成物件乘載太多的責任，比如說「顧客」是屬於「會員管理系統」還是屬於「購物系統」？)  Context定義出後，根據幾種方法(設計模式，或撰寫程式技巧)去做Context Mapping    - Shared Kernel\n - Partnership\n - Anti-corruption Layer\n - Open Host Service/Published Language\n - Separate Way\n - Big Ball of Mud\n - Customer-Supplier\n - Conformist\n     使用或設計軟體架構最小化建置與維護「需求系統」所需要的人力資源。\n   軟體的架構與功能需求沒有關係  軟體架構是非功性需球 Non-Funcitonal Requirement (系統達成的任務的能力)  常見軟體架構大概有這些類型：\n   MVC  MVP  Layered Architecture  Client Server  Microservice  Event-Driven Architecture  Pipe-Filter  MVVM  DDD 不等於 Clean Architecture，兩者關注的面向不同。DDD 的主要目的是將軟體的模型更貼近業務需求，架構只是為了達到目的的工具。     二、何謂Entity,如何定義他  根據電商前面例子, 身分管理、 商品目錄與選購中，你覺得什麼是Entity?  顧客、訂單、商品等等。這些物件不被他們的屬性所辨識(比如年齡、金額)，而是由一個專屬的身份標誌 (Identity)來辨識。這種時候，我們就需要 Entity 的幫助讓我們在不同的物件中找到我們要的那一個。  Entity 最大的特徵就是有 Identity 的概念，所以常會搭配一個擁有唯一值的 ID 欄位。但這邊要澄清一個誤解，不是有 ID 就是 Entity，重點是你在不在乎他生命週期的變化。  Entity具有幾個特徵   具有唯一值ID  具有狀態  生命週期有可能無限長  一個 Entity 是可變的、長壽的，所以通常會有複雜的生命週期變化，如一套 CRUD 的操作  不只會實作資料屬性，還會實作具有相關領域邏輯的作業或方法  實體代表領域物件，而且主要是由其身分識別、連續性及一段時間的持續性所定義，而不只是由包含這些項目的屬性所定義。 如同 Eric Evans 說，「主要由其身分識別定義的物件稱為「實體」（Entity）。 實體在領域模型中很重要，因為它們是模型的基礎。  已Order訂單為例子   訂單ID  訂單屬性(ID,Name,Address)  訂單操作Method(EditName, EditAddress)    三、跟ValueObject有何不同   當一個物件沒有概念上的標識 (conceptual identity)，而你只關心它的屬性時，這個物件就可以建立成 Value Object。  Value Object 的屬性都是為了要描述某一個事物的特徵。  判斷這兩者的標準就在於系統在不在乎這個物件的生命週期變化。      四、如何產出 Entity Id?   1. 來自用戶的輸入  這是一個非常直接的做法，比如使用用戶的 email 或是身分證字號等等作為 ID，但也容易造成額外的成本。最大的成本就在於，你需要由用戶負責產生符合需求的身份認證資料非常困難。此時的 ID 可能是唯一的，但卻有可能是不正確的。  甚至，身分證字號也有重複的可能性。  因此，我們可以將用戶輸入的資料作為 Entity 的屬性。這些屬性可以用來做搜尋用，但大多時候並不適合作為 Entity 的 ID。   2. 使用持久化機制來產生  最常見的就是使用資料庫自動生成 ID，最常見的就是 SQL 對 ID 下 AUTO_INCREMENT 讓 ID 的值自動遞增。又或者也可以向資料庫索取一個 UUID (或 GUID) 作為 ID 的值。  這樣的做法好處是可以減少程式的複雜性，直接把產生的工作交給持久化機制處理。但也容易招致效能問題的疑慮(UUID/GUID 的產生)。而且當你無法從程式碼找出 ID 的生產機制時，也會增加程式碼的隱含性不利於閱讀。  另外，使用持久化機制時，也需要特別考量這個 ID 的生成應該要在該物件持久化 (ie 存入資料庫) 之前或是之後，以配合程式的需求。  註：這裡會使用「持久化」一詞是因為儲存資料的方式不止資料庫一種，故用更通稱的方式描述。   3. 在程式中產生  在程式中產生 ID 是最常見的方法之一，這種方法好處是可以更容易掌握生產的時機，此外，更可以客製化你的 ID 格式，比如一筆訂單你可以用 order-20190930-c764e787-8182 作為 ID，如此一來，在 debug 時就不用被一堆天文數字般的 ID 搞得昏頭脹腦。所以以個人經驗來說，即使增加了一點複雜度，會最推薦這個方式。   4. 由另一個 Bounded Context 提供  最複雜的一種就是來自於另一個 Bounded Context 提供的 ID。這種可能出現在當你需要調用 API 的時候，得到對方的資料後存取下來。這種方式的複雜點在於，你不只要考慮本地端的 Entity，也需要考慮外部 Bounded Context 的改變情況，雖然可以透過訂閱另一個 Bounded Context 的方式做到，但仍舊十分麻煩。  五、.NET Core 實作微服務領域模型      參考 :\n  https://ithelp.ithome.com.tw/articles/10223150  https://docs.microsoft.com/zh-tw/dotnet/architecture/microservices/microservice-ddd-cqrs-patterns/microservice-domain-model  https://docs.microsoft.com/zh-tw/dotnet/architecture/microservices/microservice-ddd-cqrs-patterns/ddd-oriented-microservice",{"id":57,"path":58,"dir":59,"title":60,"description":9,"keywords":61,"body":65},"content:2.desktop:1.WindowsForm找不到類型xxxx上的建構涵式.md","/desktop/windowsformxxxx","desktop","WindowsForm找不到類型xxxx上的建構涵式",[62,63,64],"情境","錯誤訊息","解決方法","  WindowsForm找不到類型xxxx上的建構涵式  情境  近期在設計DeskTop頁面時有遇到幾個頁面基底邏輯相同的狀況，於是特別設置Base Page去讓UC繼承使用。因為頁面其實長差不多，所以最後決定不使用參考引用而直接使用繼承。  讓A(UC_3Dswitch_CalibrationFileManagement)繼承B(UC_3Dswitch_FileManagementBase)。  錯誤訊息  編譯上都沒有問題，但此時再使用Design模式時，發生找不到類型錯誤如下    解決方法    宣告無注入空的建構子，       // 宣告無注入空的建構子\n   public     UC_3Dswitch_FileManagementBase  ()\n   {\n     }\n   public     UC_3Dswitch_FileManagementBase  (  AppSetting     appSetting  ) \n   {\n       ProductLineDataPath   =   appSetting.ProductLineDataPath;\n       SNFolderNameLength   =   appSetting.SNFolderNameLength;\n         InitializeComponent  ();\n   }  因原先Base設定注入所宣告AppSetting物件，故發生上述無法載入錯誤。看起來Deisnger模式在Control物件使用上Defaul都是預設空的建構子設置。  .github-light_github-dark{color:#24292e;background:#fff;}.dark .github-light_github-dark{color:#e1e4e8;background:#24292e;}.ct-086898{color:#6A737D;}.ct-149352{color:#D73A49;}.dark .ct-149352{color:#F97583;}.ct-553616{color:#24292E;}.dark .ct-553616{color:#E1E4E8;}.ct-762058{color:#6F42C1;}.dark .ct-762058{color:#B392F0;}",{"id":67,"path":68,"dir":69,"title":70,"description":71,"keywords":72,"body":73},"content:3.cloud-gcp:GKE.md","/cloud-gcp/gke","cloud-gcp","GKE","GKE為GCP提供的SAAS等級的kubernetes服務。相對於自行架設kubernetes運行環境簡化了許多建置部屬、管理及擴展設定的工作。以SAAS提供kubernetes容器平台服務的優點如下",[],"  GKE  GKE為GCP提供的SAAS等級的kubernetes服務。相對於自行架設kubernetes運行環境簡化了許多建置部屬、管理及擴展設定的工作。以SAAS提供kubernetes容器平台服務的優點如下   容易上手 : Google對kubernetesr進行封裝及抽象，使用者不需要了解底層細節即可上手。能直接透過介面操作達到快速部屬與管理設定。不然一般許多部份都需要自己做相關起建，例如..\n   介面需安裝相對應的工具並做設定才可  版本升級修補需人為去維護  需自行安裝與配置監控與日誌工具  安全性設定  資源設定擴展需自行維護",{"id":75,"path":76,"dir":77,"title":78,"description":9,"keywords":79,"body":82},"content:4.database:1.MSSQL使用指令測試Server硬碟速度小技巧.md","/database/mssqlserver","database","MSSQL使用指令測試Server硬碟速度小技巧",[80,81],"讀取速度","寫入速度","  MSSQL使用指令測試Server硬碟速度小技巧  讀取速度  選抽一個資料庫 下BACKUP DATABASE指令，備分資料庫不做寫入，只做讀取，可得到讀取速度值。     BACKUP     DATABASE   [FUXIN_CPL]   TO     DISK     =  'NULL'     WITH     COPY_ONLY    下圖可看到結果每秒讀取速度為180MB/sec    寫入速度     BACKUP     DATABASE   [FUXIN_CPL]   TO     DISK     =  'C:\\TEST.BAK'     WITH     COPY_ONLY  此時會得到讀寫時間為每秒153MB    每秒153MB為讀寫時間，此時須作運算處裡將寫入時間算出  讀取總頁數共688頁，一頁8k => 688*8.0 / 1024 = 5.375M  寫入時間為 0.035-0.03 = 0.005  5.375M/0.005 = 1075M  .github-light_github-dark{color:#24292e;background:#fff;}.dark .github-light_github-dark{color:#e1e4e8;background:#24292e;}.ct-149352{color:#D73A49;}.dark .ct-149352{color:#F97583;}.ct-553616{color:#24292E;}.dark .ct-553616{color:#E1E4E8;}.ct-952708{color:#032F62;}.dark .ct-952708{color:#9ECBFF;}",{"id":84,"path":85,"dir":86,"title":87,"description":9,"keywords":88,"body":90},"content:5.keycloak:1.身份驗證與授權與Keycloak.md","/keycloak/keycloak","keycloak","身份驗證與授權與Keycloak",[89],"一、關於身份驗證與授權","  身份驗證與授權與Keycloak  一、關於身份驗證與授權  身份驗證和授權是系統安全性非常重要的環節。身份驗證用於識別使用者是誰，而授權則賦予使用者某些特定權限。更具體來說，這整個過程可以分為四個部分：   身分識別 (Identification)：這是一個讓系統知道你是誰的過程。例如，當你使用用戶名或電子郵件地址登入系統時，就是進行身分識別。  身分驗證 (Authentication)：這個過程讓系統確認你確實是你聲稱的那個人。通常是通過輸入密碼、使用FaceID或OTP來完成的。  授權 (Authorization)：這涉及到角色分配。根據你的角色，系統會賦予你不同的權限。例如，一個“編輯者”角色可能有編輯內容的權限，而一個“閱讀者”角色則只能閱讀。  存取控制 (Access Control)：這涉及到具體的操作權限。比如，在一個IT管理系統中，一個普通使用者可能可以重啟伺服器和查看系統日誌，但不能部署新的程式碼。然而，一個開發者則可能有這樣的權限。  在你登入系統，輸入帳號密碼為身分識別與身分驗證，系統驗證完後，會根據身分授予角色。至於此角色權限則可以在後台系統上設置。至於這部分的詳細實做概念牽扯還是蠻多的...會再找時間針對這部分做一個細部講解。  1. 身分識別驗證與授權簡易實作  了解這些基礎概念後，我們可以考慮如何手動實現這四個部分。   身分識別 (Identification) : 最常見的實現方式是透過一個使用者註冊頁面，讓使用者輸入基本資料，例如用戶名和密碼。這些信息會被存儲在後端的資料庫中（密碼會被加密）。  身分驗證 (Authentication) : 驗證的方法有多種。   密碼驗證 : 簡單地說，就是將輸入的密碼與資料庫中存儲的密碼進行比對。  多因素驗證 : 二次驗證，例如OTP、FaceID，或是手機&Mail驗證  Session/Token管理 : 用戶登入後，系統會生成一個session或token並發送給用戶。後續的所有請求都需要這個token以確認身份。  授權 (Authorization) : 這部分簡易實作基本上會有三部份   角色管理：在資料庫中設計一個角色和權限的模型。例如，每個使用者可以有一個或多個角色，每個角色有不同的權限。  權限檢查：每次使用者請求某個資源或操作時，檢查他們的角色是否有相應的權限。  API設計：設計API時，確保每個API端點都有適當的授權檢查。  存取控制 (Access Control)   基於角色的存取控制 (RBAC)：根據使用者的角色決定他們可以訪問的資源。  細緻的權限設定：允許系統管理者為每個角色定制細緻的權限，例如某角色只能讀取資料但不能編輯。  其他考慮   日誌和監控：記錄所有的登錄嘗試、授權請求等，以便日後分析和審計。  資料庫安全性：確保資料庫有適當的加密和備份策略。  定期檢查和更新：隨著時間的推移，可能會出現新的安全威脅。定期檢查和更新你的身份驗證和授權策略，以確保它們始終是安全的。  2. 身分識別驗證、授權與Keycloak  通過使用Keycloak，我們能夠更為高效地實現身分識別、身分驗證、授權，以及存取控制等功能。   身分識別 (Identification)   不僅提供使用者註冊功能，讓使用者可以用基本資訊，比如用戶名或電子郵件進行註冊，還支持多種社交登入方式，如Google或Facebook。  身分驗證 (Authentication   支援多種身分驗證方法，包括密碼、OTP、FaceID等，也提供Token管理，當使用者成功登入後，Keycloak 會發放一個 token，使用者可以使用此 token 來存取其他受保護的資源。  授權 (Authorization)   可以定義多個角色，並為每個角色分配不同的權限，使用者可以被分配到一個或多個角色，這些角色決定了使用者可以訪問哪些資源。  存取控制 (Access Control)   支援基於角色的存取控制 (RBAC)。你可以設定哪些角色可以訪問哪些資源。  一般來說，要全面實施這四大功能通常需要大量的時間和資源。開發者不只需要寫大量的程式碼，還必須維護系統的安全性、效能，並確保與其他系統的良好整合。有了Keycloak，這一切都變得相對簡單。",{"id":92,"path":93,"dir":86,"title":94,"description":95,"keywords":96,"body":98},"content:5.keycloak:2.OIDC與SAML.md","/keycloak/oidcsaml","OIDC vs SAML","在這部分，我們將探討OIDC和SAML。正如前一章節所提，身分驗證和授權是整個安全流程中非常關鍵的環節。一般來說，會有專門的解決方案來處理這些問題。OIDC和SAML都是為這個目的而設計的標準協議，它們提供一個集中式的方法來驗證使用者身份，並界定他們可以訪問哪些資源或執行哪些操作。",[97],"1. Open ID Connect (OIDC)：","  OIDC vs SAML  在這部分，我們將探討OIDC和SAML。正如前一章節所提，身分驗證和授權是整個安全流程中非常關鍵的環節。一般來說，會有專門的解決方案來處理這些問題。OIDC和SAML都是為這個目的而設計的標準協議，它們提供一個集中式的方法來驗證使用者身份，並界定他們可以訪問哪些資源或執行哪些操作。  1. Open ID Connect (OIDC)：  OIDC是一個建立在OAuth 2.0之上的身分認證層。OAuth 2.0本身是一個專注於授權的框架，而OIDC則在這個基礎上增加了身分驗證功能。這樣，應用程式不僅能知道使用者有哪些權限，還能瞭解使用者是誰，並獲取他們的基本資訊，比如名稱和電子郵件地址。  a. OAuth 2.0  OAuth 2.0 是一個授權框架，允許第三方應用程式在使用者同意的情況下存取使用者在某個服務上的資訊，而不需要分享使用者的密碼。通常在OAuth 2.0，會有幾個角色，我們這邊舉一個簡單情境，你希望使用「快速日記」App，而這個App提供使用Google帳戶登入的功能來使用Google雲端硬碟服務。   Resource Owner(資源擁有者) : 通常就是User(你)， 能授予應用程式取得受保護資料的人，通常就是終端使用者（end-user）。例如你希望使用「快速日記」App，而這個App提供使用Google帳戶登入的功能。在OAuth的流程中，當App請求許可存取你的資料時，你會給予（或拒絕）這個請求。  Resource Server(Resource Server) : 存放使用者受保護資料的伺服器，以這個例子來說就是Google雲端硬碟，當「快速日記」App希望保存或讀取日記時，它會向此伺服器提出請求。  Client (客戶端)：通常指稱想要取得受保護資源的「應用程式」，以這個例子來說就是「快速日記」App。 當「快速日記」App希望保存或讀取日記時，它會向此伺服器提出請求。  Authorization Server (授權伺服器) : 驗證 Resource Owner 的身份，並且在獲得同意之後，發放「Access Token」給應用程式（Client）的伺服器。以這個例子來說就是 (Google的授權伺服器)。  下圖整個驗證Flow  \n   驗證Flow     Client 到 Resource Owner :   Request Credentials : 當你打開「快速日記」App並選擇使用Google帳戶登入時，App首先會引導你到Google的登入頁面。  Authenticate : 你將在Google的頁面上輸入你的Google帳戶憑證，即用戶名和密碼。這一步是由Google完成的，而「快速日記」App不會看到或知道你的密碼。  Consent : 一旦驗證成功，Google會顯示一個請求同意頁面。在這裡，Google會詢問你是否允許「快速日記」App訪問特定的Google帳戶資料。  Credentials : 「Resource Owner」（使用者）提供的身份資訊或某種用於辨識其身份的資料。這只是一個授權請求，而實際的身份驗證會在Resource Owner和Authorization Server之間完成。    Client 到 Authorization Server   Authorization Request : 如果你同意上述的權限請求，「快速日記」App會從Google的授權伺服器請求一個授權碼。  Authorization Code : Google的授權伺服器會回傳一個短暫的授權碼給「快速日記」App。  Access Token : ，「快速日記」App會使用這個授權碼再次向Google的授權伺服器請求取得訪問令牌（Access Token）。    Client 到 Resource Server   Access Token: 一旦取得訪問令牌，「快速日記」App便可以使用此令牌來存取Google雲端硬碟（或其他你同意的資料）。  Protected Resource: 當「快速日記」App希望保存或讀取日記時，它會使用這個Access Token向Google雲端硬碟（作為資源伺服器）提出請求，然後Google雲端硬碟會根據該令牌提供相對應的資料或服務。  更詳細的其實還有關係到Redirect部分，可以參照這篇   https://cloudsundial.com/salesforce-oauth-flows  寫得還算詳細。  ",{"id":100,"path":101,"dir":86,"title":102,"description":9,"keywords":103,"body":105},"content:5.keycloak:3.關於SSO.md","/keycloak/sso","關於SSO",[104],"三、SSO 簡述","  tags:   keycloak    Tool  三、SSO 簡述  OIDC和SAML討論完後，我們來聊聊單一登入（SSO）。SSO是一個身份驗證方案，它讓使用者能透過一次登入就可訪問多個應用程式和網站。簡而言之：   透過單一的登入窗口，進行單一的身分驗證，就可以讓許多的服務共同來使用這個驗證結果  OIDC和SAML都可以實現這樣的SSO功能。舉例來說，假設你在工作中要使用三個不同的平台：   郵件系統（Email System）  公司內部網站（Intranet）  報表和數據分析平台（Analytics Platform）  通常你得記住這三個系統各自的帳號和密碼。但有了SSO，你只需透過一個統一的登入界面（比如由Keycloak管理）登入一次，然後就能自由地訪問這三個不同的平台，無需再逐一輸入帳號和密碼。  總之，SSO幫你將多個獨立的系統集成為單一的入口點。這樣不僅減少了你需要記住多組密碼的困擾，還降低了由於多個系統各自存儧行密碼所帶來的安全風險。  流程範例大致如下：   Step1(箭頭1) : 用者首先訪問「Application 01」的 URL 並按下登入按鈕，然後會被引導到 Keycloak 登入頁面。  Step2: 用戶在 Keycloak 成功登入後，將被重新導向回「Application 01」的主頁。  Step3(箭頭3): 如果用戶在合理的時間內再次訪問「Application 02」，則不需要重新登入。  箭頭2實際上是指示用戶從「應用程式01」被引導到Keycloak的登入頁面這一過程。簡單來說，當用戶嘗試在「應用程式01」登入（箭頭1）後，他們會被重定向到Keycloak以完成身份驗證（箭頭2）。  ",{"id":107,"path":85,"dir":86,"title":108,"description":109,"keywords":110,"body":111},"content:5.keycloak:4.Keycloak介紹.md","Keycloak介紹","我們剛才談到實現SSO（單一登入）的功能，那麼現在問題來了：有沒有一個工具或平台能讓我們更方便地實現這一切呢？答案是有的，那就是Keycloak。Keycloak是一個集成了多種身份驗證和授權機制（包括OIDC和SAML）的開源身份和訪問管理解決方案。",[],"  Keycloak介紹  我們剛才談到實現SSO（單一登入）的功能，那麼現在問題來了：有沒有一個工具或平台能讓我們更方便地實現這一切呢？答案是有的，那就是Keycloak。Keycloak是一個集成了多種身份驗證和授權機制（包括OIDC和SAML）的開源身份和訪問管理解決方案。  Keycloak的特點如下   多協議支持: Keycloak支持OIDC和SAML，所以你不必為了不同的應用而選擇不同的解決方案。  易於管理: Keycloak有一個使用者友善的管理界面，你可以輕鬆設定用戶、角色和權限。  靈活性: 它是開源的，意味著你可以根據自己的需要對它進行定制。  詳細提供以下功能   身分驗證(Authentication)   單點登入/登出（Single Sign-On/Single Sign-Out）: 讓使用者只需登入一次，就能訪問多個不同的應用和服務。  多因素認證（Multi-Factor Authentication, MFA）: 除了密碼外，還可以透過SMS、郵件或其他方法進行身份驗證。  支持外部身分源: AD，LDAP，Social Login(Google, FB...)。  使用者管理（User Management）   使用者身分 CRUD（Create, Read, Update, Delete）: 簡單地管理使用者資訊，包括建立、查詢、更新和刪除。  屬性管理（Attribute Management）: 可以給使用者賬戶添加多種屬性和標籤。  使用者分組（User Grouping）: 組織使用者到不同的群組以方便管理。  授權（Authorization）   Role-Based Access Control(RBA）: 基於角色給予使用者不同的訪問權限。  Attribute-Based Access Control(ABAC）: 根據使用者的特定屬性（如年齡、部門等）來給予權限。  User-based Access Control (UBAC) : 直接對個別用戶賦予權限，而不是通過角色或屬性。這在只有少數用戶需要訪問特定資源的情況下特別有用。  Context-based Access Control (CBAC) : 更動態的授權方式，考慮到目前的情境或環境狀況（如目前正在執行的操作，或者資源的當前狀態）來做出授權決策。  Rule-based Access Control (Using JavaScript) : 使用 JavaScript 程式碼來定義特定的授權規則。這是一個非常靈活的方式，可以根據極其特定的需求來制定授權策略。  Time-based Access Control : 依據時間來決定是否允許訪問，例如只有工作時間允許訪問某個資源。  Support for custom Access Control Mechanism (ACMs) through a Service Provider Interface (SPI) : 高度定制的選項，允許你通過 Service Provider Interface (SPI) 來實現自己的授權機制。這對於需要非常特殊授權邏輯的場景來說是一個非常強大的工具。  安全性（Security）   密碼政策（Password Policies）: 可以設定密碼的複雜度、有效期等。  會話管理（Session Management）: 查看和管理當前活躍的使用者會話。  應用安全（Client Security）: 對接入的客戶端進行安全設定和驗證。  其他   事件監控（Events Monitoring）: 監控和記錄關於認證、授權等的事件。  擴展性（Extensibility）: 支持自定義插件和腳本，以擴展基礎功能。",{"id":113,"path":114,"dir":115,"title":116,"description":9,"keywords":117,"body":9},"content:100.ironman-gcp:Cloud.md","/ironman-gcp/cloud","ironman-gcp","Cloud",[],{"$sdd-pages":119,"$sdd-surrounds":817,"$sdd-globals":1308,"$scolor-mode":1310,"$sdd-navigation":1312,"$sicons":1356,"$sasideScroll":1375,"$sdocus-docs-aside-collapse-map-/":1376,"$sdocus-docs-aside-collapse-map-/code":1377,"$sdocus-docs-aside-collapse-map-/architecture":1378,"$sdocus-docs-aside-collapse-map-/desktop":1379,"$sdocus-docs-aside-collapse-map-/cloud-gcp":1380,"$sdocus-docs-aside-collapse-map-/database":1381,"$sdocus-docs-aside-collapse-map-/keycloak":1382,"$sdocus-docs-aside-collapse-map-/ironman-gcp":1383},["ShallowRef",120],["ShallowReactive",121],{"/architecture/ddd-module":122},{"_path":32,"_dir":33,"_draft":123,"_partial":123,"_locale":9,"title":34,"description":9,"body":124,"_type":812,"_id":31,"_source":813,"_file":814,"_extension":815,"layout":816},false,{"type":125,"children":126,"toc":800},"root",[127,135,141,147,152,161,166,174,179,184,192,205,214,218,223,253,257,262,267,280,285,290,298,303,311,316,334,342,347,351,356,361,366,421,429,433,438,443,450,458,476,484,490,498,553,559,564,569,587,592,610,615,623,628,633,656,662,670,676,681,685,690,719,723,770,780,790],{"type":128,"tag":129,"props":130,"children":132},"element","h1",{"id":131},"ddd實戰-module",[133],{"type":134,"value":34},"text",{"type":128,"tag":136,"props":137,"children":139},"h3",{"id":138},"一關於module",[140],{"type":134,"value":36},{"type":128,"tag":142,"props":143,"children":144},"p",{},[145],{"type":134,"value":146},"在闡述Module前，讓我們先來比對非物件化設計與物件化設計的差異性。看到下圖左，在非物件化的傳統設計，資料與方法操作上是整個拆開設計，在資料流複雜外我們可以看相依性高，偶合的狀況也較高。",{"type":128,"tag":142,"props":148,"children":149},{},[150],{"type":134,"value":151},"接著討論物件化設計部分，先不論封裝等物件操作技巧，單純根據資料與方法關係設計出物件(物件特性:資料(Data) 物件行為:方法(Function))，我們可以看到原本互相依賴的Fun關係可各自獨立使用，在資料流上也較為單純。",{"type":128,"tag":142,"props":153,"children":154},{},[155],{"type":128,"tag":156,"props":157,"children":160},"img",{"alt":158,"src":159},"Data Fun vs Obj","/blog/images/01/01/001.png",[],{"type":128,"tag":142,"props":162,"children":163},{},[164],{"type":134,"value":165},"物件化後，雖然在資料操作面上簡化許多，但隨著專案功能性逐漸增加，物件與功能處理流程上會趨近越複雜，如下圖為一個簡易的系統，此系統根據外部Sensor系統獲取、過濾與計算資料，在沒模組化的設計前提，可以看到Control與Data Flow呈現一個較零散的關係狀態",{"type":128,"tag":142,"props":167,"children":168},{},[169],{"type":128,"tag":156,"props":170,"children":173},{"alt":171,"src":172},"Control && Data Flow","/blog/images/01/01/002.png",[],{"type":128,"tag":142,"props":175,"children":176},{},[177],{"type":134,"value":178},"此時我們根據Sensor功能額外設計一個Sensor模組如下，此時我們就可以針對Sensor相對應的資料模組將之封裝在模組內，此模組對外則就單純開放運算(calculation)與過濾(filtering)的功能。",{"type":128,"tag":142,"props":180,"children":181},{},[182],{"type":134,"value":183},"模組化後可以明顯看出控制與資料流的彼此相依性值，因此降低了修改與擴充狀況的互相影響性值。",{"type":128,"tag":142,"props":185,"children":186},{},[187],{"type":128,"tag":156,"props":188,"children":191},{"alt":189,"src":190},"Control && Data Flow 2","/blog/images/01/01/003.png",[],{"type":128,"tag":142,"props":193,"children":194},{},[195,197,203],{"type":134,"value":196},"模組化指是將",{"type":128,"tag":198,"props":199,"children":200},"strong",{},[201],{"type":134,"value":202},"系統功能程序作分離獨立(特定功能class的容器)",{"type":134,"value":204},"，除了功能獨立外，也強調設計上可以根據功能隨意抽換模組。達到高內聚、低耦合的目的，進而提高開發者的生產力(將複雜的功能拆分管理)。並讓程式碼能夠透過引用的方式來重複使用，提升重用性(Reusable)",{"type":128,"tag":206,"props":207,"children":208},"blockquote",{},[209],{"type":128,"tag":142,"props":210,"children":211},{},[212],{"type":134,"value":213},"Modular design allows code to remain agile in the face of ever-changing requirements.",{"type":128,"tag":215,"props":216,"children":217},"hr",{"id":9},[],{"type":128,"tag":136,"props":219,"children":221},{"id":220},"二構成module考量五要素",[222],{"type":134,"value":37},{"type":128,"tag":224,"props":225,"children":226},"ul",{},[227,233,238,243,248],{"type":128,"tag":228,"props":229,"children":230},"li",{},[231],{"type":134,"value":232},"Propose:Module功能目標單一職責，盡量不要與其他模組設計有太多相依關係。",{"type":128,"tag":228,"props":234,"children":235},{},[236],{"type":134,"value":237},"Interface:模組功能API所提供使用方式要簡潔易懂，通常User不需要去了解實際內部的實作方式，只需專注在確定輸入什麼，會輸出什麼可達到什麼功能。",{"type":128,"tag":228,"props":239,"children":240},{},[241],{"type":134,"value":242},"Encapsulation:封裝模組，除了讓不暴露資料結構讓使用者亂使用外，對於在修改細節上也能較不容易直接影響使用端。另外再使用抽象實作上，物件抽象化多少還是難以避免Leaky Abstractions的問題。",{"type":128,"tag":228,"props":244,"children":245},{},[246],{"type":134,"value":247},"Implementation:實作上除了考量功能正確性外還需考慮效能、測試與功能架構程式碼最小化。",{"type":128,"tag":228,"props":249,"children":250},{},[251],{"type":134,"value":252},"Connection(關聯性):呼應Propose功能單一職責，將與其他模組相依性最小化。",{"type":128,"tag":215,"props":254,"children":256},{"id":255},"_1",[],{"type":128,"tag":136,"props":258,"children":260},{"id":259},"三package-vs-module",[261],{"type":134,"value":38},{"type":128,"tag":142,"props":263,"children":264},{},[265],{"type":134,"value":266},"在了解Module構成要素後~隨著專案模組(Module)的增加，將難以管理及問題的追蹤，這時候就能將模組(Module)打包成套件(Package)，利用其階層式的結構來彈性規劃模組(Module)。",{"type":128,"tag":224,"props":268,"children":269},{},[270,275],{"type":128,"tag":228,"props":271,"children":272},{},[273],{"type":134,"value":274},"Module:單一功能模組",{"type":128,"tag":228,"props":276,"children":277},{},[278],{"type":134,"value":279},"Package:多Module組成",{"type":128,"tag":136,"props":281,"children":283},{"id":282},"四一般module設計方法",[284],{"type":134,"value":39},{"type":128,"tag":142,"props":286,"children":287},{},[288],{"type":134,"value":289},"在非以領域事件為出發點的設計上，大部分狀況會根據功能設計成物件與介面使用。下圖為Zebra SDK Package的Module列項，我們可以大致分得出，他的Module設計就是根據功能性值去區分(graphics, certificate...)",{"type":128,"tag":142,"props":291,"children":292},{},[293],{"type":128,"tag":156,"props":294,"children":297},{"alt":295,"src":296},"由功能性區分","/blog/images/01/01/004.png",[],{"type":128,"tag":142,"props":299,"children":300},{},[301],{"type":134,"value":302},"接著我們點近discovery看提供什麼API功能，可以看到可以使用的介面功能以及相關功能可使用的功能物件。",{"type":128,"tag":142,"props":304,"children":305},{},[306],{"type":128,"tag":156,"props":307,"children":310},{"alt":308,"src":309},"由功能性區分2","/blog/images/01/01/005.png",[],{"type":128,"tag":142,"props":312,"children":313},{},[314],{"type":134,"value":315},"在點進個別更詳細功能介紹，我們就會看到這物件功能具有什麼資料特質、物件實體化須提供什麼參數以及此物件可使用哪些方法。",{"type":128,"tag":224,"props":317,"children":318},{},[319,324,329],{"type":128,"tag":228,"props":320,"children":321},{},[322],{"type":134,"value":323},"Field: address，IP or Mac Adress",{"type":128,"tag":228,"props":325,"children":326},{},[327],{"type":134,"value":328},"Constructor:物件實體化須提供印表機的IP or Mac Adress",{"type":128,"tag":228,"props":330,"children":331},{},[332],{"type":134,"value":333},"Method:可使用的物件功能，在此例看起來需實作getConnection功能",{"type":128,"tag":142,"props":335,"children":336},{},[337],{"type":128,"tag":156,"props":338,"children":341},{"alt":339,"src":340},"由功能性區分3","/blog/images/01/01/006.png",[],{"type":128,"tag":142,"props":343,"children":344},{},[345],{"type":134,"value":346},"上述為印表機找到印表機裝置功能的模組化介紹",{"type":128,"tag":215,"props":348,"children":350},{"id":349},"_2",[],{"type":128,"tag":136,"props":352,"children":354},{"id":353},"五未使用ddd的一般service服務設計",[355],{"type":134,"value":40},{"type":128,"tag":142,"props":357,"children":358},{},[359],{"type":134,"value":360},"上述一般Module設計概念聊完，在聊DDD Module設計之前先來聊一下在一般未使用DDD領域設計的服務系統會如何設計。",{"type":128,"tag":142,"props":362,"children":363},{},[364],{"type":134,"value":365},"在對大部分的開發者，一開始習慣設計都以數據為考量的集中式設計架構。設計架構上會出現比較常見到的分層式設計，大致分成Controller, Service, Repositories, Models",{"type":128,"tag":224,"props":367,"children":368},{},[369,382,395,408],{"type":128,"tag":228,"props":370,"children":371},{},[372,374],{"type":134,"value":373},"xxx/Model\n",{"type":128,"tag":224,"props":375,"children":376},{},[377],{"type":128,"tag":228,"props":378,"children":379},{},[380],{"type":134,"value":381},"數據庫Model、Request Model, Response Model",{"type":128,"tag":228,"props":383,"children":384},{},[385,387],{"type":134,"value":386},"xxx/Controller\n",{"type":128,"tag":224,"props":388,"children":389},{},[390],{"type":128,"tag":228,"props":391,"children":392},{},[393],{"type":134,"value":394},"給Client端的API第一時間接口，提供Get,Post,Delete,Update API。除了此在此層一般都會安插屬性驗證Client第一時間傳過來的資料是否正確。並作實際的DTO(Object 與DB Model Mapping)轉換。",{"type":128,"tag":228,"props":396,"children":397},{},[398,400],{"type":134,"value":399},"xxx/Service\n",{"type":128,"tag":224,"props":401,"children":402},{},[403],{"type":128,"tag":228,"props":404,"children":405},{},[406],{"type":134,"value":407},"這層基本上就是作商業邏輯的處哩，進到此層的資料基本上都是做完DTO轉換，在此層通常會作實際的資料邏輯處理處理完後再往DB方向送。",{"type":128,"tag":228,"props":409,"children":410},{},[411,413],{"type":134,"value":412},"xxx/Repositorie\n",{"type":128,"tag":224,"props":414,"children":415},{},[416],{"type":128,"tag":228,"props":417,"children":418},{},[419],{"type":134,"value":420},"DataSource(DBContext)上一層，一般會除了實際面DataSource讀寫變更操作外，Source 資料Join處理也會在此層處理。一般多這一層都是為了隔開DataSource的來源切換，不管置換不同的DB系統，或是Source改成Shared Prefs，都可快速置換資料來源。",{"type":128,"tag":142,"props":422,"children":423},{},[424],{"type":128,"tag":156,"props":425,"children":428},{"alt":426,"src":427},"一般單體架構","/blog/images/01/01/007.png",[],{"type":128,"tag":215,"props":430,"children":432},{"id":431},"_3",[],{"type":128,"tag":136,"props":434,"children":436},{"id":435},"六在ddd世界中的module設計",[437],{"type":134,"value":41},{"type":128,"tag":142,"props":439,"children":440},{},[441],{"type":134,"value":442},"上述稍微帶過Module的設計概念後，接著探討在DDD世界裡，Module的設計概念如何~大致分成幾個探討議題",{"type":128,"tag":444,"props":445,"children":447},"h4",{"id":446},"_1ddd設計步驟流程",[448],{"type":134,"value":449},"1.DDD設計步驟流程",{"type":128,"tag":142,"props":451,"children":452},{},[453],{"type":128,"tag":156,"props":454,"children":457},{"alt":455,"src":456},"事件風暴","/blog/images/01/01/008.png",[],{"type":128,"tag":224,"props":459,"children":460},{},[461,466,471],{"type":128,"tag":228,"props":462,"children":463},{},[464],{"type":134,"value":465},"在探討需求架構DDD設計的第一步，就是根據需求情境列出事件風暴(Event storming)，並在事件風暴中的用戶操作、事件、以及依賴關係根據這些要素設計歸納出領域與實體。",{"type":128,"tag":228,"props":467,"children":468},{},[469],{"type":134,"value":470},"接著第二步在領域實體之間找尋彼此務的關聯性，將具有相關的實體組合成聚合(Aggregate)，同時確定聚合根(Aggregate Root)。在聚合根行程時，基本上第一層邊界(邏輯邊界-虛線)也會跟著產生，他們會在同一個服務器中運行。",{"type":128,"tag":228,"props":472,"children":473},{},[474],{"type":134,"value":475},"當聚合規劃好後~會根據業務及語意邊界等因素，將一個或多個聚合規劃訂製在一個限界上下文內(服務邊界)，形成領域模型。",{"type":128,"tag":142,"props":477,"children":478},{},[479],{"type":128,"tag":156,"props":480,"children":483},{"alt":481,"src":482},"聚合","/blog/images/01/01/009.png",[],{"type":128,"tag":444,"props":485,"children":487},{"id":486},"_2程式碼一級目錄架構",[488],{"type":134,"value":489},"2.程式碼一級目錄架構",{"type":128,"tag":142,"props":491,"children":492},{},[493],{"type":128,"tag":156,"props":494,"children":497},{"alt":495,"src":496},"一級目錄架構","/blog/images/01/01/010.png",[],{"type":128,"tag":224,"props":499,"children":500},{},[501,514,527,540],{"type":128,"tag":228,"props":502,"children":503},{},[504,506],{"type":134,"value":505},"Interface(API Interface)\n",{"type":128,"tag":224,"props":507,"children":508},{},[509],{"type":128,"tag":228,"props":510,"children":511},{},[512],{"type":134,"value":513},"給使用者API介面，使用者透過Restful請求，將資料傳到此層，解析用戶傳送的請求資訊，資料的組裝、資料傳輸格式以及 Facade 介面等代碼都會放在這一層目錄裡。",{"type":128,"tag":228,"props":515,"children":516},{},[517,519],{"type":134,"value":518},"Application\n",{"type":128,"tag":224,"props":520,"children":521},{},[522],{"type":128,"tag":228,"props":523,"children":524},{},[525],{"type":134,"value":526},"他有點像是原先集中式設計Service的功能，實作所有相依於指定前端之使用案例的地方。 例如，與 Web API 服務相關的實作。若使用的是 CQRS 方法，它便會包含查詢、微服務接受的命令，甚至是微服務之間的事件驅動通訊 (整合事件)。",{"type":128,"tag":228,"props":528,"children":529},{},[530,532],{"type":134,"value":531},"Domain\n",{"type":128,"tag":224,"props":533,"children":534},{},[535],{"type":128,"tag":228,"props":536,"children":537},{},[538],{"type":134,"value":539},"它主要存放領域層核心業務邏輯相關的代碼。領域層可以包含多個聚合代碼包，它們共同實現領域模型的核心業務邏輯。聚合以及聚合內的實體、方法、領域服務和事件等代碼會放在這一層目錄裡。",{"type":128,"tag":228,"props":541,"children":542},{},[543,545],{"type":134,"value":544},"Infrastructure\n",{"type":128,"tag":224,"props":546,"children":547},{},[548],{"type":128,"tag":228,"props":549,"children":550},{},[551],{"type":134,"value":552},"它主要存放基礎資源服務相關的代碼，為其它各層提供的通用技術能力、三方套裝軟體、資料庫服務、配置和基礎資源服務的代碼都會放在這一層目錄裡。",{"type":128,"tag":444,"props":554,"children":556},{"id":555},"_3在ddd-module準則",[557],{"type":134,"value":558},"3.在DDD Module準則",{"type":128,"tag":142,"props":560,"children":561},{},[562],{"type":134,"value":563},"例子:如何對電商平台上的顧客進行模塊設計",{"type":128,"tag":142,"props":565,"children":566},{},[567],{"type":134,"value":568},"對於顧客來說，一般須要維護顧客的",{"type":128,"tag":224,"props":570,"children":571},{},[572,577,582],{"type":128,"tag":228,"props":573,"children":574},{},[575],{"type":134,"value":576},"個人訊息",{"type":128,"tag":228,"props":578,"children":579},{},[580],{"type":134,"value":581},"收穫地址",{"type":128,"tag":228,"props":583,"children":584},{},[585],{"type":134,"value":586},"付款方法",{"type":128,"tag":142,"props":588,"children":589},{},[590],{"type":134,"value":591},"這三個之間的關係是緊密相關，不可獨立存在，我們根據這三點抽象出三個Aggregate",{"type":128,"tag":224,"props":593,"children":594},{},[595,600,605],{"type":128,"tag":228,"props":596,"children":597},{},[598],{"type":134,"value":599},"Customer 個人訊息",{"type":128,"tag":228,"props":601,"children":602},{},[603],{"type":134,"value":604},"AddressBook 收穫地址",{"type":128,"tag":228,"props":606,"children":607},{},[608],{"type":134,"value":609},"Wallet 付款方法",{"type":128,"tag":142,"props":611,"children":612},{},[613],{"type":134,"value":614},"那該如何去放置這些Aggregate，是針對每一個Aggregate作資料夾分類還是這三個Aggregate放同一格資料夾?基本上這三個Aggregate就是一個Custer Module，所以都會放到Custer Module資料夾內。",{"type":128,"tag":142,"props":616,"children":617},{},[618],{"type":128,"tag":156,"props":619,"children":622},{"alt":620,"src":621},"Custer Module資料夾","/blog/images/01/01/011.png",[],{"type":128,"tag":142,"props":624,"children":625},{},[626],{"type":134,"value":627},"當整理出Aggregate與Module後，接著會開始根據各Module去實作事件應用處理",{"type":128,"tag":142,"props":629,"children":630},{},[631],{"type":134,"value":632},"基本上我們在DDD模塊的設計上有幾個注意要點",{"type":128,"tag":224,"props":634,"children":635},{},[636,641,646,651],{"type":128,"tag":228,"props":637,"children":638},{},[639],{"type":134,"value":640},"Module應該要和Domain概念一致:一般一組聚合集成(領域)，我們會相對應建立一個Module。",{"type":128,"tag":228,"props":642,"children":643},{},[644],{"type":134,"value":645},"根據通用語言來命名:模組命名要一眼就看出這是在做什麼的。",{"type":128,"tag":228,"props":647,"children":648},{},[649],{"type":134,"value":650},"模組設計盡量鬆偶合:盡量與其他模組不要有太多的偶合，若有也許在領域設計上還沒切得很乾淨。",{"type":128,"tag":228,"props":652,"children":653},{},[654],{"type":134,"value":655},"如果有PeerModule或父子Module出現，盡量避免循環相依。",{"type":128,"tag":444,"props":657,"children":659},{"id":658},"_4關於module命名",[660],{"type":134,"value":661},"4.關於Module命名",{"type":128,"tag":142,"props":663,"children":664},{},[665],{"type":128,"tag":156,"props":666,"children":669},{"alt":667,"src":668},"Module命名","/blog/images/01/01/012.png",[],{"type":128,"tag":444,"props":671,"children":673},{"id":672},"_5module界線與限界上下文不同",[674],{"type":134,"value":675},"5.Module界線與限界上下文不同",{"type":128,"tag":142,"props":677,"children":678},{},[679],{"type":134,"value":680},"為了對領域模型中進行準確建模，需要將領域模型劃分成多個子域，每個子域對應一個或多個限界區域。 模塊。所以，從子域到限界某些再到模塊，應該是依次包含關係。",{"type":128,"tag":136,"props":682,"children":683},{"id":42},[684],{"type":134,"value":42},{"type":128,"tag":444,"props":686,"children":688},{"id":687},"補充一",[689],{"type":134,"value":687},{"type":128,"tag":224,"props":691,"children":692},{},[693,706],{"type":128,"tag":228,"props":694,"children":695},{},[696,698],{"type":134,"value":697},"Abstracion:\n",{"type":128,"tag":224,"props":699,"children":700},{},[701],{"type":128,"tag":228,"props":702,"children":703},{},[704],{"type":134,"value":705},"將真實世界物體與事件的大量資訊縮減一個概念或是一個現象的資訊含量來將其廣義化，保存和一特定目的有關的資訊。例如，將一個皮製的足球抽象化成一個球，只保留一般球的屬性(形狀)和行為(滾)等資訊。",{"type":128,"tag":228,"props":707,"children":708},{},[709,711],{"type":134,"value":710},"Leaky Abstractions\n",{"type":128,"tag":224,"props":712,"children":713},{},[714],{"type":128,"tag":228,"props":715,"children":716},{},[717],{"type":134,"value":718},"所有非不證自明的抽象概念，都有某種程度的疏漏。例如TCP雖簡化(抽象化)網路行為，設計上也保證網路傳送過程中不遺漏資訊，但不保證就真的能完整傳到資訊，例如我們無法避開海底電纜被魚咬斷因此斷訊的狀況。",{"type":128,"tag":136,"props":720,"children":721},{"id":43},[722],{"type":134,"value":43},{"type":128,"tag":142,"props":724,"children":725},{},[726,735,742,749,756,763],{"type":128,"tag":727,"props":728,"children":732},"a",{"href":729,"rel":730},"https://github.com/kgrzybek/modular-monolith-with-ddd#32-module-level-view",[731],"nofollow",[733],{"type":134,"value":734},"範例",{"type":128,"tag":727,"props":736,"children":739},{"href":737,"rel":738},"https://shanebdavis.medium.com/the-5-essential-elements-of-modular-software-design-6b333918e543",[731],[740],{"type":134,"value":741},"The 5 Essential Elements of Modular Software Design",{"type":128,"tag":727,"props":743,"children":746},{"href":744,"rel":745},"https://www.joelonsoftware.com/2002/11/11/the-law-of-leaky-abstractions/",[731],[747],{"type":134,"value":748},"The Law of Leaky Abstractions",{"type":128,"tag":727,"props":750,"children":753},{"href":751,"rel":752},"https://nordicapis.com/the-three-principles-of-excellent-api-design/",[731],[754],{"type":134,"value":755},"The Three Principles of Excellent API Design",{"type":128,"tag":727,"props":757,"children":760},{"href":758,"rel":759},"https://www.learncodewithmike.com/2020/01/python-module-and-package.html",[731],[761],{"type":134,"value":762},"解析Python模組(Module)和套件(Package)的概念",{"type":128,"tag":727,"props":764,"children":767},{"href":765,"rel":766},"http://www.the-software-experts.com/e_dta-sw-design-module.php",[731],[768],{"type":134,"value":769},"Module Design",{"type":128,"tag":142,"props":771,"children":772},{},[773],{"type":128,"tag":727,"props":774,"children":777},{"href":775,"rel":776},"https://devblogs.microsoft.com/cesardelatorre/domain-events-vs-integration-events-in-domain-driven-design-and-microservices-architectures/",[731],[778],{"type":134,"value":779},"Domain Events vs. Integration Events in Domain-Driven Design and microservices architectures",{"type":128,"tag":142,"props":781,"children":782},{},[783],{"type":128,"tag":727,"props":784,"children":787},{"href":785,"rel":786},"https://www.cnblogs.com/sheng-jie/p/7266557.html",[731],[788],{"type":134,"value":789},"DDD理论学习系列（13）-- 模块",{"type":128,"tag":142,"props":791,"children":792},{},[793],{"type":128,"tag":727,"props":794,"children":797},{"href":795,"rel":796},"https://www.cnblogs.com/sheng-jie/p/6931646.html",[731],[798],{"type":134,"value":799},"DDD理论学习系列——案例及目录",{"title":9,"searchDepth":801,"depth":801,"links":802},2,[803,805,806,807,808,809,810,811],{"id":138,"depth":804,"text":36},3,{"id":220,"depth":804,"text":37},{"id":259,"depth":804,"text":38},{"id":282,"depth":804,"text":39},{"id":353,"depth":804,"text":40},{"id":435,"depth":804,"text":41},{"id":42,"depth":804,"text":42},{"id":43,"depth":804,"text":43},"markdown","content","1.architecture/1.DDD實戰-Module.md","md","default",["ShallowRef",818],["ShallowReactive",819],{"/architecture/ddd-module":820},[821,830],{"_path":822,"_dir":7,"_draft":123,"_partial":823,"_locale":9,"title":824,"icon":825,"_id":826,"_type":827,"_source":813,"_file":828,"_extension":829},"/code/_dir",true,"Codesnese","🧑‍💻","content:0.code:_dir.yml","yaml","0.code/_dir.yml","yml",{"_path":47,"_dir":33,"_draft":123,"_partial":123,"_locale":9,"title":48,"description":9,"body":831,"_type":812,"_id":46,"_source":813,"_file":1307,"_extension":815},{"type":125,"children":832,"toc":1300},[833,838,843,848,853,887,900,958,966,1040,1048,1051,1056,1061,1066,1071,1099,1104,1109,1127,1135,1140,1158,1166,1174,1179,1187,1192,1197,1202,1210,1215,1220,1225,1230,1238,1243,1251,1256,1261,1269,1277],{"type":128,"tag":129,"props":834,"children":836},{"id":835},"ddd實戰-簡易整理",[837],{"type":134,"value":48},{"type":128,"tag":136,"props":839,"children":841},{"id":840},"一回顧",[842],{"type":134,"value":50},{"type":128,"tag":142,"props":844,"children":845},{},[846],{"type":134,"value":847},"(DDD) 重點在於協助您在使用案例相關的商務實際情況下建立模型，然後根據Domain定義後續不同的Context與彼此的對應關係，再與事件驅動方式實際實現。",{"type":128,"tag":142,"props":849,"children":850},{},[851],{"type":134,"value":852},"書中所提例子 : 電商系統，人員瀏覽商並下訂後交易。",{"type":128,"tag":224,"props":854,"children":855},{},[856],{"type":128,"tag":228,"props":857,"children":858},{},[859,861],{"type":134,"value":860},"定義Domain\n",{"type":128,"tag":224,"props":862,"children":863},{},[864],{"type":128,"tag":228,"props":865,"children":866},{},[867,869],{"type":134,"value":868},"根據問題空間與解決方法定義出Domain\n",{"type":128,"tag":224,"props":870,"children":871},{},[872,877,882],{"type":128,"tag":228,"props":873,"children":874},{},[875],{"type":134,"value":876},"Core Domain :產品最有價值部分 (Ex AI 推薦購買商品需求)",{"type":128,"tag":228,"props":878,"children":879},{},[880],{"type":134,"value":881},"Supporting Subdomain : 未提供核心競爭力，但支援核心所需功能 (Ex 購物需求)",{"type":128,"tag":228,"props":883,"children":884},{},[885],{"type":134,"value":886},"Generic Subdomain : 未提供核心競爭力，但整個系統都可能會用到它 (Ex 身份認證需求、金流串接)",{"type":128,"tag":142,"props":888,"children":889},{},[890,895],{"type":128,"tag":156,"props":891,"children":894},{"alt":892,"src":893},"刀子譬喻","/blog/images/01/02/001.png",[],{"type":128,"tag":156,"props":896,"children":899},{"alt":897,"src":898},"Bounding","/blog/images/01/02/002.png",[],{"type":128,"tag":224,"props":901,"children":902},{},[903,944],{"type":128,"tag":228,"props":904,"children":905},{},[906,908],{"type":134,"value":907},"根據語意(Linguistic)與業務能力(Business Capability)定義BoundContext",{"type":128,"tag":224,"props":909,"children":910},{},[911,916,939],{"type":128,"tag":228,"props":912,"children":913},{},[914],{"type":134,"value":915},"重點一、通常識別 Bounded Context 會由兩點下手：語意(Linguistic)與業務能力(Business Capability)。",{"type":128,"tag":228,"props":917,"children":918},{},[919,921],{"type":134,"value":920},"電商例子(語意-業務能力)",{"type":128,"tag":224,"props":922,"children":923},{},[924,929,934],{"type":128,"tag":228,"props":925,"children":926},{},[927],{"type":134,"value":928},"登入-帳號管理 => 身分管理Context (Identity)",{"type":128,"tag":228,"props":930,"children":931},{},[932],{"type":134,"value":933},"商品-商品選擇 => 商品目錄Context (Catalog)",{"type":128,"tag":228,"props":935,"children":936},{},[937],{"type":134,"value":938},"下購-購買功能 => 選購Context (Purchase)",{"type":128,"tag":228,"props":940,"children":941},{},[942],{"type":134,"value":943},"重點二、注重業務能力勝過資料分類 (習慣性地用資料表去起始設計系統，甚至把業務邏輯與 ORM 框架綁在一起。這麼一來容易造成物件乘載太多的責任，比如說「顧客」是屬於「會員管理系統」還是屬於「購物系統」？)",{"type":128,"tag":228,"props":945,"children":946},{},[947,949],{"type":134,"value":948},"Context定義出後，根據幾種方法(設計模式，或撰寫程式技巧)去做Context Mapping",{"type":128,"tag":950,"props":951,"children":953},"pre",{"code":952}," - Shared Kernel\n - Partnership\n - Anti-corruption Layer\n - Open Host Service/Published Language\n - Separate Way\n - Big Ball of Mud\n - Customer-Supplier\n - Conformist\n",[954],{"type":128,"tag":7,"props":955,"children":956},{"__ignoreMap":9},[957],{"type":134,"value":952},{"type":128,"tag":142,"props":959,"children":960},{},[961],{"type":128,"tag":156,"props":962,"children":965},{"alt":963,"src":964},"Context Mapping","/blog/images/01/02/003.png",[],{"type":128,"tag":224,"props":967,"children":968},{},[969],{"type":128,"tag":228,"props":970,"children":971},{},[972,974],{"type":134,"value":973},"使用或設計軟體架構最小化建置與維護「需求系統」所需要的人力資源。\n",{"type":128,"tag":224,"props":975,"children":976},{},[977,982,987,1035],{"type":128,"tag":228,"props":978,"children":979},{},[980],{"type":134,"value":981},"軟體的架構與功能需求沒有關係",{"type":128,"tag":228,"props":983,"children":984},{},[985],{"type":134,"value":986},"軟體架構是非功性需球 Non-Funcitonal Requirement (系統達成的任務的能力)",{"type":128,"tag":228,"props":988,"children":989},{},[990,992],{"type":134,"value":991},"常見軟體架構大概有這些類型：\n",{"type":128,"tag":224,"props":993,"children":994},{},[995,1000,1005,1010,1015,1020,1025,1030],{"type":128,"tag":228,"props":996,"children":997},{},[998],{"type":134,"value":999},"MVC",{"type":128,"tag":228,"props":1001,"children":1002},{},[1003],{"type":134,"value":1004},"MVP",{"type":128,"tag":228,"props":1006,"children":1007},{},[1008],{"type":134,"value":1009},"Layered Architecture",{"type":128,"tag":228,"props":1011,"children":1012},{},[1013],{"type":134,"value":1014},"Client Server",{"type":128,"tag":228,"props":1016,"children":1017},{},[1018],{"type":134,"value":1019},"Microservice",{"type":128,"tag":228,"props":1021,"children":1022},{},[1023],{"type":134,"value":1024},"Event-Driven Architecture",{"type":128,"tag":228,"props":1026,"children":1027},{},[1028],{"type":134,"value":1029},"Pipe-Filter",{"type":128,"tag":228,"props":1031,"children":1032},{},[1033],{"type":134,"value":1034},"MVVM",{"type":128,"tag":228,"props":1036,"children":1037},{},[1038],{"type":134,"value":1039},"DDD 不等於 Clean Architecture，兩者關注的面向不同。DDD 的主要目的是將軟體的模型更貼近業務需求，架構只是為了達到目的的工具。",{"type":128,"tag":142,"props":1041,"children":1042},{},[1043],{"type":128,"tag":156,"props":1044,"children":1047},{"alt":1045,"src":1046},"Cost-Time Char","/blog/images/01/02/004.png",[],{"type":128,"tag":215,"props":1049,"children":1050},{"id":9},[],{"type":128,"tag":136,"props":1052,"children":1054},{"id":1053},"二何謂entity如何定義他",[1055],{"type":134,"value":51},{"type":128,"tag":142,"props":1057,"children":1058},{},[1059],{"type":134,"value":1060},"根據電商前面例子, 身分管理、 商品目錄與選購中，你覺得什麼是Entity?",{"type":128,"tag":142,"props":1062,"children":1063},{},[1064],{"type":134,"value":1065},"顧客、訂單、商品等等。這些物件不被他們的屬性所辨識(比如年齡、金額)，而是由一個專屬的身份標誌 (Identity)來辨識。這種時候，我們就需要 Entity 的幫助讓我們在不同的物件中找到我們要的那一個。  Entity 最大的特徵就是有 Identity 的概念，所以常會搭配一個擁有唯一值的 ID 欄位。但這邊要澄清一個誤解，不是有 ID 就是 Entity，重點是你在不在乎他生命週期的變化。",{"type":128,"tag":142,"props":1067,"children":1068},{},[1069],{"type":134,"value":1070},"Entity具有幾個特徵",{"type":128,"tag":224,"props":1072,"children":1073},{},[1074,1079,1084,1089,1094],{"type":128,"tag":228,"props":1075,"children":1076},{},[1077],{"type":134,"value":1078},"具有唯一值ID",{"type":128,"tag":228,"props":1080,"children":1081},{},[1082],{"type":134,"value":1083},"具有狀態",{"type":128,"tag":228,"props":1085,"children":1086},{},[1087],{"type":134,"value":1088},"生命週期有可能無限長",{"type":128,"tag":228,"props":1090,"children":1091},{},[1092],{"type":134,"value":1093},"一個 Entity 是可變的、長壽的，所以通常會有複雜的生命週期變化，如一套 CRUD 的操作",{"type":128,"tag":228,"props":1095,"children":1096},{},[1097],{"type":134,"value":1098},"不只會實作資料屬性，還會實作具有相關領域邏輯的作業或方法",{"type":128,"tag":142,"props":1100,"children":1101},{},[1102],{"type":134,"value":1103},"實體代表領域物件，而且主要是由其身分識別、連續性及一段時間的持續性所定義，而不只是由包含這些項目的屬性所定義。 如同 Eric Evans 說，「主要由其身分識別定義的物件稱為「實體」（Entity）。 實體在領域模型中很重要，因為它們是模型的基礎。",{"type":128,"tag":142,"props":1105,"children":1106},{},[1107],{"type":134,"value":1108},"已Order訂單為例子",{"type":128,"tag":224,"props":1110,"children":1111},{},[1112,1117,1122],{"type":128,"tag":228,"props":1113,"children":1114},{},[1115],{"type":134,"value":1116},"訂單ID",{"type":128,"tag":228,"props":1118,"children":1119},{},[1120],{"type":134,"value":1121},"訂單屬性(ID,Name,Address)",{"type":128,"tag":228,"props":1123,"children":1124},{},[1125],{"type":134,"value":1126},"訂單操作Method(EditName, EditAddress)",{"type":128,"tag":142,"props":1128,"children":1129},{},[1130],{"type":128,"tag":156,"props":1131,"children":1134},{"alt":1132,"src":1133},"Order Class UML","/blog/images/01/02/005.png",[],{"type":128,"tag":136,"props":1136,"children":1138},{"id":1137},"三跟valueobject有何不同",[1139],{"type":134,"value":52},{"type":128,"tag":224,"props":1141,"children":1142},{},[1143,1148,1153],{"type":128,"tag":228,"props":1144,"children":1145},{},[1146],{"type":134,"value":1147},"當一個物件沒有概念上的標識 (conceptual identity)，而你只關心它的屬性時，這個物件就可以建立成 Value Object。",{"type":128,"tag":228,"props":1149,"children":1150},{},[1151],{"type":134,"value":1152},"Value Object 的屬性都是為了要描述某一個事物的特徵。",{"type":128,"tag":228,"props":1154,"children":1155},{},[1156],{"type":134,"value":1157},"判斷這兩者的標準就在於系統在不在乎這個物件的生命週期變化。",{"type":128,"tag":142,"props":1159,"children":1160},{},[1161],{"type":128,"tag":156,"props":1162,"children":1165},{"alt":1163,"src":1164},"Order Class UML2","/blog/images/01/02/006.png",[],{"type":128,"tag":142,"props":1167,"children":1168},{},[1169],{"type":128,"tag":156,"props":1170,"children":1173},{"alt":1171,"src":1172},"Mapping Relationship","/blog/images/01/02/007.png",[],{"type":128,"tag":136,"props":1175,"children":1177},{"id":1176},"四如何產出-entity-id",[1178],{"type":134,"value":53},{"type":128,"tag":142,"props":1180,"children":1181},{},[1182],{"type":128,"tag":198,"props":1183,"children":1184},{},[1185],{"type":134,"value":1186},"1. 來自用戶的輸入",{"type":128,"tag":142,"props":1188,"children":1189},{},[1190],{"type":134,"value":1191},"這是一個非常直接的做法，比如使用用戶的 email 或是身分證字號等等作為 ID，但也容易造成額外的成本。最大的成本就在於，你需要由用戶負責產生符合需求的身份認證資料非常困難。此時的 ID 可能是唯一的，但卻有可能是不正確的。",{"type":128,"tag":142,"props":1193,"children":1194},{},[1195],{"type":134,"value":1196},"甚至，身分證字號也有重複的可能性。",{"type":128,"tag":142,"props":1198,"children":1199},{},[1200],{"type":134,"value":1201},"因此，我們可以將用戶輸入的資料作為 Entity 的屬性。這些屬性可以用來做搜尋用，但大多時候並不適合作為 Entity 的 ID。",{"type":128,"tag":142,"props":1203,"children":1204},{},[1205],{"type":128,"tag":198,"props":1206,"children":1207},{},[1208],{"type":134,"value":1209},"2. 使用持久化機制來產生",{"type":128,"tag":142,"props":1211,"children":1212},{},[1213],{"type":134,"value":1214},"最常見的就是使用資料庫自動生成 ID，最常見的就是 SQL 對 ID 下 AUTO_INCREMENT 讓 ID 的值自動遞增。又或者也可以向資料庫索取一個 UUID (或 GUID) 作為 ID 的值。",{"type":128,"tag":142,"props":1216,"children":1217},{},[1218],{"type":134,"value":1219},"這樣的做法好處是可以減少程式的複雜性，直接把產生的工作交給持久化機制處理。但也容易招致效能問題的疑慮(UUID/GUID 的產生)。而且當你無法從程式碼找出 ID 的生產機制時，也會增加程式碼的隱含性不利於閱讀。",{"type":128,"tag":142,"props":1221,"children":1222},{},[1223],{"type":134,"value":1224},"另外，使用持久化機制時，也需要特別考量這個 ID 的生成應該要在該物件持久化 (ie 存入資料庫) 之前或是之後，以配合程式的需求。",{"type":128,"tag":142,"props":1226,"children":1227},{},[1228],{"type":134,"value":1229},"註：這裡會使用「持久化」一詞是因為儲存資料的方式不止資料庫一種，故用更通稱的方式描述。",{"type":128,"tag":142,"props":1231,"children":1232},{},[1233],{"type":128,"tag":198,"props":1234,"children":1235},{},[1236],{"type":134,"value":1237},"3. 在程式中產生",{"type":128,"tag":142,"props":1239,"children":1240},{},[1241],{"type":134,"value":1242},"在程式中產生 ID 是最常見的方法之一，這種方法好處是可以更容易掌握生產的時機，此外，更可以客製化你的 ID 格式，比如一筆訂單你可以用 order-20190930-c764e787-8182 作為 ID，如此一來，在 debug 時就不用被一堆天文數字般的 ID 搞得昏頭脹腦。所以以個人經驗來說，即使增加了一點複雜度，會最推薦這個方式。",{"type":128,"tag":142,"props":1244,"children":1245},{},[1246],{"type":128,"tag":198,"props":1247,"children":1248},{},[1249],{"type":134,"value":1250},"4. 由另一個 Bounded Context 提供",{"type":128,"tag":142,"props":1252,"children":1253},{},[1254],{"type":134,"value":1255},"最複雜的一種就是來自於另一個 Bounded Context 提供的 ID。這種可能出現在當你需要調用 API 的時候，得到對方的資料後存取下來。這種方式的複雜點在於，你不只要考慮本地端的 Entity，也需要考慮外部 Bounded Context 的改變情況，雖然可以透過訂閱另一個 Bounded Context 的方式做到，但仍舊十分麻煩。",{"type":128,"tag":136,"props":1257,"children":1259},{"id":1258},"五net-core-實作微服務領域模型",[1260],{"type":134,"value":54},{"type":128,"tag":142,"props":1262,"children":1263},{},[1264],{"type":128,"tag":156,"props":1265,"children":1268},{"alt":1266,"src":1267},"Net Demo 01","/blog/images/01/02/008.png",[],{"type":128,"tag":142,"props":1270,"children":1271},{},[1272],{"type":128,"tag":156,"props":1273,"children":1276},{"alt":1274,"src":1275},"Net Demo 02","/blog/images/01/02/009.png",[],{"type":128,"tag":142,"props":1278,"children":1279},{},[1280,1282,1288,1294],{"type":134,"value":1281},"參考 :\n",{"type":128,"tag":727,"props":1283,"children":1286},{"href":1284,"rel":1285},"https://ithelp.ithome.com.tw/articles/10223150",[731],[1287],{"type":134,"value":1284},{"type":128,"tag":727,"props":1289,"children":1292},{"href":1290,"rel":1291},"https://docs.microsoft.com/zh-tw/dotnet/architecture/microservices/microservice-ddd-cqrs-patterns/microservice-domain-model",[731],[1293],{"type":134,"value":1290},{"type":128,"tag":727,"props":1295,"children":1298},{"href":1296,"rel":1297},"https://docs.microsoft.com/zh-tw/dotnet/architecture/microservices/microservice-ddd-cqrs-patterns/ddd-oriented-microservice",[731],[1299],{"type":134,"value":1296},{"title":9,"searchDepth":801,"depth":801,"links":1301},[1302,1303,1304,1305,1306],{"id":840,"depth":804,"text":50},{"id":1053,"depth":804,"text":51},{"id":1137,"depth":804,"text":52},{"id":1176,"depth":804,"text":53},{"id":1258,"depth":804,"text":54},"1.architecture/2.DDD-簡易整理.md",["ShallowRef",1309],{},{"preference":1311,"value":1311,"unknown":823,"forced":123},"system",[1313,1318,1324,1330,1336,1341,1350],{"title":824,"_path":1314,"children":1315,"icon":825},"/code",[1316,1317],{"title":8,"_path":6},{"title":16,"_path":15},{"title":1319,"_path":1320,"children":1321,"icon":825},"Architecture","/architecture",[1322,1323],{"title":34,"_path":32},{"title":48,"_path":47},{"title":1325,"_path":1326,"children":1327,"icon":1329},"Desktop","/desktop",[1328],{"title":60,"_path":58},"🖥️",{"title":1331,"_path":1332,"children":1333,"icon":1335},"Cloud-GCP","/cloud-gcp",[1334],{"title":70,"_path":68},"🛢️",{"title":1337,"_path":1338,"children":1339,"icon":1335},"Database","/database",[1340],{"title":78,"_path":76},{"title":1342,"_path":1343,"children":1344,"icon":1349},"Keycloak","/keycloak",[1345,1346,1347,1348],{"title":87,"_path":85},{"title":94,"_path":93},{"title":102,"_path":101},{"title":108,"_path":85},"🔒",{"title":1351,"_path":1352,"children":1353,"icon":1355},"Iron Man - 雲端之路養成","/ironman-gcp",[1354],{"title":116,"_path":114},"🦸🏻",{"🧑‍💻":-1,"🖥️":-1,"🛢️":-1,"🔒":-1,"🦸🏻":-1,"heroicons-outline:menu":1357,"fa-brands:github":1361,"lucide:chevrons-down-up":1365,"heroicons-outline:search":1367,"heroicons-outline:arrow-sm-left":1369,"heroicons-outline:arrow-sm-right":1371,"heroicons-outline:chevron-right":1373},{"left":1358,"top":1358,"width":1359,"height":1359,"rotate":1358,"vFlip":123,"hFlip":123,"body":1360},0,24,"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 6h16M4 12h16M4 18h16\"/>",{"left":1358,"top":1358,"width":1362,"height":1363,"rotate":1358,"vFlip":123,"hFlip":123,"body":1364},496,512,"\u003Cpath fill=\"currentColor\" d=\"M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9c1.6 2.3 4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2\"/>",{"left":1358,"top":1358,"width":1359,"height":1359,"rotate":1358,"vFlip":123,"hFlip":123,"body":1366},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m7 20l5-5l5 5M7 4l5 5l5-5\"/>",{"left":1358,"top":1358,"width":1359,"height":1359,"rotate":1358,"vFlip":123,"hFlip":123,"body":1368},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m21 21l-6-6m2-5a7 7 0 1 1-14 0a7 7 0 0 1 14 0\"/>",{"left":1358,"top":1358,"width":1359,"height":1359,"rotate":1358,"vFlip":123,"hFlip":123,"body":1370},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m11 17l-5-5m0 0l5-5m-5 5h12\"/>",{"left":1358,"top":1358,"width":1359,"height":1359,"rotate":1358,"vFlip":123,"hFlip":123,"body":1372},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m13 7l5 5m0 0l-5 5m5-5H6\"/>",{"left":1358,"top":1358,"width":1359,"height":1359,"rotate":1358,"vFlip":123,"hFlip":123,"body":1374},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m9 5l7 7l-7 7\"/>",{"parentPath":1320,"scrollTop":1358},{},{},{},{},{},{},{},{},{"search-api":1385},null]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{baseURL:"/blog",plausible:{hashMode:false,trackLocalhost:false,domain:"",apiHost:"https://plausible.io",autoPageviews:true,autoOutboundTracking:false},studio:{apiURL:"https://api.nuxt.studio"},mdc:{components:{prose:true,map:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"}},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}}},content:{locales:[],defaultLocale:"",integrity:1706520296529,experimental:{stripQueryParameters:false,advanceQuery:false,clientDB:false},respectPathCase:false,api:{baseURL:"/api/_content"},navigation:{fields:["icon","titleTemplate","header","main","aside","footer","layout"]},tags:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},highlight:{theme:{dark:"github-dark",default:"github-light"},preload:["json","js","ts","html","css","vue","diff","shell","markdown","yaml","bash","ini"]},wsUrl:"",documentDriven:{page:true,navigation:true,surround:true,globals:{},layoutFallbacks:["theme"],injectPage:true},host:"",trailingSlash:false,contentHead:true,anchorLinks:{depth:4,exclude:[1]}}},app:{baseURL:"/blog",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body>
</html>