<!DOCTYPE html>
<html  lang="en">
<head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>依賴注入(DI) · Spyua Blog</title>
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="twitter:card" content="summary_large_image">
<meta property="og:image" content="https://user-images.githubusercontent.com/904724/185365452-87b7ca7b-6030-4813-a2db-5e65c785bf88.png">
<meta property="og:title" content="依賴注入(DI)">
<meta name="description" content="DI在目前許多軟體架構中是不可或缺的設計架構功能之一，此章節會闡述DI精神及介紹.Net的DI使用。">
<meta property="og:description" content="DI在目前許多軟體架構中是不可或缺的設計架構功能之一，此章節會闡述DI精神及介紹.Net的DI使用。">
<link rel="stylesheet" href="/blog/_nuxt/entry.1b0101cf.css">
<link rel="stylesheet" href="/blog/_nuxt/DocumentDrivenNotFound.7238633c.css">
<link rel="stylesheet" href="/blog/_nuxt/ButtonLink.c4905621.css">
<link rel="stylesheet" href="/blog/_nuxt/DocsPageLayout.2ba2acb9.css">
<link rel="stylesheet" href="/blog/_nuxt/DocsAside.7397caed.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseCodeInline.21ce328c.css">
<link rel="stylesheet" href="/blog/_nuxt/Alert.408d0512.css">
<link rel="stylesheet" href="/blog/_nuxt/DocsPageBottom.9f7ccbf0.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseA.e2976377.css">
<link rel="stylesheet" href="/blog/_nuxt/DocsPrevNext.0d80e373.css">
<link rel="stylesheet" href="/blog/_nuxt/DocsToc.855ff635.css">
<link rel="stylesheet" href="/blog/_nuxt/DocsTocLinks.310b9647.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseP.945916cd.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseH2.df45a763.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseH3.88c2d983.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseImg.018721e2.css">
<link rel="stylesheet" href="/blog/_nuxt/ProsePre.e63e49c6.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseCode.60d59d51.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseBlockquote.87ef1443.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseUl.c9c63ec7.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseLi.ac05b421.css">
<link rel="stylesheet" href="/blog/_nuxt/ProseH4.5b64d6f8.css">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/entry.a772b460.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/document-driven.ac34d019.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/DocumentDrivenEmpty.801fc40f.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ContentRenderer.aed2ed72.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ContentRendererMarkdown.vue.e32f89c0.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/DocumentDrivenNotFound.a5683644.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ButtonLink.f1a8b3dd.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/slot.e1e48d51.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/node.80739779.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/IconDocus.1e448907.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/default.1b85cf07.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/DocsPageLayout.2a05edbb.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/DocsAside.4d7e93a6.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseCodeInline.dda248a1.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/Alert.7f4970d9.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/DocsPageBottom.fac2beee.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseA.1e795e29.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/EditOnLink.vue.60dbcf44.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/DocsPrevNext.f329e89b.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/DocsToc.50b7cb92.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/DocsTocLinks.4cac430f.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ContentRendererMarkdown.fcfe3906.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseP.e282d181.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseH2.cc4da59e.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseH3.8425b940.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseImg.af003540.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProsePre.217ceb13.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseCode.c72ebc30.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseBlockquote.b0c0ac63.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseUl.3476aeee.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseLi.0a863029.js">
<link rel="modulepreload" as="script" crossorigin href="/blog/_nuxt/ProseH4.c673788e.js">
<link rel="prefetch" as="style" href="/blog/_nuxt/page.70291227.css">
<link rel="prefetch" as="script" crossorigin href="/blog/_nuxt/page.ceaf1893.js">
<link rel="prefetch" as="script" crossorigin href="/blog/_nuxt/client-db.c08406d8.js">
<link rel="prefetch" as="style" href="/blog/_nuxt/useStudio.37ff8fdd.css">
<link rel="prefetch" as="script" crossorigin href="/blog/_nuxt/useStudio.633543e7.js">
<link rel="prefetch" as="script" crossorigin href="/blog/_nuxt/debug.17344811.js">
<link rel="prefetch" as="style" href="/blog/_nuxt/error-404.e7689c2d.css">
<link rel="prefetch" as="script" crossorigin href="/blog/_nuxt/error-404.08f87510.js">
<link rel="prefetch" as="style" href="/blog/_nuxt/error-500.92b46a75.css">
<link rel="prefetch" as="script" crossorigin href="/blog/_nuxt/error-500.188bc59b.js">
<script type="module" src="/blog/_nuxt/entry.a772b460.js" crossorigin></script><style id="pinceau-runtime-hydratable">@media{.phy[--]{--puid:7Kf7Wx-v;}.pv-Hi_ikv{padding-left:var(--elements-container-padding-mobile);padding-right:var(--elements-container-padding-mobile);}@media (min-width: 475px){.pv-Hi_ikv{padding-left:var(--elements-container-padding-xs);padding-right:var(--elements-container-padding-xs);}}@media (min-width: 640px){.pv-Hi_ikv{padding-left:var(--elements-container-padding-sm);padding-right:var(--elements-container-padding-sm);}}@media (min-width: 768px){.pv-Hi_ikv{padding-left:var(--elements-container-padding-md);padding-right:var(--elements-container-padding-md);}}} @media{.phy[--]{--puid:hSRg_n-v;}.pv-HMUtSk{max-width:var(--elements-container-maxWidth);padding-left:var(--elements-container-padding-mobile);padding-right:var(--elements-container-padding-mobile);}@media (min-width: 475px){.pv-HMUtSk{padding-left:var(--elements-container-padding-xs);padding-right:var(--elements-container-padding-xs);}}@media (min-width: 640px){.pv-HMUtSk{padding-left:var(--elements-container-padding-sm);padding-right:var(--elements-container-padding-sm);}}@media (min-width: 768px){.pv-HMUtSk{padding-left:var(--elements-container-padding-md);padding-right:var(--elements-container-padding-md);}}} </style><style id="pinceau-theme">@media { :root {--pinceau-mq: initial; --docus-search-results-highlight-color: white;--docus-search-results-window-maxHeight: 100%;--docus-search-results-window-maxWidth: 640px;--docus-search-results-window-marginTop: 0;--docus-search-input-borderStyle: solid;--docus-search-input-borderWidth: 1px;--docus-search-backdropFilter: blur(24px);--docus-loadingBar-gradientColorStop3: #0047e1;--docus-loadingBar-gradientColorStop2: #34cdfe;--docus-loadingBar-gradientColorStop1: #00dc82;--docus-loadingBar-height: 3px;--docus-readableLine: 78ch;--docus-footer-height: 145px;--docus-header-height: 64px;--prose-code-inline-padding: 0.2rem 0.375rem 0.2rem 0.375rem;--prose-code-block-backdropFilter: contrast(1);--prose-code-block-border-style: solid;--prose-code-block-border-width: 1px;--prose-tbody-tr-borderBottom-style: dashed;--prose-tbody-tr-borderBottom-width: 1px;--prose-th-textAlign: inherit;--prose-thead-borderBottom-style: solid;--prose-thead-borderBottom-width: 1px;--prose-thead-border-style: solid;--prose-thead-border-width: 0px;--prose-table-textAlign: start;--prose-hr-width: 1px;--prose-hr-style: solid;--prose-li-listStylePosition: outside;--prose-ol-li-markerColor: currentColor;--prose-ol-paddingInlineStart: 21px;--prose-ol-listStyleType: decimal;--prose-ul-li-markerColor: currentColor;--prose-ul-paddingInlineStart: 21px;--prose-ul-listStyleType: disc;--prose-blockquote-border-style: solid;--prose-blockquote-border-width: 4px;--prose-blockquote-quotes: '201C' '201D' '2018' '2019';--prose-blockquote-paddingInlineStart: 24px;--prose-a-code-color-hover: currentColor;--prose-a-code-color-static: currentColor;--prose-a-hasCode-borderBottom: none;--prose-a-border-distance: 2px;--prose-a-border-color-hover: currentColor;--prose-a-border-color-static: currentColor;--prose-a-border-style-hover: solid;--prose-a-border-style-static: dashed;--prose-a-border-width: 1px;--prose-a-color-static: inherit;--prose-a-textDecoration: none;--prose-h6-margin: 3rem 0 2rem;--prose-h5-margin: 3rem 0 2rem;--prose-h4-margin: 3rem 0 2rem;--prose-h3-margin: 3rem 0 2rem;--prose-h2-margin: 3rem 0 2rem;--prose-h1-margin: 0 0 2rem;--typography-lead-loose: 2;--typography-lead-relaxed: 1.625;--typography-lead-normal: 1.5;--typography-lead-snug: 1.375;--typography-lead-tight: 1.25;--typography-lead-none: 1;--typography-lead-10: 2.5rem;--typography-lead-9: 2.25rem;--typography-lead-8: 2rem;--typography-lead-7: 1.75rem;--typography-lead-6: 1.5rem;--typography-lead-5: 1.25rem;--typography-lead-4: 1rem;--typography-lead-3: .75rem;--typography-lead-2: .5rem;--typography-lead-1: .025rem;--typography-fontWeight-black: 900;--typography-fontWeight-extrabold: 800;--typography-fontWeight-bold: 700;--typography-fontWeight-semibold: 600;--typography-fontWeight-medium: 500;--typography-fontWeight-normal: 400;--typography-fontWeight-light: 300;--typography-fontWeight-extralight: 200;--typography-fontWeight-thin: 100;--typography-fontSize-9xl: 128px;--typography-fontSize-8xl: 96px;--typography-fontSize-7xl: 72px;--typography-fontSize-6xl: 60px;--typography-fontSize-5xl: 48px;--typography-fontSize-4xl: 36px;--typography-fontSize-3xl: 30px;--typography-fontSize-2xl: 24px;--typography-fontSize-xl: 20px;--typography-fontSize-lg: 18px;--typography-fontSize-base: 16px;--typography-fontSize-sm: 14px;--typography-fontSize-xs: 12px;--typography-letterSpacing-wide: 0.025em;--typography-letterSpacing-tight: -0.025em;--typography-verticalMargin-base: 24px;--typography-verticalMargin-sm: 16px;--elements-border-secondary-hover: [object Object];--elements-backdrop-background: #fffc;--elements-backdrop-filter: saturate(200%) blur(20px);--elements-container-maxWidth: 80rem;--lead-loose: 2;--lead-relaxed: 1.625;--lead-normal: 1.5;--lead-snug: 1.375;--lead-tight: 1.25;--lead-none: 1;--lead-10: 2.5rem;--lead-9: 2.25rem;--lead-8: 2rem;--lead-7: 1.75rem;--lead-6: 1.5rem;--lead-5: 1.25rem;--lead-4: 1rem;--lead-3: .75rem;--lead-2: .5rem;--lead-1: .025rem;--letterSpacing-widest: 0.1em;--letterSpacing-wider: 0.05em;--letterSpacing-wide: 0.025em;--letterSpacing-normal: 0em;--letterSpacing-tight: -0.025em;--letterSpacing-tighter: -0.05em;--fontSize-9xl: 8rem;--fontSize-8xl: 6rem;--fontSize-7xl: 4.5rem;--fontSize-6xl: 3.75rem;--fontSize-5xl: 3rem;--fontSize-4xl: 2.25rem;--fontSize-3xl: 1.875rem;--fontSize-2xl: 1.5rem;--fontSize-xl: 1.25rem;--fontSize-lg: 1.125rem;--fontSize-base: 1rem;--fontSize-sm: 0.875rem;--fontSize-xs: 0.75rem;--fontWeight-black: 900;--fontWeight-extrabold: 800;--fontWeight-bold: 700;--fontWeight-semibold: 600;--fontWeight-medium: 500;--fontWeight-normal: 400;--fontWeight-light: 300;--fontWeight-extralight: 200;--fontWeight-thin: 100;--font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace;--font-serif: ui-serif, Georgia, Cambria, Times New Roman, Times, serif;--font-sans: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Arial, Noto Sans, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji;--opacity-total: 1;--opacity-high: 0.8;--opacity-medium: 0.5;--opacity-soft: 0.3;--opacity-light: 0.15;--opacity-bright: 0.1;--opacity-noOpacity: 0;--borderWidth-lg: 3px;--borderWidth-md: 2px;--borderWidth-sm: 1px;--borderWidth-noBorder: 0;--space-rem-875: 0.875rem;--space-rem-625: 0.625rem;--space-rem-375: 0.375rem;--space-rem-125: 0.125rem;--space-px: 1px;--space-128: 32rem;--space-96: 24rem;--space-80: 20rem;--space-72: 18rem;--space-64: 16rem;--space-60: 15rem;--space-56: 14rem;--space-52: 13rem;--space-48: 12rem;--space-44: 11rem;--space-40: 10rem;--space-36: 9rem;--space-32: 8rem;--space-28: 7rem;--space-24: 6rem;--space-20: 5rem;--space-16: 4rem;--space-14: 3.5rem;--space-12: 3rem;--space-11: 2.75rem;--space-10: 2.5rem;--space-9: 2.25rem;--space-8: 2rem;--space-7: 1.75rem;--space-6: 1.5rem;--space-5: 1.25rem;--space-4: 1rem;--space-3: 0.75rem;--space-2: 0.5rem;--space-1: 0.25rem;--space-0: 0px;--size-full: 100%;--size-7xl: 80rem;--size-6xl: 72rem;--size-5xl: 64rem;--size-4xl: 56rem;--size-3xl: 48rem;--size-2xl: 42rem;--size-xl: 36rem;--size-lg: 32rem;--size-md: 28rem;--size-sm: 24rem;--size-xs: 20rem;--size-200: 200px;--size-104: 104px;--size-80: 80px;--size-64: 64px;--size-56: 56px;--size-48: 48px;--size-40: 40px;--size-32: 32px;--size-24: 24px;--size-20: 20px;--size-16: 16px;--size-12: 12px;--size-8: 8px;--size-6: 6px;--size-4: 4px;--size-2: 2px;--size-0: 0px;--radii-full: 9999px;--radii-3xl: 1.75rem;--radii-2xl: 1.5rem;--radii-xl: 1rem;--radii-lg: 0.75rem;--radii-md: 0.5rem;--radii-sm: 0.375rem;--radii-xs: 0.25rem;--radii-2xs: 0.125rem;--radii-none: 0px;--shadow-none: 0px 0px 0px 0px transparent;--height-screen: 100vh;--width-screen: 100vw;--color-primary-900: #001A1F;--color-primary-800: #00232B;--color-primary-700: #024757;--color-primary-600: #09A0C1;--color-primary-500: #1AD6FF;--color-primary-400: #55E1FF;--color-primary-300: #82E3FF;--color-primary-200: #C5F2FF;--color-primary-100: #DCF7FF;--color-primary-50: #F1FCFF;--color-ruby-900: #380011;--color-ruby-800: #700021;--color-ruby-700: #a90032;--color-ruby-600: #e10043;--color-ruby-500: #ff1a5e;--color-ruby-400: #ff4079;--color-ruby-300: #ff6694;--color-ruby-200: #ff8dae;--color-ruby-100: #ffb3c9;--color-ruby-50: #ffd9e4;--color-pink-900: #380025;--color-pink-800: #70004b;--color-pink-700: #a90070;--color-pink-600: #e10095;--color-pink-500: #ff1ab2;--color-pink-400: #ff40bf;--color-pink-300: #ff66cc;--color-pink-200: #ff8dd8;--color-pink-100: #ffb3e5;--color-pink-50: #ffd9f2;--color-purple-900: #190038;--color-purple-800: #330070;--color-purple-700: #4c00a9;--color-purple-600: #6500e1;--color-purple-500: #811aff;--color-purple-400: #9640ff;--color-purple-300: #ab66ff;--color-purple-200: #c08dff;--color-purple-100: #d5b3ff;--color-purple-50: #ead9ff;--color-royalblue-900: #0b0531;--color-royalblue-800: #160a62;--color-royalblue-700: #211093;--color-royalblue-600: #2c15c4;--color-royalblue-500: #4127e8;--color-royalblue-400: #614bec;--color-royalblue-300: #806ff0;--color-royalblue-200: #a093f3;--color-royalblue-100: #c0b7f7;--color-royalblue-50: #dfdbfb;--color-indigoblue-900: #001238;--color-indigoblue-800: #002370;--color-indigoblue-700: #0035a9;--color-indigoblue-600: #0047e1;--color-indigoblue-500: #1a62ff;--color-indigoblue-400: #407cff;--color-indigoblue-300: #6696ff;--color-indigoblue-200: #8db0ff;--color-indigoblue-100: #b3cbff;--color-indigoblue-50: #d9e5ff;--color-blue-900: #00131D;--color-blue-800: #002235;--color-blue-700: #014267;--color-blue-600: #0069A6;--color-blue-500: #1AADFF;--color-blue-400: #64C7FF;--color-blue-300: #A1DDFF;--color-blue-200: #C6EAFF;--color-blue-100: #DFF3FF;--color-blue-50: #F2FAFF;--color-lightblue-900: #002e38;--color-lightblue-800: #005c70;--color-lightblue-700: #008aa9;--color-lightblue-600: #00b9e1;--color-lightblue-500: #1ad6ff;--color-lightblue-400: #40ddff;--color-lightblue-300: #66e4ff;--color-lightblue-200: #8deaff;--color-lightblue-100: #b3f1ff;--color-lightblue-50: #d9f8ff;--color-teal-900: #062a28;--color-teal-800: #0b544f;--color-teal-700: #117d77;--color-teal-600: #16a79e;--color-teal-500: #1cd1c6;--color-teal-400: #36e4da;--color-teal-300: #5fe9e1;--color-teal-200: #87efe9;--color-teal-100: #aff4f0;--color-teal-50: #d7faf8;--color-pear-900: #2a2b09;--color-pear-800: #545512;--color-pear-700: #7e801b;--color-pear-600: #a8aa24;--color-pear-500: #d0d32f;--color-pear-400: #d8da52;--color-pear-300: #e0e274;--color-pear-200: #e8e997;--color-pear-100: #eff0ba;--color-pear-50: #f7f8dc;--color-red-900: #1C0301;--color-red-800: #340A01;--color-red-700: #701704;--color-red-600: #BB2402;--color-red-500: #FF3B10;--color-red-400: #FF7353;--color-red-300: #FFA692;--color-red-200: #FFDED7;--color-red-100: #FFF3F0;--color-red-50: #FFF9F8;--color-orange-900: #381800;--color-orange-800: #702f00;--color-orange-700: #a94700;--color-orange-600: #e15e00;--color-orange-500: #ff7a1a;--color-orange-400: #ff9040;--color-orange-300: #ffa666;--color-orange-200: #ffbd8d;--color-orange-100: #ffd3b3;--color-orange-50: #ffe9d9;--color-yellow-900: #1B1500;--color-yellow-800: #292100;--color-yellow-700: #614E02;--color-yellow-600: #CBA408;--color-yellow-500: #FBCA05;--color-yellow-400: #FFDC4E;--color-yellow-300: #FFE372;--color-yellow-200: #FFF0B1;--color-yellow-100: #FFF6D3;--color-yellow-50: #FFFCEE;--color-green-900: #00190F;--color-green-800: #002817;--color-green-700: #006037;--color-green-600: #00B467;--color-green-500: #0DD885;--color-green-400: #3CEEA5;--color-green-300: #86FBCB;--color-green-200: #C3FFE6;--color-green-100: #DEFFF1;--color-green-50: #ECFFF7;--color-gray-900: #121110;--color-gray-800: #201E1B;--color-gray-700: #36332E;--color-gray-600: #67635D;--color-gray-500: #97948F;--color-gray-400: #ADA9A4;--color-gray-300: #DBD9D3;--color-gray-200: #ECEBE8;--color-gray-100: #F6F5F4;--color-gray-50: #FBFBFB;--color-black: #0B0A0A;--color-white: #ffffff;--media-portrait: only screen and (orientation: portrait);--media-landscape: only screen and (orientation: landscape);--media-rm: (prefers-reduced-motion: reduce);--media-2xl: (min-width: 1536px);--media-xl: (min-width: 1280px);--media-lg: (min-width: 1024px);--media-md: (min-width: 768px);--media-sm: (min-width: 640px);--media-xs: (min-width: 475px);--docus-search-results-highlight-backgroundColor: var(--color-primary-500);--docus-search-results-selected-backgroundColor: var(--color-gray-300);--docus-search-results-window-borderRadius: none;--docus-search-results-window-marginX: 0;--docus-search-input-backgroundColor: var(--color-gray-200);--docus-search-input-padding: var(--space-2) var(--space-4);--docus-search-input-gap: var(--space-2);--docus-search-input-fontSize: var(--fontSize-sm);--docus-search-input-borderColor: var(--color-gray-200);--docus-search-input-borderRadius: var(--radii-2xs);--docus-footer-padding: var(--space-4) 0;--docus-header-title-color-hover: var(--color-primary-500);--docus-header-title-color-static: var(--color-gray-900);--docus-header-title-fontWeight: var(--fontWeight-bold);--docus-header-title-fontSize: var(--fontSize-2xl);--docus-header-logo-height: var(--space-6);--docus-body-fontFamily: var(--font-sans);--docus-body-color: var(--color-gray-800);--docus-body-backgroundColor: var(--color-white);--prose-code-inline-fontWeight: var(--typography-fontWeight-normal);--prose-code-inline-fontSize: var(--typography-fontSize-sm);--prose-code-inline-borderRadius: var(--radii-xs);--prose-code-block-pre-padding: var(--typography-verticalMargin-sm);--prose-code-block-margin: var(--typography-verticalMargin-base) 0;--prose-code-block-fontSize: var(--typography-fontSize-sm);--prose-tbody-code-inline-fontSize: var(--typography-fontSize-sm);--prose-tbody-td-padding: var(--typography-verticalMargin-sm);--prose-th-fontWeight: var(--typography-fontWeight-semibold);--prose-th-padding: 0 var(--typography-verticalMargin-sm) var(--typography-verticalMargin-sm) var(--typography-verticalMargin-sm);--prose-table-lineHeight: var(--typography-lead-6);--prose-table-fontSize: var(--typography-fontSize-sm);--prose-table-margin: var(--typography-verticalMargin-base) 0;--prose-hr-margin: var(--typography-verticalMargin-base) 0;--prose-li-margin: var(--typography-verticalMargin-sm) 0;--prose-ol-margin: var(--typography-verticalMargin-base) 0;--prose-ul-margin: var(--typography-verticalMargin-base) 0;--prose-blockquote-margin: var(--typography-verticalMargin-base) 0;--prose-a-code-border-style: var(--prose-a-border-style-static);--prose-a-code-border-width: var(--prose-a-border-width);--prose-a-fontWeight: var(--typography-fontWeight-medium);--prose-img-margin: var(--typography-verticalMargin-base) 0;--prose-strong-fontWeight: var(--typography-fontWeight-semibold);--prose-h6-iconSize: var(--typography-fontSize-base);--prose-h6-fontWeight: var(--typography-fontWeight-semibold);--prose-h6-lineHeight: var(--typography-lead-normal);--prose-h6-fontSize: var(--typography-fontSize-lg);--prose-h5-iconSize: var(--typography-fontSize-lg);--prose-h5-fontWeight: var(--typography-fontWeight-semibold);--prose-h5-lineHeight: var(--typography-lead-snug);--prose-h5-fontSize: var(--typography-fontSize-xl);--prose-h4-iconSize: var(--typography-fontSize-lg);--prose-h4-letterSpacing: var(--typography-letterSpacing-tight);--prose-h4-fontWeight: var(--typography-fontWeight-semibold);--prose-h4-lineHeight: var(--typography-lead-snug);--prose-h4-fontSize: var(--typography-fontSize-2xl);--prose-h3-iconSize: var(--typography-fontSize-xl);--prose-h3-letterSpacing: var(--typography-letterSpacing-tight);--prose-h3-fontWeight: var(--typography-fontWeight-semibold);--prose-h3-lineHeight: var(--typography-lead-snug);--prose-h3-fontSize: var(--typography-fontSize-3xl);--prose-h2-iconSize: var(--typography-fontSize-2xl);--prose-h2-letterSpacing: var(--typography-letterSpacing-tight);--prose-h2-fontWeight: var(--typography-fontWeight-semibold);--prose-h2-lineHeight: var(--typography-lead-tight);--prose-h2-fontSize: var(--typography-fontSize-4xl);--prose-h1-iconSize: var(--typography-fontSize-3xl);--prose-h1-letterSpacing: var(--typography-letterSpacing-tight);--prose-h1-fontWeight: var(--typography-fontWeight-bold);--prose-h1-lineHeight: var(--typography-lead-tight);--prose-h1-fontSize: var(--typography-fontSize-5xl);--prose-p-br-margin: var(--typography-verticalMargin-base) 0 0 0;--prose-p-margin: var(--typography-verticalMargin-base) 0;--prose-p-lineHeight: var(--typography-lead-normal);--prose-p-fontSize: var(--typography-fontSize-base);--typography-color-secondary-900: var(--color-gray-900);--typography-color-secondary-800: var(--color-gray-800);--typography-color-secondary-700: var(--color-gray-700);--typography-color-secondary-600: var(--color-gray-600);--typography-color-secondary-500: var(--color-gray-500);--typography-color-secondary-400: var(--color-gray-400);--typography-color-secondary-300: var(--color-gray-300);--typography-color-secondary-200: var(--color-gray-200);--typography-color-secondary-100: var(--color-gray-100);--typography-color-secondary-50: var(--color-gray-50);--typography-color-primary-900: var(--color-primary-900);--typography-color-primary-800: var(--color-primary-800);--typography-color-primary-700: var(--color-primary-700);--typography-color-primary-600: var(--color-primary-600);--typography-color-primary-500: var(--color-primary-500);--typography-color-primary-400: var(--color-primary-400);--typography-color-primary-300: var(--color-primary-300);--typography-color-primary-200: var(--color-primary-200);--typography-color-primary-100: var(--color-primary-100);--typography-color-primary-50: var(--color-primary-50);--typography-font-code: var(--font-mono);--typography-font-body: var(--font-sans);--typography-font-display: var(--font-sans);--typography-body-backgroundColor: var(--color-white);--typography-body-color: var(--color-black);--elements-state-danger-borderColor-secondary: var(--color-red-200);--elements-state-danger-borderColor-primary: var(--color-red-100);--elements-state-danger-backgroundColor-secondary: var(--color-red-100);--elements-state-danger-backgroundColor-primary: var(--color-red-50);--elements-state-danger-color-secondary: var(--color-red-600);--elements-state-danger-color-primary: var(--color-red-500);--elements-state-warning-borderColor-secondary: var(--color-yellow-200);--elements-state-warning-borderColor-primary: var(--color-yellow-100);--elements-state-warning-backgroundColor-secondary: var(--color-yellow-100);--elements-state-warning-backgroundColor-primary: var(--color-yellow-50);--elements-state-warning-color-secondary: var(--color-yellow-700);--elements-state-warning-color-primary: var(--color-yellow-600);--elements-state-success-borderColor-secondary: var(--color-green-200);--elements-state-success-borderColor-primary: var(--color-green-100);--elements-state-success-backgroundColor-secondary: var(--color-green-100);--elements-state-success-backgroundColor-primary: var(--color-green-50);--elements-state-success-color-secondary: var(--color-green-600);--elements-state-success-color-primary: var(--color-green-500);--elements-state-info-borderColor-secondary: var(--color-blue-200);--elements-state-info-borderColor-primary: var(--color-blue-100);--elements-state-info-backgroundColor-secondary: var(--color-blue-100);--elements-state-info-backgroundColor-primary: var(--color-blue-50);--elements-state-info-color-secondary: var(--color-blue-600);--elements-state-info-color-primary: var(--color-blue-500);--elements-state-primary-borderColor-secondary: var(--color-primary-200);--elements-state-primary-borderColor-primary: var(--color-primary-100);--elements-state-primary-backgroundColor-secondary: var(--color-primary-100);--elements-state-primary-backgroundColor-primary: var(--color-primary-50);--elements-state-primary-color-secondary: var(--color-primary-700);--elements-state-primary-color-primary: var(--color-primary-600);--elements-surface-secondary-backgroundColor: var(--color-gray-200);--elements-surface-primary-backgroundColor: var(--color-gray-100);--elements-surface-background-base: var(--color-gray-100);--elements-border-secondary-static: var(--color-gray-200);--elements-border-primary-hover: var(--color-gray-200);--elements-border-primary-static: var(--color-gray-100);--elements-container-padding-md: var(--space-6);--elements-container-padding-sm: var(--space-6);--elements-container-padding-xs: var(--space-4);--elements-container-padding-mobile: var(--space-4);--elements-text-secondary-color-hover: var(--color-gray-700);--elements-text-secondary-color-static: var(--color-gray-500);--elements-text-primary-color-static: var(--color-gray-900);--text-6xl-lineHeight: var(--lead-none);--text-6xl-fontSize: var(--fontSize-6xl);--text-5xl-lineHeight: var(--lead-none);--text-5xl-fontSize: var(--fontSize-5xl);--text-4xl-lineHeight: var(--lead-10);--text-4xl-fontSize: var(--fontSize-4xl);--text-3xl-lineHeight: var(--lead-9);--text-3xl-fontSize: var(--fontSize-3xl);--text-2xl-lineHeight: var(--lead-8);--text-2xl-fontSize: var(--fontSize-2xl);--text-xl-lineHeight: var(--lead-7);--text-xl-fontSize: var(--fontSize-xl);--text-lg-lineHeight: var(--lead-7);--text-lg-fontSize: var(--fontSize-lg);--text-base-lineHeight: var(--lead-6);--text-base-fontSize: var(--fontSize-base);--text-sm-lineHeight: var(--lead-5);--text-sm-fontSize: var(--fontSize-sm);--text-xs-lineHeight: var(--lead-4);--text-xs-fontSize: var(--fontSize-xs);--color-shadow: var(--color-gray-400);--color-secondary-900: var(--color-gray-900);--color-secondary-800: var(--color-gray-800);--color-secondary-700: var(--color-gray-700);--color-secondary-600: var(--color-gray-600);--color-secondary-500: var(--color-gray-500);--color-secondary-400: var(--color-gray-400);--color-secondary-300: var(--color-gray-300);--color-secondary-200: var(--color-gray-200);--color-secondary-100: var(--color-gray-100);--color-secondary-50: var(--color-gray-50);--prose-code-inline-backgroundColor: var(--typography-color-secondary-100);--prose-code-inline-color: var(--typography-color-secondary-700);--prose-code-block-backgroundColor: var(--typography-color-secondary-100);--prose-code-block-color: var(--typography-color-secondary-700);--prose-code-block-border-color: var(--typography-color-secondary-200);--prose-tbody-tr-borderBottom-color: var(--typography-color-secondary-200);--prose-th-color: var(--typography-color-secondary-600);--prose-thead-borderBottom-color: var(--typography-color-secondary-200);--prose-thead-border-color: var(--typography-color-secondary-300);--prose-hr-color: var(--typography-color-secondary-200);--prose-blockquote-border-color: var(--typography-color-secondary-200);--prose-blockquote-color: var(--typography-color-secondary-500);--prose-a-code-background-hover: var(--typography-color-primary-50);--prose-a-code-border-color-hover: var(--typography-color-primary-500);--prose-a-code-border-color-static: var(--typography-color-secondary-400);--prose-a-color-hover: var(--typography-color-primary-500);--shadow-2xl: 0px 25px 50px -12px var(--color-shadow);--shadow-xl: 0px 20px 25px -5px var(--color-shadow), 0px 8px 10px -6px var(--color-shadow);--shadow-lg: 0px 10px 15px -3px var(--color-shadow), 0px 4px 6px -4px var(--color-shadow);--shadow-md: 0px 4px 6px -1px var(--color-shadow), 0px 2px 4px -2px var(--color-shadow);--shadow-sm: 0px 1px 3px 0px var(--color-shadow), 0px 1px 2px -1px var(--color-shadow);--shadow-xs: 0px 1px 2px 0px var(--color-shadow); } }@media { :root.dark {--pinceau-mq: dark; --prose-code-block-backdropFilter: contrast(1);--prose-ol-li-markerColor: currentColor;--prose-ul-li-markerColor: currentColor;--prose-a-code-color-hover: currentColor;--prose-a-code-color-static: currentColor;--prose-a-border-color-hover: currentColor;--prose-a-border-color-static: currentColor;--prose-a-color-static: inherit;--elements-backdrop-background: #0c0d0ccc;--docus-search-results-selected-backgroundColor: var(--color-gray-700);--docus-search-input-backgroundColor: var(--color-gray-800);--docus-search-input-borderColor: transparent;--docus-header-title-color-static: var(--color-gray-100);--docus-body-color: var(--color-gray-200);--docus-body-backgroundColor: var(--color-black);--typography-body-backgroundColor: var(--color-black);--typography-body-color: var(--color-white);--elements-state-danger-borderColor-secondary: var(--color-red-700);--elements-state-danger-borderColor-primary: var(--color-red-800);--elements-state-danger-backgroundColor-secondary: var(--color-red-800);--elements-state-danger-backgroundColor-primary: var(--color-red-900);--elements-state-danger-color-secondary: var(--color-red-200);--elements-state-danger-color-primary: var(--color-red-300);--elements-state-warning-borderColor-secondary: var(--color-yellow-700);--elements-state-warning-borderColor-primary: var(--color-yellow-800);--elements-state-warning-backgroundColor-secondary: var(--color-yellow-800);--elements-state-warning-backgroundColor-primary: var(--color-yellow-900);--elements-state-warning-color-secondary: var(--color-yellow-200);--elements-state-warning-color-primary: var(--color-yellow-400);--elements-state-success-borderColor-secondary: var(--color-green-700);--elements-state-success-borderColor-primary: var(--color-green-800);--elements-state-success-backgroundColor-secondary: var(--color-green-800);--elements-state-success-backgroundColor-primary: var(--color-green-900);--elements-state-success-color-secondary: var(--color-green-200);--elements-state-success-color-primary: var(--color-green-400);--elements-state-info-borderColor-secondary: var(--color-blue-700);--elements-state-info-borderColor-primary: var(--color-blue-800);--elements-state-info-backgroundColor-secondary: var(--color-blue-800);--elements-state-info-backgroundColor-primary: var(--color-blue-900);--elements-state-info-color-secondary: var(--color-blue-200);--elements-state-info-color-primary: var(--color-blue-400);--elements-state-primary-borderColor-secondary: var(--color-primary-700);--elements-state-primary-borderColor-primary: var(--color-primary-800);--elements-state-primary-backgroundColor-secondary: var(--color-primary-800);--elements-state-primary-backgroundColor-primary: var(--color-primary-900);--elements-state-primary-color-secondary: var(--color-primary-200);--elements-state-primary-color-primary: var(--color-primary-400);--elements-surface-secondary-backgroundColor: var(--color-gray-800);--elements-surface-primary-backgroundColor: var(--color-gray-900);--elements-surface-background-base: var(--color-gray-900);--elements-border-secondary-static: var(--color-gray-800);--elements-border-primary-hover: var(--color-gray-800);--elements-border-primary-static: var(--color-gray-900);--elements-text-secondary-color-hover: var(--color-gray-200);--elements-text-secondary-color-static: var(--color-gray-400);--elements-text-primary-color-static: var(--color-gray-50);--color-shadow: var(--color-gray-800);--prose-code-inline-backgroundColor: var(--typography-color-secondary-800);--prose-code-inline-color: var(--typography-color-secondary-200);--prose-code-block-backgroundColor: var(--typography-color-secondary-900);--prose-code-block-color: var(--typography-color-secondary-200);--prose-code-block-border-color: var(--typography-color-secondary-800);--prose-tbody-tr-borderBottom-color: var(--typography-color-secondary-800);--prose-th-color: var(--typography-color-secondary-400);--prose-thead-borderBottom-color: var(--typography-color-secondary-800);--prose-thead-border-color: var(--typography-color-secondary-600);--prose-hr-color: var(--typography-color-secondary-800);--prose-blockquote-border-color: var(--typography-color-secondary-700);--prose-blockquote-color: var(--typography-color-secondary-400);--prose-a-code-background-hover: var(--typography-color-primary-900);--prose-a-code-border-color-hover: var(--typography-color-primary-600);--prose-a-code-border-color-static: var(--typography-color-secondary-600);--prose-a-color-hover: var(--typography-color-primary-400); } }@media (min-width: 640px) { :root {--pinceau-mq: sm; --docus-search-results-window-maxHeight: 320px;--docus-search-results-window-marginTop: 20vh;--docus-footer-height: 100px;--docus-search-results-window-borderRadius: var(--radii-xs);--docus-search-results-window-marginX: var(--space-4);--docus-header-logo-height: var(--space-7); } }</style><script>"use strict";(()=>{const a=window,e=document.documentElement,m=["dark","light"],c=window.localStorage.getItem("nuxt-color-mode")||"system";let n=c==="system"?f():c;const l=e.getAttribute("data-color-mode-forced");l&&(n=l),i(n),a["__NUXT_COLOR_MODE__"]={preference:c,value:n,getColorScheme:f,addColorScheme:i,removeColorScheme:d};function i(o){const t=""+o+"",s="theme";e.classList?e.classList.add(t):e.className+=" "+t,s&&e.setAttribute("data-"+s,o)}function d(o){const t=""+o+"",s="theme";e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp(t,"g"),""),s&&e.removeAttribute("data-"+s)}function r(o){return a.matchMedia("(prefers-color-scheme"+o+")")}function f(){if(a.matchMedia&&r("").media!=="not all"){for(const o of m)if(r(":"+o).matches)return o}return"light"}})();
</script></head>
<body ><!----><!--teleport anchor--><!----><!--teleport anchor--><div id="__nuxt"><div class="app-layout" data-v-5c2f7786><div class="nuxt-progress" style="width:0%;opacity:0;background-size:Infinity% auto;" data-v-5c2f7786></div><header class="has-dialog" data-v-5c2f7786 data-v-f465a985><div class="container pv-Hi_ikv pc-7Kf7Wx" data-v-f465a985 data-v-a8d7e2a7><!--[--><div class="section left" data-v-f465a985><!--[--><button aria-label="Menu" data-v-8fd30205><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" role="img" class="icon" data-v-8fd30205 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg></button><!--teleport start--><!--teleport end--><!--]--><a href="/blog/" class="navbar-logo" aria-label="Spyua Blog" data-v-f465a985 data-v-58a8631e><span class="title" data-v-58a8631e>Spyua Blog</span></a></div><div class="section center" data-v-f465a985><a href="/blog/" class="navbar-logo" aria-label="Spyua Blog" data-v-f465a985 data-v-58a8631e><span class="title" data-v-58a8631e>Spyua Blog</span></a><!----></div><div class="section right" data-v-f465a985><!--[--><button type="button" aria-label="Search" data-v-42bfc035><span class="content" data-v-42bfc035><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-42bfc035 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21l-6-6m2-5a7 7 0 1 1-14 0a7 7 0 0 1 14 0"/></svg><span data-v-42bfc035>Search</span><span data-v-42bfc035><kbd data-v-42bfc035>⌘</kbd><kbd data-v-42bfc035>K</kbd></span></span></button><!--teleport start--><!--teleport end--><!--]--><button aria-label="Color Mode" data-v-f465a985 data-v-87324333><span data-v-87324333>...</span></button><div class="social-icons" data-v-f465a985><!--[--><a href="https://github.com/spyua" rel="noopener noreferrer" target="_blank" title="https://github.com/spyua" aria-label="https://github.com/spyua" data-v-22569e45><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-22569e45 style="" width="1em" height="1em" viewBox="0 0 496 512" data-v-e610b8e3><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9c1.6 2.3 4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2"/></svg></a><!--]--></div></div><!--]--></div></header><main data-v-5c2f7786><!--[--><div class="document-driven-page"><div class="container pv-Hi_ikv pc-1ELdSY docs-page-content fluid has-toc has-aside" data-v-73d798d2 data-v-a8d7e2a7><!--[--><aside class="aside-nav" data-v-73d798d2><nav class="app-aside" data-v-73d798d2 data-v-89fb8999><ul class="docs-aside-tree" data-v-89fb8999 data-v-d42239fd><!--[--><li class="" data-v-d42239fd><button class="title-collapsible-button" data-v-d42239fd><span class="content" data-v-d42239fd><span class="icon" style="font-size:1em;line-height:1em;width:1em;height:1em;" data-v-d42239fd data-v-e610b8e3>🧑‍💻</span><span data-v-d42239fd>Codesnese</span></span><span data-v-d42239fd><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-d42239fd style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-d42239fd data-v-d42239fd><!--[--><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/code/refcotr" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>重構筆記</span></span></a><!----></li><li class="has-parent-icon bordered active" data-v-d42239fd><a aria-current="page" href="/blog/code/(di)" class="router-link-active router-link-exact-active link padded active" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>依賴注入(DI)</span></span></a><!----></li><!--]--></ul></li><li class="" data-v-d42239fd><button class="title-collapsible-button" data-v-d42239fd><span class="content" data-v-d42239fd><span class="icon" style="font-size:1em;line-height:1em;width:1em;height:1em;" data-v-d42239fd data-v-e610b8e3>🧑‍💻</span><span data-v-d42239fd>Architecture</span></span><span data-v-d42239fd><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-d42239fd style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-d42239fd data-v-d42239fd><!--[--><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/architecture/ddd-module" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>DDD實戰-Module</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/architecture/ddd" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>DDD實戰-簡易整理</span></span></a><!----></li><!--]--></ul></li><li class="" data-v-d42239fd><button class="title-collapsible-button" data-v-d42239fd><span class="content" data-v-d42239fd><span class="icon" style="font-size:1em;line-height:1em;width:1em;height:1em;" data-v-d42239fd data-v-e610b8e3>🖥️</span><span data-v-d42239fd>Desktop</span></span><span data-v-d42239fd><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-d42239fd style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-d42239fd data-v-d42239fd><!--[--><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/desktop/windowsformxxxx" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>WindowsForm找不到類型xxxx上的建構涵式</span></span></a><!----></li><!--]--></ul></li><li class="" data-v-d42239fd><button class="title-collapsible-button" data-v-d42239fd><span class="content" data-v-d42239fd><span class="icon" style="font-size:1em;line-height:1em;width:1em;height:1em;" data-v-d42239fd data-v-e610b8e3>🛢️</span><span data-v-d42239fd>Cloud-GCP</span></span><span data-v-d42239fd><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-d42239fd style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-d42239fd data-v-d42239fd><!--[--><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/cloud-gcp/gke" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>GKE</span></span></a><!----></li><!--]--></ul></li><li class="" data-v-d42239fd><button class="title-collapsible-button" data-v-d42239fd><span class="content" data-v-d42239fd><span class="icon" style="font-size:1em;line-height:1em;width:1em;height:1em;" data-v-d42239fd data-v-e610b8e3>🛢️</span><span data-v-d42239fd>Database</span></span><span data-v-d42239fd><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-d42239fd style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-d42239fd data-v-d42239fd><!--[--><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/database/mssqlserver" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>MSSQL使用指令測試Server硬碟速度小技巧</span></span></a><!----></li><!--]--></ul></li><li class="" data-v-d42239fd><button class="title-collapsible-button" data-v-d42239fd><span class="content" data-v-d42239fd><span class="icon" style="font-size:1em;line-height:1em;width:1em;height:1em;" data-v-d42239fd data-v-e610b8e3>🔒</span><span data-v-d42239fd>Keycloak</span></span><span data-v-d42239fd><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-d42239fd style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-d42239fd data-v-d42239fd><!--[--><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/keycloak/keycloak" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>身份驗證與授權與Keycloak</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/keycloak/oidcsaml" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>OIDC vs SAML</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/keycloak/sso" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>關於SSO</span></span></a><!----></li><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/keycloak/keycloak-introduce" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>Keycloak Introduce</span></span></a><!----></li><!--]--></ul></li><li class="" data-v-d42239fd><button class="title-collapsible-button" data-v-d42239fd><span class="content" data-v-d42239fd><span class="icon" style="font-size:1em;line-height:1em;width:1em;height:1em;" data-v-d42239fd data-v-e610b8e3>🦸🏻</span><span data-v-d42239fd>Iron Man - 雲端之路養成</span></span><span data-v-d42239fd><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-d42239fd style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-d42239fd data-v-d42239fd><!--[--><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/ironman-gcp/cloud" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>Cloud</span></span></a><!----></li><!--]--></ul></li><li class="" data-v-d42239fd><button class="title-collapsible-button" data-v-d42239fd><span class="content" data-v-d42239fd><span class="icon" style="font-size:1em;line-height:1em;width:1em;height:1em;" data-v-d42239fd data-v-e610b8e3>🦸🏻</span><span data-v-d42239fd>證照考試準備</span></span><span data-v-d42239fd><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon collapsible-icon" data-v-d42239fd style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m7 20l5-5l5 5M7 4l5 5l5-5"/></svg></span></button><ul class="docs-aside-tree recursive" style="" data-v-d42239fd data-v-d42239fd><!--[--><li class="has-parent-icon bordered" data-v-d42239fd><a href="/blog/license/ace" class="link padded" data-v-d42239fd><span class="content" data-v-d42239fd><!----><span data-v-d42239fd>ACE [模擬考題]</span></span></a><!----></li><!--]--></ul></li><!--]--></ul></nav></aside><article class="page-body" data-v-73d798d2><!--[--><!--[--><div><p data-v-9dc9c102><!--[-->DI在目前許多軟體架構中是不可或缺的設計架構功能之一，此章節會闡述DI精神及介紹.Net的DI使用。<!--]--></p><h2 id="a-依賴注入dependency-injection" data-v-70b0c1e2><a aria-current="page" href="/blog/code/(di)#a-依賴注入dependency-injection" class="router-link-active router-link-exact-active" data-v-70b0c1e2><!--[-->A. 依賴注入(Dependency Injection)<!--]--><!----></a></h2><p data-v-9dc9c102><!--[-->先來講依賴跟注入的概念<!--]--></p><h3 id="a-dependency" data-v-4cf5bb93><a aria-current="page" href="/blog/code/(di)#a-dependency" class="router-link-active router-link-exact-active" data-v-4cf5bb93><!--[-->a. Dependency<!--]--><!----></a></h3><p data-v-9dc9c102><!--[-->依賴如字面上所述，在軟體中，我們很常遇到物件彼此相依的狀況。如下圖，在做計算時需做Printer輸出資訊，因此Calculator物件會相依Printer物件，則在Instance Calculator物件時則就需要同步Instance Printer物件並帶入Calculator物件中。<!--]--></p><p data-v-9dc9c102><!--[--><img src="/blog/images/00/02/001.png" alt="Object Reference" data-v-2ef15301><!--]--></p><div class="highlight-csharp prose-code" meta data-v-c164ce0a><!----><!--[--><pre class="language-csharp github-light_github-dark"><!--[--><code><span class="line" line="1"><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-149352">class</span><span class="ct-553616"> </span><span class="ct-762058">Calculator
</span></span><span class="line" line="2"><span class="ct-553616">{
</span></span><span class="line" line="3"><span class="ct-553616">    </span><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-762058">Printer</span><span class="ct-553616"> </span><span class="ct-762058">Printer</span><span class="ct-553616"> {</span><span class="ct-149352">get</span><span class="ct-553616">;</span><span class="ct-149352">private</span><span class="ct-553616"> </span><span class="ct-149352">set</span><span class="ct-553616">}
</span></span><span class="line" line="4"><span class="ct-553616">    </span><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-762058">Add</span><span class="ct-553616">(</span><span class="ct-149352">int</span><span class="ct-553616"> </span><span class="ct-762058">a</span><span class="ct-553616">, </span><span class="ct-149352">int</span><span class="ct-553616"> </span><span class="ct-762058">b</span><span class="ct-553616">){
</span></span><span class="line" line="5"><span class="ct-553616">        </span><span class="ct-149352">var</span><span class="ct-553616"> </span><span class="ct-762058">sum</span><span class="ct-553616"> </span><span class="ct-149352">=</span><span class="ct-553616"> a</span><span class="ct-149352">+</span><span class="ct-553616">b;
</span></span><span class="line" line="6"><span class="ct-553616">        Printer.</span><span class="ct-762058">ConsoleOut</span><span class="ct-553616">(sum);
</span></span><span class="line" line="7"><span class="ct-553616">    }
</span></span><span class="line" line="8"><span class="ct-553616">    </span><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-762058">Calculator</span><span class="ct-553616">(</span><span class="ct-762058">Printer</span><span class="ct-553616"> </span><span class="ct-762058">printer</span><span class="ct-553616">){
</span></span><span class="line" line="9"><span class="ct-553616">        Printer </span><span class="ct-149352">=</span><span class="ct-553616"> printer;
</span></span><span class="line" line="10"><span class="ct-553616">    }
</span></span><span class="line" line="11"><span class="ct-553616">}
</span></span><span class="line" line="12"><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-149352">class</span><span class="ct-553616"> </span><span class="ct-762058">Printer
</span></span><span class="line" line="13"><span class="ct-553616">{
</span></span><span class="line" line="14"><span class="ct-553616">    </span><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-149352">void</span><span class="ct-553616"> </span><span class="ct-762058">ConsoleOut</span><span class="ct-553616">(</span><span class="ct-149352">string</span><span class="ct-553616"> </span><span class="ct-762058">txt</span><span class="ct-553616">) 
</span></span><span class="line" line="15"><span class="ct-553616">    {
</span></span><span class="line" line="16"><span class="ct-553616">        Console.</span><span class="ct-762058">WriteLine</span><span class="ct-553616">(txt);
</span></span><span class="line" line="17"><span class="ct-553616">    }
</span></span><span class="line" line="18"><span class="ct-553616">}
</span></span><span class="line" line="19"><span class="ct-149352">static</span><span class="ct-553616"> </span><span class="ct-149352">class</span><span class="ct-553616"> </span><span class="ct-762058">Program
</span></span><span class="line" line="20"><span class="ct-553616">{
</span></span><span class="line" line="21"><span class="ct-553616">    </span><span class="ct-149352">static</span><span class="ct-553616"> </span><span class="ct-149352">void</span><span class="ct-553616"> </span><span class="ct-762058">Main</span><span class="ct-553616">()
</span></span><span class="line" line="22"><span class="ct-553616">    {
</span></span><span class="line" line="23"><span class="ct-553616">        </span><span class="ct-149352">var</span><span class="ct-553616"> </span><span class="ct-762058">printer</span><span class="ct-553616"> </span><span class="ct-149352">=</span><span class="ct-553616"> </span><span class="ct-149352">new</span><span class="ct-553616"> </span><span class="ct-762058">Printer</span><span class="ct-553616">();
</span></span><span class="line" line="24"><span class="ct-553616">        </span><span class="ct-149352">var</span><span class="ct-553616"> </span><span class="ct-762058">calculator</span><span class="ct-553616"> </span><span class="ct-149352">=</span><span class="ct-553616"> </span><span class="ct-149352">new</span><span class="ct-553616"> </span><span class="ct-762058">Calculator</span><span class="ct-553616">(printer);
</span></span><span class="line" line="25"><span class="ct-553616">        calculator.</span><span class="ct-762058">Add</span><span class="ct-553616">(</span><span class="ct-617022">1</span><span class="ct-149352">+</span><span class="ct-617022">1</span><span class="ct-553616">); 
</span></span><span class="line" line="26"><span class="ct-553616">    }
</span></span><span class="line" line="27"><span class="ct-553616">}</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-c164ce0a data-v-4a003820><span class="sr-only" data-v-4a003820>Copy to clipboard</span><span class="icon-wrapper" data-v-4a003820><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-4a003820 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-e610b8e3><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-9dc9c102><!--[-->這例子為Calculator依賴Printer，所以控制權不是在Printer身上。什麼意思? 簡單來說當Printer有異動時，會有一定程度是影響到Calculator的。<!--]--></p><p data-v-9dc9c102><!--[-->對於物件依賴這件事情我在網上看到一個例子描述還蠻貼切的，今天有一名8+9在吸食毒品如下。8+9 以為自己吸食毒品只是滿足自己的快感，他還以為他自己的意志行為是被自己所掌控<!--]--></p><p data-v-9dc9c102><!--[-->錯!!!<!--]--></p><p data-v-9dc9c102><!--[-->其實8+9這時候所有的行為已經被毒品所控制，再也離不開毒品了。<!--]--></p><p data-v-9dc9c102><!--[--><img src="/blog/images/00/02/002.png" alt="8+9" data-v-2ef15301><!--]--></p><h3 id="b-dependency-with-interface" data-v-4cf5bb93><a aria-current="page" href="/blog/code/(di)#b-dependency-with-interface" class="router-link-active router-link-exact-active" data-v-4cf5bb93><!--[-->b. Dependency With Interface<!--]--><!----></a></h3><p data-v-9dc9c102><!--[-->那我們該如何解除依賴關係? 一般來說，在實作方法時，我們會讓物件去相依介面，讓物件彼此因介面而解偶，如下圖<!--]--></p><p data-v-9dc9c102><!--[--><img src="/blog/images/00/02/003.png" alt="Dependency With Interface" data-v-2ef15301><!--]--></p><div class="highlight-csharp prose-code" meta data-v-c164ce0a><!----><!--[--><pre class="language-csharp github-light_github-dark"><!--[--><code><span class="line" line="1"><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-149352">class</span><span class="ct-553616"> </span><span class="ct-762058">Calculator
</span></span><span class="line" line="2"><span class="ct-553616">{
</span></span><span class="line" line="3"><span class="ct-553616">    </span><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-762058">IPrinter</span><span class="ct-553616"> </span><span class="ct-762058">Printer</span><span class="ct-553616"> {</span><span class="ct-149352">get</span><span class="ct-553616">;</span><span class="ct-149352">private</span><span class="ct-553616"> </span><span class="ct-149352">set</span><span class="ct-553616">}
</span></span><span class="line" line="4"><span class="ct-553616">    </span><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-762058">Add</span><span class="ct-553616">(</span><span class="ct-149352">int</span><span class="ct-553616"> </span><span class="ct-762058">a</span><span class="ct-553616">, </span><span class="ct-149352">int</span><span class="ct-553616"> </span><span class="ct-762058">b</span><span class="ct-553616">){
</span></span><span class="line" line="5"><span class="ct-553616">        </span><span class="ct-149352">var</span><span class="ct-553616"> </span><span class="ct-762058">sum</span><span class="ct-553616"> </span><span class="ct-149352">=</span><span class="ct-553616"> a</span><span class="ct-149352">+</span><span class="ct-553616">b;
</span></span><span class="line" line="6"><span class="ct-553616">        Printer.</span><span class="ct-762058">ConsoleOut</span><span class="ct-553616">(sum);
</span></span><span class="line" line="7"><span class="ct-553616">    }
</span></span><span class="line" line="8"><span class="ct-553616">    </span><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-762058">Calculator</span><span class="ct-553616">(</span><span class="ct-762058">IPrinter</span><span class="ct-553616"> </span><span class="ct-762058">printer</span><span class="ct-553616">){
</span></span><span class="line" line="9"><span class="ct-553616">        Printer </span><span class="ct-149352">=</span><span class="ct-553616"> printer;
</span></span><span class="line" line="10"><span class="ct-553616">    }
</span></span><span class="line" line="11"><span class="ct-553616">}
</span></span><span class="line" line="12"><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-149352">class</span><span class="ct-553616"> </span><span class="ct-762058">Printer</span><span class="ct-553616">:</span><span class="ct-762058">IPrinter
</span></span><span class="line" line="13"><span class="ct-553616">{
</span></span><span class="line" line="14"><span class="ct-553616">    </span><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-149352">void</span><span class="ct-553616"> </span><span class="ct-762058">ConsoleOut</span><span class="ct-553616">(</span><span class="ct-149352">string</span><span class="ct-553616"> </span><span class="ct-762058">txt</span><span class="ct-553616">) 
</span></span><span class="line" line="15"><span class="ct-553616">    {
</span></span><span class="line" line="16"><span class="ct-553616">        Console.</span><span class="ct-762058">WriteLine</span><span class="ct-553616">(txt);
</span></span><span class="line" line="17"><span class="ct-553616">    }
</span></span><span class="line" line="18"><span class="ct-553616">}
</span></span><span class="line" line="19"><span></span></span><span class="line" line="20"><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-149352">interface</span><span class="ct-553616"> </span><span class="ct-762058">IPrinter</span><span class="ct-553616">{
</span></span><span class="line" line="21"><span class="ct-553616">    </span><span class="ct-149352">void</span><span class="ct-553616"> </span><span class="ct-762058">ConsoleOut</span><span class="ct-553616">(</span><span class="ct-149352">string</span><span class="ct-553616"> </span><span class="ct-762058">txt</span><span class="ct-553616">);
</span></span><span class="line" line="22"><span class="ct-553616">}
</span></span><span class="line" line="23"><span></span></span><span class="line" line="24"><span class="ct-149352">static</span><span class="ct-553616"> </span><span class="ct-149352">class</span><span class="ct-553616"> </span><span class="ct-762058">Program
</span></span><span class="line" line="25"><span class="ct-553616">{
</span></span><span class="line" line="26"><span class="ct-553616">    </span><span class="ct-149352">static</span><span class="ct-553616"> </span><span class="ct-149352">void</span><span class="ct-553616"> </span><span class="ct-762058">Main</span><span class="ct-553616">()
</span></span><span class="line" line="27"><span class="ct-553616">    {
</span></span><span class="line" line="28"><span class="ct-553616">        </span><span class="ct-762058">IPrinter</span><span class="ct-553616"> </span><span class="ct-762058">printer</span><span class="ct-553616"> </span><span class="ct-149352">=</span><span class="ct-553616"> </span><span class="ct-149352">new</span><span class="ct-553616"> </span><span class="ct-762058">Printer</span><span class="ct-553616">();
</span></span><span class="line" line="29"><span class="ct-553616">        </span><span class="ct-149352">var</span><span class="ct-553616"> </span><span class="ct-762058">calculator</span><span class="ct-553616"> </span><span class="ct-149352">=</span><span class="ct-553616"> </span><span class="ct-149352">new</span><span class="ct-553616"> </span><span class="ct-762058">Calculator</span><span class="ct-553616">(printer);
</span></span><span class="line" line="30"><span class="ct-553616">        calculator.</span><span class="ct-762058">Add</span><span class="ct-553616">(</span><span class="ct-617022">1</span><span class="ct-149352">+</span><span class="ct-617022">1</span><span class="ct-553616">); 
</span></span><span class="line" line="31"><span class="ct-553616">    }
</span></span><span class="line" line="32"><span class="ct-553616">}</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-c164ce0a data-v-4a003820><span class="sr-only" data-v-4a003820>Copy to clipboard</span><span class="icon-wrapper" data-v-4a003820><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-4a003820 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-e610b8e3><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-9dc9c102><!--[-->因相依介面，若我們要抽換功能，例如原本的Console輸出改成輸出至記事本。只需要在新增一個記事本輸出方法，替換掉原本的28行的printer即可。而這狀況我們稱為Dependency Inversion Principle(DIP)，依賴倒轉原則。簡單來說就是解除高階模組和低階模組的依賴關係。<!--]--></p><blockquote data-v-96397147><!--[--><p data-v-9dc9c102><!--[-->高低階模組定義<!--]--></p><!--]--></blockquote><blockquote data-v-96397147><!--[--><p data-v-9dc9c102><!--[-->高階模組指的是呼叫者(Caller)-Calculator<!--]--></p><!--]--></blockquote><blockquote data-v-96397147><!--[--><p data-v-9dc9c102><!--[-->低階模組就是被呼叫者(Callee)-Printer<!--]--></p><!--]--></blockquote><p data-v-9dc9c102><!--[-->我們再回到8+9例子，今天想要讓8+9改過向上，戒毒成為奮發向上的好青年。因為現在8+9直接依賴著毒品，我們讓8+9改成依賴藥品這個介面。<!--]--></p><p data-v-9dc9c102><!--[--><img src="/blog/images/00/02/004.png" alt="Dependency With Interface 8+9" data-v-2ef15301><!--]--></p><p data-v-9dc9c102><!--[-->現在我們成功讓8+9依賴藥品而不是毒品。然後再將做一個健康食品的類別實作藥品，然後偷偷把毒品換成健康食品。這樣子8+9以為自己吃的藥品是毒品，實際上卻是每天吃健康食品，於是8+9頭腦變好了 走路也不晃了 考試也考100分成為國家的棟樑。<!--]--></p><h3 id="c-injection" data-v-4cf5bb93><a aria-current="page" href="/blog/code/(di)#c-injection" class="router-link-active router-link-exact-active" data-v-4cf5bb93><!--[-->c. Injection<!--]--><!----></a></h3><p data-v-9dc9c102><!--[-->接著講注入，上述Calculator例子注入方式稱為建構子注入，其實注入平常我們就有在使用。一般人比較不會注意到這些行為其實就是一種注入。常見的注入模式有三種<!--]--></p><ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->建構子注入(Constructor Injection)<!--]--></li><li data-v-4c2f5fb9><!--[-->屬性注入(Property Injection)<!--]--></li><li data-v-4c2f5fb9><!--[-->方法注入(Method Injection)<!--]--></li><!--]--></ul><h4 id="建構子注入constructor-injection" data-v-57e8d291><a aria-current="page" href="/blog/code/(di)#建構子注入constructor-injection" class="router-link-active router-link-exact-active" data-v-57e8d291><!--[-->建構子注入(Constructor Injection)<!--]--><!----></a></h4><div class="highlight-java prose-code" meta data-v-c164ce0a><!----><!--[--><pre class="language-java github-light_github-dark"><!--[--><code><span class="line" line="1"><span class="ct-086898">// 汽車的抽象介面
</span></span><span class="line" line="2"><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-149352">interface</span><span class="ct-553616"> </span><span class="ct-762058">ICar</span><span class="ct-553616"> {
</span></span><span class="line" line="3"><span class="ct-553616">    </span><span class="ct-086898">// 行駛汽車
</span></span><span class="line" line="4"><span class="ct-553616">    </span><span class="ct-149352">void</span><span class="ct-553616"> </span><span class="ct-762058">run</span><span class="ct-553616">();
</span></span><span class="line" line="5"><span class="ct-553616">}
</span></span><span class="line" line="6"><span></span></span><span class="line" line="7"><span class="ct-086898">// 司機的抽象介面
</span></span><span class="line" line="8"><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-149352">interface</span><span class="ct-553616"> </span><span class="ct-762058">IDriver</span><span class="ct-553616"> {
</span></span><span class="line" line="9"><span class="ct-553616">    </span><span class="ct-086898">// 司機駕駛汽車
</span></span><span class="line" line="10"><span class="ct-553616">    </span><span class="ct-149352">void</span><span class="ct-553616"> </span><span class="ct-762058">drive</span><span class="ct-553616">();
</span></span><span class="line" line="11"><span class="ct-553616">}
</span></span><span class="line" line="12"><span></span></span><span class="line" line="13"><span class="ct-086898">// 實作司機的抽象類別
</span></span><span class="line" line="14"><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-149352">class</span><span class="ct-553616"> </span><span class="ct-762058">Driver</span><span class="ct-553616"> </span><span class="ct-149352">implements</span><span class="ct-553616"> </span><span class="ct-762058">IDriver</span><span class="ct-553616"> {
</span></span><span class="line" line="15"><span class="ct-553616">    </span><span class="ct-149352">private</span><span class="ct-553616"> ICar car;
</span></span><span class="line" line="16"><span class="ct-553616">    </span><span class="ct-086898">// 建構子方式注入抽象類別
</span></span><span class="line" line="17"><span class="ct-553616">    </span><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-762058">Driver</span><span class="ct-553616">(ICar </span><span class="ct-157101">car</span><span class="ct-553616">){
</span></span><span class="line" line="18"><span class="ct-553616">        </span><span class="ct-617022">this</span><span class="ct-553616">.car </span><span class="ct-149352">=</span><span class="ct-553616"> car;
</span></span><span class="line" line="19"><span class="ct-553616">    }    
</span></span><span class="line" line="20"><span class="ct-553616">    @</span><span class="ct-149352">Override
</span></span><span class="line" line="21"><span class="ct-553616">    </span><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-149352">void</span><span class="ct-553616"> </span><span class="ct-762058">drive</span><span class="ct-553616">() {
</span></span><span class="line" line="22"><span class="ct-553616">        car.</span><span class="ct-762058">run</span><span class="ct-553616">();
</span></span><span class="line" line="23"><span class="ct-553616">    }
</span></span><span class="line" line="24"><span class="ct-553616">}</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-c164ce0a data-v-4a003820><span class="sr-only" data-v-4a003820>Copy to clipboard</span><span class="icon-wrapper" data-v-4a003820><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-4a003820 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-e610b8e3><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><h4 id="屬性注入property-injection" data-v-57e8d291><a aria-current="page" href="/blog/code/(di)#屬性注入property-injection" class="router-link-active router-link-exact-active" data-v-57e8d291><!--[-->屬性注入(Property Injection)<!--]--><!----></a></h4><div class="highlight-java prose-code" meta data-v-c164ce0a><!----><!--[--><pre class="language-java github-light_github-dark"><!--[--><code><span class="line" line="1"><span class="ct-086898">// 汽車的抽象介面
</span></span><span class="line" line="2"><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-149352">interface</span><span class="ct-553616"> </span><span class="ct-762058">ICar</span><span class="ct-553616"> {
</span></span><span class="line" line="3"><span class="ct-553616">    </span><span class="ct-086898">// 行駛汽車
</span></span><span class="line" line="4"><span class="ct-553616">    </span><span class="ct-149352">void</span><span class="ct-553616"> </span><span class="ct-762058">run</span><span class="ct-553616">();
</span></span><span class="line" line="5"><span class="ct-553616">}
</span></span><span class="line" line="6"><span></span></span><span class="line" line="7"><span class="ct-086898">// 司機的抽象介面
</span></span><span class="line" line="8"><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-149352">interface</span><span class="ct-553616"> </span><span class="ct-762058">IDriver</span><span class="ct-553616"> {
</span></span><span class="line" line="9"><span class="ct-553616">    </span><span class="ct-086898">// 司機駕駛汽車
</span></span><span class="line" line="10"><span class="ct-553616">    </span><span class="ct-149352">void</span><span class="ct-553616"> </span><span class="ct-762058">drive</span><span class="ct-553616">();
</span></span><span class="line" line="11"><span class="ct-553616">}
</span></span><span class="line" line="12"><span></span></span><span class="line" line="13"><span class="ct-086898">// 實作司機的抽象類別
</span></span><span class="line" line="14"><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-149352">class</span><span class="ct-553616"> </span><span class="ct-762058">Driver</span><span class="ct-553616"> </span><span class="ct-149352">implements</span><span class="ct-553616"> </span><span class="ct-762058">IDriver</span><span class="ct-553616"> {
</span></span><span class="line" line="15"><span class="ct-553616">    </span><span class="ct-149352">private</span><span class="ct-553616"> ICar car;
</span></span><span class="line" line="16"><span class="ct-553616">    </span><span class="ct-086898">// 使用setter來傳遞物件 (c# get set)
</span></span><span class="line" line="17"><span class="ct-553616">    </span><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-762058">setCar</span><span class="ct-553616">(ICar </span><span class="ct-157101">car</span><span class="ct-553616">){
</span></span><span class="line" line="18"><span class="ct-553616">        </span><span class="ct-617022">this</span><span class="ct-553616">.car </span><span class="ct-149352">=</span><span class="ct-553616"> car;
</span></span><span class="line" line="19"><span class="ct-553616">    }
</span></span><span class="line" line="20"><span class="ct-553616">      
</span></span><span class="line" line="21"><span class="ct-553616">    @</span><span class="ct-149352">Override
</span></span><span class="line" line="22"><span class="ct-553616">    </span><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-149352">void</span><span class="ct-553616"> </span><span class="ct-762058">drive</span><span class="ct-553616">() {
</span></span><span class="line" line="23"><span class="ct-553616">        car.</span><span class="ct-762058">run</span><span class="ct-553616">();
</span></span><span class="line" line="24"><span class="ct-553616">    }
</span></span><span class="line" line="25"><span class="ct-553616">}</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-c164ce0a data-v-4a003820><span class="sr-only" data-v-4a003820>Copy to clipboard</span><span class="icon-wrapper" data-v-4a003820><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-4a003820 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-e610b8e3><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><h4 id="方法注入property-injection" data-v-57e8d291><a aria-current="page" href="/blog/code/(di)#方法注入property-injection" class="router-link-active router-link-exact-active" data-v-57e8d291><!--[-->方法注入(Property Injection)<!--]--><!----></a></h4><div class="highlight-java prose-code" meta data-v-c164ce0a><!----><!--[--><pre class="language-java github-light_github-dark"><!--[--><code><span class="line" line="1"><span class="ct-086898">// 汽車的抽象介面
</span></span><span class="line" line="2"><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-149352">interface</span><span class="ct-553616"> </span><span class="ct-762058">ICar</span><span class="ct-553616"> {
</span></span><span class="line" line="3"><span class="ct-553616">    </span><span class="ct-086898">// 行駛汽車
</span></span><span class="line" line="4"><span class="ct-553616">    </span><span class="ct-149352">void</span><span class="ct-553616"> </span><span class="ct-762058">run</span><span class="ct-553616">();
</span></span><span class="line" line="5"><span class="ct-553616">}
</span></span><span class="line" line="6"><span class="ct-553616"> 
</span></span><span class="line" line="7"><span class="ct-086898">// 司機的抽象介面
</span></span><span class="line" line="8"><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-149352">interface</span><span class="ct-553616"> </span><span class="ct-762058">IDriver</span><span class="ct-553616"> {
</span></span><span class="line" line="9"><span class="ct-553616">    </span><span class="ct-086898">// 司機駕駛汽車
</span></span><span class="line" line="10"><span class="ct-553616">    </span><span class="ct-149352">void</span><span class="ct-553616"> </span><span class="ct-762058">drive</span><span class="ct-553616">(ICar </span><span class="ct-157101">car</span><span class="ct-553616">);
</span></span><span class="line" line="11"><span class="ct-553616">}
</span></span><span class="line" line="12"><span></span></span><span class="line" line="13"><span></span></span><span class="line" line="14"><span class="ct-086898">// 實作司機的抽象類別
</span></span><span class="line" line="15"><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-149352">class</span><span class="ct-553616"> </span><span class="ct-762058">Driver</span><span class="ct-553616"> </span><span class="ct-149352">implements</span><span class="ct-553616"> </span><span class="ct-762058">IDriver</span><span class="ct-553616"> {
</span></span><span class="line" line="16"><span class="ct-553616">     </span><span class="ct-086898">// 使用介面來傳遞物件
</span></span><span class="line" line="17"><span class="ct-553616">    @</span><span class="ct-149352">Override
</span></span><span class="line" line="18"><span class="ct-553616">    </span><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-149352">void</span><span class="ct-553616"> </span><span class="ct-762058">drive</span><span class="ct-553616">(ICar </span><span class="ct-157101">car</span><span class="ct-553616">) {
</span></span><span class="line" line="19"><span class="ct-553616">        car.</span><span class="ct-762058">run</span><span class="ct-553616">();
</span></span><span class="line" line="20"><span class="ct-553616">    }
</span></span><span class="line" line="21"><span class="ct-553616">}</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-c164ce0a data-v-4a003820><span class="sr-only" data-v-4a003820>Copy to clipboard</span><span class="icon-wrapper" data-v-4a003820><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-4a003820 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-e610b8e3><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><blockquote data-v-96397147><!--[--><p data-v-9dc9c102><!--[-->在了解Dependency與Injection後，應該就可以理解相依注入動作就在於在Instance物件後放置對應的相應物件中<!--]--></p><!--]--></blockquote><h2 id="b-容器概念" data-v-70b0c1e2><a aria-current="page" href="/blog/code/(di)#b-容器概念" class="router-link-active router-link-exact-active" data-v-70b0c1e2><!--[-->B. 容器概念<!--]--><!----></a></h2><p data-v-9dc9c102><!--[-->上述DI概念講完後，接著我們要述說容器的概念。A章節提到關於相依的問題，雖然我們可以透過介面去作解偶。但一般在大型專案物件複雜度及數量一定會是更複雜的狀態。因此有了容器的機制設計產生。<!--]--></p><p data-v-9dc9c102><!--[-->容器的概念在於把物件全都收到一個盒子中，當要使用物件時再去盒子拿資料。有點像是打高爾夫球人員要打高爾夫時都會準備一個球袋把要用的球桿放進球袋中，並帶一個球僮陪伴在旁。當要使用哪一支高爾夫球桿時直接告訴球童即可。<!--]--></p><h3 id="a-窮人與有錢人的依賴注入方式" data-v-4cf5bb93><a aria-current="page" href="/blog/code/(di)#a-窮人與有錢人的依賴注入方式" class="router-link-active router-link-exact-active" data-v-4cf5bb93><!--[-->a. 窮人與有錢人的依賴注入方式<!--]--><!----></a></h3><p data-v-9dc9c102><!--[-->上述講解完後，相信目前對相依注入及容器有一定的概念。而注入部分一般分成窮人注入與有錢人注入。<!--]--></p><ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->我們一般稱為Poor DI(Dependency Injection)，由使用者手動創建以new物件的方式，各自注入，除了麻煩外而且會有傳遞注入等等的問題。<!--]--></li><li data-v-4c2f5fb9><!--[-->有錢人的注入方式，我們一般都會使用DI容器來完成，由框架或類別庫撰寫的容器，提供物件給予使用者使用，猶如上述所講的球童跟高爾夫球員關係一樣。使用者只需要在撰寫程式前設定好物件後，就不需要在手動注入。<!--]--></li><!--]--></ul><h2 id="c-iocinversion-of-control控制反轉" data-v-70b0c1e2><a aria-current="page" href="/blog/code/(di)#c-iocinversion-of-control控制反轉" class="router-link-active router-link-exact-active" data-v-70b0c1e2><!--[-->C. Ioc(Inversion of Control)控制反轉<!--]--><!----></a></h2><p data-v-9dc9c102><!--[-->窮人跟有錢人，我們當然選擇當有錢人!(使用DI容器)。若我們使用DI容器去管理我們物件時，此時我們即可達到控制反轉的設計。<!--]--></p><p data-v-9dc9c102><!--[-->簡單來說A物件程式內部需要使用B物件，程序需自行在A物件去new B物件。由程序主動去控制，有了容器，這一切交給容器去控制(新增物件流程)即可。<!--]--></p><p data-v-9dc9c102><!--[-->如果說DIP 是解偶物件之間的依賴，IOC 就是對物件依賴流程控制的反轉。以常見的web框架而言，將監聽http 請求，解析請求等，包裝進框架，一般使用者並不用主動去處理解析請求，處理http請求的流程，由主動處理轉交給了框架，因此，所以框架其實也是一種IoC的設計。<!--]--></p><blockquote data-v-96397147><!--[--><p data-v-9dc9c102><!--[-->你可以將IOC是一種設計模式，將流程控制重定向到外部處理程序或控制器來提供控制結果，而不是透過控制項(大多情境就是程序)來直接得到結果<!--]--></p><!--]--></blockquote><h2 id="d-c-di-框架-範例請點我" data-v-70b0c1e2><a aria-current="page" href="/blog/code/(di)#d-c-di-框架-範例請點我" class="router-link-active router-link-exact-active" data-v-70b0c1e2><!--[-->D. C# DI 框架 <a href="https://github.com/spyua/DIWindowsFormSample.git" rel="nofollow" data-v-692834dd><!--[-->[範例請點我]<!--]--></a><!--]--><!----></a></h2><p data-v-9dc9c102><!--[-->上述聊完後，相信對於DI、容器、DIP與IOC有一定認知。接著就需要進入實作部分。在.NET中最常見的DI有兩套如下<!--]--></p><ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->Microsoft.Extensions.DependencyInjection<!--]--></li><li data-v-4c2f5fb9><!--[-->Autofac<!--]--></li><!--]--></ul><p data-v-9dc9c102><!--[-->上述提到注入三種方式(建構子、屬性與方法)，Autofac都有提供，而ASP.NET DI的目前只有建構子注入方式。網上大多是Web範例，在此使用這兩套DI工具使用在DeskTop Windows From。<!--]--></p><h3 id="microsoftextensionsdependencyinjection" data-v-4cf5bb93><a aria-current="page" href="/blog/code/(di)#microsoftextensionsdependencyinjection" class="router-link-active router-link-exact-active" data-v-4cf5bb93><!--[-->Microsoft.Extensions.DependencyInjection<!--]--><!----></a></h3><p data-v-9dc9c102><!--[-->範例DI設定在DIServiceConfigure.cs<!--]--></p><h4 id="注入服務生命週期型態" data-v-57e8d291><a aria-current="page" href="/blog/code/(di)#注入服務生命週期型態" class="router-link-active router-link-exact-active" data-v-57e8d291><!--[-->注入服務生命週期型態<!--]--><!----></a></h4><p data-v-9dc9c102><!--[-->服務生命週期指：透過 DI 取得某個元件時，是每次要求得建立一顆新物件，還是從頭到尾共用一個 Instance (執行個體-物件)。<!--]--></p><ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->1.AddSingleton (單一性)<!--]--></li><li data-v-4c2f5fb9><!--[-->2.AddTransient (暫時性)<!--]--></li><li data-v-4c2f5fb9><!--[-->3.AddScoped (範圍性)<!--]--></li><!--]--></ul><h4 id="_1-addsingleton-單一性" data-v-57e8d291><a aria-current="page" href="/blog/code/(di)#_1-addsingleton-單一性" class="router-link-active router-link-exact-active" data-v-57e8d291><!--[-->1. AddSingleton (單一性)<!--]--><!----></a></h4><p data-v-9dc9c102><!--[-->整個程序只建立一個 Instance，任何時候都共用它。簡單來說就是程序中不同流程使用此物件時，他都為同一份物件，有點像是Static，差在於使用DI可做物件設計及抽換。<!--]--></p><p data-v-9dc9c102><!--[-->下圖為Asp.Net DI生命週期圖示，物件相依關係由左至右。<!--]--></p><p data-v-9dc9c102><!--[--><img src="/blog/images/00/02/006.png" alt="Singleton" data-v-2ef15301><!--]--></p><p data-v-9dc9c102><!--[-->而在範例模擬中設計，物件對應可視為<!--]--></p><ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->Rqeuest : Button_Singleton_Click 按下<!--]--></li><li data-v-4c2f5fb9><!--[-->第一個圈 : Call LogController<!--]--></li><li data-v-4c2f5fb9><!--[-->第二個圈 : Call LogController2<!--]--></li><li data-v-4c2f5fb9><!--[-->Instance : SingletonLogRepository<!--]--></li><!--]--></ul><p data-v-9dc9c102><!--[-->Repository注入部分我們使用AddSingleton，而物件在Instance時，我們會建置Guid去觀察他是否為同一個物件。<!--]--></p><div class="highlight-csharp prose-code" meta data-v-c164ce0a><!----><!--[--><pre class="language-csharp github-light_github-dark"><!--[--><code><span class="line" line="1"><span class="ct-553616">  </span><span class="ct-086898">// 系統單一物件定義使用，或沒有異部與大量Request問題，可直接用Singleton
</span></span><span class="line" line="2"><span class="ct-553616">collection.</span><span class="ct-762058">AddSingleton</span><span class="ct-553616">&lt;</span><span class="ct-762058">ISingletonLogRepository</span><span class="ct-553616">, </span><span class="ct-762058">LogRepository</span><span class="ct-553616">&gt;();</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-c164ce0a data-v-4a003820><span class="sr-only" data-v-4a003820>Copy to clipboard</span><span class="icon-wrapper" data-v-4a003820><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-4a003820 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-e610b8e3><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-9dc9c102><!--[-->當我們按下Button_Singleton_Click時，會去呼叫LogController及LogController2裡的SingletonLogRepository物件。並印出Guid。<!--]--></p><div class="highlight-csharp prose-code" meta data-v-c164ce0a><!----><!--[--><pre class="language-csharp github-light_github-dark"><!--[--><code><span class="line" line="1"><span class="ct-149352">private</span><span class="ct-553616"> </span><span class="ct-149352">void</span><span class="ct-553616"> </span><span class="ct-762058">Button_Singleton_Click</span><span class="ct-553616">(</span><span class="ct-149352">object</span><span class="ct-553616"> </span><span class="ct-762058">sender</span><span class="ct-553616">, </span><span class="ct-762058">EventArgs</span><span class="ct-553616"> </span><span class="ct-762058">e</span><span class="ct-553616">)
</span></span><span class="line" line="2"><span class="ct-553616">{
</span></span><span class="line" line="3"><span class="ct-553616">    </span><span class="ct-086898">//var provider = DIServiceConfigure.GetProvider();
</span></span><span class="line" line="4"><span class="ct-553616">    </span><span class="ct-086898">//var logController = provider.GetRequiredService&lt;ILogController&gt;();
</span></span><span class="line" line="5"><span class="ct-553616">    </span><span class="ct-149352">var</span><span class="ct-553616"> </span><span class="ct-762058">log</span><span class="ct-553616"> </span><span class="ct-149352">=</span><span class="ct-553616"> </span><span class="ct-952708">&quot;Log1(Singleton):&quot;</span><span class="ct-149352">+</span><span class="ct-952708">&quot;UUID-&quot;</span><span class="ct-149352">+</span><span class="ct-553616">LogController.</span><span class="ct-762058">OperationId</span><span class="ct-553616">(</span><span class="ct-952708">&quot;Singleton&quot;</span><span class="ct-553616">);
</span></span><span class="line" line="6"><span class="ct-553616">    </span><span class="ct-149352">var</span><span class="ct-553616"> </span><span class="ct-762058">log2</span><span class="ct-553616"> </span><span class="ct-149352">=</span><span class="ct-553616"> </span><span class="ct-952708">&quot;Log2(Singleton):&quot;</span><span class="ct-553616"> </span><span class="ct-149352">+</span><span class="ct-553616"> </span><span class="ct-952708">&quot;UUID-&quot;</span><span class="ct-553616"> </span><span class="ct-149352">+</span><span class="ct-553616"> LogController2.</span><span class="ct-762058">OperationId</span><span class="ct-553616">(</span><span class="ct-952708">&quot;Singleton&quot;</span><span class="ct-553616">);
</span></span><span class="line" line="7"><span class="ct-553616">    richTextBox_Info.</span><span class="ct-762058">AppendText</span><span class="ct-553616">(log</span><span class="ct-149352">+</span><span class="ct-952708">&quot;</span><span class="ct-617022">\n</span><span class="ct-952708">&quot;</span><span class="ct-553616">);
</span></span><span class="line" line="8"><span class="ct-553616">    richTextBox_Info.</span><span class="ct-762058">AppendText</span><span class="ct-553616">(log2 </span><span class="ct-149352">+</span><span class="ct-553616"> </span><span class="ct-952708">&quot;</span><span class="ct-617022">\n</span><span class="ct-952708">&quot;</span><span class="ct-553616">);
</span></span><span class="line" line="9"><span class="ct-553616">    richTextBox_Info.</span><span class="ct-762058">AppendText</span><span class="ct-553616">(LogController.</span><span class="ct-762058">QueryLogCount</span><span class="ct-553616">());
</span></span><span class="line" line="10"><span class="ct-553616">}</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-c164ce0a data-v-4a003820><span class="sr-only" data-v-4a003820>Copy to clipboard</span><span class="icon-wrapper" data-v-4a003820><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-4a003820 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-e610b8e3><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-9dc9c102><!--[-->此時我們可以看到兩個印出來的UUID會完全相同。代表在SingletonLogRepository在Controller與Controller2中為同一個物件。<!--]--></p><p data-v-9dc9c102><!--[--><img src="/blog/images/00/02/007.png" alt="Singleton Result" data-v-2ef15301><!--]--></p><h4 id="_2-addtransient-暫時性" data-v-57e8d291><a aria-current="page" href="/blog/code/(di)#_2-addtransient-暫時性" class="router-link-active router-link-exact-active" data-v-57e8d291><!--[-->2. AddTransient (暫時性)<!--]--><!----></a></h4><p data-v-9dc9c102><!--[-->定義上為程序中每次要求物件(包含物件要其他相依物件)時就建立一個新的，永不共用。<!--]--></p><p data-v-9dc9c102><!--[-->下圖為 Asp.Net DI生命週期圖示，物件相依關係由左至右。<!--]--></p><p data-v-9dc9c102><!--[--><img src="/blog/images/00/02/008.png" alt="Transient" data-v-2ef15301><!--]--></p><p data-v-9dc9c102><!--[-->而在範例模擬中設計，物件對應可視為<!--]--></p><ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->Rqeuest : Button_Transient_Click 按下<!--]--></li><li data-v-4c2f5fb9><!--[-->第一個圈 : Call LogController<!--]--></li><li data-v-4c2f5fb9><!--[-->第二個圈 : Call LogController2<!--]--></li><li data-v-4c2f5fb9><!--[-->Instance : TransientLogRepository<!--]--></li><!--]--></ul><p data-v-9dc9c102><!--[-->Repository注入部分我們使用AddTransient，而物件在Instance時，我們會建置Guid去觀察他是否為同一個物件。<!--]--></p><div class="highlight-csharp prose-code" meta data-v-c164ce0a><!----><!--[--><pre class="language-csharp github-light_github-dark"><!--[--><code><span class="line" line="1"><span class="ct-086898">// 異步，且須大量Request的建議使用Transient (WundowsForm簡易Sample較難模擬)
</span></span><span class="line" line="2"><span class="ct-553616">collection.</span><span class="ct-762058">AddTransient</span><span class="ct-553616">&lt;</span><span class="ct-762058">ITransientLogRepository</span><span class="ct-553616">, </span><span class="ct-762058">LogRepository</span><span class="ct-553616">&gt;();</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-c164ce0a data-v-4a003820><span class="sr-only" data-v-4a003820>Copy to clipboard</span><span class="icon-wrapper" data-v-4a003820><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-4a003820 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-e610b8e3><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-9dc9c102><!--[-->當我們按下Button_Transient_Click時，會去呼叫LogController及LogController2裡的SingletonLogRepository物件。並印出Guid。<!--]--></p><div class="highlight-csharp prose-code" meta data-v-c164ce0a><!----><!--[--><pre class="language-csharp github-light_github-dark"><!--[--><code><span class="line" line="1"><span class="ct-149352">private</span><span class="ct-553616"> </span><span class="ct-149352">void</span><span class="ct-553616"> </span><span class="ct-762058">Button_Transient_Click</span><span class="ct-553616">(</span><span class="ct-149352">object</span><span class="ct-553616"> </span><span class="ct-762058">sender</span><span class="ct-553616">, </span><span class="ct-762058">EventArgs</span><span class="ct-553616"> </span><span class="ct-762058">e</span><span class="ct-553616">)
</span></span><span class="line" line="2"><span class="ct-553616">{
</span></span><span class="line" line="3"><span class="ct-553616">   </span><span class="ct-086898">// 模擬多次Request
</span></span><span class="line" line="4"><span class="ct-553616">   </span><span class="ct-086898">//var provider = DIServiceConfigure.GetProvider();
</span></span><span class="line" line="5"><span class="ct-553616">   </span><span class="ct-086898">//var logController = provider.GetRequiredService&lt;LogController&gt;();
</span></span><span class="line" line="6"><span class="ct-553616">   </span><span class="ct-086898">//var log = &quot;Log1(Transient):&quot; + &quot;UUID-&quot; + logController.GUID.ToString();
</span></span><span class="line" line="7"><span class="ct-553616">   </span><span class="ct-086898">//richTextBox_Info.AppendText(log + &quot;\n&quot;);
</span></span><span class="line" line="8"><span></span></span><span class="line" line="9"><span class="ct-553616">       </span><span class="ct-086898">// 單次Request
</span></span><span class="line" line="10"><span class="ct-553616">   </span><span class="ct-149352">var</span><span class="ct-553616"> </span><span class="ct-762058">log</span><span class="ct-553616"> </span><span class="ct-149352">=</span><span class="ct-553616"> </span><span class="ct-952708">&quot;Log1(Transient):&quot;</span><span class="ct-553616"> </span><span class="ct-149352">+</span><span class="ct-553616"> </span><span class="ct-952708">&quot;UUID-&quot;</span><span class="ct-553616"> </span><span class="ct-149352">+</span><span class="ct-553616"> LogController.</span><span class="ct-762058">OperationId</span><span class="ct-553616">(</span><span class="ct-952708">&quot;Transient&quot;</span><span class="ct-553616">);
</span></span><span class="line" line="11"><span class="ct-553616">   </span><span class="ct-149352">var</span><span class="ct-553616"> </span><span class="ct-762058">log2</span><span class="ct-553616"> </span><span class="ct-149352">=</span><span class="ct-553616"> </span><span class="ct-952708">&quot;Log2(Transient):&quot;</span><span class="ct-553616"> </span><span class="ct-149352">+</span><span class="ct-553616"> </span><span class="ct-952708">&quot;UUID-&quot;</span><span class="ct-553616"> </span><span class="ct-149352">+</span><span class="ct-553616"> LogController2.</span><span class="ct-762058">OperationId</span><span class="ct-553616">(</span><span class="ct-952708">&quot;Transient&quot;</span><span class="ct-553616">);
</span></span><span class="line" line="12"><span class="ct-553616">   richTextBox_Info.</span><span class="ct-762058">AppendText</span><span class="ct-553616">(log </span><span class="ct-149352">+</span><span class="ct-553616"> </span><span class="ct-952708">&quot;</span><span class="ct-617022">\n</span><span class="ct-952708">&quot;</span><span class="ct-553616">);
</span></span><span class="line" line="13"><span class="ct-553616">   richTextBox_Info.</span><span class="ct-762058">AppendText</span><span class="ct-553616">(log2 </span><span class="ct-149352">+</span><span class="ct-553616"> </span><span class="ct-952708">&quot;</span><span class="ct-617022">\n</span><span class="ct-952708">&quot;</span><span class="ct-553616">);
</span></span><span class="line" line="14"><span></span></span><span class="line" line="15"><span class="ct-553616">   </span><span class="ct-086898">//richTextBox_Info.AppendText(LogController.QueryLogCount());
</span></span><span class="line" line="16"><span class="ct-553616">}</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-c164ce0a data-v-4a003820><span class="sr-only" data-v-4a003820>Copy to clipboard</span><span class="icon-wrapper" data-v-4a003820><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-4a003820 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-e610b8e3><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-9dc9c102><!--[-->此時我們可以看到兩個印出來的UUID會不相同。代表在TransientLogRepository在Controller與Controller2中為不同物件。<!--]--></p><p data-v-9dc9c102><!--[--><img src="/blog/images/00/02/009.png" alt="Transient Result" data-v-2ef15301><!--]--></p><p data-v-9dc9c102><!--[-->上述模擬範例其實只模擬一個Request1的狀況。根據定義，程序中每次要求元件時就建立一個新的物件，對此我們已再按多次Button來做模擬。要模擬這狀況，就需要再跟Container拿取Controller物件，在範例中Controller與Controller2都是注入AddTransient，我們將模擬多次Request區塊註解打開，並註解單次Request程式碼<!--]--></p><div class="highlight-csharp prose-code" meta data-v-c164ce0a><!----><!--[--><pre class="language-csharp github-light_github-dark"><!--[--><code><span class="line" line="1"><span class="ct-149352">private</span><span class="ct-553616"> </span><span class="ct-149352">void</span><span class="ct-553616"> </span><span class="ct-762058">Button_Transient_Click</span><span class="ct-553616">(</span><span class="ct-149352">object</span><span class="ct-553616"> </span><span class="ct-762058">sender</span><span class="ct-553616">, </span><span class="ct-762058">EventArgs</span><span class="ct-553616"> </span><span class="ct-762058">e</span><span class="ct-553616">)
</span></span><span class="line" line="2"><span class="ct-553616">{
</span></span><span class="line" line="3"><span class="ct-553616">    </span><span class="ct-086898">// 模擬多次Request
</span></span><span class="line" line="4"><span class="ct-553616">    </span><span class="ct-149352">var</span><span class="ct-553616"> </span><span class="ct-762058">provider</span><span class="ct-553616"> </span><span class="ct-149352">=</span><span class="ct-553616"> DIServiceConfigure.</span><span class="ct-762058">GetProvider</span><span class="ct-553616">();
</span></span><span class="line" line="5"><span class="ct-553616">    </span><span class="ct-149352">var</span><span class="ct-553616"> </span><span class="ct-762058">logController</span><span class="ct-553616"> </span><span class="ct-149352">=</span><span class="ct-553616"> provider.</span><span class="ct-762058">GetRequiredService</span><span class="ct-553616">&lt;</span><span class="ct-762058">LogController</span><span class="ct-553616">&gt;();
</span></span><span class="line" line="6"><span class="ct-553616">    </span><span class="ct-149352">var</span><span class="ct-553616"> </span><span class="ct-762058">log</span><span class="ct-553616"> </span><span class="ct-149352">=</span><span class="ct-553616"> </span><span class="ct-952708">&quot;Log1(Transient):&quot;</span><span class="ct-553616"> </span><span class="ct-149352">+</span><span class="ct-553616"> </span><span class="ct-952708">&quot;UUID-&quot;</span><span class="ct-553616"> </span><span class="ct-149352">+</span><span class="ct-553616"> logController.GUID.</span><span class="ct-762058">ToString</span><span class="ct-553616">();
</span></span><span class="line" line="7"><span class="ct-553616">    richTextBox_Info.</span><span class="ct-762058">AppendText</span><span class="ct-553616">(log </span><span class="ct-149352">+</span><span class="ct-553616"> </span><span class="ct-952708">&quot;</span><span class="ct-617022">\n</span><span class="ct-952708">&quot;</span><span class="ct-553616">);
</span></span><span class="line" line="8"><span></span></span><span class="line" line="9"><span class="ct-553616">    </span><span class="ct-086898">// 模擬單次Request
</span></span><span class="line" line="10"><span class="ct-553616">    </span><span class="ct-086898">//var log = &quot;Log1(Transient):&quot; + &quot;UUID-&quot; + LogController.OperationId(&quot;Transient&quot;);
</span></span><span class="line" line="11"><span class="ct-553616">    </span><span class="ct-086898">//var log2 = &quot;Log2(Transient):&quot; + &quot;UUID-&quot; + LogController2.OperationId(&quot;Transient&quot;);
</span></span><span class="line" line="12"><span class="ct-553616">    </span><span class="ct-086898">//richTextBox_Info.AppendText(log + &quot;\n&quot;);
</span></span><span class="line" line="13"><span class="ct-553616">    </span><span class="ct-086898">//richTextBox_Info.AppendText(log2 + &quot;\n&quot;);
</span></span><span class="line" line="14"><span></span></span><span class="line" line="15"><span class="ct-553616">    </span><span class="ct-086898">//richTextBox_Info.AppendText(LogController.QueryLogCount());
</span></span><span class="line" line="16"><span class="ct-553616">}</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-c164ce0a data-v-4a003820><span class="sr-only" data-v-4a003820>Copy to clipboard</span><span class="icon-wrapper" data-v-4a003820><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-4a003820 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-e610b8e3><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-9dc9c102><!--[-->此時我們可以看到每次的UUID就會不相同，代表在Controller在每次跟Container拿取時都為不同物件。相對的，注入其他物件時也是同一個狀況。<!--]--></p><p data-v-9dc9c102><!--[--><img src="/blog/images/00/02/010.png" alt="Transient Result 2" data-v-2ef15301><!--]--></p><h4 id="_3-addscope-範圍性" data-v-57e8d291><a aria-current="page" href="/blog/code/(di)#_3-addscope-範圍性" class="router-link-active router-link-exact-active" data-v-57e8d291><!--[-->3. AddScope  (範圍性)<!--]--><!----></a></h4><p data-v-9dc9c102><!--[-->Scope我覺得是最難了解的，直接看 Asp.Net DI生命週期圖示，物件相依一樣關係由左至右。如圖所示，程序中要求物件(包含物件要其他相依物件)時，這個Flow處理過程中用到的物件則為同一個物件。而第二次再次要物件時，則會跟第一次的物件是不一樣的物件。<!--]--></p><p data-v-9dc9c102><!--[--><img src="/blog/images/00/02/011.png" alt="Scope" data-v-2ef15301><!--]--></p><p data-v-9dc9c102><!--[-->我們已Call Dialog方式去模擬多次Request，程式碼這邊不多做解釋，結果與物件對照如下圖，觀察Instance部分物件分別為<!--]--></p><ul data-v-5bd61aad><!--[--><li data-v-4c2f5fb9><!--[-->SingletonLogRepository<!--]--></li><li data-v-4c2f5fb9><!--[-->TransientLogRepository<!--]--></li><li data-v-4c2f5fb9><!--[-->ScopedLogRepository<!--]--></li><!--]--></ul><p data-v-9dc9c102><!--[-->可以看到ScopedLogRepository，在同一次的Request Flow，LogController與LogService的LogRepository UUID為一樣的，但在第二次打開Dialog時，則UUID會與第一次的不同。這點會跟Singleton有很大的不同。<!--]--></p><p data-v-9dc9c102><!--[-->在此我們也可以看到Transaction則是在每個物件中，及每次Request都為不同UUID。<!--]--></p><p data-v-9dc9c102><!--[--><img src="/blog/images/00/02/012.png" alt="Scope Result" data-v-2ef15301><!--]--></p><p data-v-9dc9c102><!--[-->其實Scoped跟Transaction之間有時候蠻容易混淆的。對我來說比較好懂得在於Scoped在跟Container要物件時，若前一個物件還未dispose(生命週期還未結束)，則都是同一個物件。物件結束生命週期後在新的Request後才會在新增新的物件。而Transaction就無生命週期概念，在每一次要求物件時，都會New一個新的給他，有點像平常我們想用物件就New Instance的概念。<!--]--></p><h4 id="生命週期小結論" data-v-57e8d291><a aria-current="page" href="/blog/code/(di)#生命週期小結論" class="router-link-active router-link-exact-active" data-v-57e8d291><!--[-->生命週期小結論<!--]--><!----></a></h4><p data-v-9dc9c102><!--[-->上述描述完後，沒意外應該會對注入的生命週期會有所了解。而在Web的世界中，這三種注入方式會很常被使用到。在每一次Http Request情境，Request具有連線即結束，在這狀況下的連線相關物件基本上就會使用Scoped，因此在Web情境，大多數物件都會使用Scoped注入。<!--]--></p><p data-v-9dc9c102><!--[-->但WindowsForm App下，其實我們最常使用的會是Singleton居多，其次是Transaction，Scoped狀況就比較少，因為WindowsForm一開始畫面就那些就載入到 memory中，除非我們將畫面dispose掉，然後再重新開啟畫面，此時就會建議使用Scoped注入。<!--]--></p><p data-v-9dc9c102><!--[-->Transaction使用場景比較會偏向用後就直接dispose，不過這種應用場景，我們很常直接手動去new物件.實際架構應用上目前我也沒太多經驗。<!--]--></p><h4 id="注入抽換" data-v-57e8d291><a aria-current="page" href="/blog/code/(di)#注入抽換" class="router-link-active router-link-exact-active" data-v-57e8d291><!--[-->注入抽換<!--]--><!----></a></h4><p data-v-9dc9c102><!--[-->生命週期講完後，接著就是闡述關於抽換實體物件。範例中我們使用IPrinter注入抽換PrinterMethodA與PrinterMethodB。<!--]--></p><p data-v-9dc9c102><!--[-->在一開始我們IPrinter注入為PrinterMethodA，在按下button_Printer_Click按鈕時，Console則會印出MethodA Print:Prionter Out<!--]--></p><p data-v-9dc9c102><!--[--><img src="/blog/images/00/02/013.png" alt="抽換" data-v-2ef15301><!--]--></p><p data-v-9dc9c102><!--[-->此時我們將PrinterMethodA改成PrinterMethodB<!--]--></p><div class="highlight-csharp prose-code" meta data-v-c164ce0a><!----><!--[--><pre class="language-csharp github-light_github-dark"><!--[--><code><span class="line" line="1"><span class="ct-553616">collection.</span><span class="ct-762058">AddTransient</span><span class="ct-553616">&lt;</span><span class="ct-762058">IPrinter</span><span class="ct-553616">, </span><span class="ct-762058">PrinterMethodB</span><span class="ct-553616">&gt;();</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-c164ce0a data-v-4a003820><span class="sr-only" data-v-4a003820>Copy to clipboard</span><span class="icon-wrapper" data-v-4a003820><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-4a003820 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-e610b8e3><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-9dc9c102><!--[-->此時在按下button_Printer_Click按鈕時，Console則會印出MethodB Print:Prionter Out<!--]--></p><p data-v-9dc9c102><!--[--><img src="/blog/images/00/02/014.png" alt="抽換2" data-v-2ef15301><!--]--></p><p data-v-9dc9c102><!--[-->另外我們也可以注入IPrinter List，只要注入多Concreate實體<!--]--></p><div class="highlight-csharp prose-code" meta data-v-c164ce0a><!----><!--[--><pre class="language-csharp github-light_github-dark"><!--[--><code><span class="line" line="1"><span class="ct-553616">collection.</span><span class="ct-762058">AddTransient</span><span class="ct-553616">&lt;</span><span class="ct-762058">IPrinter</span><span class="ct-553616">, </span><span class="ct-762058">PrinterMethodA</span><span class="ct-553616">&gt;();
</span></span><span class="line" line="2"><span class="ct-553616">collection.</span><span class="ct-762058">AddTransient</span><span class="ct-553616">&lt;</span><span class="ct-762058">IPrinter</span><span class="ct-553616">, </span><span class="ct-762058">PrinterMethodB</span><span class="ct-553616">&gt;();</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-c164ce0a data-v-4a003820><span class="sr-only" data-v-4a003820>Copy to clipboard</span><span class="icon-wrapper" data-v-4a003820><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-4a003820 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-e610b8e3><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-9dc9c102><!--[-->就可注入多PrinterMethod方法<!--]--></p><div class="highlight-csharp prose-code" meta data-v-c164ce0a><!----><!--[--><pre class="language-csharp github-light_github-dark"><!--[--><code><span class="line" line="1"><span class="ct-149352">private</span><span class="ct-553616"> </span><span class="ct-762058">LogController</span><span class="ct-553616"> </span><span class="ct-762058">LogController</span><span class="ct-553616">;
</span></span><span class="line" line="2"><span class="ct-149352">private</span><span class="ct-553616"> </span><span class="ct-762058">LogController2</span><span class="ct-553616"> </span><span class="ct-762058">LogController2</span><span class="ct-553616">;
</span></span><span class="line" line="3"><span></span></span><span class="line" line="4"><span class="ct-086898">// 多重注入
</span></span><span class="line" line="5"><span class="ct-149352">private</span><span class="ct-553616"> </span><span class="ct-762058">IEnumerable</span><span class="ct-553616">&lt;</span><span class="ct-762058">IPrinter</span><span class="ct-553616">&gt; </span><span class="ct-762058">Printer</span><span class="ct-553616">;
</span></span><span class="line" line="6"><span></span></span><span class="line" line="7"><span class="ct-149352">public</span><span class="ct-553616"> </span><span class="ct-762058">Form1</span><span class="ct-553616">(</span><span class="ct-762058">IEnumerable</span><span class="ct-553616">&lt;</span><span class="ct-762058">IPrinter</span><span class="ct-553616">&gt; </span><span class="ct-762058">printer</span><span class="ct-553616">,
</span></span><span class="line" line="8"><span class="ct-553616">             </span><span class="ct-762058">LogController</span><span class="ct-553616"> </span><span class="ct-762058">logController</span><span class="ct-553616">, 
</span></span><span class="line" line="9"><span class="ct-553616">             </span><span class="ct-762058">LogController2</span><span class="ct-553616"> </span><span class="ct-762058">logController2</span><span class="ct-553616">)
</span></span><span class="line" line="10"><span class="ct-553616">{
</span></span><span class="line" line="11"><span class="ct-553616">    </span><span class="ct-762058">InitializeComponent</span><span class="ct-553616">();
</span></span><span class="line" line="12"><span class="ct-553616">    LogController </span><span class="ct-149352">=</span><span class="ct-553616"> logController;
</span></span><span class="line" line="13"><span class="ct-553616">    LogController2 </span><span class="ct-149352">=</span><span class="ct-553616"> logController2;
</span></span><span class="line" line="14"><span class="ct-553616">    </span><span class="ct-086898">// 多重注入
</span></span><span class="line" line="15"><span class="ct-553616">    Printer </span><span class="ct-149352">=</span><span class="ct-553616"> printer;
</span></span><span class="line" line="16"><span class="ct-553616">}</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-c164ce0a data-v-4a003820><span class="sr-only" data-v-4a003820>Copy to clipboard</span><span class="icon-wrapper" data-v-4a003820><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-4a003820 style="" width="18px" height="18px" viewBox="0 0 256 256" data-v-e610b8e3><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"/></svg></span></button></div><p data-v-9dc9c102><!--[--><img src="/blog/images/00/02/015.png" alt="抽換3" data-v-2ef15301><!--]--></p><p data-v-9dc9c102><!--[-->我們只須改Container設定，主程式都不用更動，即可抽換程式中所有物件用到IPrinter的地方。<!--]--></p><h3 id="autofac" data-v-4cf5bb93><a aria-current="page" href="/blog/code/(di)#autofac" class="router-link-active router-link-exact-active" data-v-4cf5bb93><!--[-->AutoFac<!--]--><!----></a></h3><p data-v-9dc9c102><!--[-->範例DI設定在AutofacConfig.cs<!--]--></p><p data-v-9dc9c102><!--[-->AutoFac與 ASP.NET DI 注入生命週期概念其實大同小異，下圖為對應表<a href="https://devblogs.microsoft.com/cesardelatorre/comparing-asp-net-core-ioc-service-life-times-and-autofac-ioc-instance-scopes/" rel="nofollow" data-v-692834dd><!--[-->出處<!--]--></a><!--]--></p><p data-v-9dc9c102><!--[--><img src="/blog/images/00/02/016.png" alt="Autofac" data-v-2ef15301><!--]--></p><p data-v-9dc9c102><!--[-->根據對應表，在範例程式要換成Autofac範例，只需將Bootstrapper與Form.cs裡Button_Scoped_Click的Net DI程式碼註解掉，並解開Autofac註解相關程式碼。即可觀察注入物件生命週期的不同。<!--]--></p><style>.github-light_github-dark{color:#24292e;background:#fff;}.dark .github-light_github-dark{color:#e1e4e8;background:#24292e;}.ct-149352{color:#D73A49;}.dark .ct-149352{color:#F97583;}.ct-553616{color:#24292E;}.dark .ct-553616{color:#E1E4E8;}.ct-762058{color:#6F42C1;}.dark .ct-762058{color:#B392F0;}.ct-617022{color:#005CC5;}.dark .ct-617022{color:#79B8FF;}.ct-086898{color:#6A737D;}.ct-157101{color:#E36209;}.dark .ct-157101{color:#FFAB70;}.ct-952708{color:#032F62;}.dark .ct-952708{color:#9ECBFF;}</style></div><!--]--><!--]--><!--[--><div class="docs-page-bottom" data-v-73d798d2 data-v-346454d4><!----><!----></div><div class="docs-prev-next" data-v-73d798d2 data-v-30e1aea1><a href="/blog/code/refcotr" class="prev" data-v-30e1aea1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-30e1aea1 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m11 17l-5-5m0 0l5-5m-5 5h12"/></svg><div class="wrapper" data-v-30e1aea1><span class="directory" data-v-30e1aea1>Code</span><span class="title" data-v-30e1aea1>重構筆記</span></div></a><a href="/blog/code/_dir" class="next" data-v-30e1aea1><div class="wrapper" data-v-30e1aea1><span class="directory" data-v-30e1aea1>Code</span><span class="title" data-v-30e1aea1>Codesnese</span></div><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-30e1aea1 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m13 7l5 5m0 0l-5 5m5-5H6"/></svg></a></div><!--]--></article><div class="toc" data-v-73d798d2><div class="toc-wrapper" data-v-73d798d2><button data-v-73d798d2><span class="title" data-v-73d798d2>Table of Contents</span><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-73d798d2 style="" width="1em" height="1em" viewBox="0 0 24 24" data-v-e610b8e3><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 5l7 7l-7 7"/></svg></button><div class="docs-toc-wrapper" data-v-73d798d2><div class="docs-toc" data-v-73d798d2 data-v-ebd2b6b2><!--[--><div class="docs-toc-title" data-v-ebd2b6b2><span data-v-ebd2b6b2>Table of Contents</span></div><ul class="docs-toc-links" data-v-ebd2b6b2 data-v-a97df893><!--[--><li class="depth-2" data-v-a97df893><a href="#a-依賴注入dependency-injection" class="" data-v-a97df893>A. 依賴注入(Dependency Injection)</a><ul class="docs-toc-links" data-v-a97df893 data-v-a97df893><!--[--><li class="depth-3" data-v-a97df893><a href="#a-dependency" class="" data-v-a97df893>a. Dependency</a><!----></li><li class="depth-3" data-v-a97df893><a href="#b-dependency-with-interface" class="" data-v-a97df893>b. Dependency With Interface</a><!----></li><li class="depth-3" data-v-a97df893><a href="#c-injection" class="" data-v-a97df893>c. Injection</a><!----></li><!--]--></ul></li><li class="depth-2" data-v-a97df893><a href="#b-容器概念" class="" data-v-a97df893>B. 容器概念</a><ul class="docs-toc-links" data-v-a97df893 data-v-a97df893><!--[--><li class="depth-3" data-v-a97df893><a href="#a-窮人與有錢人的依賴注入方式" class="" data-v-a97df893>a. 窮人與有錢人的依賴注入方式</a><!----></li><!--]--></ul></li><li class="depth-2" data-v-a97df893><a href="#c-iocinversion-of-control控制反轉" class="" data-v-a97df893>C. Ioc(Inversion of Control)控制反轉</a><!----></li><li class="depth-2" data-v-a97df893><a href="#d-c-di-框架-範例請點我" class="" data-v-a97df893>D. C# DI 框架 [範例請點我]</a><ul class="docs-toc-links" data-v-a97df893 data-v-a97df893><!--[--><li class="depth-3" data-v-a97df893><a href="#microsoftextensionsdependencyinjection" class="" data-v-a97df893>Microsoft.Extensions.DependencyInjection</a><!----></li><li class="depth-3" data-v-a97df893><a href="#autofac" class="" data-v-a97df893>AutoFac</a><!----></li><!--]--></ul></li><!--]--></ul><!--]--></div></div></div></div><!--]--></div></div><!--]--></main><footer data-v-5c2f7786 data-v-39bdaab3><div class="container pv-HMUtSk pc-hSRg_n footer-container" data-v-39bdaab3 data-v-a8d7e2a7><!--[--><div class="left" data-v-39bdaab3><a href="https://docus.dev" rel="noopener" target="_blank" data-v-39bdaab3><svg viewbox="0 0 57 57" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon left-icon" width="1em" height="1em" data-v-39bdaab3 data-v-e610b8e3><path fill-rule="evenodd" clip-rule="evenodd" d="M28.5445 0C12.8044 0 0 12.7599 0 28.5v25.4549c0 1.5835 1.28368 2.8672 2.86718 2.8672H28.5889C44.2799 56.8221 57 44.102 57 28.4111 57 12.7201 44.2355 0 28.5445 0Zm15.4963 34.452c3.3649 0 6.0927-2.7278 6.0927-6.0928 0-3.3649-2.7278-6.0927-6.0927-6.0927-3.365 0-6.0928 2.7278-6.0928 6.0927 0 3.365 2.7278 6.0928 6.0928 6.0928Zm-18.0833.0003c3.3649 0 6.0927-2.7278 6.0927-6.0927s-2.7278-6.0928-6.0927-6.0928-6.0928 2.7279-6.0928 6.0928c0 3.3649 2.7279 6.0927 6.0928 6.0927Z" fill="currentColor"></path></svg><p data-v-39bdaab3>Powered by Docus</p></a></div><div class="center" data-v-39bdaab3><!--[--><!--]--></div><div class="right" data-v-39bdaab3><!--[--><!--]--><!--[--><a href="https://github.com/spyua" rel="noopener noreferrer" target="_blank" title="https://github.com/spyua" aria-label="https://github.com/spyua" data-v-22569e45><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" data-v-22569e45 style="" width="1em" height="1em" viewBox="0 0 496 512" data-v-e610b8e3><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9c1.6 2.3 4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2"/></svg></a><!--]--></div><!--]--></div></footer></div></div><script type="application/json" id="__NUXT_DATA__" data-ssr="true">[["Reactive",1],{"data":2,"state":128,"_errors":5345,"serverRendered":5254,"path":15},{"search-api":3},[4,13,24,30,45,56,66,74,83,91,99,106,114,120],{"id":5,"path":6,"dir":7,"title":8,"description":9,"keywords":10,"body":12},"content:0.code:1.Refcotr閱讀.md","/code/refcotr","code","重構筆記","",[11],"2019/11/13","  重構筆記  2019/11/13   Lazy Class   別開創無所謂的Class(Ex 指宣告一個變數, Inline Class),邏輯資料相同可以使用繼承延伸,Super Class。要設計Class仙藥思考它的合理性。  Speculative Generality   在設計時，預留太多未來可能會用的擴充點。彈性使用Template模式，然後寫成介面，ConcreateClass去設計跟Imp。  遇到不能關閉的程式，要考慮好資源回收與OOM問題。\n   1.Collapse Hierachy  2.Inline Class  3.Remove Parameter  4.Remove Method  Temporay Field   Class欄位過多，在替代變數命名尚不清楚會讓開發者混淆，這是在開發過程中在需求還不清楚會常遇到，盡量避免這種狀況發生。  Message Chains(過度耦合訊息練)   Fun串Fun太多得意思....使用垂直折疊、提取或是使用委託與封裝，使用注入。  Middle Man(中間轉手人)   Class放與這個Class不相干的內容，邏輯提煉出來其他模組，或使用把功能寫成父類別繼承，或用注入盡量避免這件事情  Inappropriate Intimacy(互相依賴)   過度互相依賴，或是沒邏輯性的互相依賴(亂使用繼承)。 讀卡機讀取票卡例子(讀卡機，票卡自己也需判斷黑名單)。\n   1.可以定義一個卡片Interface(鎖卡，解卡，判斷)。此Interface讓讀卡機繼承，讓讀卡機注入...(依賴注入,RW定義一個介面，再去實作)  2.使用委託註冊介面. Call Back方式把有註冊過的方式拉進Class做處理。  Alternative Class with different Interface(異曲同工的類別)   做Extract SuperClass   Incomplete Libary Class(不完美程式庫類別)   如果要改一點類別庫直接修改，大改套模式..EX:套裝飾者模式,或使用繼承~~~ New程式碼直接延接  Data Class(純稚資料類別)   如果你有資料結構Class專門存取，很多Class會使用他，建議寫Get Set(c#直接產生)。  Refuesed Bequest(被拒絕的遺贈)   繼承錯誤.  Comments(過多的註釋)   包Package或好的命名可以避免",{"id":14,"path":15,"dir":7,"title":16,"description":17,"keywords":18,"body":23},"content:0.code:2.依賴注入(DI).md","/code/(di)","依賴注入(DI)","DI在目前許多軟體架構中是不可或缺的設計架構功能之一，此章節會闡述DI精神及介紹.Net的DI使用。",[19,20,21,22],"A. 依賴注入(Dependency Injection)","B. 容器概念","C. Ioc(Inversion of Control)控制反轉","D. C# DI 框架 [範例請點我]","  DI在目前許多軟體架構中是不可或缺的設計架構功能之一，此章節會闡述DI精神及介紹.Net的DI使用。  A. 依賴注入(Dependency Injection)  先來講依賴跟注入的概念  a. Dependency  依賴如字面上所述，在軟體中，我們很常遇到物件彼此相依的狀況。如下圖，在做計算時需做Printer輸出資訊，因此Calculator物件會相依Printer物件，則在Instance Calculator物件時則就需要同步Instance Printer物件並帶入Calculator物件中。       public     class     Calculator\n   {\n         public     Printer     Printer   {  get  ;  private     set  }\n         public     Add  (  int     a  ,   int     b  ){\n             var     sum     =   a  +  b;\n           Printer.  ConsoleOut  (sum);\n       }\n         public     Calculator  (  Printer     printer  ){\n           Printer   =   printer;\n       }\n   }\n   public     class     Printer\n   {\n         public     void     ConsoleOut  (  string     txt  ) \n       {\n           Console.  WriteLine  (txt);\n       }\n   }\n   static     class     Program\n   {\n         static     void     Main  ()\n       {\n             var     printer     =     new     Printer  ();\n             var     calculator     =     new     Calculator  (printer);\n           calculator.  Add  (  1  +  1  ); \n       }\n   }  這例子為Calculator依賴Printer，所以控制權不是在Printer身上。什麼意思? 簡單來說當Printer有異動時，會有一定程度是影響到Calculator的。  對於物件依賴這件事情我在網上看到一個例子描述還蠻貼切的，今天有一名8+9在吸食毒品如下。8+9 以為自己吸食毒品只是滿足自己的快感，他還以為他自己的意志行為是被自己所掌控  錯!!!  其實8+9這時候所有的行為已經被毒品所控制，再也離不開毒品了。    b. Dependency With Interface  那我們該如何解除依賴關係? 一般來說，在實作方法時，我們會讓物件去相依介面，讓物件彼此因介面而解偶，如下圖       public     class     Calculator\n   {\n         public     IPrinter     Printer   {  get  ;  private     set  }\n         public     Add  (  int     a  ,   int     b  ){\n             var     sum     =   a  +  b;\n           Printer.  ConsoleOut  (sum);\n       }\n         public     Calculator  (  IPrinter     printer  ){\n           Printer   =   printer;\n       }\n   }\n   public     class     Printer  :  IPrinter\n   {\n         public     void     ConsoleOut  (  string     txt  ) \n       {\n           Console.  WriteLine  (txt);\n       }\n   }\n     public     interface     IPrinter  {\n         void     ConsoleOut  (  string     txt  );\n   }\n     static     class     Program\n   {\n         static     void     Main  ()\n       {\n             IPrinter     printer     =     new     Printer  ();\n             var     calculator     =     new     Calculator  (printer);\n           calculator.  Add  (  1  +  1  ); \n       }\n   }  因相依介面，若我們要抽換功能，例如原本的Console輸出改成輸出至記事本。只需要在新增一個記事本輸出方法，替換掉原本的28行的printer即可。而這狀況我們稱為Dependency Inversion Principle(DIP)，依賴倒轉原則。簡單來說就是解除高階模組和低階模組的依賴關係。   高低階模組定義   高階模組指的是呼叫者(Caller)-Calculator   低階模組就是被呼叫者(Callee)-Printer  我們再回到8+9例子，今天想要讓8+9改過向上，戒毒成為奮發向上的好青年。因為現在8+9直接依賴著毒品，我們讓8+9改成依賴藥品這個介面。    現在我們成功讓8+9依賴藥品而不是毒品。然後再將做一個健康食品的類別實作藥品，然後偷偷把毒品換成健康食品。這樣子8+9以為自己吃的藥品是毒品，實際上卻是每天吃健康食品，於是8+9頭腦變好了 走路也不晃了 考試也考100分成為國家的棟樑。  c. Injection  接著講注入，上述Calculator例子注入方式稱為建構子注入，其實注入平常我們就有在使用。一般人比較不會注意到這些行為其實就是一種注入。常見的注入模式有三種   建構子注入(Constructor Injection)  屬性注入(Property Injection)  方法注入(Method Injection)  建構子注入(Constructor Injection)     // 汽車的抽象介面\n   public     interface     ICar   {\n         // 行駛汽車\n         void     run  ();\n   }\n     // 司機的抽象介面\n   public     interface     IDriver   {\n         // 司機駕駛汽車\n         void     drive  ();\n   }\n     // 實作司機的抽象類別\n   public     class     Driver     implements     IDriver   {\n         private   ICar car;\n         // 建構子方式注入抽象類別\n         public     Driver  (ICar   car  ){\n             this  .car   =   car;\n       }    \n       @  Override\n         public     void     drive  () {\n           car.  run  ();\n       }\n   }  屬性注入(Property Injection)     // 汽車的抽象介面\n   public     interface     ICar   {\n         // 行駛汽車\n         void     run  ();\n   }\n     // 司機的抽象介面\n   public     interface     IDriver   {\n         // 司機駕駛汽車\n         void     drive  ();\n   }\n     // 實作司機的抽象類別\n   public     class     Driver     implements     IDriver   {\n         private   ICar car;\n         // 使用setter來傳遞物件 (c# get set)\n         public     setCar  (ICar   car  ){\n             this  .car   =   car;\n       }\n         \n       @  Override\n         public     void     drive  () {\n           car.  run  ();\n       }\n   }  方法注入(Property Injection)     // 汽車的抽象介面\n   public     interface     ICar   {\n         // 行駛汽車\n         void     run  ();\n   }\n    \n   // 司機的抽象介面\n   public     interface     IDriver   {\n         // 司機駕駛汽車\n         void     drive  (ICar   car  );\n   }\n       // 實作司機的抽象類別\n   public     class     Driver     implements     IDriver   {\n          // 使用介面來傳遞物件\n       @  Override\n         public     void     drive  (ICar   car  ) {\n           car.  run  ();\n       }\n   }   在了解Dependency與Injection後，應該就可以理解相依注入動作就在於在Instance物件後放置對應的相應物件中  B. 容器概念  上述DI概念講完後，接著我們要述說容器的概念。A章節提到關於相依的問題，雖然我們可以透過介面去作解偶。但一般在大型專案物件複雜度及數量一定會是更複雜的狀態。因此有了容器的機制設計產生。  容器的概念在於把物件全都收到一個盒子中，當要使用物件時再去盒子拿資料。有點像是打高爾夫球人員要打高爾夫時都會準備一個球袋把要用的球桿放進球袋中，並帶一個球僮陪伴在旁。當要使用哪一支高爾夫球桿時直接告訴球童即可。  a. 窮人與有錢人的依賴注入方式  上述講解完後，相信目前對相依注入及容器有一定的概念。而注入部分一般分成窮人注入與有錢人注入。   我們一般稱為Poor DI(Dependency Injection)，由使用者手動創建以new物件的方式，各自注入，除了麻煩外而且會有傳遞注入等等的問題。  有錢人的注入方式，我們一般都會使用DI容器來完成，由框架或類別庫撰寫的容器，提供物件給予使用者使用，猶如上述所講的球童跟高爾夫球員關係一樣。使用者只需要在撰寫程式前設定好物件後，就不需要在手動注入。  C. Ioc(Inversion of Control)控制反轉  窮人跟有錢人，我們當然選擇當有錢人!(使用DI容器)。若我們使用DI容器去管理我們物件時，此時我們即可達到控制反轉的設計。  簡單來說A物件程式內部需要使用B物件，程序需自行在A物件去new B物件。由程序主動去控制，有了容器，這一切交給容器去控制(新增物件流程)即可。  如果說DIP 是解偶物件之間的依賴，IOC 就是對物件依賴流程控制的反轉。以常見的web框架而言，將監聽http 請求，解析請求等，包裝進框架，一般使用者並不用主動去處理解析請求，處理http請求的流程，由主動處理轉交給了框架，因此，所以框架其實也是一種IoC的設計。   你可以將IOC是一種設計模式，將流程控制重定向到外部處理程序或控制器來提供控制結果，而不是透過控制項(大多情境就是程序)來直接得到結果  D. C# DI 框架   [範例請點我]  上述聊完後，相信對於DI、容器、DIP與IOC有一定認知。接著就需要進入實作部分。在.NET中最常見的DI有兩套如下   Microsoft.Extensions.DependencyInjection  Autofac  上述提到注入三種方式(建構子、屬性與方法)，Autofac都有提供，而ASP.NET DI的目前只有建構子注入方式。網上大多是Web範例，在此使用這兩套DI工具使用在DeskTop Windows From。  Microsoft.Extensions.DependencyInjection  範例DI設定在DIServiceConfigure.cs  注入服務生命週期型態  服務生命週期指：透過 DI 取得某個元件時，是每次要求得建立一顆新物件，還是從頭到尾共用一個 Instance (執行個體-物件)。   1.AddSingleton (單一性)  2.AddTransient (暫時性)  3.AddScoped (範圍性)  1. AddSingleton (單一性)  整個程序只建立一個 Instance，任何時候都共用它。簡單來說就是程序中不同流程使用此物件時，他都為同一份物件，有點像是Static，差在於使用DI可做物件設計及抽換。  下圖為Asp.Net DI生命週期圖示，物件相依關係由左至右。    而在範例模擬中設計，物件對應可視為   Rqeuest : Button_Singleton_Click 按下  第一個圈 : Call LogController  第二個圈 : Call LogController2  Instance : SingletonLogRepository  Repository注入部分我們使用AddSingleton，而物件在Instance時，我們會建置Guid去觀察他是否為同一個物件。         // 系統單一物件定義使用，或沒有異部與大量Request問題，可直接用Singleton\n   collection.  AddSingleton  \u003C  ISingletonLogRepository  ,   LogRepository  >();  當我們按下Button_Singleton_Click時，會去呼叫LogController及LogController2裡的SingletonLogRepository物件。並印出Guid。     private     void     Button_Singleton_Click  (  object     sender  ,   EventArgs     e  )\n   {\n         //var provider = DIServiceConfigure.GetProvider();\n         //var logController = provider.GetRequiredService\u003CILogController>();\n         var     log     =     \"Log1(Singleton):\"  +  \"UUID-\"  +  LogController.  OperationId  (  \"Singleton\"  );\n         var     log2     =     \"Log2(Singleton):\"     +     \"UUID-\"     +   LogController2.  OperationId  (  \"Singleton\"  );\n       richTextBox_Info.  AppendText  (log  +  \"  \\n  \"  );\n       richTextBox_Info.  AppendText  (log2   +     \"  \\n  \"  );\n       richTextBox_Info.  AppendText  (LogController.  QueryLogCount  ());\n   }  此時我們可以看到兩個印出來的UUID會完全相同。代表在SingletonLogRepository在Controller與Controller2中為同一個物件。    2. AddTransient (暫時性)  定義上為程序中每次要求物件(包含物件要其他相依物件)時就建立一個新的，永不共用。  下圖為 Asp.Net DI生命週期圖示，物件相依關係由左至右。    而在範例模擬中設計，物件對應可視為   Rqeuest : Button_Transient_Click 按下  第一個圈 : Call LogController  第二個圈 : Call LogController2  Instance : TransientLogRepository  Repository注入部分我們使用AddTransient，而物件在Instance時，我們會建置Guid去觀察他是否為同一個物件。     // 異步，且須大量Request的建議使用Transient (WundowsForm簡易Sample較難模擬)\n   collection.  AddTransient  \u003C  ITransientLogRepository  ,   LogRepository  >();  當我們按下Button_Transient_Click時，會去呼叫LogController及LogController2裡的SingletonLogRepository物件。並印出Guid。     private     void     Button_Transient_Click  (  object     sender  ,   EventArgs     e  )\n   {\n        // 模擬多次Request\n        //var provider = DIServiceConfigure.GetProvider();\n        //var logController = provider.GetRequiredService\u003CLogController>();\n        //var log = \"Log1(Transient):\" + \"UUID-\" + logController.GUID.ToString();\n        //richTextBox_Info.AppendText(log + \"\\n\");\n              // 單次Request\n        var     log     =     \"Log1(Transient):\"     +     \"UUID-\"     +   LogController.  OperationId  (  \"Transient\"  );\n        var     log2     =     \"Log2(Transient):\"     +     \"UUID-\"     +   LogController2.  OperationId  (  \"Transient\"  );\n      richTextBox_Info.  AppendText  (log   +     \"  \\n  \"  );\n      richTextBox_Info.  AppendText  (log2   +     \"  \\n  \"  );\n          //richTextBox_Info.AppendText(LogController.QueryLogCount());\n   }  此時我們可以看到兩個印出來的UUID會不相同。代表在TransientLogRepository在Controller與Controller2中為不同物件。    上述模擬範例其實只模擬一個Request1的狀況。根據定義，程序中每次要求元件時就建立一個新的物件，對此我們已再按多次Button來做模擬。要模擬這狀況，就需要再跟Container拿取Controller物件，在範例中Controller與Controller2都是注入AddTransient，我們將模擬多次Request區塊註解打開，並註解單次Request程式碼     private     void     Button_Transient_Click  (  object     sender  ,   EventArgs     e  )\n   {\n         // 模擬多次Request\n         var     provider     =   DIServiceConfigure.  GetProvider  ();\n         var     logController     =   provider.  GetRequiredService  \u003C  LogController  >();\n         var     log     =     \"Log1(Transient):\"     +     \"UUID-\"     +   logController.GUID.  ToString  ();\n       richTextBox_Info.  AppendText  (log   +     \"  \\n  \"  );\n           // 模擬單次Request\n         //var log = \"Log1(Transient):\" + \"UUID-\" + LogController.OperationId(\"Transient\");\n         //var log2 = \"Log2(Transient):\" + \"UUID-\" + LogController2.OperationId(\"Transient\");\n         //richTextBox_Info.AppendText(log + \"\\n\");\n         //richTextBox_Info.AppendText(log2 + \"\\n\");\n           //richTextBox_Info.AppendText(LogController.QueryLogCount());\n   }  此時我們可以看到每次的UUID就會不相同，代表在Controller在每次跟Container拿取時都為不同物件。相對的，注入其他物件時也是同一個狀況。    3. AddScope  (範圍性)  Scope我覺得是最難了解的，直接看 Asp.Net DI生命週期圖示，物件相依一樣關係由左至右。如圖所示，程序中要求物件(包含物件要其他相依物件)時，這個Flow處理過程中用到的物件則為同一個物件。而第二次再次要物件時，則會跟第一次的物件是不一樣的物件。    我們已Call Dialog方式去模擬多次Request，程式碼這邊不多做解釋，結果與物件對照如下圖，觀察Instance部分物件分別為   SingletonLogRepository  TransientLogRepository  ScopedLogRepository  可以看到ScopedLogRepository，在同一次的Request Flow，LogController與LogService的LogRepository UUID為一樣的，但在第二次打開Dialog時，則UUID會與第一次的不同。這點會跟Singleton有很大的不同。  在此我們也可以看到Transaction則是在每個物件中，及每次Request都為不同UUID。    其實Scoped跟Transaction之間有時候蠻容易混淆的。對我來說比較好懂得在於Scoped在跟Container要物件時，若前一個物件還未dispose(生命週期還未結束)，則都是同一個物件。物件結束生命週期後在新的Request後才會在新增新的物件。而Transaction就無生命週期概念，在每一次要求物件時，都會New一個新的給他，有點像平常我們想用物件就New Instance的概念。  生命週期小結論  上述描述完後，沒意外應該會對注入的生命週期會有所了解。而在Web的世界中，這三種注入方式會很常被使用到。在每一次Http Request情境，Request具有連線即結束，在這狀況下的連線相關物件基本上就會使用Scoped，因此在Web情境，大多數物件都會使用Scoped注入。  但WindowsForm App下，其實我們最常使用的會是Singleton居多，其次是Transaction，Scoped狀況就比較少，因為WindowsForm一開始畫面就那些就載入到 memory中，除非我們將畫面dispose掉，然後再重新開啟畫面，此時就會建議使用Scoped注入。  Transaction使用場景比較會偏向用後就直接dispose，不過這種應用場景，我們很常直接手動去new物件.實際架構應用上目前我也沒太多經驗。  注入抽換  生命週期講完後，接著就是闡述關於抽換實體物件。範例中我們使用IPrinter注入抽換PrinterMethodA與PrinterMethodB。  在一開始我們IPrinter注入為PrinterMethodA，在按下button_Printer_Click按鈕時，Console則會印出MethodA Print:Prionter Out    此時我們將PrinterMethodA改成PrinterMethodB     collection.  AddTransient  \u003C  IPrinter  ,   PrinterMethodB  >();  此時在按下button_Printer_Click按鈕時，Console則會印出MethodB Print:Prionter Out    另外我們也可以注入IPrinter List，只要注入多Concreate實體     collection.  AddTransient  \u003C  IPrinter  ,   PrinterMethodA  >();\n   collection.  AddTransient  \u003C  IPrinter  ,   PrinterMethodB  >();  就可注入多PrinterMethod方法     private     LogController     LogController  ;\n   private     LogController2     LogController2  ;\n     // 多重注入\n   private     IEnumerable  \u003C  IPrinter  >   Printer  ;\n     public     Form1  (  IEnumerable  \u003C  IPrinter  >   printer  ,\n                  LogController     logController  , \n                  LogController2     logController2  )\n   {\n         InitializeComponent  ();\n       LogController   =   logController;\n       LogController2   =   logController2;\n         // 多重注入\n       Printer   =   printer;\n   }    我們只須改Container設定，主程式都不用更動，即可抽換程式中所有物件用到IPrinter的地方。  AutoFac  範例DI設定在AutofacConfig.cs  AutoFac與 ASP.NET DI 注入生命週期概念其實大同小異，下圖為對應表  出處    根據對應表，在範例程式要換成Autofac範例，只需將Bootstrapper與Form.cs裡Button_Scoped_Click的Net DI程式碼註解掉，並解開Autofac註解相關程式碼。即可觀察注入物件生命週期的不同。  .github-light_github-dark{color:#24292e;background:#fff;}.dark .github-light_github-dark{color:#e1e4e8;background:#24292e;}.ct-149352{color:#D73A49;}.dark .ct-149352{color:#F97583;}.ct-553616{color:#24292E;}.dark .ct-553616{color:#E1E4E8;}.ct-762058{color:#6F42C1;}.dark .ct-762058{color:#B392F0;}.ct-617022{color:#005CC5;}.dark .ct-617022{color:#79B8FF;}.ct-086898{color:#6A737D;}.ct-157101{color:#E36209;}.dark .ct-157101{color:#FFAB70;}.ct-952708{color:#032F62;}.dark .ct-952708{color:#9ECBFF;}",{"id":25,"path":26,"dir":9,"title":27,"description":9,"keywords":28,"body":29},"content:0.index.md","/","Home",[],"     Hakuna Matata.   I am a dedicated learner, and together with my friend, we have formed a team called Code Sense in Kaohsiung. We engage in research and study on a weekly basis, with a passion for learning new technologies and skills.Continual learning is the driving force of my life.     8-9 years of software development and maintenance experience  3-4 years of experience in automation domain development  1-2 years of experience in department software training and management  Familiar with integration and connection of various factory systems (  MES ,   WMS ,   PLC )  Proficient in web system front-end and back-end development and database design  Well-versed in measurement instrument and motor PC Base control (  RS232 ,   ModBusTCP ,   EtherCAT )      My Personal Moments.      Reading Blog   Regular Reading and Public Journal of Thoughts and Moods.[  Medium ]    Code Sense Trello   Regular Study and Discussion Sessions with Friends.\n[  Code Sense Trello ]    Slider   My Presentation Slides.[  Slider Link ]    Technical Documentation   Regular document writing and temporary storage.[  Hackmd ]",{"id":31,"path":32,"dir":33,"title":34,"description":9,"keywords":35,"body":44},"content:1.architecture:1.DDD實戰-Module.md","/architecture/ddd-module","architecture","DDD實戰-Module",[36,37,38,39,40,41,42,43],"一、關於Module","二、構成Module考量五要素","三、Package Vs Module","四、一般Module設計方法","五、未使用DDD的一般Service服務設計","六、在DDD世界中的Module設計","補充","參考","  DDD實戰-Module  一、關於Module  在闡述Module前，讓我們先來比對非物件化設計與物件化設計的差異性。看到下圖左，在非物件化的傳統設計，資料與方法操作上是整個拆開設計，在資料流複雜外我們可以看相依性高，偶合的狀況也較高。  接著討論物件化設計部分，先不論封裝等物件操作技巧，單純根據資料與方法關係設計出物件(物件特性:資料(Data) 物件行為:方法(Function))，我們可以看到原本互相依賴的Fun關係可各自獨立使用，在資料流上也較為單純。    物件化後，雖然在資料操作面上簡化許多，但隨著專案功能性逐漸增加，物件與功能處理流程上會趨近越複雜，如下圖為一個簡易的系統，此系統根據外部Sensor系統獲取、過濾與計算資料，在沒模組化的設計前提，可以看到Control與Data Flow呈現一個較零散的關係狀態    此時我們根據Sensor功能額外設計一個Sensor模組如下，此時我們就可以針對Sensor相對應的資料模組將之封裝在模組內，此模組對外則就單純開放運算(calculation)與過濾(filtering)的功能。  模組化後可以明顯看出控制與資料流的彼此相依性值，因此降低了修改與擴充狀況的互相影響性值。    模組化指是將  系統功能程序作分離獨立(特定功能class的容器) ，除了功能獨立外，也強調設計上可以根據功能隨意抽換模組。達到高內聚、低耦合的目的，進而提高開發者的生產力(將複雜的功能拆分管理)。並讓程式碼能夠透過引用的方式來重複使用，提升重用性(Reusable)   Modular design allows code to remain agile in the face of ever-changing requirements.   二、構成Module考量五要素   Propose:Module功能目標單一職責，盡量不要與其他模組設計有太多相依關係。  Interface:模組功能API所提供使用方式要簡潔易懂，通常User不需要去了解實際內部的實作方式，只需專注在確定輸入什麼，會輸出什麼可達到什麼功能。  Encapsulation:封裝模組，除了讓不暴露資料結構讓使用者亂使用外，對於在修改細節上也能較不容易直接影響使用端。另外再使用抽象實作上，物件抽象化多少還是難以避免Leaky Abstractions的問題。  Implementation:實作上除了考量功能正確性外還需考慮效能、測試與功能架構程式碼最小化。  Connection(關聯性):呼應Propose功能單一職責，將與其他模組相依性最小化。   三、Package Vs Module  在了解Module構成要素後~隨著專案模組(Module)的增加，將難以管理及問題的追蹤，這時候就能將模組(Module)打包成套件(Package)，利用其階層式的結構來彈性規劃模組(Module)。   Module:單一功能模組  Package:多Module組成  四、一般Module設計方法  在非以領域事件為出發點的設計上，大部分狀況會根據功能設計成物件與介面使用。下圖為Zebra SDK Package的Module列項，我們可以大致分得出，他的Module設計就是根據功能性值去區分(graphics, certificate...)    接著我們點近discovery看提供什麼API功能，可以看到可以使用的介面功能以及相關功能可使用的功能物件。    在點進個別更詳細功能介紹，我們就會看到這物件功能具有什麼資料特質、物件實體化須提供什麼參數以及此物件可使用哪些方法。   Field: address，IP or Mac Adress  Constructor:物件實體化須提供印表機的IP or Mac Adress  Method:可使用的物件功能，在此例看起來需實作getConnection功能    上述為印表機找到印表機裝置功能的模組化介紹   五、未使用DDD的一般Service服務設計  上述一般Module設計概念聊完，在聊DDD Module設計之前先來聊一下在一般未使用DDD領域設計的服務系統會如何設計。  在對大部分的開發者，一開始習慣設計都以數據為考量的集中式設計架構。設計架構上會出現比較常見到的分層式設計，大致分成Controller, Service, Repositories, Models   xxx/Model\n   數據庫Model、Request Model, Response Model  xxx/Controller\n   給Client端的API第一時間接口，提供Get,Post,Delete,Update API。除了此在此層一般都會安插屬性驗證Client第一時間傳過來的資料是否正確。並作實際的DTO(Object 與DB Model Mapping)轉換。  xxx/Service\n   這層基本上就是作商業邏輯的處哩，進到此層的資料基本上都是做完DTO轉換，在此層通常會作實際的資料邏輯處理處理完後再往DB方向送。  xxx/Repositorie\n   DataSource(DBContext)上一層，一般會除了實際面DataSource讀寫變更操作外，Source 資料Join處理也會在此層處理。一般多這一層都是為了隔開DataSource的來源切換，不管置換不同的DB系統，或是Source改成Shared Prefs，都可快速置換資料來源。     六、在DDD世界中的Module設計  上述稍微帶過Module的設計概念後，接著探討在DDD世界裡，Module的設計概念如何~大致分成幾個探討議題  1.DDD設計步驟流程     在探討需求架構DDD設計的第一步，就是根據需求情境列出事件風暴(Event storming)，並在事件風暴中的用戶操作、事件、以及依賴關係根據這些要素設計歸納出領域與實體。  接著第二步在領域實體之間找尋彼此務的關聯性，將具有相關的實體組合成聚合(Aggregate)，同時確定聚合根(Aggregate Root)。在聚合根行程時，基本上第一層邊界(邏輯邊界-虛線)也會跟著產生，他們會在同一個服務器中運行。  當聚合規劃好後~會根據業務及語意邊界等因素，將一個或多個聚合規劃訂製在一個限界上下文內(服務邊界)，形成領域模型。    2.程式碼一級目錄架構     Interface(API Interface)\n   給使用者API介面，使用者透過Restful請求，將資料傳到此層，解析用戶傳送的請求資訊，資料的組裝、資料傳輸格式以及 Facade 介面等代碼都會放在這一層目錄裡。  Application\n   他有點像是原先集中式設計Service的功能，實作所有相依於指定前端之使用案例的地方。 例如，與 Web API 服務相關的實作。若使用的是 CQRS 方法，它便會包含查詢、微服務接受的命令，甚至是微服務之間的事件驅動通訊 (整合事件)。  Domain\n   它主要存放領域層核心業務邏輯相關的代碼。領域層可以包含多個聚合代碼包，它們共同實現領域模型的核心業務邏輯。聚合以及聚合內的實體、方法、領域服務和事件等代碼會放在這一層目錄裡。  Infrastructure\n   它主要存放基礎資源服務相關的代碼，為其它各層提供的通用技術能力、三方套裝軟體、資料庫服務、配置和基礎資源服務的代碼都會放在這一層目錄裡。  3.在DDD Module準則  例子:如何對電商平台上的顧客進行模塊設計  對於顧客來說，一般須要維護顧客的   個人訊息  收穫地址  付款方法  這三個之間的關係是緊密相關，不可獨立存在，我們根據這三點抽象出三個Aggregate   Customer 個人訊息  AddressBook 收穫地址  Wallet 付款方法  那該如何去放置這些Aggregate，是針對每一個Aggregate作資料夾分類還是這三個Aggregate放同一格資料夾?基本上這三個Aggregate就是一個Custer Module，所以都會放到Custer Module資料夾內。    當整理出Aggregate與Module後，接著會開始根據各Module去實作事件應用處理  基本上我們在DDD模塊的設計上有幾個注意要點   Module應該要和Domain概念一致:一般一組聚合集成(領域)，我們會相對應建立一個Module。  根據通用語言來命名:模組命名要一眼就看出這是在做什麼的。  模組設計盡量鬆偶合:盡量與其他模組不要有太多的偶合，若有也許在領域設計上還沒切得很乾淨。  如果有PeerModule或父子Module出現，盡量避免循環相依。  4.關於Module命名    5.Module界線與限界上下文不同  為了對領域模型中進行準確建模，需要將領域模型劃分成多個子域，每個子域對應一個或多個限界區域。 模塊。所以，從子域到限界某些再到模塊，應該是依次包含關係。  補充  補充一   Abstracion:\n   將真實世界物體與事件的大量資訊縮減一個概念或是一個現象的資訊含量來將其廣義化，保存和一特定目的有關的資訊。例如，將一個皮製的足球抽象化成一個球，只保留一般球的屬性(形狀)和行為(滾)等資訊。  Leaky Abstractions\n   所有非不證自明的抽象概念，都有某種程度的疏漏。例如TCP雖簡化(抽象化)網路行為，設計上也保證網路傳送過程中不遺漏資訊，但不保證就真的能完整傳到資訊，例如我們無法避開海底電纜被魚咬斷因此斷訊的狀況。  參考   範例  The 5 Essential Elements of Modular Software Design  The Law of Leaky Abstractions  The Three Principles of Excellent API Design  解析Python模組(Module)和套件(Package)的概念  Module Design   Domain Events vs. Integration Events in Domain-Driven Design and microservices architectures   DDD理论学习系列（13）-- 模块   DDD理论学习系列——案例及目录",{"id":46,"path":47,"dir":33,"title":48,"description":9,"keywords":49,"body":55},"content:1.architecture:2.DDD-簡易整理.md","/architecture/ddd","DDD實戰-簡易整理",[50,51,52,53,54],"一、回顧","二、何謂Entity,如何定義他","三、跟ValueObject有何不同","四、如何產出 Entity Id?","五、.NET Core 實作微服務領域模型","  DDD實戰-簡易整理  一、回顧  (DDD) 重點在於協助您在使用案例相關的商務實際情況下建立模型，然後根據Domain定義後續不同的Context與彼此的對應關係，再與事件驅動方式實際實現。  書中所提例子 : 電商系統，人員瀏覽商並下訂後交易。   定義Domain\n   根據問題空間與解決方法定義出Domain\n   Core Domain :產品最有價值部分 (Ex AI 推薦購買商品需求)  Supporting Subdomain : 未提供核心競爭力，但支援核心所需功能 (Ex 購物需求)  Generic Subdomain : 未提供核心競爭力，但整個系統都可能會用到它 (Ex 身份認證需求、金流串接)      根據語意(Linguistic)與業務能力(Business Capability)定義BoundContext   重點一、通常識別 Bounded Context 會由兩點下手：語意(Linguistic)與業務能力(Business Capability)。  電商例子(語意-業務能力)   登入-帳號管理 => 身分管理Context (Identity)  商品-商品選擇 => 商品目錄Context (Catalog)  下購-購買功能 => 選購Context (Purchase)  重點二、注重業務能力勝過資料分類 (習慣性地用資料表去起始設計系統，甚至把業務邏輯與 ORM 框架綁在一起。這麼一來容易造成物件乘載太多的責任，比如說「顧客」是屬於「會員管理系統」還是屬於「購物系統」？)  Context定義出後，根據幾種方法(設計模式，或撰寫程式技巧)去做Context Mapping    - Shared Kernel\n - Partnership\n - Anti-corruption Layer\n - Open Host Service/Published Language\n - Separate Way\n - Big Ball of Mud\n - Customer-Supplier\n - Conformist\n     使用或設計軟體架構最小化建置與維護「需求系統」所需要的人力資源。\n   軟體的架構與功能需求沒有關係  軟體架構是非功性需球 Non-Funcitonal Requirement (系統達成的任務的能力)  常見軟體架構大概有這些類型：\n   MVC  MVP  Layered Architecture  Client Server  Microservice  Event-Driven Architecture  Pipe-Filter  MVVM  DDD 不等於 Clean Architecture，兩者關注的面向不同。DDD 的主要目的是將軟體的模型更貼近業務需求，架構只是為了達到目的的工具。     二、何謂Entity,如何定義他  根據電商前面例子, 身分管理、 商品目錄與選購中，你覺得什麼是Entity?  顧客、訂單、商品等等。這些物件不被他們的屬性所辨識(比如年齡、金額)，而是由一個專屬的身份標誌 (Identity)來辨識。這種時候，我們就需要 Entity 的幫助讓我們在不同的物件中找到我們要的那一個。  Entity 最大的特徵就是有 Identity 的概念，所以常會搭配一個擁有唯一值的 ID 欄位。但這邊要澄清一個誤解，不是有 ID 就是 Entity，重點是你在不在乎他生命週期的變化。  Entity具有幾個特徵   具有唯一值ID  具有狀態  生命週期有可能無限長  一個 Entity 是可變的、長壽的，所以通常會有複雜的生命週期變化，如一套 CRUD 的操作  不只會實作資料屬性，還會實作具有相關領域邏輯的作業或方法  實體代表領域物件，而且主要是由其身分識別、連續性及一段時間的持續性所定義，而不只是由包含這些項目的屬性所定義。 如同 Eric Evans 說，「主要由其身分識別定義的物件稱為「實體」（Entity）。 實體在領域模型中很重要，因為它們是模型的基礎。  已Order訂單為例子   訂單ID  訂單屬性(ID,Name,Address)  訂單操作Method(EditName, EditAddress)    三、跟ValueObject有何不同   當一個物件沒有概念上的標識 (conceptual identity)，而你只關心它的屬性時，這個物件就可以建立成 Value Object。  Value Object 的屬性都是為了要描述某一個事物的特徵。  判斷這兩者的標準就在於系統在不在乎這個物件的生命週期變化。      四、如何產出 Entity Id?   1. 來自用戶的輸入  這是一個非常直接的做法，比如使用用戶的 email 或是身分證字號等等作為 ID，但也容易造成額外的成本。最大的成本就在於，你需要由用戶負責產生符合需求的身份認證資料非常困難。此時的 ID 可能是唯一的，但卻有可能是不正確的。  甚至，身分證字號也有重複的可能性。  因此，我們可以將用戶輸入的資料作為 Entity 的屬性。這些屬性可以用來做搜尋用，但大多時候並不適合作為 Entity 的 ID。   2. 使用持久化機制來產生  最常見的就是使用資料庫自動生成 ID，最常見的就是 SQL 對 ID 下 AUTO_INCREMENT 讓 ID 的值自動遞增。又或者也可以向資料庫索取一個 UUID (或 GUID) 作為 ID 的值。  這樣的做法好處是可以減少程式的複雜性，直接把產生的工作交給持久化機制處理。但也容易招致效能問題的疑慮(UUID/GUID 的產生)。而且當你無法從程式碼找出 ID 的生產機制時，也會增加程式碼的隱含性不利於閱讀。  另外，使用持久化機制時，也需要特別考量這個 ID 的生成應該要在該物件持久化 (ie 存入資料庫) 之前或是之後，以配合程式的需求。  註：這裡會使用「持久化」一詞是因為儲存資料的方式不止資料庫一種，故用更通稱的方式描述。   3. 在程式中產生  在程式中產生 ID 是最常見的方法之一，這種方法好處是可以更容易掌握生產的時機，此外，更可以客製化你的 ID 格式，比如一筆訂單你可以用 order-20190930-c764e787-8182 作為 ID，如此一來，在 debug 時就不用被一堆天文數字般的 ID 搞得昏頭脹腦。所以以個人經驗來說，即使增加了一點複雜度，會最推薦這個方式。   4. 由另一個 Bounded Context 提供  最複雜的一種就是來自於另一個 Bounded Context 提供的 ID。這種可能出現在當你需要調用 API 的時候，得到對方的資料後存取下來。這種方式的複雜點在於，你不只要考慮本地端的 Entity，也需要考慮外部 Bounded Context 的改變情況，雖然可以透過訂閱另一個 Bounded Context 的方式做到，但仍舊十分麻煩。  五、.NET Core 實作微服務領域模型      參考 :\n  https://ithelp.ithome.com.tw/articles/10223150  https://docs.microsoft.com/zh-tw/dotnet/architecture/microservices/microservice-ddd-cqrs-patterns/microservice-domain-model  https://docs.microsoft.com/zh-tw/dotnet/architecture/microservices/microservice-ddd-cqrs-patterns/ddd-oriented-microservice",{"id":57,"path":58,"dir":59,"title":60,"description":9,"keywords":61,"body":65},"content:2.desktop:1.WindowsForm找不到類型xxxx上的建構涵式.md","/desktop/windowsformxxxx","desktop","WindowsForm找不到類型xxxx上的建構涵式",[62,63,64],"情境","錯誤訊息","解決方法","  WindowsForm找不到類型xxxx上的建構涵式  情境  近期在設計DeskTop頁面時有遇到幾個頁面基底邏輯相同的狀況，於是特別設置Base Page去讓UC繼承使用。因為頁面其實長差不多，所以最後決定不使用參考引用而直接使用繼承。  讓A(UC_3Dswitch_CalibrationFileManagement)繼承B(UC_3Dswitch_FileManagementBase)。  錯誤訊息  編譯上都沒有問題，但此時再使用Design模式時，發生找不到類型錯誤如下    解決方法    宣告無注入空的建構子，       // 宣告無注入空的建構子\n   public     UC_3Dswitch_FileManagementBase  ()\n   {\n     }\n   public     UC_3Dswitch_FileManagementBase  (  AppSetting     appSetting  ) \n   {\n       ProductLineDataPath   =   appSetting.ProductLineDataPath;\n       SNFolderNameLength   =   appSetting.SNFolderNameLength;\n         InitializeComponent  ();\n   }  因原先Base設定注入所宣告AppSetting物件，故發生上述無法載入錯誤。看起來Deisnger模式在Control物件使用上Defaul都是預設空的建構子設置。  .github-light_github-dark{color:#24292e;background:#fff;}.dark .github-light_github-dark{color:#e1e4e8;background:#24292e;}.ct-086898{color:#6A737D;}.ct-149352{color:#D73A49;}.dark .ct-149352{color:#F97583;}.ct-553616{color:#24292E;}.dark .ct-553616{color:#E1E4E8;}.ct-762058{color:#6F42C1;}.dark .ct-762058{color:#B392F0;}",{"id":67,"path":68,"dir":69,"title":70,"description":71,"keywords":72,"body":73},"content:3.cloud-gcp:GKE.md","/cloud-gcp/gke","cloud-gcp","GKE","GKE為GCP提供的SAAS等級的kubernetes服務。相對於自行架設kubernetes運行環境簡化了許多建置部屬、管理及擴展設定的工作。以SAAS提供kubernetes容器平台服務的優點如下",[],"  GKE  GKE為GCP提供的SAAS等級的kubernetes服務。相對於自行架設kubernetes運行環境簡化了許多建置部屬、管理及擴展設定的工作。以SAAS提供kubernetes容器平台服務的優點如下   容易上手 : Google對kubernetesr進行封裝及抽象，使用者不需要了解底層細節即可上手。能直接透過介面操作達到快速部屬與管理設定。不然一般許多部份都需要自己做相關起建，例如..\n   介面需安裝相對應的工具並做設定才可  版本升級修補需人為去維護  需自行安裝與配置監控與日誌工具  安全性設定  資源設定擴展需自行維護",{"id":75,"path":76,"dir":77,"title":78,"description":9,"keywords":79,"body":82},"content:4.database:1.MSSQL使用指令測試Server硬碟速度小技巧.md","/database/mssqlserver","database","MSSQL使用指令測試Server硬碟速度小技巧",[80,81],"讀取速度","寫入速度","  MSSQL使用指令測試Server硬碟速度小技巧  讀取速度  選抽一個資料庫 下BACKUP DATABASE指令，備分資料庫不做寫入，只做讀取，可得到讀取速度值。     BACKUP     DATABASE   [FUXIN_CPL]   TO     DISK     =  'NULL'     WITH     COPY_ONLY    下圖可看到結果每秒讀取速度為180MB/sec    寫入速度     BACKUP     DATABASE   [FUXIN_CPL]   TO     DISK     =  'C:\\TEST.BAK'     WITH     COPY_ONLY  此時會得到讀寫時間為每秒153MB    每秒153MB為讀寫時間，此時須作運算處裡將寫入時間算出  讀取總頁數共688頁，一頁8k => 688*8.0 / 1024 = 5.375M  寫入時間為 0.035-0.03 = 0.005  5.375M/0.005 = 1075M  .github-light_github-dark{color:#24292e;background:#fff;}.dark .github-light_github-dark{color:#e1e4e8;background:#24292e;}.ct-149352{color:#D73A49;}.dark .ct-149352{color:#F97583;}.ct-553616{color:#24292E;}.dark .ct-553616{color:#E1E4E8;}.ct-952708{color:#032F62;}.dark .ct-952708{color:#9ECBFF;}",{"id":84,"path":85,"dir":86,"title":87,"description":9,"keywords":88,"body":90},"content:5.keycloak:1.身份驗證與授權與Keycloak.md","/keycloak/keycloak","keycloak","身份驗證與授權與Keycloak",[89],"一、關於身份驗證與授權","  身份驗證與授權與Keycloak  一、關於身份驗證與授權  身份驗證和授權是系統安全性非常重要的環節。身份驗證用於識別使用者是誰，而授權則賦予使用者某些特定權限。更具體來說，這整個過程可以分為四個部分：   身分識別 (Identification)：這是一個讓系統知道你是誰的過程。例如，當你使用用戶名或電子郵件地址登入系統時，就是進行身分識別。  身分驗證 (Authentication)：這個過程讓系統確認你確實是你聲稱的那個人。通常是通過輸入密碼、使用FaceID或OTP來完成的。  授權 (Authorization)：這涉及到角色分配。根據你的角色，系統會賦予你不同的權限。例如，一個“編輯者”角色可能有編輯內容的權限，而一個“閱讀者”角色則只能閱讀。  存取控制 (Access Control)：這涉及到具體的操作權限。比如，在一個IT管理系統中，一個普通使用者可能可以重啟伺服器和查看系統日誌，但不能部署新的程式碼。然而，一個開發者則可能有這樣的權限。  在你登入系統，輸入帳號密碼為身分識別與身分驗證，系統驗證完後，會根據身分授予角色。至於此角色權限則可以在後台系統上設置。至於這部分的詳細實做概念牽扯還是蠻多的...會再找時間針對這部分做一個細部講解。  1. 身分識別驗證與授權簡易實作  了解這些基礎概念後，我們可以考慮如何手動實現這四個部分。   身分識別 (Identification) : 最常見的實現方式是透過一個使用者註冊頁面，讓使用者輸入基本資料，例如用戶名和密碼。這些信息會被存儲在後端的資料庫中（密碼會被加密）。  身分驗證 (Authentication) : 驗證的方法有多種。   密碼驗證 : 簡單地說，就是將輸入的密碼與資料庫中存儲的密碼進行比對。  多因素驗證 : 二次驗證，例如OTP、FaceID，或是手機&Mail驗證  Session/Token管理 : 用戶登入後，系統會生成一個session或token並發送給用戶。後續的所有請求都需要這個token以確認身份。  授權 (Authorization) : 這部分簡易實作基本上會有三部份   角色管理：在資料庫中設計一個角色和權限的模型。例如，每個使用者可以有一個或多個角色，每個角色有不同的權限。  權限檢查：每次使用者請求某個資源或操作時，檢查他們的角色是否有相應的權限。  API設計：設計API時，確保每個API端點都有適當的授權檢查。  存取控制 (Access Control)   基於角色的存取控制 (RBAC)：根據使用者的角色決定他們可以訪問的資源。  細緻的權限設定：允許系統管理者為每個角色定制細緻的權限，例如某角色只能讀取資料但不能編輯。  其他考慮   日誌和監控：記錄所有的登錄嘗試、授權請求等，以便日後分析和審計。  資料庫安全性：確保資料庫有適當的加密和備份策略。  定期檢查和更新：隨著時間的推移，可能會出現新的安全威脅。定期檢查和更新你的身份驗證和授權策略，以確保它們始終是安全的。  2. 身分識別驗證、授權與Keycloak  通過使用Keycloak，我們能夠更為高效地實現身分識別、身分驗證、授權，以及存取控制等功能。   身分識別 (Identification)   不僅提供使用者註冊功能，讓使用者可以用基本資訊，比如用戶名或電子郵件進行註冊，還支持多種社交登入方式，如Google或Facebook。  身分驗證 (Authentication   支援多種身分驗證方法，包括密碼、OTP、FaceID等，也提供Token管理，當使用者成功登入後，Keycloak 會發放一個 token，使用者可以使用此 token 來存取其他受保護的資源。  授權 (Authorization)   可以定義多個角色，並為每個角色分配不同的權限，使用者可以被分配到一個或多個角色，這些角色決定了使用者可以訪問哪些資源。  存取控制 (Access Control)   支援基於角色的存取控制 (RBAC)。你可以設定哪些角色可以訪問哪些資源。  一般來說，要全面實施這四大功能通常需要大量的時間和資源。開發者不只需要寫大量的程式碼，還必須維護系統的安全性、效能，並確保與其他系統的良好整合。有了Keycloak，這一切都變得相對簡單。",{"id":92,"path":93,"dir":86,"title":94,"description":95,"keywords":96,"body":98},"content:5.keycloak:2.OIDC與SAML.md","/keycloak/oidcsaml","OIDC vs SAML","在這部分，我們將探討OIDC和SAML。正如前一章節所提，身分驗證和授權是整個安全流程中非常關鍵的環節。一般來說，會有專門的解決方案來處理這些問題。OIDC和SAML都是為這個目的而設計的標準協議，它們提供一個集中式的方法來驗證使用者身份，並界定他們可以訪問哪些資源或執行哪些操作。",[97],"1. Open ID Connect (OIDC)：","  OIDC vs SAML  在這部分，我們將探討OIDC和SAML。正如前一章節所提，身分驗證和授權是整個安全流程中非常關鍵的環節。一般來說，會有專門的解決方案來處理這些問題。OIDC和SAML都是為這個目的而設計的標準協議，它們提供一個集中式的方法來驗證使用者身份，並界定他們可以訪問哪些資源或執行哪些操作。  1. Open ID Connect (OIDC)：  OIDC是一個建立在OAuth 2.0之上的身分認證層。OAuth 2.0本身是一個專注於授權的框架，而OIDC則在這個基礎上增加了身分驗證功能。這樣，應用程式不僅能知道使用者有哪些權限，還能瞭解使用者是誰，並獲取他們的基本資訊，比如名稱和電子郵件地址。  a. OAuth 2.0  OAuth 2.0 是一個授權框架，允許第三方應用程式在使用者同意的情況下存取使用者在某個服務上的資訊，而不需要分享使用者的密碼。通常在OAuth 2.0，會有幾個角色，我們這邊舉一個簡單情境，你希望使用「快速日記」App，而這個App提供使用Google帳戶登入的功能來使用Google雲端硬碟服務。   Resource Owner(資源擁有者) : 通常就是User(你)， 能授予應用程式取得受保護資料的人，通常就是終端使用者（end-user）。例如你希望使用「快速日記」App，而這個App提供使用Google帳戶登入的功能。在OAuth的流程中，當App請求許可存取你的資料時，你會給予（或拒絕）這個請求。  Resource Server(Resource Server) : 存放使用者受保護資料的伺服器，以這個例子來說就是Google雲端硬碟，當「快速日記」App希望保存或讀取日記時，它會向此伺服器提出請求。  Client (客戶端)：通常指稱想要取得受保護資源的「應用程式」，以這個例子來說就是「快速日記」App。 當「快速日記」App希望保存或讀取日記時，它會向此伺服器提出請求。  Authorization Server (授權伺服器) : 驗證 Resource Owner 的身份，並且在獲得同意之後，發放「Access Token」給應用程式（Client）的伺服器。以這個例子來說就是 (Google的授權伺服器)。  下圖整個驗證Flow  \n   驗證Flow     Client 到 Resource Owner :   Request Credentials : 當你打開「快速日記」App並選擇使用Google帳戶登入時，App首先會引導你到Google的登入頁面。  Authenticate : 你將在Google的頁面上輸入你的Google帳戶憑證，即用戶名和密碼。這一步是由Google完成的，而「快速日記」App不會看到或知道你的密碼。  Consent : 一旦驗證成功，Google會顯示一個請求同意頁面。在這裡，Google會詢問你是否允許「快速日記」App訪問特定的Google帳戶資料。  Credentials : 「Resource Owner」（使用者）提供的身份資訊或某種用於辨識其身份的資料。這只是一個授權請求，而實際的身份驗證會在Resource Owner和Authorization Server之間完成。    Client 到 Authorization Server   Authorization Request : 如果你同意上述的權限請求，「快速日記」App會從Google的授權伺服器請求一個授權碼。  Authorization Code : Google的授權伺服器會回傳一個短暫的授權碼給「快速日記」App。  Access Token : ，「快速日記」App會使用這個授權碼再次向Google的授權伺服器請求取得訪問令牌（Access Token）。    Client 到 Resource Server   Access Token: 一旦取得訪問令牌，「快速日記」App便可以使用此令牌來存取Google雲端硬碟（或其他你同意的資料）。  Protected Resource: 當「快速日記」App希望保存或讀取日記時，它會使用這個Access Token向Google雲端硬碟（作為資源伺服器）提出請求，然後Google雲端硬碟會根據該令牌提供相對應的資料或服務。  更詳細的其實還有關係到Redirect部分，可以參照這篇   https://cloudsundial.com/salesforce-oauth-flows  寫得還算詳細。  ",{"id":100,"path":101,"dir":86,"title":102,"description":9,"keywords":103,"body":105},"content:5.keycloak:3.關於SSO.md","/keycloak/sso","關於SSO",[104],"三、SSO 簡述","  三、SSO 簡述  OIDC和SAML討論完後，我們來聊聊單一登入（SSO）。SSO是一個身份驗證方案，它讓使用者能透過一次登入就可訪問多個應用程式和網站。簡而言之：   透過單一的登入窗口，進行單一的身分驗證，就可以讓許多的服務共同來使用這個驗證結果  OIDC和SAML都可以實現這樣的SSO功能。舉例來說，假設你在工作中要使用三個不同的平台：   郵件系統（Email System）  公司內部網站（Intranet）  報表和數據分析平台（Analytics Platform）  通常你得記住這三個系統各自的帳號和密碼。但有了SSO，你只需透過一個統一的登入界面（比如由Keycloak管理）登入一次，然後就能自由地訪問這三個不同的平台，無需再逐一輸入帳號和密碼。  總之，SSO幫你將多個獨立的系統集成為單一的入口點。這樣不僅減少了你需要記住多組密碼的困擾，還降低了由於多個系統各自存儧行密碼所帶來的安全風險。  流程範例大致如下：   Step1(箭頭1) : 用者首先訪問「Application 01」的 URL 並按下登入按鈕，然後會被引導到 Keycloak 登入頁面。  Step2: 用戶在 Keycloak 成功登入後，將被重新導向回「Application 01」的主頁。  Step3(箭頭3): 如果用戶在合理的時間內再次訪問「Application 02」，則不需要重新登入。  箭頭2實際上是指示用戶從「應用程式01」被引導到Keycloak的登入頁面這一過程。簡單來說，當用戶嘗試在「應用程式01」登入（箭頭1）後，他們會被重定向到Keycloak以完成身份驗證（箭頭2）。  ",{"id":107,"path":108,"dir":86,"title":109,"description":110,"keywords":111,"body":113},"content:5.keycloak:4.Keycloak Introduce.md","/keycloak/keycloak-introduce","Keycloak Introduce","我們剛才談到實現SSO（單一登入）的功能，那麼現在問題來了：有沒有一個工具或平台能讓我們更方便地實現這一切呢？答案是有的，那就是Keycloak。Keycloak是一個集成了多種身份驗證和授權機制（包括OIDC和SAML）的開源身份和訪問管理解決方案。",[112],"2. Keycloak 細部解析","  Keycloak Introduce  我們剛才談到實現SSO（單一登入）的功能，那麼現在問題來了：有沒有一個工具或平台能讓我們更方便地實現這一切呢？答案是有的，那就是Keycloak。Keycloak是一個集成了多種身份驗證和授權機制（包括OIDC和SAML）的開源身份和訪問管理解決方案。  Keycloak的特點如下   多協議支持: Keycloak支持OIDC和SAML，所以你不必為了不同的應用而選擇不同的解決方案。  易於管理: Keycloak有一個使用者友善的管理界面，你可以輕鬆設定用戶、角色和權限。  靈活性: 它是開源的，意味著你可以根據自己的需要對它進行定制。  詳細提供以下功能   身分驗證(Authentication)   單點登入/登出（Single Sign-On/Single Sign-Out）: 讓使用者只需登入一次，就能訪問多個不同的應用和服務。  多因素認證（Multi-Factor Authentication, MFA）: 除了密碼外，還可以透過SMS、郵件或其他方法進行身份驗證。  支持外部身分源: AD，LDAP，Social Login(Google, FB...)。  使用者管理（User Management）   使用者身分 CRUD（Create, Read, Update, Delete）: 簡單地管理使用者資訊，包括建立、查詢、更新和刪除。  屬性管理（Attribute Management）: 可以給使用者賬戶添加多種屬性和標籤。  使用者分組（User Grouping）: 組織使用者到不同的群組以方便管理。  授權（Authorization）   Role-Based Access Control(RBA）: 基於角色給予使用者不同的訪問權限。  Attribute-Based Access Control(ABAC）: 根據使用者的特定屬性（如年齡、部門等）來給予權限。  User-based Access Control (UBAC) : 直接對個別用戶賦予權限，而不是通過角色或屬性。這在只有少數用戶需要訪問特定資源的情況下特別有用。  Context-based Access Control (CBAC) : 更動態的授權方式，考慮到目前的情境或環境狀況（如目前正在執行的操作，或者資源的當前狀態）來做出授權決策。  Rule-based Access Control (Using JavaScript) : 使用 JavaScript 程式碼來定義特定的授權規則。這是一個非常靈活的方式，可以根據極其特定的需求來制定授權策略。  Time-based Access Control : 依據時間來決定是否允許訪問，例如只有工作時間允許訪問某個資源。  Support for custom Access Control Mechanism (ACMs) through a Service Provider Interface (SPI) : 高度定制的選項，允許你通過 Service Provider Interface (SPI) 來實現自己的授權機制。這對於需要非常特殊授權邏輯的場景來說是一個非常強大的工具。  安全性（Security）   密碼政策（Password Policies）: 可以設定密碼的複雜度、有效期等。  會話管理（Session Management）: 查看和管理當前活躍的使用者會話。  應用安全（Client Security）: 對接入的客戶端進行安全設定和驗證。  其他   事件監控（Events Monitoring）: 監控和記錄關於認證、授權等的事件。  擴展性（Extensibility）: 支持自定義插件和腳本，以擴展基礎功能。  2. Keycloak 細部解析  a. Keycloak Core  為了充分利用Keycloak，並根據我們的需求進行客製化，我們必須了解其核心組件以及它們是如何互動的。以下為Keycloak Core Block圖     Realm:master：可想像成一個隔離的命名空間，裡面有你的使用者、角色、客戶端等資料。你可以有多個Realm，每個Realm都有其獨立的設定。\n   Client：代表需要與Keycloak進行互動的應用程式或服務。像是網頁應用或API。這些客戶端會使用Keycloak進行身份驗證。  Roles：確定使用者在Client中可以執行哪些操作。  Security Defense：確保Realm的安全性，例如對抗暴力攻擊或強化密碼政策。  User Federation：允許你把外部的使用者來源（如LDAP）連接到Keycloak。  Roles：通常用於定義訪問權限。例如，管理員角色可能允許使用者更改系統設定。  Groups：一組使用者的集合，有助於管理與分配角色。  Events：記錄Keycloak的所有活動，如誰何時登錄或更改設定。  Users：這是指註冊到Realm的使用者。他們可以有不同的角色或屬於不同的群組。  Identity Provider (IdP)：確認使用者身份的部分，允許使用者用像是Google或Facebook這類的外部服務進行登錄。  核心和外部區塊的互動部分。例如，當一個使用者使用Twitter賬號登錄時，Twitter會和Keycloak中的Identity Provider互動，然後IdP再與Realm互動，確認使用者的身份並賦予他適當的角色和權限。  另外這邊稍微提一下Realm裡面的Roles跟外部的Roles有什麼不同   Realm裡面的Roles (Realm-level Roles)：這些角色是直接相對於Realm本身的。一旦你在Realm中定義了一個角色，你就可以將它指派給任何Realm內的使用者。它們通常是更通用的，例如“管理員”或“使用者”，並且可以跨多個客戶端使用。  外部的Roles (Client-level Roles)：這些角色是相對於特定的客戶端（應用程式或服務）的。所以它們是在特定客戶端的上下文中定義和使用的。允許你為每個應用程式定制更具體的角色。例如，你可能有一個\"編輯\"角色在你的CMS系統中，而有一個\"購物者\"角色在你的電商網站中。  簡單來說，Realm內的角色是全域性的，可以在整個Realm中使用，而Client-level角色是特定於某個應用程式的。  b. Kyecloak 角色  使用Keycloak服務時，裡面有幾種角色必須釐清他們的關係   Realm : 每一個Realm在Keycloak中都代表了一個獨特的命名空間或領域。在同一個Keycloak實例中，不同的Realm之間的資料和設定是完全隔離的。例如，行銷部門和研發部門可能有不同的應用程式和使用者，因此他們可以在不同的Realm中被管理。某種程度有點像Project概念。   設定 : 每個Realm都有自己獨特的設定，包括但不限於認證策略、令牌生命週期、SMTP設定等。這意味著你可以為不同的組織或專案客製化其身份和訪問管理策略。  使用者和客戶端 : 每個Realm內都有其專屬的Users和Clients。例如，兩個不同的Realm之間的Users是不可以交互認證的。  事件和審計 : 可以為每個Realm單獨配置事件和審計策略，以追踪和記錄Realm內的活動。  Clients : 通常代表你想要與Keycloak整合的應用程式或服務。定義了如何與那些應用程式或服務進行交互，包括認證方法、回調URL等。例如有一個Web應用程式和一個手機應用程式，兩者都需要身份驗證。在這種情況下，你可以為每個應用程式設定一個Client，並為它們設定不同的認證流程或訪問限制。   設定 : Clients的設定包括如何與其進行認證的具體細節，例如回調URL、認證方法、封裝方法等。包含協議，可能是OpenID Connect、SAML 2.0。  角色 : 你可以在每個Client裡設置特定的角色，這些角色可以賦予給使用者，以決定他們在該Client中可以進行哪些操作。  Users : Users基本上是真實的個體，如員工或客戶。   設定 : 在Keycloak中，User的憑證（如密碼）是存儲在User的設定中。但是，具體的認證流程（例如，如何驗證這些憑證）是由Client來定義的。  與Client的關係 : Users在Clients中獲得訪問令牌，這些令牌決定了他們在該Client中可以進行哪些操作。例如，一個User可能在一個Client中具有\"讀者\"的角色，在另一個Client中具有\"管理員\"的角色。  Groups : Groups代表了一種組織層次結構，可以將Users組合在一起。這允許管理者更容易地管理大量使用者和其訪問權限。   設定 : 跟Users一樣，Groups也可以有其自己的屬性和設定。例如，你可以為某個Group設定一個特定的屬性，然後所有屬於該Group的Users都可以看到或使用這個屬性。  角色賦予 : 可以將角色賦予給一個Group，然後所有屬於那個Group的Users都會繼承這些角色。  靈活性 : 一個User可以同時屬於多個Group。例如，一個User可能同時是\"研發團隊\"和\"高級工程師\"這兩個Groups的成員。  Role : 角色是一種用於表示使用者或群組所擁有的權限的方式。換句話說，角色定義了使用者或群組可以執行哪些操作或訪問哪些資源。例如，您可能有一個\"管理員\"角色，該角色允許使用者訪問和修改所有資源，而\"編輯者\"角色則可能只允許使用者修改，但不能刪除資源。   設定 : 在Keycloak中，角色可以分配給單個使用者或群組。當使用者試圖訪問某個資源或執行某個操作時，系統會檢查他們所分配的角色是否具有所需的權限。  角色的類型：Realm比較偏向Keycloak設定管理權限，客戶端角色比較偏向客戶端API使用權限。  Realm角色：可分配給Realm中的任何使用者或群組。例如，Realm範疇的\"管理員\"角色允許使用者管理整個Realm的設定。  客戶端角色：只能分配給特定客戶端的使用者或群組。例如，一個\"編輯器\"角色在\"新聞應用程式\"客戶端可能意味著使用者可以發布新的新聞文章，但在另一個\"帳單系統\"客戶端，相同的\"編輯器\"角色可能有完全不同的權限。  最後稍微用圖舉個他們關係的例子     Client：在此領域中的應用程式或服務，用戶會透過它進行認證。  Role 1, 2, 3, 4：這些是在該Realm中定義的角色。角色通常代表某些權限或能力。  Users：代表該Realm中的所有用戶。  Group 1, 2, 3… n：代表不同的用戶群組。每個群組可能有不同的權限和角色。  User 1：當此用戶登入時，被賦予了Role 1角色，並且是Group 1, Group 2, 和 Group 3的成員。 而 User 2 用戶登入時，被賦予了Role 2角色，並且是Group 2, Group 3, 和 Group 5的成員。最後User 3 用戶登入時，會被賦予了Role 4角色，並且是Group 2, Group 3, Group 4, 和 Group 5的成員。  可以看到Keycloak如何將角色和群組賦予用戶。這有助於管理哪些用戶可以訪問哪些資源，以及他們可以執行哪些操作。此外，通過將用戶分組，可以輕鬆地管理大量用戶的權限，而不必逐一配置。",{"id":115,"path":116,"dir":117,"title":118,"description":9,"keywords":119,"body":9},"content:100.ironman-gcp:Cloud.md","/ironman-gcp/cloud","ironman-gcp","Cloud",[],{"id":121,"path":122,"dir":123,"title":124,"description":125,"keywords":126,"body":127},"content:101.license:1.ACE.md","/license/ace","license","ACE [模擬考題]","For Taipei Cathy Bank Cloud AP Group一起整理",[],"  ACE [  模擬考題 ]  For Taipei Cathy Bank Cloud AP Group一起整理     Every employee of your company has a Google account. Your operational team needs to manage a large number of instances on Compute Engine. Each member of this team needs only administrative access to the servers. Your security team wants to ensure that the deployment of credentials is operationally efficient and must be able to determine who accessed a given instance. What should you do?     A. Generate a new SSH key pair. Give the private key to each member of your team. Configure the public key in the metadata of each instance.\n  B. Ask each member of the team to generate a new SSH key pair and to send you their public key. Use a configuration management tool to deploy those keys on each instance.\n  C. Ask each member of the team to generate a new SSH key pair and to add the public key to their Google account. Grant the compute.osAdminLogin role to the Google group corresponding to this team.\n  D. Generate a new SSH key pair. Give the private key to each member of your team. Configure the public key as a project- wide public SSH key in your Cloud Platform project and allow project-wide public SSH keys on each instance.\n  \n    解題  答案為C，基本上就是考IAM帳戶管理控制  公司每位員工都有Google帳戶，而運營團隊需要管理大量的Compute Engine實例。每位團隊成員都需要對這些虛擬機器有管理權限，但只限於管理權限，不需要其他額外的權限。希望部署這些訪問權限的方式要高效，且之後能追踪到哪位員工訪問了特定的實例。   A.生成一個新的SSH密鑰對，將私鑰給團隊的每個成員，並在每個實例的元數據中配置公鑰。這種方法的問題在於所有成員共享相同的私鑰，這不僅安全風險高，而且無法追蹤具體人員的訪問。  B.要求團隊的每個成員生成一個新的SSH密鑰對並將他們的公鑰發給你。使用配置管理工具在每個實例上部署這些密鑰。這個方法能夠實現每個成員都有自己的密鑰，從而提高安全性並能追蹤到每個人的訪問，但部署公鑰的過程可能會比較繁瑣。  C.要求團隊的每個成員生成一個新的SSH密鑰對並將公鑰添加到他們的Google帳戶中。給予對應這個團隊的Google群組compute.osAdminLogin角色。這個方法不僅確保了每個成員都有自己的密鑰，還利用了GCP的IAM（Identity and Access Management）功能來管理訪問權限，同時也簡化了密鑰的部署過程。  D. 生成一個新的SSH密鑰對，將私鑰給團隊的每個成員，在你的Cloud Platform項目中配置公鑰為項目範圍內的公開SSH密鑰，並允許在每個實例上使用項目範圍的公開SSH密鑰。這個選項同樣存在A選項的問題，即共享私鑰並不能追蹤到具體個人。     You need to create a custom VPC with a single subnet. The subnet's range must be as large as possible. Which range should you use?   A. 0.0.0.0/0\nB. 10.0.0.0/8\nC. 172.16.0.0/12\nD. 192.168.0.0/16\n  \n    解題  答案為B，考CIDR（Classless Inter-Domain Routing）  詢問如何在Google Cloud Platform（GCP）上創建一個自定義虛擬私有雲（VPC）並設定一個單一子網，使得這個子網的IP範圍盡可能大。   A. 0.0.0.0/0 - 這個範圍代表所有可能的IPv4地址，但它不是一個實際可用於子網的範圍，因為它用於特殊目的（例如路由規則中表示任何地址）。  B. 10.0.0.0/8 - 這個範圍在私有地址空間中是可用的，並且提供了最大的IP地址範圍，大約有16777216個可用地址（2^24）。這是一個廣泛用於大型網絡的範圍。 (/8表示前8位是網絡地址，剩下的24位（32-8=24）是主機地址。所以，可以有224224個可能的地址。)  C. 172.16.0.0/12 - 這也是私有地址空間的一部分，但提供的地址數量少於10.0.0.0/8範圍，大約有1048576個可用地址（2^20）。(/12表示前12位是網絡地址，剩下的20位（32-12=20）是主機地址。所以，可以有220220個可能的地址。)  D. 192.168.0.0/16 - 這個範圍同樣屬於私有地址空間，提供的IP地址數量更少，大約有65536個可用地址（2^16）。(/16表示前16位是網絡地址，剩下的16位（32-16=16）是主機地址。所以，可以有216216個可能的地址。)     You want to select and configure a cost-effective solution for relational data on Google Cloud Platform. You are working with a small set of operational data in one geographic location. You need to support point-in-time recovery. What should you do?   A. Select Cloud SQL (MySQL). Verify that the enable binary logging option is selected. \nB. Select Cloud SQL (MySQL). Select the create failover replicas option.\nC. Select Cloud Spanner. Set up your instance with 2 nodes.\nD. Select Cloud Spanner. Set up your instance as multi-regional.\n \n   \n    解題  答案是A，考Cloud SQL 及對 Cloud Spanner 選用上認知  這個問題是關於在Google Cloud Platform（GCP）上選擇和配置一個成本效益高的關聯式數據存儲解決方案。考慮的情境是你正在處理一個小型的運營數據集，而且這些數據只需要在一個地理位置存儲。此外，你需要支持點時間恢復（Point-in-Time Recovery, PITR），這意味著你需要能夠恢復到數據庫在過去任何一個特定時間點的狀態。   A. 選擇Cloud SQL (MySQL)。確保選擇了啟用二進制日誌記錄選項。   Cloud SQL是一個完全管理的關聯式數據庫服務，支持MySQL等流行的數據庫系統。啟用二進制日誌記錄是支持點時間恢復的一個要求，因為它可以記錄數據庫的所有更改，從而允許恢復到特定的時間點。   B. 選擇Cloud SQL (MySQL)。選擇創建故障轉移副本選項。   創建故障轉移副本提高了數據庫的可用性和災難恢復能力，但它不直接與支持點時間恢復的需求相關。   C. 選擇Cloud Spanner。設置你的實例為2個節點。   Cloud Spanner是一個完全管理的、水平可擴展的關聯式數據庫服務，支持全球分佈的數據庫和強一致性。但對於一個小型數據集且只在一個地理位置的需求來說，Cloud Spanner可能是一個過於昂貴的選項，尤其是當只需要點時間恢復這一特定功能時。   D. 選擇Cloud Spanner。設置你的實例為多區域。   這個選項提供了高可用性和災難恢復能力，但與C選項一樣，對於小型數據集來說，這是一個成本較高的解決方案，並且超出了只需要一個地理位置存儲的需求。     You want to configure autohealing for network load balancing for a group of Compute Engine instances that run in multiple zones, using the fewest possible steps. You need to configure re-creation of VMs if they are unresponsive after 3 attempts of 10 seconds each. What should you do?   A. Create an HTTP load balancer with a backend configuration that references an existing instance group. Set the health check to healthy (HTTP)\nB. Create an HTTP load balancer with a backend configuration that references an existing instance group. Define a balancing mode and set the maximum RPS to 10.\nC. Create a managed instance group. Set the Autohealing health check to healthy (HTTP)\nD. Create a managed instance group. Verify that the autoscaling setting is on.\n \n   \n    解題  答案是C， ref :   https://cloud.google.com/compute/docs/tutorials/high-availability-autohealing  這題考的是如何在Google Cloud Platform上為運行在多個區域的Compute Engine實例群組配置網絡負載均衡的自動修復功能，並且要求用盡可能少的步驟完成。自動修復功能能夠檢測到實例因無響應而失效時自動重新創建實例。具體來說，題目要求配置系統在實例經過3次每次10秒的嘗試無響應後進行重新創建。   A. 創建一個HTTP負載均衡器，並且配置後端參照一個現有的實例群組。設置健康檢查為健康(HTTP): 這個選項設置了HTTP負載均衡器並使用健康檢查，但是主要聚焦在流量分配而非自動修復。  B. 創建一個HTTP負載均衡器，並且配置後端參照一個現有的實例群組。定義一個平衡模式並設置最大RPS為10: 這個選項同樣是設置HTTP負載均衡器，聚焦在處理請求的能力上，與自動修復無關。  C. 創建一個管理的實例群組。設置自動修復健康檢查為健康(HTTP): 這個選項直接指向了自動修復的需求，通過在管理的實例群組中設置健康檢查來達到當實例無響應時自動重新創建的目標。  D. 創建一個管理的實例群組。驗證自動擴展設置是否開啟: 雖然這個選項涉及到管理的實例群組，但是它聚焦在自動擴展上，與問題中要求的自動修復功能不直接相關。     You are using multiple configurations for gcloud. You want to review the configured Kubernetes Engine cluster of an inactive configuration using the fewest possible steps. What should you do?   A. Use gcloud config configurations describe to review the output.\nB. Use gcloud config configurations activate and gcloud config list to review the output. \nC. Use kubectl config get-contexts to review the output.\nD. Use kubectl config use-context and kubectl config view to review the output.\n \n    \n    解題  答案是D，考gcloud config指令在GKE上應用  如何在使用Google Cloud SDK（gcloud）的多配置環境中，用最少的步驟審查一個不活躍配置下的Kubernetes Engine集群配置。   A. 使用gcloud config configurations describe來審查輸出。 這個命令用於顯示當前或指定配置的詳細信息，但不直接針對Kubernetes Engine集群的配置。  B. 使用gcloud config configurations activate命令可以切換到一個特定的配置，然後使用gcloud config list可以查看當前激活配置的詳細設置。這個方法直接關聯到gcloud工具和Google Cloud平台的配置，但它更多地是關於查看gcloud CLI的配置，而不直接指向Kubernetes Engine集群的具體配置。  C. kubectl config get-contexts命令顯示所有可用的上下文。每個上下文代表一個連接到特定Kubernetes集群的設定。這個命令快速顯示了所有配置的上下文，但它不切換到這些上下文或直接審查它們的細節。  D. kubectl config use-context允許你切換到一個特定的Kubernetes上下文（這個上下文可能是指向一個特定的Kubernetes Engine集群），而kubectl config view能夠讓你查看當前的kubectl配置，包括與所選上下文相關的配置。這對於審查Kubernetes Engine集群的配置來說，是一種更直接的方法。     Your company uses Cloud Storage to store application backup files for disaster recovery purposes.\nYou want to follow Google's recommended practices. Which storage option should you use?   A. Multi-Regional Storage\nB. Regional Storage\nC. Nearline Storage\nD. Coldline Storage\n \n   \n    解題  答案是D, 考對Storage認知，基本上題目提到備份檔案，代表要存取的資料時長時間不會去異動他的，所以答案選Coldline Storage(D)。  使用雲端儲存來儲存應用程式的備份檔案，目的是為了災難恢復。並且遵循Google的建議做法。當我們說備份檔案是為了diaster恢復，這意味著這些文件不太可能經常被存取，但在必要時需要能迅速取得。   A. 資料會分散儲存在多個區域中，主要適用於那些需要在全球多個地點進行高頻率存取的數據。適用情境: 如果你有一個網站或應用，並希望全球的用戶都能快速存取資料。  B. 資料僅儲存在特定的區域中。這意味著它比多區域儲存更有地域性，但同時也具有高的存取速度。適用情境: 如果你的應用或服務主要是針對某一特定地理區域的用戶，例如只在亞洲。  C. 是一種低成本的儲存方式，適用於那些你不經常需要存取，但當需要時，你希望能在數秒內獲取的數據。適用情境: 假設你有一些資料，大概每月需要查看或使用一次。可選擇Nearline Storage  D. 用於那些很少存取的資料，但可能在未來需要它們。成本非常低，但取得資料時可能需要較長的時間。適用情境: 如果你有需要長期保存但很少存取的資料，例如備份或檔案存檔，那麼冷儲存是個好選擇。     Several employees at your company have been creating projects with Cloud Platform and paying for it with their personal credit cards, which the company reimburses. The company wants to centralize all these projects under a single, new billing account. What should you do?   A. Contact cloud-billing@google.com with your bank account details and request a corporate billing account for your company.\nB. Create a ticket with Google Support and wait for their call to share your credit card details over the phone.\nC. In the Google Platform Console, go to the Resource Manage and move all projects to the root Organizarion.\nD. In the Google Cloud Platform Console, create a new billing account and set up a payment method.\n \n    \n    解題  答案為D  探討的是如何將一個公司內多個員工為了工作目的而分別使用個人信用卡支付的Google雲端平台（GCP）項目，統一到一個公司的計費帳戶下。這樣做的目的是為了讓公司能夠更有效地管理雲端資源的費用和項目，避免個別員工需要先行支付然後再報銷的不便和風險。   A. 聯絡Google的計費部門的電子郵件地址，並提供你的銀行帳戶詳細資訊，請求為公司建立一個企業計費帳戶。  B. 通過創建支持票務並等待通話來分享信用卡詳細資訊。這個選項在處理計費問題時通常不是推薦的做法，因為涉及到信用卡資訊的共享應該通過安全的方法進行。  C. 在Google雲端平台控制台中，前往資源管理器並將所有項目移至根組織。這個選項解決了項目組織的問題，但並未直接解決計費帳戶的統一問題。  D. 在Google雲端平台控制台中創建一個新的計費帳戶並設置支付方式。這是解決問題的直接方法，允許公司設置一個中央計費帳戶並將所有現有和未來的項目關聯到這個帳戶。這樣，公司可以直接管理所有雲端資源的費用，而不需要員工個別支付並求報銷。     You have an application that looks for its licensing server on the IP 10.0.3.21. You need to deploy the licensing server on Compute Engine. You do not want to change the configuration of the application and want the application to be able to reach the licensing server. What should you do?   A. Reserve the IP 10.0.3.21 as a static internal IP address using gcloud and assign it to the licensing server.\nB. Reserve the IP 10.0.3.21 as a static public IP address using gcloud and assign it to the licensing server.\nC. Use the IP 10.0.3.21 as a custom ephemeral IP address and assign it to the licensing server.\nD. Start the licensing server with an automatic ephemeral IP address, and then promote it to a static internal IP address\n \n    \n    解題  答案為A  有一個應用程式，該應用程式依賴於一個具有固定IP地址（10.0.3.21）的伺服器。你需要在Google Compute Engine上部署這個伺服器，而且不希望更改應用程式的配置。你應該怎麼做才能讓應用程式能夠正確地連接到這個伺服器？   A. 此選項建議使用gcloud命令行工具預先保留10.0.3.21作為靜態內部IP地址，並將其分配給認證伺服器。  B. 此選項建議使用gcloud工具將10.0.3.21保留為靜態公共IP地址。  C. 使用10.0.3.21作為臨時（ephemeral）IP地址  D. 建議首先使用自動分配的臨時IP啟動認證伺服器，然後再將其提升（或更改）為靜態內部IP地址。  上述四個選項以A的設定，就算VM重啟，IP地址也會保持不變。其餘三個，B實作上不建議使用公用IP，C的話臨時IP會在虛擬機重啟或停止會更動，最後D在VM啟動後，還需要進行額外的步驟更改IP地址。選項A是最好的解決方案，因為它確保了即使虛擬機器重啟，IP地址也會保持不變。而且它使用的是內部IP，適合於內部應用程式和伺服器之間的通信。     You are deploying an application to App Engine. You want the number of instances to scale based on request rate. You need at least 3 unoccupied instances at all times. Which scaling type should you use?   A. Manual Scaling with 3 instances.\nB. Basic Scaling with min_instances set to 3.\nC. Basic Scaling with max_instances set to 3\nD. Automatic Scaling with min_idle_instances set to 3.\n \n    \n    解題  D、ref:  https://cloud.google.com/appengine/docs/legacy/standard/python/how-instances-are-managed  題目希望您選擇一個scale策略，使應用程式的Instance可以基於請求速率自動調整，而且任何時候都至少有3個未被使用的實例。   A. 手動設定要運行的實例數量，不考慮當前的請求量。  B. 基本Scale基於請求速率和其他指標進行伸縮，但它也允許您設定最小實例數量。  C. 設定最多只能有3個實例運行，這不符合題目要求始終有3個“未被使用”的實例。  D. 自動伸縮允許實例數量根據實際的請求負載動態調整。  答案D，這題很明顯D為Automatic Scaling，字面上意思就是確保了有3個始終未被使用的實例，並且會根據請求速率自動調整其他實例數量。稍微提一下min_instances與min_idle_instances不一樣。min_instances只保證至少有3個實例運行，不管它們是否處於空閒狀態。min_idle_instances確保有3個實例始終處於空閒狀態，所以隨時可以開始處理新的請求。   補充：\nAn instance of an auto-scaled service is always running. \nHowever, an instance of a manual or basic scaled service can be either running or stopped. \nAll instances of the same service and version share the same state.\n     You have a development project with appropriate IAM roles defined. You are creating a production project and want to have the same IAM roles on the new project, using the fewest possible steps. What should you do?   A. Use gcloud iam roles copy and specify the production project as the destination project.\nB. Use gcloud iam roles copy and specify your organization as the destination organization.\nC. In the Google Cloud Platform Console, use the 'create role from role' functionality.\nD. In the Google Cloud Platform Console, use the 'create role' functionality and select all applicable permissions\n \n    \n    解題  A  如何最有效地在新的專案中複製或遷移既有的IAM角色設定。   A. 使用gcloud iam roles copy並指定生產專案作為目標專案。 這個選項建議使用gcloud命令行工具來直接複製一個角色到另一個專案。  B. 使用gcloud iam roles copy並指定你的組織作為目標組織。 這個選項也是使用gcloud命令行工具，但是建議將角色複製到整個組織範圍，這樣所有專案都能夠繼承這個角色。  C. 在Google Cloud Platform Console中，使用'create role from role'功能。 這個選項建議在GCP控制台中使用一個具體功能來從一個現有角色創建一個新角色。  D. 在Google Cloud Platform Console中，使用'create role'功能並選擇所有適用的權限。 這個選項建議手動在GCP控制台中創建一個新角色，並從頭開始選擇所需的權限。  答案是A，C沒有這個指令     You need a dynamic way of provisioning VMs on Compute Engine. The exact specifications will be in a dedicated configuration file. You want to follow Google's recommended practices. Which method should you use?   A. Deployment Manager\nB. Cloud Composer\nC. Managed Instance Group\nD. Unmanaged Instance Group\n \n   \n    解題  A  這個問題是關於在Google Cloud Platform（GCP）上動態配置和管理虛擬機（VMs）的最佳方法。特別是，它詢問如何根據一個專門的配置文件準確地配置VMs，同時遵循Google推薦的實踐。  A. Deployment Manager 已經於2022年終止服務，官方建議使用KRM 或 Terraform。原使用方法應為配置Yaml使其可以自動建置與增加VM。  B. Cloud Composer基於 Apache Airflow，是一個完全管理的工作流程自動化工具，用於建立、計畫、監控和管理工作流程。比較像在自動化建立GCP相關服務並整合  C. Managed Instance Group (MIG) (Migrate to Virtual Machines) 支持負載均衡、自動擴展和滾動更新，確保指定數量的實例始終是健康的和運行的。例如，如果MIG中的一個實例失效，MIG會自動替換該實例，以維持所需的實例數量。MIG還可以基於CPU使用率或其他指標動態調整實例的數量。  D. Unmanaged Instance Group 允許您組織一組單獨的實例，但不自動管理實例的生命週期。     You have a Dockerfile that you need to deploy on Kubernetes Engine. What should you do?   A. Use kubectl app deploy \u003Cdockerfilename>.\nB. Use gcloud app deploy \u003Cdockerfilename>.\nC. Create a docker image from the Dockerfile and upload it to Container Registry. \n   Create a Deployment YAML file to point to that image. Use kubectl to create the deployment with that file.\nD. Create a docker image from the Dockerfile and upload it to Cloud Storage. \n   Create a Deployment YAML file to point to that image. Use kubectl to create the deployment with that file.\n \n   \n    解題  C,  這個問題是關於如何在Google Kubernetes Engine (GKE) 上部署一個Docker容器。具體來說，它詢問當你有一個Dockerfile時，應該怎麼做才能將它部署到Kubernetes集群中。  A. 使用kubectl app deploy   。 這個命令格式並不正確，kubectl沒有app deploy這個指令。  B. 使用gcloud app deploy   。 這是Google Cloud Platform上的App Engine應用部署命令，用於部署App Engine應用，而不是用於Kubernetes Engine上部署Docker容器。  C. 從Dockerfile創建一個docker映像並將其上傳到Container Registry。創建一個指向該映像的Deployment YAML文件。使用kubectl來用該文件創建部署。 這是一個典型的流程，用於在Kubernetes上部署容器化應用。首先，你需要從Dockerfile構建一個Docker映像，然後將該映像推送到一個容器映像庫（在這裡是Google Container Registry）。接著，你需要創建一個Deployment的YAML配置文件，指定如何運行你的容器映像，最後使用kubectl命令來根據YAML文件創建部署。  D.  從Dockerfile創建一個docker映像並將其上傳到Cloud Storage。創建一個指向該映像的Deployment YAML文件。使用kubectl來用該文件創建部署。 這個選項建議將映像上傳到Google Cloud Storage，但這不是容器映像的標準存儲方式。通常，容器映像應該被推送到一個容器註冊中心，如Google Container Registry或Docker Hub。     Your development team needs a new Jenkins server for their project. You need to deploy the server using the fewest steps possible. What should you do?   A. Download and deploy the Jenkins Java WAR to App Engine Standard.\nB. Create a new Compute Engine instance and install Jenkins through the command line interface.\nC. Create a Kubernetes cluster on Compute Engine and create a deployment with the Jenkins Docker image.\nD. Use GCP Marketplace to launch the Jenkins solution.\n \n   \n    解題  D  您的開發團隊需要一個新的Jenkins伺服器用於他們的專案。您需要使用最少的步驟來部署伺服器。您應該怎麼做？  A. 下載並部署Jenkins Java WAR到App Engine Standard。  B. 創建一個新的Compute Engine實例並通過命令行介面安裝Jenkins。  C. 在Compute Engine上創建一個Kubernetes集群，並使用Jenkins Docker映像創建一個部署。  D. 使用GCP Marketplace啟動Jenkins解決方案。    https://cloud.google.com/solutions/using-jenkins-for-distributed-builds-on-compute-engine     You need to update a deployment in Deployment Manager without any resource downtime in the deployment. Which command should you use?   A. gcloud deployment-manager deployments create --config \u003Cdeployment-config-path>\nB. gcloud deployment-manager deployments update --config \u003Cdeployment-config-path>\nC. gcloud deployment-manager resources create --config \u003Cdeployment-config-path>\nD. gcloud deployment-manager resources update --config \u003Cdeployment-config-path>\n \n    \n    解題  B  如何使用Google Cloud Deployment Manager來更新一個現有部署，同時確保更新過程中不會導致任何資源的停機。Deployment Manager是一個基於資源的配置管理系統，允許你使用模板來自動創建、更新和管理Google Cloud資源。  A: 這個命令用於創建一個新的部署，並不適用於更新現有部署  B: 這個命令用於更新一個現有的部署。如果你的目標是在不停機的情況下更新部署，這是正確的選擇。  C: 這個命令用於創建新資源，而不是更新現有部署。  D: 這個選項不是一個實際存在的命令。在Deployment Manager中，資源的更新是通過更新部署來實現的，而不是直接對資源進行更新。 \n      You need to run an important query in BigQuery but expect it to return a lot of records. You want to find out how much it will cost to run the query. You are using on-demand pricing. What should you do?   A. Arrange to switch to Flat-Rate pricing for this query, then move back to on-demand.\n\nB. Use the command line to run a dry run query to estimate the number of bytes read. Then convert that bytes estimate to dollars using the Pricing Calculator.\n\nC. Use the command line to run a dry run query to estimate the number of bytes returned. Then convert that bytes estimate to dollars using the Pricing Calculator.\n\nD. Run a select count (*) to get an idea of how many records your query will look through. Then convert that number of rows to dollars using the Pricing Calculator.\n \n   \n    解題  B  這個問題是關於如何在使用Google Cloud BigQuery時，事先估算出一個查詢操作的成本。BigQuery是Google Cloud提供的一個大數據分析平台，它允許用戶存儲和查詢大量數據。BigQuery提供兩種計費模式：按需定價（on-demand pricing）和固定費率定價（flat-rate pricing）。按需定價根據查詢處理的數據量計費，而固定費率定價則允許用戶為一定的查詢容量支付固定費用。  A. 安排在這次查詢時切換到固定費率定價，然後再切回按需定價。 這個選項在技術上可行，但對於一次查詢來說過於繁瑣，且並非成本估算的直接方法。  B. 使用命令行運行一次試運行（dry run）查詢來估算讀取的字節數。然後使用定價計算器將這個字節估算轉換成美元。 這是一個有效的方法，因為BigQuery的按需定價是根據查詢分析的數據量來計費的，而不是基於返回的記錄數。這允許用戶在實際運行查詢前獲得成本估算。簡單來說按需定價可以做一個模擬估算的意思。  C. 使用命令行運行一次試運行查詢來估算返回的字節數。然後使用定價計算器將這個字節估算轉換成美元。 這個選項似乎有誤，因為BigQuery的費用是根據查詢過程中掃描的數據量來計算的，而不是基於查詢結果返回的數據量。  D. 運行一個select count (*)查詢來獲得你的查詢將查看多少記錄。然後使用定價計算器將這個行數轉換成美元。 這個方法不適用於估算成本，因為它並不考慮查詢實際上會掃描多少數據。BigQuery的費用計算基於查詢的數據量，而不是結果集的大小。     You have a single binary application that you want to run on Google Cloud Platform. You decided to automatically scale the application based on underlying infrastructure CPU usage. Your organizational policies require you to use virtual machines directly. You need to ensure that the application scaling is operationally efficient and completed as quickly as possible. What should you do?   A. Create a Google Kubernetes Engine cluster, and use horizontal pod autoscaling to scale the application.\nB. Create an instance template, and use the template in a managed instance group with autoscaling configured.\nC. Create an instance template, and use the template in a managed instance group that scales up and down based on the time of day.\nD. Use a set of third-party tools to build automation around scaling the application up and down, based on Stackdriver CPU usage monitoring.\n \n   \n    解題  B  這題在問的是，當你有一個單一的二進制應用程式，並希望在Google Cloud Platform（GCP）上運行這個應用程式時，如何根據底層基礎設施的CPU使用率自動調整應用程式的規模，同時要求操作效率高且迅速完成，而且還要遵循組織政策直接使用虛擬機（VM）。  A. 建立一個 GKE，使用橫向自動擴展設定應用 (題目要求用VM)  B. 建立一個 instance template ，並在 managed instance group 搭配 autoscaling configured 使用該template  C. 建立一個 instance template ，並在 managed instance group 中使用該模板，該 instance group 根據時間進行縮放  D. 使用第三方工具，基於 Stackdriver CPU 監看自動擴縮應用程式  最適合的選項是B：創建一個實例模板，並在一個配置了自動擴展的管理實例群組中使用該模板。這樣可以直接在虛擬機上運行應用程式，並根據CPU使用率自動調整應用程式的規模，符合操作效率高且快速完成的要求。選項C和D提供了基於時間或使用第三方工具的解決方案，這可能不如直接使用GCP內建的功能那樣操作高效且快速。   Instance template（實例模板）是一種Google Cloud Platform（GCP）的資源，用於定義虛擬機實例的配置。當你需要創建許多具有相同配置的虛擬機時，實例模板可以幫助你實現快速且一致的部署。     You are analyzing Google Cloud Platform service costs from three separate projects. You want to use this information to create service cost estimates by service type, daily and monthly, for the next six months using standard query syntax. What should you do?   A. Export your bill to a Cloud Storage bucket, and then import into Cloud Bigtable for analysis.\nB. Export your bill to a Cloud Storage bucket, and then import into Google Sheets for analysis.\nC. Export your transactions to a local file, and perform analysis with a desktop tool.\nD. Export your bill to a BigQuery dataset, and then write time window-based SQL queries for analysis.\n \n    \n    解題  D  這道題目是關於如何使用Google Cloud Platform（GCP）上的工具來分析三個不同項目的服務成本，並基於這些資料來預估未來六個月每種服務類型的日常和月度成本。選項中提供了不同的方法來達成這個目標，問題在於找出最合適的方式。  A. 將你的賬單導出到Cloud Storage桶，然後導入到Cloud Bigtable進行分析。 Cloud Bigtable是一個高效能的NoSQL數據庫服務，適用於大規模數據分析，但它可能不是分析賬單數據最直觀或成本效益最高的選擇。  B. 將你的賬單導出到Cloud Storage桶，然後導入到Google Sheets進行分析。 Google Sheets是一個雲端試算表應用，適合進行較小規模的數據分析和預算規劃，但可能不適合處理大量資料或進行複雜的時間窗口基礎的SQL查詢。  C. 將你的交易記錄導出到本地文件，並使用桌面工具進行分析。 這是一個選項，但它可能不利於自動化或規模化分析，且無法充分利用GCP提供的強大數據處理能力。  D. 將你的賬單導出到一個BigQuery數據集，然後撰寫基於時間窗口的SQL查詢進行分析。 BigQuery是一個企業級的數據倉庫服務，支持快速SQL查詢，非常適合進行大規模數據分析。通過將賬單數據導入BigQuery，你可以利用其強大的分析能力來執行複雜的查詢，如基於時間窗口的成本預估。  選項D是最佳選擇，因為它允許你利用BigQuery的強大查詢能力來分析賬單數據，並預測未來幾個月的服務成本。這種方法支持標準查詢語法，適合進行複雜的時間序列分析，且能夠處理大量數據，非常適合於成本估算的需求。     You need to set up a policy so that videos stored in a specific Cloud Storage Regional bucket are moved to Coldline after 90 days, and then deleted after one year from their creation. How should you set up the policy?   A. Use Cloud Storage Object Lifecycle Management using Age conditions with SetStorageClass and Delete actions. Set the SetStorageClass action to 90 days and the Delete action to 275 days (365-90).\n\nB. Use Cloud Storage Object Lifecycle Management using Age conditions with SetStorageClass and Delete actions. Set the SetStorageClass action to 90 days and the Delete action to 365 days.\n\nC. Use gsutil rewrite and set the Delete action to 275 days (365-90).\n\nD. Use gsutil rewrite and set the Delete action to 365 days.\n  \n    解題  B  如何設定一個策略，使得特定的Cloud Storage區域性儲存桶中的影片檔案在創建後90天自動轉移到Coldline存儲類別，並在創建後一年被自動刪除。  要實現這一點，你需要使用Cloud Storage的物件生命周期管理功能。物件生命周期管理允許你根據指定的條件（例如文件的年齡、存儲類別等）自動執行操作（如刪除文件或改變文件的存儲類別）。這是通過在儲存桶中設定規則來完成的。  A: 使用Cloud Storage物件生命周期管理，根據文件年齡設定SetStorageClass和Delete動作。將SetStorageClass動作設定為90天，Delete動作設定為275天（365-90）。這個選項的計算方法錯誤，因為它假設你需要在轉移後的時間計算刪除動作，但是Delete應該從原始創建日期計算365天。   正確的做法應該是將SetStorageClass動作設定為90天，以將文件轉移到Coldline存儲，然後將Delete動作直接設定為365天，表示從文件創建之日起一年後刪除，無論其是否已被轉移到Coldline存儲。这样，文件在创立90天后转移至Coldline，到达创立365天时被删除，而不是在转移后开始计算删除的时间。  B: 使用Cloud Storage物件生命周期管理，根據文件年齡設定SetStorageClass和Delete動作。將SetStorageClass動作設定為90天，Delete動作設定為365天。這是正確的設定方式，因為它確保了文件在創建後90天轉移到Coldline，並在創建後一年被刪除，無論其在90天時的存儲類別變更。  C 和 D: 使用gsutil rewrite命令並設定Delete動作。這些選項並不支持自動基於檔案年齡轉換存儲類別或自動刪除檔案的功能。     You have a Linux VM that must connect to Cloud SQL. You created a service account with the appropriate access rights. You want to make sure that the VM uses this service account instead of the default Compute Engine service account. What should you do?   A. When creating the VM via the web console, specify the service account under the 'Identity and API Access' section.\n\nB. Download a JSON Private Key for the service account. On the Project Metadata, add that JSON as the value for the key compute-engine-service- account.\n\nC. Download a JSON Private Key for the service account. On the Custom Metadata of the VM, add that JSON as the value for the key compute-engine-service-account.\n\nD. Download a JSON Private Key for the service account. After creating the VM, ssh into the VM and save the JSON under ~/.gcloud/compute-engine-service-account.json.\n \n   \n    解題  A，正確的做法是選項A：在創建VM的過程中，透過網頁控制台，在“身份和API訪問”部分指定你想使用的服務帳戶。這樣做可以確保VM在創建時就配置好了正確的服務帳戶，無需後續手動操作或保存私鑰到VM上，這也是一種更安全的做法。  這題目在詢問當你擁有一台需要連接到Cloud SQL的Linux虛擬機（VM），且已經創建了一個具有適當訪問權限的服務帳戶時，你應該如何配置VM，使其使用這個指定的服務帳戶來代替默認的Compute Engine服務帳戶。  A. 在網頁控制台創建VM時，在“身份和API訪問”部分指定服務帳戶。  B. 為服務帳戶下載一個JSON私鑰。在項目元數據上，將該JSON作為compute-engine-service-account鍵的值添加。  C. 為服務帳戶下載一個JSON私鑰。在VM的自定義元數據上，將該JSON作為compute-engine-service-account鍵的值添加。  D. 為服務帳戶下載一個JSON私鑰。創建VM後，ssh進入VM並將JSON保存在~/.gcloud/compute-engine-service-account.json下。     You created an instance of SQL Server 2017 on Compute Engine to test features in the new version. You want to connect to this instance using the fewest number of steps. What should you do?   A. Install a RDP client on your desktop. Verify that a firewall rule for port 3389 exists.\n\nB. Install a RDP client in your desktop. Set a Windows username and password in the GCP Console. Use the credentials to log in to the instance.\n\nC. Set a Windows password in the GCP Console. Verify that a firewall rule for port 22 exists. Click the RDP button in the GCP Console and supply the credentials to log in.\n\nD. Set a Windows username and password in the GCP Console. Verify that a firewall rule for port 3389 exists. Click the RDP button in the GCP Console, and supply the credentials to log in\n \n    \n    解題  B  當你在Compute Engine上創建了一個SQL Server 2017的實例以測試新版本的功能時，應該如何使用最少的步驟連接到這個實例。  A. 在你的桌面安裝一個RDP（遠端桌面協議）客戶端。確認存在針對端口3389的防火牆規則。  B. 在你的桌面安裝一個RDP客戶端。在GCP控制台設置一個Windows用戶名和密碼。使用這些憑證登入實例。  C. 在GCP控制台設置一個Windows密碼。確認存在針對端口22的防火牆規則。點擊GCP控制台中的RDP按鈕，並提供憑證以登入。  D. 在GCP控制台設置一個Windows用戶名和密碼。確認存在針對端口3389的防火牆規則。點擊GCP控制台中的RDP按鈕，並提供憑證以登入。  在Google Cloud Platform (GCP) 上，Compute Engine提供的Windows映像（Image）預設已經啟用了遠端桌面連線（Remote Desktop Protocol, RDP），且相關的防火牆規則（對於端口3389，即RDP使用的端口）通常也是預設開啟的。這樣的設計是為了讓用戶能夠更容易地開始使用虛擬機實例，無需進行複雜的初始設定。  因此，在這種情況下，當你需要連接到Compute Engine上的SQL Server 2017實例時，主要步驟實際上就是：  在GCP控制台為Compute Engine實例設置Windows用戶名和密碼。這一步是必要的，因為它提供了登入Windows系統的認證。\n使用任何標準的RDP客戶端軟件從你的桌面連接到該實例。由於RDP和對應的防火牆規則已經預設啟用，這一步應該是直接可行的。\n因此，選項B是最合理的選擇，因為它直接指向了實際操作中需要完成的主要步驟，而無需擔心遠端桌面連線或防火牆設置的問題。这样的设计极大地简化了在GCP上部署和管理Windows虚拟机实例的过程。     You have one GCP account running in your default region and zone and another account running in a non-default region and zone. You want to start a new Compute Engine instance in these two Google Cloud Platform accounts using the command line interface. What should you do?   A. Create two configurations using gcloud config configurations create [NAME]. \n  Run gcloud config configurations activate [NAME] to switch between accounts \n  when running the commands to start the Compute Engine instances.\n\nB. Create two configurations using gcloud config configurations create [NAME]. \n  Run gcloud configurations list to start the Compute Engine instances.\n\nC. Activate two configurations using gcloud configurations activate [NAME]. \n  Run gcloud config list to start the Compute Engine instances.\n\nD. Activate two configurations using gcloud configurations activate [NAME]. \n  Run gcloud configurations list to start the Compute Engine instances.\n \n    \n    解題  A  關於如何使用Google Cloud Platform (GCP) 的gcloud命令行工具來管理不同帳戶和配置，並在這些帳戶中啟動(激活)新的Compute Engine實例。   command line interface指得就是gcloud CLI（Command Line Interface）  A: 這個選項提供了一個步驟來管理不同的GCP帳戶或項目的方法。首先，使用gcloud config configurations create   NAME 創建不同的配置文件，每個配置對應一個帳戶或項目。然後，通過gcloud config configurations activate   NAME 來激活特定的配置，這樣就可以在該配置對應的帳戶或項目中運行命令了。這是啟動Compute Engine實例時切換帳戶的有效方法。  B: 這個選項提到了創建配置和列出配置的命令，但沒有提到如何激活特定配置或如何在特定配置下啟動實例的步驀。  C 和 D: 這兩個選項提到了gcloud configurations activate   NAME 和gcloud configurations list命令，但實際上，正確的命令應該是gcloud config configurations activate   NAME 用於激活配置，而gcloud config list可以用來查看當前激活配置的詳細信息。這兩個選項中的命令和步驟描述不準確或不完整。  A是最合適的選項，因為它正確描述了如何創建和激活配置，以及在不同的GCP帳戶或項目中管理和啟動Compute Engine實例的流程。     You significantly changed a complex Deployment Manager template and want to confirm that the\ndependencies of all defined resources are properly met before committing it to the project.\nYou want the most rapid feedback on your changes. What should you do?   A. Use granular logging statements within a Deployment Manager template authored in Python.\nB. Monitor activity of the Deployment Manager execution on the Stackdriver Logging page of the GCP Console.\nC. Execute the Deployment Manager template against a separate project with the same configuration, \n   and monitor for failures.\nD. Execute the Deployment Manager template using the --preview option in the same project, \n   and observe the state of interdependent resources.\n \n   \n    解題  D  GCP 上面建立新的資源，基本上可以下列透過三種方式：   直接在 Web UI 上用瀏覽器操作  Deployment Manager  直接呼叫 GCP 的 API  這題是在詢問，當你對一個複雜的Deployment Manager模板進行了重大更改後，如何在提交到項目之前確認所有定義資源的依賴關係是否得到了妥善處理，以便能夠最快速地獲得對這些更改的反饋。  A. 在Python編寫的Deployment Manager模板中使用細粒度日誌語句。這個方法可以提供一定的反饋，但可能不是最快或最直接的方法來檢查依賴關係是否正確。  B. 在GCP Console的Stackdriver Logging頁面上監控Deployment Manager執行的活動。這同樣可以提供反饋，但是相對間接，且需要等待部署執行。   Stackdriver Logging，現在被稱為Google Cloud's Operations Suite的一部分，是Google Cloud提供的一項服務，用於收集、查看和分析Google Cloud和Amazon Web Services (AWS)上的虛擬機器和應用程式的日誌數據。這項服務支援日誌數據的即時分析，並允許用戶通過強大的搜尋功能來檢索和過濾日誌。它是Google Cloud's Operations Suite的核心組件之一，旨在幫助開發人員和運維團隊監控和診斷跨多種雲服務和應用程式的問題。  C. 對一個具有相同配置的單獨項目執行Deployment Manager模板，並監控是否有失敗發生。這個方法可以提供實際的測試反饋，但是比較耗時且可能影響到其他項目。  D. 使用--preview選項在相同項目中執行Deployment Manager模板，並觀察相互依賴資源的狀態。這個方法可以在不真正執行部署的情況下，快速地提供對依賴關係和配置更改的預覽和驗證。  基於快速獲得反饋的需求，選項D提供了一種在實際提交更改之前，快速檢查和預覽資源依賴關係是否正確的方法。     You are building a pipeline to process time-series data. Which Google Cloud Platform services should you put in boxes 1,2,3, and 4?     A. Cloud Pub/Sub, Cloud Dataflow, Cloud Datastore, BigQuery\nB. Firebase Messages, Cloud Pub/Sub, Cloud Spanner, BigQuery\nC. Cloud Pub/Sub, Cloud Storage, BigQuery, Cloud Bigtable\nD. Cloud Pub/Sub, Cloud Dataflow, Cloud Bigtable, BigQuery\n \n    \n    解題  D  這個題目給出了一個處理時序數據的Google Cloud Platform (GCP)架構圖，要求你選擇適合放入四個標示為1、2、3和4的框中的GCP服務。這些框代表數據流通的不同階段：  數據接收：數據從設備通過閘道器進入GCP。\n數據處理：數據在GCP內部進行處理。\n數據儲存：處理後的數據被存儲起來。\n數據分析：存儲的數據進行分析。   Cloud Pub/Sub: 用於消息傳遞和流式數據的實時傳遞，適合放在1號框中，作為數據的接收點。  Cloud Dataflow: 是一個完全管理的服務，用於轉換和豐富數據在流和批處理模式下，適合放在2號框中，處理數據。  Cloud Storage: 是一個對象存儲服務，用於存儲大量未處理或處理後的數據，適合放在3號框中。  BigQuery: 是一個完全管理的大數據分析平台，適合放在4號框中，進行數據分析。  根據這些描述，正確答案應該是選項D：Cloud Pub/Sub, Cloud Dataflow, Cloud Bigtable, BigQuery。這樣的選擇符合時序數據處理的一般流程：從接收數據（Pub/Sub），到處理數據（Dataflow），再到儲存數據（Bigtable是一種適合時序數據的NoSQL數據庫），最後進行數據分析（BigQuery）。     You have a project for your App Engine application that serves a development environment.\nThe required testing has succeeded and you want to create a new project to serve as your production environment. What should you do?   A. Use gcloud to create the new project, and then deploy your application to the new project.\nB. Use gcloud to create the new project and to copy the deployed application to the new project.\nC. Create a Deployment Manager configuration file that copies the current App Engine deployment into a new project.\nD. Deploy your application again using gcloud and specify the project parameter with the new project name to create the new project.\n \n   \n    解題  這個題目是關於如何在Google Cloud Platform上使用App Engine應用程式，從一個已經存在的開發環境項目（project）創建一個新的生產環境項目。選項中提供了幾種不同的方法來創建新項目並部署應用程式。  A. 使用gcloud命令行工具創建新項目，然後將應用程式部署到新項目中。\nB. 使用gcloud命令行工具創建新項目並將已部署的應用程式複製到新項目。\nC. 創建一個Deployment Manager配置文件，將當前App Engine部署複製到新項目中。\nD. 再次使用gcloud部署應用程式，並指定新項目的項目參數以創建新項目。  正確的做法是選項A。你需要首先創建一個新的項目，然後將你的應用程式部署到這個新項目中作為生產環境。在Google Cloud中，一個項目是最高層級的組織單位，它代表了一組設置和服務資源的集合。你不能直接將一個項目中的應用程式複製到另一個項目，因此選項B和C不可行。同樣地，選項D的描述也不正確，因為你不能通過部署應用程式來創建一個新項目；項目必須先存在才能部署應用程式。  具體作法如下  1.創建新的GCP項目：  使用gcloud命令行工具創建一個新的Google Cloud Platform項目。可以使用下面的命令：   gcloud projects create [YOUR_PROJECT_ID] --name=\"[YOUR_PROJECT_NAME]\"\n\n  其中  YOUR_PROJECT_ID 是你選擇的項目ID（這個ID必須是唯一的），而  YOUR_PROJECT_NAME 是你給項目的名稱。  2.設置計費資訊：  新項目創建後，你需要為它設置計費資訊。這通常需要在Google Cloud Console中手動完成。  3.部署應用程式到新項目：  在你的開發機器上，配置gcloud命令行工具以使用新項目：   gcloud config set project [YOUR_PROJECT_ID]\n  然後部署你的App Engine應用程式到新項目中：   gcloud app deploy [YOUR_APP_YAML_PATH] --project=[YOUR_PROJECT_ID]\n   YOUR_APP_YAML_PATH 是你的App Engine應用程式配置文件的路徑。  4.驗證部署：  部署完成後，檢查應用程式是否正確運行。你可以使用以下命令來瀏覽你的應用程式：   gcloud app browse --project=[YOUR_PROJECT_ID]\n     You need to configure IAM access audit logging in BigQuery for external auditors.\nYou want to follow Google-recommended practices. What should you do?   A. Add the auditors group to the 'logging.viewer' and 'bigQuery.dataViewer' predefined IAM roles.\nB. Add the auditors group to two new custom IAM roles.\nC. Add the auditor user accounts to the 'logging.viewer' and 'bigQuery.dataViewer' predefined IAM roles.\nD. Add the auditor user accounts to two new custom IAM roles.\n\n \n   \n    解題  A  這題在問如何為外部審計人員配置BigQuery的IAM（Identity and Access Management）訪問審計日誌。目的是確保審計人員可以查看日誌和數據，但同時遵循Google推薦的最佳做法。  A. 將審計人員組添加到'logging.viewer'和'bigQuery.dataViewer'這兩個預定義的IAM角色。\nB. 為審計人員組創建兩個新的自定義IAM角色。\nC. 將審計人員的用戶帳戶添加到'logging.viewer'和'bigQuery.dataViewer'這兩個預定義的IAM角色。\nD. 為審計人員的用戶帳戶創建兩個新的自定義IAM角色。  在這些選項中，選項A和C都提到了將審計人員（無論是以組還是個別用戶帳戶的形式）添加到預定義的IAM角色中。'logging.viewer'角色允許用戶查看日誌，而'bigQuery.dataViewer'角色允許用戶查看BigQuery中的數據。  選項B和D提到了創建自定義的IAM角色，這可以提供更細緻的訪問控制，但並非Google推薦的實踐，除非有特定需求。  根據Google的最佳做法，最簡單且推薦的方法是使用預定義的IAM角色，因為它們已經為特定的服務定義了必要的許可權。因此，選項A或C會是合適的選擇。通常建議使用組（選項A）而不是個別用戶帳戶（選項C），因為這樣可以更容易地管理多個審計人員的訪問權限。如果審計人員已經組織在一個Google群組中，那麼將該組添加到這些角色會是最好的做法。     You need to set up permissions for a set of Compute Engine instances to enable them to write data into a particular Cloud Storage bucket. You want to follow Google-recommended practices. What should you do?   A. Create a service account with an access scope. Use the access scope 'https://www.googleapis.com/auth/devstorage.write_only'.\nB. Create a service account with an access scope. Use the access scope 'https://www.googleapis.com/auth/cloud-platform'.\nC. Create a service account and add it to the IAM role 'storage.objectCreator' for that bucket.\nD. Create a service account and add it to the IAM role 'storage.objectAdmin' for that bucket.\n \n   \n    解題  C  為一組Compute Engine實例設置權限，使它們能夠寫入數據到特定的Cloud Storage桶，你應該根據Google推薦的做法進行操作  A. 創建一個服務帳戶並賦予訪問範圍。使用訪問範圍'  https://www.googleapis.com/auth/devstorage.write_only'，這個範圍僅允許寫入訪問權限，不允許讀取或列出桶中的對象。  B. 創建一個服務帳戶並賦予訪問範圍。使用訪問範圍'  https://www.googleapis.com/auth/cloud-platform'，這個範圍賦予對所有Cloud  Platform服務的完整訪問權限。  C. 創建一個服務帳戶，並將其添加到該桶的IAM角色'storage.objectCreator'，此角色賦予服務帳戶向該桶中創建對象的權限。  D. 創建一個服務帳戶，並將其添加到該桶的IAM角色'storage.objectAdmin'，此角色賦予服務帳戶對該桶中對象的完全管理權限，包括讀取、寫入和刪除。  根據Google的最佳做法，最好是遵循最小權限原則，只賦予足夠的權限以完成任務，不多給不必要的權限。因此，選項C（將服務帳戶添加到IAM角色'storage.objectCreator'）是最佳選擇     You have sensitive data stored in three Cloud Storage buckets and have enabled data access logging.\nYou want to verify activities for a particular user for these buckets, using the fewest possible steps.\nYou need to verify the addition of metadata labels and which files have been viewed from those buckets. What should you do?   A. Using the GCP Console, filter the Activity log to view the information.\nB. Using the GCP Console, filter the Stackdriver log to view the information. \nC. View the bucket in the Storage section of the GCP Console.\nD. Create a trace in Stackdriver to view the information.\n \n   \n    解題  A  如何利用Google Cloud Platform (GCP) 的日誌功能來檢查特定用戶對於三個Cloud Storage桶的數據存取活動，特別是要驗證用戶是否添加了元數據標籤以及查看了哪些文件。如果要以最少的步驟完成這個任務，應該採取哪種做法。  A. 使用GCP控制台，過濾「活動日誌」以查看這些信息。\nB. 使用GCP控制台，過濾「Stackdriver日誌」以查看這些信息。   Stackdriver 被整合成現在 GCP Cloud Logging，用來記錄自定義Log。\nC. 在GCP控制台的「存儲」部分查看桶。\nD. 在Stackdriver中創建一個追踪以查看這些信息。  A步驟為  步驟：   登入GCP控制台。  點擊左上角的漢堡菜單（三條橫線）。  在菜單中找到並點擊“Logging”（日誌記錄）。  點擊“Activity log”（活動日誌）標籤。  點擊“Filter”（篩選）按鈕。  在“Resource”（資源）欄位，輸入三個Cloud Storage存儲桶的名稱。  在“User”（用戶）欄位，輸入你想要審核的特定用戶的名稱。  點擊“Apply”（應用）按鈕。  活動日誌會展示這個特定用戶在三個指定Cloud Storage存儲桶上的所有活動記錄。你可以檢視這些記錄以確認是否有添加元數據標籤的動作，以及哪些文件被查看過。  選擇B、C和D不如選擇A高效，因為它們不提供按用戶或資源過濾結果的選項，或者需要較多的步驟和資源來執行。  選擇B提到的操作需要在Stackdriver（現在稱為Google Cloud's operations suite的一部分）中創建追踪。創建追踪可能會比較複雜，並且如果沒有準確的了解如何設定，容易導致錯誤。此外，這個過程相比於直接查看活動日誌，可能更加耗時。  選項C和D提供的方法不允許用戶根據特定的用戶或特定的資源（如特定的Cloud Storage存儲桶）來過濾和查看活動。在驗證特定用戶的行為時，能夠按用戶或資源進行篩選是非常重要的，因為這樣可以直接定位到相關的活動日誌條目。     You are the project owner of a GCP project and want to delegate control to colleagues to manage buckets and files in Cloud Storage. You want to follow Google-recommended practices. Which IAM roles should you grant your colleagues?   A. Project Editor\nB. Storage Admin\nC. Storage Object Admin \nD. Storage Object Creator\n \n   \n    解題  C, 只管Sotrage裡面的東西..所以不會是B  你是一個Google Cloud Platform (GCP)項目的擁有者，並希望將權限委派給同事去管理Cloud Storage中的桶(bucket)和文件(object)，你應該賦予他們哪種IAM(身份及存取管理)角色，以便遵循Google推薦的最佳實踐。  A. Project Editor: 這個角色允許對項目中的資源進行廣泛的修改操作，但它提供的權限範圍比較廣，可能不是最適合細粒度控制Cloud Storage資源的選擇。  B. Storage Admin: 此角色提供對Cloud Storage資源的完全管理許可權，包括創建、刪除桶，以及管理桶內的對象和設置。它是一個適合需要完整控制Cloud Storage資源的情況。  C. Storage Object Admin: 此角色專注於對存儲在桶中的對象進行管理，包括創建、刪除和修改對象。它不提供創建或刪除桶的能力。  D. Storage Object Creator: 這個角色限於允許創建對象（文件）在桶中，但不允許刪除或修改現有對象，適合只需要上傳文件權限的情境。     You have an object in a Cloud Storage bucket that you want to share with an external company.\nThe object contains sensitive data. You want access to the content to be removed after four hours.\nThe external company does not have a Google account to which you can grant specific user-based access privileges. You want to use the most secure method that requires the fewest steps. What should you do?   A. Create a signed URL with a four-hour expiration and share the URL with the company.\n\nB. Set object access to 'public' and use object lifecycle management to remove the object after four hours.\n\nC. Configure the storage bucket as a static website and furnish the object's URL to the company. Delete the object from the storage bucket after four hours.\n\nD. Create a new Cloud Storage bucket specifically for the external company to access. Copy the object to that bucket. Delete the bucket after four hours have passed. \n \n   \n    解題  A  如何安全地與一個外部公司分享一個包含敏感資料的物件（object），該物件存儲在Google Cloud Storage桶（bucket）中，並且要求在四小時後自動撤銷對該內容的訪問權限。外部公司沒有Google賬戶，因此無法透過基於用戶的訪問權限直接分享。  A. 創建一個帶有四小時過期時間的簽名URL，並與該公司分享。**這是一種安全的分享方法，允許非Google用戶透過簽名URL訪問特定物件，該URL在設定的時間後自動失效，無需手動介入。  B. 將物件訪問設置為'public'，並使用物件生命周期管理在四小時後刪除物件。**這種方法會暴露敏感資料給公眾直到被刪除，風險較高。  C. 將存儲桶配置為靜態網站，提供物件的URL給該公司。四小時後從存儲桶中刪除物件。**這個選項需要手動操作刪除物件，且在刪除前物件對所有人可見，不是最安全的選擇。  D. 專門為外部公司訪問創建一個新的Cloud Storage桶，將物件復制到該桶中。四小時後刪除該桶。**這個方法比較繁瑣，需要創建新的存儲桶並在四小時後手動刪除。     You are creating a Google Kubernetes Engine (GKE) cluster with a cluster autoscaler feature enabled.\nYou need to make sure that each node of the cluster will run a monitoring pod that sends container metrics to a third-party monitoring solution. What should you do?   A. Deploy the monitoring pod in a StatefulSet object.\nB. Deploy the monitoring pod in a DaemonSet object.\nC. Reference the monitoring pod in a Deployment object.\nD. Reference the monitoring pod in a cluster initializer at the GKE cluster creation time.\n \n   \n    解題  B  如何在Google Kubernetes Engine (GKE) 集群中確保每個節點都運行一個監控Pod，這個Pod負責將容器的度量指標發送到第三方監控解決方案。在Kubernetes中，有幾種不同的方式來部署和管理Pods，這個題目考察的是選擇哪一種部署方式最合適。  **A. 在StatefulSet物件中部署監控Pod。**StatefulSet主要用於管理有狀態的應用，保證Pod的順序和唯一性，並不適合確保每個節點都運行一個Pod的場景。  **B. 在DaemonSet物件中部署監控Pod。**DaemonSet確保所有（或者某些特定的）節點運行一份Pod的副本。當有節點加入集群時，會自動添加Pod到新節點，當節點從集群中移除時，這些Pod也會被回收。這適合於部署集群範圍內的監控和日誌收集。  **C. 在Deployment物件中引用監控Pod。**Deployment主要用於無狀態應用，提供聲明式更新等特性。雖然它可以擴展Pod副本數量，但不能保證在每個節點上都運行一個Pod。  **D. 在GKE集群創建時，於集群初始化器中引用監控Pod。**這不是Kubernetes的標準操作，也不提供一種機制來確保每個節點都運行指定的Pod。  根據題目要求，最佳選項是B. 在DaemonSet物件中部署監控Pod，因為它能夠保證每個節點都運行一個監控Pod，從而實現對整個集群的監控。  特殊型別服務、StatefulSet\\ DaemonSet\\ Deployment 概念   DaemonSet 確保每個 Node 都有一個 Pod 運行副本。每個 Node 都會監控 Pod  StatefulSet 它設計用於管理需長久儲存、依序啟動和停止的 Pod  Deployment 集群初始化程序（cluster initializer）通常用于在集群创建时进行一次性操作，而不是确保在每个节点上运行一个 Pod。   StatefulSet具體做法：   創建StatefulSet：你定義一個StatefulSet資源，指定應用的容器映像、所需的服務名稱（用於網絡通信），以及存儲卷的配置（通常是通過PersistentVolumeClaim來實現持久化存儲）。  部署和管理：Kubernetes為每個StatefulSet的Pod創建一個唯一的、有序的標識符，並根據定義的規則來管理這些Pod的部署和擴展。這包括在更新或擴展StatefulSet時保持Pod的啟動順序。  DaemonSet具體做法：   創建DaemonSet：你定義一個DaemonSet資源，指出要運行的容器映像和需要在每個節點上運行的任務或服務。  自動部署：Kubernetes自動在現有的每個節點上部署指定的Pod。當有新節點加入集群時，DaemonSet會自動在這些新節點上啟動其Pod副本，確保每個節點都運行該服務。     You want to send and consume Cloud Pub/Sub messages from your App Engine application. The Cloud Pub/Sub API is currently disabled. You will use a service account to authenticate your application to the API. You want to make sure your application can use Cloud Pub/Sub. What should you do?   A. Enable the Cloud Pub/Sub API in the API Library on the GCP Console.\nB. Rely on the automatic enablement of the Cloud Pub/Sub API when the Service Account accesses it.\nC. Use Deployment Manager to deploy your application. Rely on the automatic enablement of all APIs used by the application being deployed.\nD. Grant the App Engine Default service account the role of Cloud Pub/Sub Admin. Have your application enable the API on the first connection to Cloud Pub/ Sub.\n \n    \n    解題  A.  很單純邏輯，The Cloud Pub/Sub API is currently disabled，所以就是啟用API...其餘不用多看     You need to monitor resources that are distributed over different projects in Google Cloud Platform. You want to consolidate reporting under the same Stackdriver Monitoring dashboard. What should you do?   A. Use Shared VPC to connect all projects, and link Stackdriver to one of the projects.\n\nB. For each project, create a Stackdriver account. In each project, create a service account for that project and grant it the role of Stackdriver Account Editor in all other projects.\n\nC. Configure a single Stackdriver account, and link all projects to the same account.\n\nD. Configure a single Stackdriver account for one of the projects. In Stackdriver, create a Group and add the other project names as criteria for that Group.\n \n    \n    解題  C  如何在Google Cloud Platform（GCP）中監控分布於不同項目之間的資源，並希望將報告整合到同一個Stackdriver監控儀表板下。  A. 使用Shared VPC連接所有項目，並將Stackdriver鏈接到其中一個項目。 Shared VPC允許不同的GCP項目共享網絡資源，但這與在Stackdriver中整合監控資源的要求不直接相關。  B. 對每個項目創建一個Stackdriver賬戶。在每個項目中，為該項目創建一個服務賬戶，並在所有其他項目中授予它Stackdriver賬戶編輯者角色。 這種方法在理論上可以工作，但它需要復雜的設置且管理起來相當繁瑣，並不是一個高效的解決方案。  C. 配置單一的Stackdriver賬戶，並將所有項目鏈接到同一賬戶。 這是一個直接且高效的方法，允許你將來自不同GCP項目的監控資料整合到一個Stackdriver儀表板中。這樣做可以簡化監控和報告的過程，是Google推薦的做法。  D. 為其中一個項目配置單一的Stackdriver賬戶。在Stackdriver中創建一個群組，並將其他項目名作為該群組的標準。 這種方法也可以實現跨項目的資源監控，但它比選項C更加間接和複雜。  最佳做法是選擇C，配置單一的Stackdriver賬戶並將所有項目鏈接到這個賬戶。這樣可以最簡單直接地實現跨多個GCP項目的資源監控和報告整合。   訪問Google Cloud Console： 首先，登入你的Google Cloud Console (console.cloud.google.com)。  選擇或創建一個Stackdriver賬戶：   如果你已經有一個Stackdriver賬戶，可以直接使用。  如果沒有，你需要創建一個。在Google Cloud Console的導航菜單中選擇“Monitoring”或在搜索框中搜索“Monitoring”，然後跟隨指引創建一個新的Stackdriver賬戶。  將項目鏈接到Stackdriver賬戶：   在創建或選擇你的Stackdriver賬戶後，你會被引導到Stackdriver的儀表板。在這裡，你可以添加或鏈接其他Google Cloud項目到你的Stackdriver賬戶。  在Stackdriver儀表板上，尋找“設置”或“管理”選項，然後選擇“帳戶設置”或類似選項。  找到“項目”或“添加項目”選項，選擇你想要監控的Google Cloud項目，並將它們添加到你的Stackdriver賬戶中。  設置權限：   確保你有足夠的權限來將項目添加到Stackdriver賬戶。你可能需要擁有這些項目的“項目擁有者”或“項目編輯者”角色。  對於需要監控的每個項目，確保Stackdriver服務賬戶（通常是自動創建的）具有足夠的權限來訪問和收集監控數據。  驗證配置：   完成添加和配置後，返回到Stackdriver儀表板，檢查是否能夠看到所有鏈接項目的監控數據。  你可以創建自定義儀表板來顯示跨多個項目的關鍵指標，或使用預設的監控視圖來查看資源的狀態。     You are deploying an application to a Compute Engine VM in a managed instance group. The application must be running at all times, but only a single instance of the VM should run per GCP project. How should you configure the instance group?   A. Set autoscaling to On, set the minimum number of instances to 1, and then set the maximum number of instances to 1. \n\nB. Set autoscaling to Off, set the minimum number of instances to 1, and then set the maximum number of instances to 1. \n\nC. Set autoscaling to On, set the minimum number of instances to 1, and then set the maximum number of instances to 2. \n\nD. Set autoscaling to Off, set the minimum number of instances to 1, and then set the maximum number of instances to 2.\n \n    \n    解題  A, 要開autoscaling，不然掛了無法自動復原     You want to verify the IAM users and roles assigned within a GCP project named my-project. What should you do?   A. Run gcloud iam roles list. Review the output section.\nB. Run gcloud iam service-accounts list. Review the output section.\nC. Navigate to the project and then to the IAM section in the GCP Console. Review the members and roles. \nD. Navigate to the project and then to the Roles section in the GCP Console. Review the roles and status.\n \n    \n    解題  C  如何查驗在一個名為 my-project 的 Google Cloud Platform (GCP) 項目中指派給 IAM（Identity and Access Management，身份與存取管理）用戶和角色的方式。  A. Run gcloud iam roles list. Review the output section. 這個命令列出所有可用的IAM角色，但不會顯示哪些用戶或服務賬戶被指派了這些角色。  B. Run gcloud iam service-accounts list. Review the output section. 這個命令會列出所有的服務賬戶，但同樣不會提供哪些角色被指派給這些服務賬戶的資訊。  C. Navigate to the project and then to the IAM section in the GCP Console. Review the members and roles. 這是正確的操作步驟。在GCP Console中的IAM部分，你可以查看到所有被授予訪問該項目的成員（用戶、服務賬戶等）以及他們被指派的角色。  D. Navigate to the project and then to the Roles section in the GCP Console. Review the roles and status. 這個操作會讓你查看到所有可用的角色及其狀態，但不會顯示哪些成員被指派了這些角色。     You need to create a new billing account and then link it with an existing Google Cloud Platform project. What should you do?   A. Verify that you are Project Billing Manager for the GCP project. Update the existing project to link it to the existing billing account.\n\nB. Verify that you are Project Billing Manager for the GCP project. Create a new billing account and link the new billing account to the existing project.\n\nC. Verify that you are Billing Administrator for the billing account. Create a new project and link the new project to the existing billing account.\n\nD. Verify that you are Billing Administrator for the billing account. Update the existing project to link it to the existing billing account.\n \n    \n    解題  題目要求創建一個新的計費帳戶，然後將這個新的計費帳戶與一個已經存在的GCP專案連結。這個過程涉及到兩個角色：「計費管理員」和「項目計費管理員」。這些角色確保了只有擁有適當權限的使用者能夠更改計費和專案設定。  A. 驗證你是GCP專案的項目計費管理員。更新現有專案，將其連結到現有計費帳戶。  這個選項提到了更新現有專案以連結到一個「現有」的計費帳戶，但題目要求創建一個「新的」計費帳戶並進行連結，因此這個選項不正確。  B. 驗證你是GCP專案的項目計費管理員。創建一個新的計費帳戶並將新計費帳戶連結到現有專案。  這個選項正好符合題目的要求：先確認你擁有對專案的計費管理權限，然後創建一個新的計費帳戶，並將這個新帳戶與一個已存在的專案連結。這是一個看起來很合理的步驟。  C. 驗證你是計費帳戶的計費管理員。創建一個新專案並將新專案連結到現有計費帳戶。  這個選項與題目要求不符，因為它講的是創建一個新的專案並將其連結到一個已存在的計費帳戶，而不是創建新的計費帳戶。  D. 驗證你是計費帳戶的計費管理員。更新現有專案，將其連結到現有計費帳戶。  這個選項同樣沒有涉及到創建一個新的計費帳戶，所以也不符合題目的要求。  正確答案\n根據以上分析，正確答案是 B。這個選項直接回應了題目的需求，即創建一個新的計費帳戶並將其與一個已存在的GCP專案連結，同時確保操作者有適當的權限（作為專案的項目計費管理員）。這樣的流程不僅合乎邏輯，也符合GCP管理計費和專案的標準操作程序。    Billing Administrator（計費管理員）   職責範圍：計費管理員主要負責管理計費帳戶的設定和付款方式。這包括創建和管理計費帳戶、設定付款方式、查看和管理計費報告和成本分析，以及設定預算和警報。  權限範圍：計費管理員有權訪問和修改計費帳戶的所有相關資訊。這意味著他們可以對計費帳戶進行廣泛的操作，從而控制成本和付款。  Project Billing Manager（項目計費管理員）   職責範圍：項目計費管理員主要負責將特定的GCP專案與一個計費帳戶連結。他們確保專案的使用費用被正確記錄和計費到指定的計費帳戶。  權限範圍：項目計費管理員的權限限於  特定專案的計費設定 。他們可以變更專案所關聯的計費帳戶，但不能管理計費帳戶本身的財務細節或設定。  核心差異  權限範圍：計費管理員擁有對計費帳戶的全面控制權，而項目計費管理員的控制權限限於將專案連結到計費帳戶。  職責重點：計費管理員關注的是計費帳戶和付款管理，而項目計費管理員則專注於管理專案的計費和成本追蹤。    總的來說，這兩個角色共同協作，確保GCP資源的使用費用得到正確管理和計費。計費管理員負責帳戶層面的管理，而項目計費管理員則確保專案層面的計費設定正確無誤。     You have one project called proj-sa where you manage all your service accounts. You want to be able to use a service account from this project to take snapshots of VMs running in another project called proj-vm. What should you do?   A. Download the private key from the service account, and add it to each VMs custom metadata.\nB. Download the private key from the service account, and add the private key to each VM's SSH keys.\nC. Grant the service account the IAM Role of Compute Storage Admin in the project called proj-vm.\nD. When creating the VMs, set the service account's API scope for Compute Engine to read/write\n \n   \n    解題  這是一個關於如何在GCP中使用一個專案中的服務帳戶來對另一個專案中運行的虛擬機（VMs）進行快照操作的問題。  A. 從服務帳戶下載私鑰，並將其添加到每台VM的自定義元數據中。  這種做法會引入安全風險，因為將私鑰直接存儲在VM的元數據中並不是一種安全的做法。  B. 從服務帳戶下載私鑰，並將私鑰添加到每台VM的SSH鑰匙中。  同樣，這也不是推薦的做法，因為它涉及到將敏感的私鑰分發到多台VM上，這可能會導致安全問題。  C. 在名為proj-vm的專案中，授予服務帳戶Compute Storage Admin的IAM角色。  這是一種安全的做法，因為它通過IAM（身份及存取管理）授權機制賦予服務帳戶必要的權限，使其能夠在不同專案中進行操作，而無需直接處理任何敏感的私鑰信息。  D. 創建VM時，設置服務帳戶的Compute Engine API範圍為讀/寫  雖然這個選項看起來似乎提供了所需的權限，但它實際上是在設置服務帳戶對Compute Engine API的訪問範圍，並不直接賦予服務帳戶在另一個專案中操作的權限。  正確答案是 C。這個選項通過給予服務帳戶適當的IAM角色（Compute Storage Admin）  設置圖片        You created a Google Cloud Platform project with an App Engine application inside the project.\nYou initially configured the application to be served from the us- central region.\nNow you want the application to be served from the asia-northeast1 region. What should you do?   A. Change the default region property setting in the existing GCP project to asia-northeast1.\n\nB. Change the region property setting in the existing App Engine application from us-central to asia-northeast1.\n\nC. Create a second App Engine application in the existing GCP project and specify asia-northeast1 as the \nregion to serve your application.\n\nD. Create a new GCP project and create an App Engine application inside this new project. Specify asia-northeast1 as the region to serve your application\n \n   \n    解題  A. 在現有的GCP項目中更改預設區域屬性設定為asia-northeast1。  這個選項可能會讓人誤解，因為GCP項目本身並不允許直接更改預設區域。特別是對於App Engine應用程序，一旦設定了部署區域，在App Engine的標準環境中是無法更改的。  B. 將現有App Engine應用程序的區域屬性設定從us-central更改為asia-northeast1。  這個選項同樣不可行，因為App Engine應用程序一旦部署在某個區域，就無法將它遷移到另一個區域。  C. 在現有的GCP項目中創建第二個App Engine應用程序，並指定asia-northeast1作為服務您的應用程序的區域。  這是一個可行的選項。GCP允許在同一個項目中創建多個App Engine應用程序，每個應用程序可以在不同的區域運行。不過，值得注意的是，每個GCP項目在每個區域只能有一個App Engine應用實例，這意味著如果你要在另一個區域部署相同的應用，你需要創建一個新的應用實例。  D. 創建一個新的GCP項目並在這個新項目中創建一個App Engine應用程序。指定asia-northeast1作為服務您的應用程序的區域。  這也是一個有效的選項，且是最乾淨的解決方案。創建一個新的GCP項目，並在該項目中設定App Engine應用程序的區域為asia-northeast1，可以確保應用程序在所需的區域內運行，而不影響原有的項目設置或應用程序。  考慮到GCP和App Engine的工作原理，D 是最佳選項。這是因為App Engine的應用區域一旦設定，在標準環境中就不能更改。     You need to grant access for three users so that they can view and edit table data on a Cloud Spanner instance. What should you do?   A. Run gcloud iam roles describe roles/spanner.databaseUser. Add the users to the role. \nB. Run gcloud iam roles describe roles/spanner.databaseUser. Add the users to a new group. Add the group to the role. \nC. Run gcloud iam roles describe roles/spanner.viewer - -project my-project. Add the users to the role. \nD. Run gcloud iam roles describe roles/spanner.viewer - -project my-project. Add the users to a new group. Add the group to the role\n \n    \n    解題  這題就考IAM...以IAM權限角色選擇，要能編輯鐵定不能寫viwer，接下來就是考慮一次要授予三個人這個權限，用Group的做法會比較妥當。可以集中管理就做集中管理，答案就是B     You create a new Google Kubernetes Engine (GKE) cluster and want to make sure that it always runs a supported and stable version of Kubernetes. What should you do?   A. Enable the Node Auto-Repair feature for your GKE cluster. \nB. Enable the Node Auto-Upgrades feature for your GKE cluster. \nC. Select the latest available cluster version for your GKE cluster. \nD. Select Container-Optimized OS (cos) as a node image for your GKE cluster.\n \n    \n    解題  這題很簡單，答案直覺就是B...(upgrades)  A的Auto-Repair為節點自動修復。  C這表示當你創建或升級 GKE 集群時，你選擇了最新的可用版本。但這不保證它將來仍然是受支援的版本。  D為一種特別為運行容器而優化的操作系統。選擇它可以提供一個簡化且安全的環境來運行你的應用程式，但它與確保 Kubernetes 版本受支援和穩定無直接關係。     You have an instance group that you want to load balance. You want the load balancer to terminate the client SSL session. The instance group is used to serve a public web application over HTTPS. You want to follow Google recommended practices. What should you do?   A. Configure an HTTP(S) load balancer. \nB. Configure an internal TCP load balancer. \nC. Configure an external SSL proxy load balancer. \nD. Configure an external TCP proxy load balancer\n \n   \n    解題  在Google Cloud Platform（GCP）上，當你想要設定一個負載平衡器來終止客戶端的SSL會話（也就是進行SSL解密），並且這個負載平衡器是用來服務一個公開的Web  A. 配置一個HTTP(S)負載平衡器。  這是正確的選擇，因為HTTP(S)負載平衡器能夠在負載平衡器層面終止SSL會話，並且支援公開的Web應用程式透過HTTPS服務。  B. 配置一個內部TCP負載平衡器。  這不是正確的選擇，因為內部TCP負載平衡器是用於內部網絡流量的負載平衡，不適用於公開的Web應用程式。  C. 配置一個外部SSL代理負載平衡器。  雖然SSL代理負載平衡器也支援SSL會話的終止，但它主要用於非HTTP/HTTPS流量的SSL終止。對於要服務HTTPS的Web應用程式，HTTP(S)負載平衡器是更加適合的選擇。  D. 配置一個外部TCP代理負載平衡器。  這也不是正確的選擇，因為TCP代理負載平衡器主要用於TCP流量的負載平衡，而不是終止SSL會話。  基於以上分析，A. 配置一個HTTP(S)負載平衡器 是最符合Google推薦做法的選擇，用於終止客戶端的SSL會話並服務一個公開的Web應用程式透過HTTPS。   設定一個負載平衡器來終止客戶端的SSL會話，這個過程被稱為SSL終止（SSL Termination）。這裡的「終止」指的是加密連接在達到負載平衡器時被解密，之後負載平衡器再將解密後的流量轉發到後端伺服器。這意味著SSL加密和解密的工作是在負載平衡器上完成的，而不是在每個後端伺服器上進行。   停止SSL加密過程 ：雖然**  HTTP(S)負載平衡器  和  外部SSL代理負載平衡器 **都能做到這一點，但考慮到您的應用程式是基於Web的，您可能還會需要根據HTTP/HTTPS的具體內容進行路由決策，例如根據URL路徑。  因此，選擇**  HTTP(S)負載平衡器 **會是更合適的選擇，因為它不僅可以終止SSL會話，還可以提供基於HTTP/HTTPS內容的高度靈活的路由能力。     SSL終止的過程   客戶端到負載平衡器的連接：   客戶端（例如瀏覽器）通過HTTPS向負載平衡器發起一個連接請求。  負載平衡器接收到請求後，使用其SSL證書來與客戶端進行加密連接的建立，這個過程包括加密的鑰匙交換。  解密和轉發流量：   一旦加密連接建立，負載平衡器就會解密客戶端發來的加密流量。  解密後，負載平衡器讀取請求內容，並根據設定的負載平衡策略決定將請求轉發到哪個後端伺服器。  後端伺服器處理請求：   後端伺服器收到來自負載平衡器的請求（此時請求已經是解密的），處理請求，並返回響應給負載平衡器。  負載平衡器可以選擇對響應再次進行加密，然後發送回客戶端，或者直接以明文形式發送，取決於配置和需求。  為什麼要使用SSL終止？   性能優化：將加解密的工作集中在負載平衡器上，可以減輕後端伺服器的負擔，提高整體系統的處理能力。  簡化證書管理：只需在負載平衡器上管理SSL證書，無需在每台後端伺服器上分別配置和更新，這樣可以大大簡化證書的管理工作。  安全性：雖然SSL終止意味著在負載平衡器和後端伺服器之間的流量可能是未加密的，但在一個受控和安全的網絡環境中，這種設置仍然能夠提供足夠的安全保障。如果需要，也可以在負載平衡器和後端伺服器之間再次進行加密，這被稱為SSL重新加密（SSL Re-encryption）。     You have 32 GB of data in a single file that you need to upload to a Nearline Storage bucket.The WAN connection you are using is rated at 1 Gbps, and you are the only one on the connection. You want to use as much of the rated 1 Gbps as possible to transfer the file rapidly. How should you upload the file?   A. Use the GCP Console to transfer the file instead of gsutil.\nB. Enable parallel composite uploads using gsutil on the file transfer.\nC. Decrease the TCP window size on the machine initiating the transfer. \nD. Change the storage class of the bucket from Nearline to Multi-Regional.\n \n    \n    解題  答案是B，要最大限度地利用1 Gbps的速度快速上傳大型檔案，最佳的方法是使用平行複合上傳。這是因為gsutil的平行複合上傳會將大檔案分割成多個較小的部分，這些部分可以並行上傳，從而加快整體上傳速度。   選項A：使用GCP控制台可能不如使用gsutil效率，特別是對於大型檔案。\n  選項B：平行複合上傳允許檔案在上傳到Google Cloud Storage時被分割並且並行上傳，從而加快上傳速度。  選項C：降低TCP窗口大小可能會減慢傳輸速度，而不是加快它。  選項D：更改存儲類別並不影響上傳速度。此外，選擇Multi-Regional可能會增加存儲成本。     You've deployed a microservice called myapp1 to a Google Kubernetes Engine cluster using the YAML file specified below:  You need to refactor this configuration so that the database password is not stored in plain text. You want to follow Google- recommended practices. What should you do?   A. Store the database password inside the Docker image of the container, not in the YAML file.\nB. Store the database password inside a Secret object. Modify the YAML file to populate the DB_PASSWORD environment variable from the Secret.\nC. Store the database password inside a ConfigMap object. Modify the YAML file to populate the DB_PASSWORD environment variable from the ConfigMap.\nD. Store the database password in a file inside a Kubernetes persistent volume, and use a persistent volume claim to mount the volume to the container.\n \n   \n    解題  當您在Kubernetes中管理敏感數據，如數據庫密碼，推薦的做法是使用Kubernetes Secrets。  A. 將數據庫密碼存儲在Docker映像內是不推薦的。這樣做很不安全，且不符合最佳做法。任何可以訪問此映像的人都可以檢索密碼。  B. 這是正確的選擇。您可以在Kubernetes中使用Secrets存儲敏感信息，然後在YAML配置中參考這些Secrets，以將數據傳遞給容器環境變量。 (不是很建議的Solution…但考試ㄇ…)  C. ConfigMap主要用於存儲非機密配置，而不是存儲敏感數據，如密碼。  D. 雖然這個選擇理論上可行，但使用Secret物件是更簡單且更加安全的方法來管理敏感數據。     You are running an application on multiple virtual machines within a managed instance group\nand have autoscaling enabled. The autoscaling policy is configured so that additional instances are added to the group if the CPU utilization of instances goes above 80%. VMs are added until the instance group reaches its maximum limit of five VMs or until CPU utilization of instances lowers to 80%. The initial delay for HTTP health checks against the instances is set to 30 seconds. The virtual machine instances take around three minutes to become available for users. You observe that when the instance group autoscales, it adds more instances then necessary to support the levels of end-user traffic. You want to properly maintain instance group sizes when autoscaling. What should you do?   A. Set the maximum number of instances to 1.\nB. Decrease the maximum number of instances to 3.\nC. Use a TCP health check instead of an HTTP health check.\nD. Increase the initial delay of the HTTP health check to 200 seconds.\n \n   \n    解題  您正在一個受管理的實例組中的多個虛擬機上運行應用程序，並已啟用自動縮放功能。自動縮放策略配置為，如果實例的CPU利用率超過80%，則將額外的實例添加到組中。添加VM，直到實例組達到其最大限制的五個VM，或直到實例的CPU利用率降低到80%。針對實例進行HTTP健康檢查的初始延遲設置為30秒。虛擬機實例需要大約三分鐘才能供用戶使用。您觀察到，當實例組自動縮放時，它會添加比支持最終用戶流量所需的更多實例。您希望在自動縮放時正確維護實例組的大小。您應該怎麼做？  問題指出，當實例組自動縮放時，它會添加不必要的多餘實例。這可能是因為健康檢查的初始延遲過短，導致自動縮放策略在新實例完全啟動並處理流量之前就試圖添加更多的實例。  A. 這不是一個好選擇，因為只有一個實例將不能滿足需要擴展的需求。\nB. 減少到3的實例最大數量可能不足以處理高流量。\nC. 使用TCP健康檢查與HTTP健康檢查之間的選擇不太可能解決這個問題。\nD. 增加HTTP健康檢查的初始延遲將允許新實例有更多的時間啟動並開始處理流量，這可能會解決過度擴展的問題。  答案是D     You need to select and configure compute resources for a set of batch processing jobs. These jobs take around 2 hours to complete and are run nightly. You want to minimize service costs. What should you do?   A. Select Google Kubernetes Engine. Use a single-node cluster with a small instance type.\nB. Select Google Kubernetes Engine. Use a three-node cluster with micro instance types.\nC. Select Compute Engine. Use preemptible VM instances of the appropriate standard machine type. \nD. Select Compute Engine. Use VM instance types that support micro bursting.\n \n   \n    解題  對於批量處理工作，特別是當您希望最小化成本時，選擇預先中止(Preemptible) VM實例是一個好選擇。這些實例比常規實例便宜很多，但可能會在任何時候被GCP回收，這在批量處理工作中是可以接受的，因為它們可以容易地重新啟動。  A. 這不是最經濟的選擇，因為Kubernetes Engine可能對批處理作業過於冗余。\nB. 同上，對於批處理，Kubernetes Engine可能不是最經濟的選擇。\nC. 預先中止的VM實例非常適合短期和可中斷的批量處理工作，而且它們比常規VM實例便宜很多。\nD. Micro bursting是當小型VM實例在短時間內超出其基礎性能時使用的，這可能不是最佳選擇。     You recently deployed a new version of an application to App Engine and then discovered a bug in the release. You need to immediately revert to the prior version of the application. What should you do?   A. Run gcloud app restore.\n\nB. On the App Engine page of the GCP Console, select the application that needs to be reverted and click Revert.\n\nC. On the App Engine Versions page of the GCP Console, route 100% of the traffic to the previous version.\n\nD. Deploy the original version as a separate application. Then go to App Engine settings and split traffic between applications so that the original version serves 100% of the requests.\n \n    \n    解題  當您需要迅速還原到先前的版本時，最快捷且不會造成中斷的方法是調整流量分配。  A. **  gcloud app restore **不是有效的命令。\nB. GCP控制台的App Engine頁面上沒有直接的\"Revert\"選項。\nC. 通過App Engine的版本控制，您可以輕鬆地將所有流量路由到先前的版本。\nD. 這個選項過於複雜，且不是建議的方法。     You deployed an App Engine application using gcloud app deploy, but it did not deploy to the intended project. You want to find out why this happened and where the application deployed. What should you do?   A. Check the app.yaml file for your application and check project settings.\nB. Check the web-application.xml file for your application and check project settings.\nC. Go to Deployment Manager and review settings for deployment of applications.\nD. Go to Cloud Shell and run gcloud config list to review the Google Cloud configuration used for deployment.\n \n   \n    解題  你使用 gcloud app deploy 部屬應用程式，但應用程式並未部屬到目標專案，你想要找出爲何會發生這樣的事  A. 檢查應用程式內的 app.yaml ，確認專案設定，app.yaml: 是 App 執行時的參數相關設定，不是 Deploy 的設定  B. 檢查應用程式內的 web-application.xml ，確認專案設定，web-application.xml: GCP 沒有服務會吃到這個設定，也不知道這個設定是給誰的  C. 前往 Deployment Manager 確認該應用程式的設定，題目情境是使用 gcloud app deploy  D. 前往 Cloud Shell 執行 gcloud config list 確認 deployment 的相關設定       You want to configure 10 Compute Engine instances for availability when maintenance occurs.Your requirements state that these instances should attempt to automatically restart if they crash. Also, the instances should be highly available including during system maintenance. What should you do?   A. Create an instance template for the instances. Set the 'Automatic Restart' to on. Set the 'On-host maintenance' to Migrate VM instance. Add the instance template to an instance group.\n\nB. Create an instance template for the instances. Set 'Automatic Restart' to off. Set 'On-host maintenance' to Terminate VM instances. Add the instance template to an instance group.\n\nC. Create an instance group for the instances. Set the 'Autohealing' health check to healthy (HTTP).\n\nD. Create an instance group for the instance. Verify that the 'Advanced creation options' setting for 'do \nnot retry machine creation' is set to off.\n \n    \n    解題  為了確保Compute Engine實例在維護期間的可用性，並且在出現故障時自動重新啟動  A選項是符合需求的正確做法。透過創建一個實例模板，並設定「自動重新啟動」為開啟狀態，以及在主機維護期間選擇「遷移VM實例」，能確保實例在遇到系統維護或故障時仍保持高可用性。再將此模板加入實例群組中，可以進一步提高整體應用的可靠性和可用性。  B選項提出的設定「自動重新啟動」關閉，以及在主機維護時選擇「終止VM實例」，這明顯與需求相反，因為它不會在實例崩潰時自動重啟，也不會在系統維護期間保持實例的可用性。  C選項提到為實例群組設置「自動修復」健康檢查，雖然這有助於確保實例的健康狀態，但它並未直接解決在系統維護期間或實例崩潰時保持高可用性的需求。  D選項談到確認「高級創建選項」中的「不重試機器創建」設置是否關閉，這更多關注於創建實例的過程，而不是實例崩潰或系統維護期間的自動重啟和高可用性策略。  綜上所述，A選項提供了一個全面的解決方案，能夠滿足自動重新啟動以及在系統維護期間保持實例高可用性的需求。     You host a static website on Cloud Storage. Recently, you began to include links to PDF files on this site. Currently, when users click on the links to these PDF files, their browsers prompt them to save the file onto their local system. Instead, you want the clicked PDF files to be displayed within the browser window directly, without prompting the user to save the file locally. What should you do?   A. Enable Cloud CDN on the website frontend.\nB. Enable 'Share publicly' on the PDF file objects.\nC. Set Content-Type metadata to application/pdf on the PDF file objects.\nD. Add a label to the storage bucket with a key of Content-Type and value of application/pdf.\n \n   \n    解題  當您希望在點擊PDF文件鏈接時，讓用戶在瀏覽器窗口中直接查看PDF內容，而不是提示用戶將文件保存到本地系統，您需要設定正確的MIME類型。MIME類型告訴瀏覽器文件的類型，從而瀏覽器可以決定如何處理該文件。  C選項提到將PDF文件對象的Content-Type元數據設置為application/pdf。這是達到您目標的正確方法。通過這樣設置，當用戶點擊PDF文件鏈接時，瀏覽器識別到文件類型為PDF，並嘗試在瀏覽器內直接顯示文件，而不是提示用戶進行下載。  A選項，啟用Cloud CDN對於改變文件如何被瀏覽器處理（即顯示或下載）沒有直接影響。CDN主要用於內容的快速分發。  B選項，啟用PDF文件對象的'公開分享'並不直接影響文件在瀏覽器中的打開方式。它只確保沒有存取控制限制阻止用戶訪問這些文件。  D選項，在存儲桶上添加帶有Content-Type鍵和application/pdf值的標籤並不會改變對象的實際Content-Type元數據。對於如何處理特定文件，瀏覽器查看的是文件對象的Content-Type元數據，而不是存儲桶的標籤。  C選項是正確的選擇，因為它通過設置正確的Content-Type元數據來直接在瀏覽器中打開PDF文件，而無需下載。     You have a virtual machine that is currently configured with 2 vCPUs and 4 GB of memory. It is running out of memory. You want to upgrade the virtual machine to have 8 GB of memory. What should you do?   A. Rely on live migration to move the workload to a machine with more memory.\nB. Use gcloud to add metadata to the VM. Set the key to required-memory-size and the value to 8 GB.\nC. Stop the VM, change the machine type to n1-standard-8, and start the VM.\nD. Stop the VM, increase the memory to 8 GB, and start the VM.\n \n   \n    解題  選D，VM 的 CPU / RAM 是無法 live 變更的，硬碟空間可以live變更，但需注意硬碟只能擴不能縮     You have production and test workloads that you want to deploy on Compute Engine. Production\nVMs need to be in a different subnet than the test VMs. All the VMs must be able to reach each other\nover Internal IP without creating additional routes. You need to set up VPC and the 2 subnets. Which configuration meets these requirements?   A. Create a single custom VPC with 2 subnets. Create each subnet in a different region and with a different CIDR range.\n\nB. Create a single custom VPC with 2 subnets. Create each subnet in the same region and with the same CIDR range.\n\nC. Create 2 custom VPCs, each with a single subnet. Create each subnet in a different region and with a different CIDR range.\n\nD. Create 2 custom VPCs, each with a single subnet. Create each subnet in the same region and with the same CIDR range.\n \n   \n    解題  要滿足生產環境和測試環境的虛擬機（VM）部署在不同子網中，同時又能夠通過內部IP互相連接而不需要創建額外路由的需求，最佳做法是將所有VM部署在同一個自定義虛擬私人網路（VPC）中，但在不同的子網下。這樣設置可以確保即使在不同子網中的VM也能在同一VPC內部通信，無需額外路由設置。  A選項提出了在一個自定義VPC中創建兩個子網，每個子網在不同的地區且擁有不同的CIDR範圍。這符合需求，因為即使子網在不同地區，它們仍然屬於同一VPC內，從而能夠實現內部互連。  B選項提議在同一個自定義VPC中創建兩個子網，且兩個子網在相同的地區且擁有相同的CIDR範圍。這個選項是不可行的，因為兩個子網不能擁有相同的CIDR範圍，這會導致IP地址衝突。  C選項和D選項都提議創建兩個自定義VPC，每個VPC包含一個子網。這兩個選項都不能滿足需求，因為在不同VPC之間的VM默認是不能直接通信的，除非設置VPC對等連接，這違背了不創建額外路由的要求。  A選項是符合要求的最佳配置，它能夠確保生產環境和測試環境的VM在不同子網中，同時保持了它們之間的內部通信能力，且無需額外路由設置。     You need to create an autoscaling managed instance group for an HTTPS web application. You want to make sure that unhealthy VMs are recreated. What should you do?   A. Create a health check on port 443 and use that when creating the Managed Instance Group.\nB. Select Multi-Zone instead of Single-Zone when creating the Managed Instance Group.\nC. In the Instance Template, add the label 'health-check'.\nD. In the Instance Template, add a startup script that sends a heartbeat to the metadata server.\n \n   \n    解題  要創建一個自動擴展的管理實例組（Managed Instance Group, MIG）來支持HTTPS網絡應用，並且確保不健康的虛擬機（VM）被重新創建，最直接且有效的方法是使用健康檢查（Health Check）。  A選項提議創建一個在端口443上的健康檢查，並在創建管理實例組時使用該健康檢查。這是一個符合需求的選擇，因為HTTPS應用通常運行在端口443上。通過對每個實例進行健康檢查，不健康的實例可以被識別並自動替換，從而確保應用的可用性和穩定性。  B選項建議在創建管理實例組時選擇多區域（Multi-Zone）而非單區域（Single-Zone）。雖然這樣可以提高應用的高可用性，但它不直接解決不健康VM的重建問題。  C選項和D選項都提到了在實例模板中添加標籤或啟動腳本。這些方法可能有助於實現自定義的健康檢查或監控，但它們不如直接使用GCP提供的健康檢查機制來得直接和標準化。  因此，A選項是最佳的做法，因為它直接使用GCP的健康檢查功能來確保HTTPS應用的虛擬機在出現不健康狀態時能夠被自動檢測並重建。     Your company has a Google Cloud Platform project that uses BigQuery for data warehousing. Your data science team changes frequently and has few members.You need to allow members of this team to perform queries.You want to follow Google-recommended practices. What should you do?   A. \n   1. Create an IAM entry for each data scientist's user account. \n   2. Assign the BigQuery jobUser role to the group.\nB. \n   1. Create an IAM entry for each data scientist's user account.\n   2. Assign the BigQuery dataViewer user role to the group.\nC. \n   1. Create a dedicated Google group in Cloud Identity. \n   2. Add each data scientist's user account to the group. \n   3. Assign the BigQuery jobUser role to the group.\nD. \n   1. Create a dedicated Google group in Cloud Identity. \n   2. Add each data scientist's user account to the group. \n   3. Assign the BigQuery dataViewer user role to the group\n \n    \n    解題  答案C, DataViewer does not allow user to perform queries.  C的步驟是：   在Cloud Identity中創建一個專門的Google群組。  將每個資料科學家的用戶帳戶添加到這個群組中。  給這個群組分配BigQuery jobUser角色。  BigQuery jobUser角色允許群組成員執行BigQuery作業，包括運行查詢     Your company has a 3-tier solution running on Compute Engine. The configuration of the current infrastructure is shown below.Each tier has a service account that is associated with all instances within it. You need to enable communication on TCP port 8080 between tiers as follows:   Instances in tier #1 must communicate with tier #2.  Instances in tier #2 must communicate with tier #3.  What should you do?     A. \n    1. Create an ingress firewall rule with the following settings: \n         Targets: all instances\n         Source filter: IP ranges (with the range set to 10.0.2.0/24)\n         Protocols: allow all \n    2. Create an ingress firewall rule with the following settings:\n         Targets: all instances\n         Source filter: IP ranges (with the range set to 10.0.1.0/24) \n         Protocols: allow all\nB. \n    1. Create an ingress firewall rule with the following settings:\n         Targets: all instances with tier #2 service account\n         Source filter: all instances with tier #1 service account\n         Protocols: allow TCP:8080 \n    2. Create an ingress firewall rule with the following settings:\n         Targets: all instances with tier #3 service account\n         Source filter: all instances with tier #2 service account\n         Protocols: allow TCP: 8080\nC. \n    1. Create an ingress firewall rule with the following settings:\n         Targets: all instances with tier #2 service account\n         Source filter: all instances with tier #1 service account\n         Protocols: allow all \n    2. Create an ingress firewall rule with the following settings:\n         Targets: all instances with tier #3 service account\n         Source filter: all instances with tier #2 service account\n         Protocols: allow all\nD. \n    1. Create an egress firewall rule with the following settings:\n         Targets: all instances\n         Source filter: IP ranges (with the range set to 10.0.2.0/24)\n         Protocols: allow TCP: 8080 \n    2. Create an egress firewall rule with the following settings:\n         Targets: all instances\n         Source filter: IP ranges (with the range set to 10.0.1.0/24)\n         Protocols: allow TCP: 8080\n \n   \n    解題  答案是B,   先排除不是 8080 port的選項  egress 是對外，ingress才是授權連線  選項A\n這個選項提議創建兩條入站(ingress)防火牆規則，基於IP範圍來允許所有協議的通信。然而，這並不精確地針對要求的TCP端口8080，且使用IP範圍而非服務帳戶作為過濾條件，可能不是最佳選擇，因為它沒有細化到特定的服務帳戶或所需的端口。  選項B\n這個選項建議基於服務帳戶創建兩條入站(ingress)防火牆規則，專門允許TCP端口8080的通信。第一條規則允許第一層的實例與第二層的實例通信，第二條規則允許第二層的實例與第三層的實例通信。這完全符合題目的要求，是一個精確且高效的解決方案。  選項C\n與選項B類似，這個選項也是基於服務帳戶創建防火牆規則，但它允許所有協議的通信，而不是僅限於TCP端口8080。這樣的設置比題目要求的更為寬泛，可能會引入不必要的安全風險。  選項D\n這個選項建議創建出站(egress)防火牆規則，這與題目要求的入站(ingress)通信不符。雖然它專注於TCP端口8080，但是從方向上說，它不適用於這個特定的需求。     You are given a project with a single Virtual Private Cloud (VPC) and a single subnetwork in the us-central1 region. There is a Compute Engine instance hosting an application in this subnetwork.\nYou need to deploy a new instance in the same project in the europe-west1 region. This new instance needs access to the application. You want to follow Google-recommended practices. What should you do?   A. \n    1. Create a subnetwork in the same VPC, in europe-west1. \n    2. Create the new instance in the new subnetwork and use the first instance's private address as the endpoint.\nB. \n    1. Create a VPC and a subnetwork in europe-west1. \n    2. Expose the application with an internal load balancer. \n    3. Create the new instance in the new subnetwork and use the load balancer's address as the endpoint.\nC. \n    1. Create a subnetwork in the same VPC, in europe-west1. \n    2. Use Cloud VPN to connect the two subnetworks. \n    3. Create the new instance in the new subnetwork and use the first instance's private address as the endpoint.\nD. \n    1. Create a VPC and a subnetwork in europe-west1. \n    2. Peer the 2 VPCs. \n    3. Create the new instance in the new subnetwork and use the first instance's private address as the endpoint.\n \n   \n    解題  你有一個項目，其中包含一個單一的虛擬私有雲(VPC)和一個位於美國中部(us-central1)地區的子網絡。在這個子網絡中，有一個Compute Engine實例托管著一個應用程式。你需要在同一項目中的歐洲西部(europe-west1)地區部署一個新實例，且這個新實例需要訪問原有應用程式。題目要求按照Google推薦的實踐操作。  選項A 建議在相同VPC中，為europe-west1地區創建一個新的子網絡，並在此子網絡中創建新實例，使用第一個實例的私有地址作為端點。這是一個符合Google推薦做法的直接且簡潔的方法，因為它利用了同一VPC內跨地區的自動私有連接功能。  選項B 提議創建一個新的VPC和子網絡，並使用內部負載平衡器暴露應用程式。這個選項雖然可行，但它引入了不必要的復雜性，包括額外的VPC和負載平衡器配置，這並不是Google推薦的最佳實踐。且沒必要。  選項C 建議使用Cloud VPN連接兩個子網絡。雖然這可以實現跨地區連接，但對於位於同一VPC內的實例來說，這是一種過於複雜和不必要的方法。VPN在這題用不到.....  選項D 建議創建一個新的VPC和子網絡，並進行VPC對等連接。這同樣比題目要求的更為複雜，因為它需要額外的VPC和對等連接設置。且沒必要。  正確答案是A。這是最簡單直接的方法，符合Google的推薦實踐，允許在同一VPC內跨地區自動進行私有連接，無需額外的連接或負載平衡設置。  Subnets：每個 VPC network 都包含一到多組 IP 區間，稱為子網域(subnets).       Your projects incurred more costs than you expected last month.Your research reveals that a development GKE container emitted a huge number of logs, which resulted in higher costs. You want to disable the logs quickly using the minimum number of steps. What should you do?   A. Go to the Logs ingestion window in Stackdriver Logging, and disable the log source for the GKE container resource.\n\nB. Go to the Logs ingestion window in Stackdriver Logging, and disable the log source for the GKE Cluster Operation resource.\n\nC. \n  1. Go to the GKE console, and delete existing clusters.\n  2. Recreate a new cluster.\n  3. Clear the option to enable legacy Stackdriver Logging.\n\nD. \n    1. Go to the GKE console, and delete existing clusters.\n    2. Recreate a new cluster. \n    3. Clear the option to enable legacy Stackdriver Monitoring.\n \n   \n    解題  你發現上個月項目的成本超出預期，原因是開發用的GKE容器產生了大量日誌，導致成本增加。你希望通過最少的步驟快速禁用這些日誌。  選項A 提議在Stackdriver Logging的日誌攝取窗口中，禁用GKE容器資源的日誌源。這是一個直接且有效的方法，可以立即停止日誌的攝取，從而降低成本。  選項B 建議禁用GKE Cluster Operation資源的日誌源。這可能不會完全解決問題，因為它專注於操作日誌而非容器產生的日誌。  選項C 和 選項D 都提議刪除現有的集群並重新創建，這是一種非常極端且耗時的方法，並不推薦作為首選方案，特別是當可以通過更簡單的配置變更來解決問題時。  正確答案是A。這是最快且最直接的方法來停止特定容     You have a website hosted on App Engine standard environment. You want 1% of your users to see a new test version of the website. You want to minimize complexity. What should you do?   A. Deploy the new version in the same application and use the --migrate option.\n\nB. Deploy the new version in the same application and use the --splits option to give a weight of 99 to the current version and a weight of 1 to the new version.\n\nC. Create a new App Engine application in the same project. Deploy the new version in that application. Use the App Engine library to proxy 1% of the requests to the new version.\n\nD. Create a new App Engine application in the same project. Deploy the new version in that application. Configure your network load balancer to send 1% of the traffic to that new application.\n \n    \n    解題  B  您在App Engine標準環境上托管了一個網站。您希望1%的用戶看到網站的新測試版本。您希望盡量減少複雜性，應該怎麼做？  選項A：在同一應用中部署新版本並使用--migrate選項。這個選項用於遷移流量，但並不適用於只對一小部分用戶展示新版本的情境。  選項B：在同一應用中部署新版本並使用--splits選項，給當前版本分配99的權重，新版本分配1的權重。這是一種簡單且有效的方法，允許您按比例分配流量到不同版本，正好符合只讓1%的用戶看到新測試版本的需求。  選項C & D：在同一項目中創建一個新的App Engine應用並部署新版本，然後使用App Engine庫或網絡負載平衡器將1%的請求代理到新版本。這些選項增加了管理複雜性，因為它們要求創建全新的應用並進行額外配置。     You have a web application deployed as a managed instance group.\nYou have a new version of the application to gradually deploy.\nYour web application is currently receiving live web traffic.\nYou want to ensure that the available capacity does not decrease during the deployment.\nWhat should you do?   A. Perform a rolling-action start-update with maxSurge set to 0 and maxUnavailable set to 1. \n\nB. Perform a rolling-action start-update with maxSurge set to 1 and maxUnavailable set to 0.\n\nC. Create a new managed instance group with an updated instance template. Add the group to the backend service for the load balancer. When all instances in the new managed instance group are healthy, delete the old managed instance group. \n\nD. Create a new instance template with the new application version. \nUpdate the existing managed instance group with the new instance template. \nDelete the instances in the managed instance group to allow the managed instance group to recreate the instance using the new instance template.\n \n   \n    解題  您的網絡應用作為一個管理實例組部署，您有一個新版本的應用需要逐步部署。您的網絡應用當前正在接收實際網絡流量。您想確保在部署期間可用容量不會減少，應該怎麼做？  選項A：進行滾動更新（rolling-action start-update），設置maxSurge為0，maxUnavailable為1。這個選項意味著在更新過程中不會增加額外的實例（maxSurge=0），且同一時間最多有一個實例不可用（maxUnavailable=1）。這可能會在更新期間暫時減少可用容量，不符合題目要求。  選項B：進行滾動更新，設置maxSurge為1，maxUnavailable為0。這個選項在更新過程中允許臨時增加一個實例（maxSurge=1），確保在任何時刻都不會有實例不可用（maxUnavailable=0），從而保持可用容量不變。這完全符合題目要求，是一種既安全又有效的更新策略。   maxSurge: 升級過程中最多可以比原先設定所多出的pod 數量\nmaxUnavailable:最多可以有幾個 pod 處在無法服務的狀態  選項C：創建一個新的受管理實例組，並使用更新後的實例模板。將新組添加到負載平衡器的後端服務中，所有新管理組中的實例健康後，刪除舊的管理實例組。這個選項雖然可以保證在部署新版本時不減少可用容量，但比選項B更為繁瑣和昂貴。  選項D：創建一個新的實例模板並包含新版本的應用程序。使用新的實例模板更新現有的受管理實例組，然後刪除實例組中的實例，讓受管理實例組使用新的實例模板重新創建實例。這個選項並沒有明確保證在更新過程中保持可用容量不變，且刪除再創建的過程可能會暫時減少可用容量。     You are building an application that stores relational data from users.\nUsers across the globe will use this application.\nYour CTO is concerned about the scaling requirements because the size of the user base is unknown.\nYou need to implement a database solution that can scale with your user growth with minimum configuration changes.\nWhich storage solution should you use?   A. Cloud SQL\nB. Cloud Spanner \nC. Cloud Firestore \nD. Cloud Datastore\n  \n    解題  根據情境，需要一個可以隨著用戶增長而輕鬆擴展的數據庫解決方案，且涉及到關係性數據的存儲  A. Cloud SQL：是一種完全管理的關係數據庫服務，支援MySQL、PostgreSQL等。雖然它對於許多應用來說是個好選擇，但當涉及到需要自動橫向擴展以支持全球用戶和未知規模增長的應用時，Cloud SQL可能需要更多的配置和手動擴展操作。  B. Cloud Spanner：是Google Cloud提供的一種全球分佈式數據庫服務，既提供了關係數據庫的ACID事務特性，又具備NoSQL數據庫的橫向擴展能力。它能夠在全球範圍內無縫擴展，非常適合對於大小未知且可能迅速增長的用戶基礎。  C. Cloud Firestore：是一種高度擴展的NoSQL數據庫，適用於存儲靈活的、非結構化的數據。雖然它非常適合需要實時同步數據的應用，但對於需要關係數據存儲的場景可能不是最佳選擇。  D. Cloud Datastore：現在被Cloud Firestore的數據庫模式所取代，主要是針對應用程式提供自動擴展的NoSQL數據存儲解決方案。雖然適合存儲非關係性數據，但並不是專門設計來處理關係數據的最佳選項。  選項B：Cloud Spanner 是最適合你的需求的解決方案。它不僅提供了必要的關係數據庫功能，還能夠隨著用戶增長自動橫向擴展，並且需要的配置變更最小。但不便宜XD     You are the organization and billing administrator for your company.\nThe engineering team has the Project Creator role on the organization.\nYou do not want the engineering team to be able to link projects to the billing account.\nOnly the finance team should be able to link a project to a billing account, but they should not be able to make any other changes to projects.\nWhat should you do?   A. Assign the finance team only the Billing Account User role on the billing account.\nB. Assign the engineering team only the Billing Account User role on the billing account.\nC. Assign the finance team the Billing Account User role on the billing account and the Project Billing Manager role on the organization.\nD. Assign the engineering team the Billing Account User role on the billing account and the Project Billing Manager role on the organization.\n \n   \n    解題  答案為C，   Billing Account User 角色允許用戶管理計費賬戶的設置，包括將計費賬戶關聯到項目上。但是，這個角色本身不允許用戶對項目進行其他更改。  Project Billing Manager 角色可以讓用戶更改項目的計費賬戶關聯。將此角色授予財務團隊並在組織層級進行此操作，確保他們可以對任何項目進行計費賬戶的關聯操作，但沒有足夠的權限進行其他項目設置的更改。  選項A不符合需求，因為它只涵蓋了對計費賬戶的操作，沒有提及對項目計費的管理權限。  選項B和D都不適合，因為它們提供了工程團隊關聯計費賬戶的能力，這是你想要避免的。       You have an application running in Google Kubernetes Engine (GKE) with cluster autoscaling enabled.\nThe application exposes a TCP endpoint. There are several replicas of this application.\nYou have a Compute Engine instance in the same region but in another Virtual Private Cloud (VPC),\ncalled gce-network, that has no overlapping IP ranges with the first VPC.\nThis instance needs to connect to the application on GKE.\nYou want to minimize effort.\nWhat should you do?   A. \n    1. In GKE, create a Service of type LoadBalancer that uses the application's Pods as backend. \n    2. Set the service's externalTrafficPolicy to Cluster. \n    3. Configure the Compute Engine instance to use the address of the load balancer that has been created.\nB. \n    1. In GKE, create a Service of type NodePort that uses the application's Pods as backend. \n    2. Create a Compute Engine instance called proxy with 2 network interfaces, one in each VPC. \n    3. Use iptables on this instance to forward traffic from gcenetwork to the GKE nodes. \n    4. Configure the Compute Engine instance to use the address of proxy in gce-network as endpoint.\nC. \n    1. In GKE, create a Service of type LoadBalancer that uses the application's Pods as backend. \n    2. Add an annotation to this service: cloud.google.com/load-balancer-type: Internal \n    3. Peer the two VPCs together. \n    4. Configure the Compute Engine instance to use the address of the load balancer that has been created.\nD. \n    1. In GKE, create a Service of type LoadBalancer that uses the application's Pods as backend. \n    2. Add a Cloud Armor Security Policy to the load balancer that whitelists the internal IPs of the MIG's instances. \n    3. Configure the Compute Engine instance to use the address of the load balancer that has been created.\n \n   \n    解題  要讓一個位於另一個VPC中的Compute Engine實例連接到GKE上運行的應用，而且希望盡量減少工作量，最合適的選項是：C   在GKE中，創建一個LoadBalancer類型的服務，將應用程序的Pod用作後端。  在此服務上添加一個注釋：cloud.google.com/load-balancer-type: Internal。  將兩個VPC進行對等連接。  配置Compute Engine實例以使用已創建的負載均衡器的地址。  從安全性和最佳實踐的角度來看，選擇一個允許在私有網絡內通信的解決方案（如VPC對等連接），通常會比選擇一個將流量暴露於公共互聯網的方案更為推薦。這樣的配置不僅能夠降低資料被截獲的風險，還能夠在一定程度上減少延遲和提高連接的穩定性。  在這樣的背景下，選項C（使用VPC對等連接的內部LoadBalancer）可能會被視為更加適合的選擇，因為它符合最佳安全實踐並且直接回應了題目中的暗示。  其餘答案  A   在GKE中，創建一個LoadBalancer類型的服務，將應用程序的Pod用作後端。這將創建一個負載均衡器（Load Balancer）。  將服務的externalTrafficPolicy設置為Cluster。這個設置確保外部流量被導向到叢集中的Pod。  配置Compute Engine實例以使用已創建的負載均衡器的地址作為端點。  提供了一種通過創建一個外部負載平衡器來連接GKE應用和Compute Engine實例的方法。儘管這是最直接的方法，且在技術上可行，但它涉及到通過互聯網路由流量，這在安全性和延遲方面可能不是最佳選擇。考慮到題目提到的實例位於同一地區且無IP範圍重疊，這暗示了一種傾向於使用更私密連接的解決方案。  B.   在GKE中，創建一個NodePort類型的服務，將應用程序的Pod用作後端。  創建一個名為proxy的Compute Engine實例，該實例有2個網絡接口，一個在每個VPC中。  在此實例上使用iptables將流量從gce-network轉發到GKE節點。  配置Compute Engine實例以使用gce-network中proxy的地址作為端點。  涉及到創建一個類型為NodePort的Service，並使用一個配置了兩個網絡介面的代理Compute Engine實例來轉發流量。這種方法增加了設置的複雜性，需要手動配置網絡和iptables規則。儘管這為兩個不同VPC間的通信提供了一種可能的路徑，但它遠比選項A和C更為複雜，並且可能引入額外的延遲和管理負擔。  D.   在GKE中，創建一個LoadBalancer類型的服務，將應用程序的Pod用作後端。  在負載均衡器上添加一個Cloud Armor安全策略，該策略將MIG實例的內部IP列入白名單。  配置Compute Engine實例以使用已創建的負載均衡器的地址。  提出了創建一個外部負載平衡器並使用Cloud Armor安全策略來限制訪問的方案。雖然這可以提供額外的安全性控制，但就連接兩個VPC中資源的需求而言，它並不比選項A提供更多的私密性或效率。此外，這個方案也涉及到流量經過互聯網，與選項A類似，可能不是題目暗示的最佳選擇。     Your organization is a financial company that needs to store audit log files for 3 years. Your organizationhas hundreds of Google Cloud projects. You need to implement a cost-effective approach for log file retention. What should you do?   A. Create an export to the sink that saves logs from Cloud Audit to BigQuery.\nB. Create an export to the sink that saves logs from Cloud Audit to a Coldline Storage bucket.\nC. Write a custom script that uses logging API to copy the logs from Stackdriver logs to BigQuery.\nD. Export these logs to Cloud Pub/Sub and write a Cloud Dataflow pipeline to store logs to Cloud SQL.\n \n    \n    解題  您的組織是一家金融公司，需要存儲3年的審計日誌文件。您的組織擁有數百個Google Cloud項目。您需要實施一種成本效益的方法來保留日誌文件。您應該怎麼做？  對於需要長期存儲審計日誌文件的金融公司來說，選擇成本效益高的存儲解決方案至關重要。考慮到需求是存儲審計日誌文件長達3年，我們應該選擇一個既能保證數據安全又能在成本上有效管理的方案。  選項A：將日誌導出到BigQuery可能對於分析日誌非常有用，但長期存儲大量日誌數據可能成本較高，尤其是如果這些日誌不需要經常訪問。  選項B：將日誌導出到設定為Coldline存儲類別的Cloud Storage桶是一種成本效益高的選擇，特別適合於需要長期存儲但訪問頻率低的數據。Coldline存儲為低頻訪問的數據提供了較低的存儲成本。  選項C：編寫自定義腳本使用日誌API將日誌從Stackdriver日誌複製到BigQuery，這需要額外的開發工作，並且在長期存儲大量數據時可能不是最成本效益的選擇。  選項D：將這些日誌導出到Cloud Pub/Sub，然後編寫一個Cloud Dataflow管道將日誌存儲到Cloud SQL，這在技術上可行，但對於僅需長期存儲而言，這種方案過於複雜且成本可能相對較高。  基於成本效益的考慮，選項B是最合適的選擇。它直接使用Cloud Storage的Coldline存儲類別來存儲審計日誌，既能滿足長期存儲的要求，又能保持較低的成本。     You want to run a single caching HTTP reverse proxy on GCP for a latency-sensitive website. This specific reverse proxy consumes almost no CPU. You want to have a 30-GB in-memory cache, and need an additional 2 GB of memory for the rest of the processes. You want to minimize cost. How should you run this reverse proxy?   A. Create a Cloud Memorystore for Redis instance with 32-GB capacity.\nB. Run it on Compute Engine, and choose a custom instance type with 6 vCPUs and 32 GB of memory.\nC. Package it in a container image, and run it on Kubernetes Engine, using n1-standard-32 instances as nodes.\nD. Run it on Compute Engine, choose the instance type n1-standard-1, and add an SSD persistent disk of 32 GB.\n \n   \n    解題  您想在GCP上為一個對延遲敏感的網站運行一個單一的緩存HTTP反向代理。這個特定的反向代理幾乎不消耗CPU。您想要有一個30GB的內存緩存，並需要額外的2GB內存來運行其他進程。您希望最小化成本。您應該如何運行這個反向代理？  A是在 GCP 上運行緩存 HTTP 反向代理的最具成本效益的解決方案。Cloud Memorystore for Redis 是一項託管服務，可為您的應用程序提供內存緩存。它提供對 Redis 協議的高吞吐量和低延遲訪問。Cloud Memorystore 為 Redis 實例提供 99.9% 可用性的 SLA 和自動故障轉移。在這種情況下，32 GB Redis 實例足以容納 30 GB 緩存以及其餘進程所需的額外 2 GB 內存。該解決方案具有高度可擴展性，允許您隨著需求的增長而增加 Redis 實例的大小。  B 不是一個經濟高效的解決方案，因為它需要具有 6 個 vCPU 和 32 GB 內存的自定義實例類型，這對於緩存 HTTP 反向代理來說是過度配置的。  C 不是一個經濟高效的解決方案，因為它使用 Kubernetes Engine，管理開銷較高，並且對於單個緩存 HTTP 反向代理來說可能不是必需的。  D 不是一個可行的解決方案，因為實例類型 n1-standard-1 僅提供 3.75 GB 內存，不足以滿足 30 GB 緩存以及其餘進程所需的額外 2 GB 內存。添加 32 GB 的 SSD 永久磁盤將無法為反向代理提供足夠的內存。  反向代理幾乎不消耗CPU  Cloud Memorystore for Redis提供的是一個全管式的Redis服務，可以非常適合用作高性能的緩存解決方案。考慮到題目的需求是一個高效的緩存機制，而不是一個通用的計算實例，選擇選項A：創建一個32-GB容量的Cloud Memorystore for Redis實例，確實是一個更為合適的解答。這樣可以直接提供足夠的緩存空間，而且由於是全管式服務，可以減少管理複雜性和維護負擔。     You are hosting an application on bare-metal servers own data center. The application needs access to Cloud Storage. However, security policies prevent the servers hosting the application from having public IP addresses or access to the internet. You want to follow Google-recommended practices to provide the application with access to Cloud Storage. What should you do?   A. 1. Use nslookup to get the IP address for storage.googleapis.com. \n   2. Negotiate with the security team to be able to give a public IP address to the servers. \n   3. Only allow egress traffic from those servers to the IP addresses for storage.googleapis.com.\n\nB. 1. Using Cloud VPN, create a VPN tunnel to a Virtual Private Cloud (VPC) in Google Cloud. \n   2. In this VPC, create a Compute Engine instance and install the Squid proxy server on this instance. \n   3. Configure your servers to use that instance as a proxy to access Cloud Storage.\n\nC. 1. Use Migrate for Compute Engine (formerly known as Velostrata) to migrate those servers to Compute Engine. \n   2. Create an internal load balancer (ILB) that uses storage.googleapis.com as backend. \n   3. Configure your new instances to use this ILB as proxy.\n\nD. 1. Using Cloud VPN or Interconnect, create a tunnel to a VPC in Google Cloud. \n   2. Use Cloud Router to create a custom route advertisement for 199.36.153.4/30. Announce that network to your on-premises network through the VPN tunnel. \n   3. In your on-premises network, configure your DNS server to resolve *.googleapis.com as a CNAME to restricted.googleapis.com.\n  \n    解題  您正在自家數據中心的實體服務器上托管一個應用程序。該應用程序需要訪問雲存儲。然而，安全策略阻止托管應用程序的伺服器具有公共IP地址或訪問互聯網的權限。您想要遵循Google建議的最佳實踐，以為應用程序提供訪問雲存儲的權限。您應該怎麼做？  A. 1. 使用nslookup獲取storage.googleapis.com的IP地址。\n2. 與安全團隊協商，以便為伺服器提供公共IP地址。\n3. 僅允許從這些伺服器到storage.googleapis.com的IP地址的出口流量。  B. 1. 使用Cloud VPN，在Google Cloud中創建一個與虛擬專用雲（VPC）的VPN隧道。\n2. 在此VPC中，創建一個Compute Engine實例，並在此實例上安裝Squid代理伺服器。\n3. 配置您的伺服器以使用該實例作為代理來訪問雲存儲。  C. 1. 使用Migrate for Compute Engine（以前稱為Velostrata）將這些伺服器遷移到Compute Engine。\n2. 創建一個使用storage.googleapis.com作為後端的內部負載平衡器（ILB）。\n3. 配置您的新實例以使用此ILB作為代理。  D. 1. 使用Cloud VPN或Interconnect，在Google Cloud中創建一個與VPC的隧道。\n2. 使用Cloud Router創建一個自定義路由廣告，針對199.36.153.4/30。通過VPN隧道向您的本地網路宣佈該網路。\n3. 在您的本地網路中，配置您的DNS伺服器，將*.googleapis.com解析為restricted.googleapis.com的CNAME。  託管應用程序的服務器無法直接訪問公共IP。因此，要訪問 Google Cloud，必須通過 VPN。  D 是推薦的解決方案，因為它提供了與 Cloud Storage 的安全直接連接，無需訪問 Internet 或將服務器暴露給公共 IP 地址。  通過設置 VPN 或互連隧道，本地服務器可以通過私有加密連接訪問 Google Cloud 資源。  199.36.153.4/30 的自定義路由通告可確保流量在本地網絡和 Google Cloud 之間正確路由。     You want to deploy an application on Cloud Run that processes messages from a Cloud Pub/Sub topic. You want to follow Google-recommended practices. What should you do?   A. 1. Create a Cloud Function that uses a Cloud Pub/Sub trigger on that topic. \n   2. Call your application on Cloud Run from the Cloud Function for every message.\n\nB. 1. Grant the Pub/Sub Subscriber role to the service account used by Cloud Run. \n   2. Create a Cloud Pub/Sub subscription for that topic. \n   3. Make your application pull messages from that subscription.\n\nC. 1. Create a service account. \n   2. Give the Cloud Run Invoker role to that service account for your Cloud Run application. \n   3. Create a Cloud Pub/Sub subscription that uses that service account and uses your Cloud Run application as the push endpoint.\n\nD. 1. Deploy your application on Cloud Run on GKE with the connectivity set to Internal. \n  2. Create a Cloud Pub/Sub subscription for that topic. \n  3. In the same Google Kubernetes Engine cluster as your application, deploy a container that takes the messages and sends them to your application.\n \n   \n    解題     You need to deploy an application, which is packaged in a container image, in a new project. The application exposes an HTTP endpoint and receives very few requests per day. You want to minimize costs. What should you do?   A. Deploy the container on Cloud Run.\nB. Deploy the container on Cloud Run on GKE.\nC. Deploy the container on App Engine Flexible.\nD. Deploy the container on GKE with cluster autoscaling and horizontal pod autoscaling enabled.\n",{"$sdd-pages":129,"$sdd-surrounds":5041,"$sdd-globals":5261,"$scolor-mode":5263,"$sdd-navigation":5265,"$sicons":5314,"$sasideScroll":5335,"$sdocus-docs-aside-collapse-map-/":5336,"$sdocus-docs-aside-collapse-map-/code":5337,"$sdocus-docs-aside-collapse-map-/architecture":5338,"$sdocus-docs-aside-collapse-map-/desktop":5339,"$sdocus-docs-aside-collapse-map-/cloud-gcp":5340,"$sdocus-docs-aside-collapse-map-/database":5341,"$sdocus-docs-aside-collapse-map-/keycloak":5342,"$sdocus-docs-aside-collapse-map-/ironman-gcp":5343,"$sdocus-docs-aside-collapse-map-/license":5344},["ShallowRef",130],["ShallowReactive",131],{"/code/(di)":132},{"_path":15,"_dir":7,"_draft":133,"_partial":133,"_locale":9,"title":16,"description":17,"body":134,"_type":5036,"_id":14,"_source":5037,"_file":5038,"_extension":5039,"layout":5040},false,{"type":135,"children":136,"toc":5021},"root",[137,144,150,155,162,167,176,864,869,874,879,884,892,898,903,911,1610,1615,1624,1632,1640,1645,1653,1658,1664,1669,1689,1695,2100,2105,2492,2498,2826,2834,2839,2844,2849,2855,2860,2873,2878,2883,2888,2893,2901,2915,2920,2933,2938,2943,2948,2953,2958,2976,2982,2987,2992,3000,3005,3028,3033,3090,3095,3467,3472,3480,3486,3491,3496,3504,3508,3529,3534,3582,3587,4007,4012,4020,4025,4404,4409,4417,4423,4428,4436,4441,4459,4464,4469,4477,4482,4487,4492,4497,4502,4507,4512,4517,4525,4530,4569,4574,4582,4587,4657,4662,4967,4975,4980,4986,4991,5003,5010,5015],{"type":138,"tag":139,"props":140,"children":141},"element","p",{},[142],{"type":143,"value":17},"text",{"type":138,"tag":145,"props":146,"children":148},"h2",{"id":147},"a-依賴注入dependency-injection",[149],{"type":143,"value":19},{"type":138,"tag":139,"props":151,"children":152},{},[153],{"type":143,"value":154},"先來講依賴跟注入的概念",{"type":138,"tag":156,"props":157,"children":159},"h3",{"id":158},"a-dependency",[160],{"type":143,"value":161},"a. Dependency",{"type":138,"tag":139,"props":163,"children":164},{},[165],{"type":143,"value":166},"依賴如字面上所述，在軟體中，我們很常遇到物件彼此相依的狀況。如下圖，在做計算時需做Printer輸出資訊，因此Calculator物件會相依Printer物件，則在Instance Calculator物件時則就需要同步Instance Printer物件並帶入Calculator物件中。",{"type":138,"tag":139,"props":168,"children":169},{},[170],{"type":138,"tag":171,"props":172,"children":175},"img",{"alt":173,"src":174},"Object Reference","/blog/images/00/02/001.png",[],{"type":138,"tag":177,"props":178,"children":182},"pre",{"className":179,"code":180,"language":181,"meta":9},"language-csharp github-light_github-dark","public class Calculator\n{\n    public Printer Printer {get;private set}\n    public Add(int a, int b){\n        var sum = a+b;\n        Printer.ConsoleOut(sum);\n    }\n    public Calculator(Printer printer){\n        Printer = printer;\n    }\n}\npublic class Printer\n{\n    public void ConsoleOut(string txt) \n    {\n        Console.WriteLine(txt);\n    }\n}\nstatic class Program\n{\n    static void Main()\n    {\n        var printer = new Printer();\n        var calculator = new Calculator(printer);\n        calculator.Add(1+1); \n    }\n}\n","csharp",[183],{"type":138,"tag":7,"props":184,"children":185},{"__ignoreMap":9},[186,219,228,292,355,402,421,430,472,490,498,506,531,539,591,600,619,627,635,661,669,703,711,761,811,847,855],{"type":138,"tag":187,"props":188,"children":191},"span",{"class":189,"line":190},"line",1,[192,198,204,209,213],{"type":138,"tag":187,"props":193,"children":195},{"class":194},"ct-149352",[196],{"type":143,"value":197},"public",{"type":138,"tag":187,"props":199,"children":201},{"class":200},"ct-553616",[202],{"type":143,"value":203}," ",{"type":138,"tag":187,"props":205,"children":206},{"class":194},[207],{"type":143,"value":208},"class",{"type":138,"tag":187,"props":210,"children":211},{"class":200},[212],{"type":143,"value":203},{"type":138,"tag":187,"props":214,"children":216},{"class":215},"ct-762058",[217],{"type":143,"value":218},"Calculator\n",{"type":138,"tag":187,"props":220,"children":222},{"class":189,"line":221},2,[223],{"type":138,"tag":187,"props":224,"children":225},{"class":200},[226],{"type":143,"value":227},"{\n",{"type":138,"tag":187,"props":229,"children":231},{"class":189,"line":230},3,[232,237,241,245,250,254,258,263,268,273,278,282,287],{"type":138,"tag":187,"props":233,"children":234},{"class":200},[235],{"type":143,"value":236},"    ",{"type":138,"tag":187,"props":238,"children":239},{"class":194},[240],{"type":143,"value":197},{"type":138,"tag":187,"props":242,"children":243},{"class":200},[244],{"type":143,"value":203},{"type":138,"tag":187,"props":246,"children":247},{"class":215},[248],{"type":143,"value":249},"Printer",{"type":138,"tag":187,"props":251,"children":252},{"class":200},[253],{"type":143,"value":203},{"type":138,"tag":187,"props":255,"children":256},{"class":215},[257],{"type":143,"value":249},{"type":138,"tag":187,"props":259,"children":260},{"class":200},[261],{"type":143,"value":262}," {",{"type":138,"tag":187,"props":264,"children":265},{"class":194},[266],{"type":143,"value":267},"get",{"type":138,"tag":187,"props":269,"children":270},{"class":200},[271],{"type":143,"value":272},";",{"type":138,"tag":187,"props":274,"children":275},{"class":194},[276],{"type":143,"value":277},"private",{"type":138,"tag":187,"props":279,"children":280},{"class":200},[281],{"type":143,"value":203},{"type":138,"tag":187,"props":283,"children":284},{"class":194},[285],{"type":143,"value":286},"set",{"type":138,"tag":187,"props":288,"children":289},{"class":200},[290],{"type":143,"value":291},"}\n",{"type":138,"tag":187,"props":293,"children":295},{"class":189,"line":294},4,[296,300,304,308,313,318,323,327,332,337,341,345,350],{"type":138,"tag":187,"props":297,"children":298},{"class":200},[299],{"type":143,"value":236},{"type":138,"tag":187,"props":301,"children":302},{"class":194},[303],{"type":143,"value":197},{"type":138,"tag":187,"props":305,"children":306},{"class":200},[307],{"type":143,"value":203},{"type":138,"tag":187,"props":309,"children":310},{"class":215},[311],{"type":143,"value":312},"Add",{"type":138,"tag":187,"props":314,"children":315},{"class":200},[316],{"type":143,"value":317},"(",{"type":138,"tag":187,"props":319,"children":320},{"class":194},[321],{"type":143,"value":322},"int",{"type":138,"tag":187,"props":324,"children":325},{"class":200},[326],{"type":143,"value":203},{"type":138,"tag":187,"props":328,"children":329},{"class":215},[330],{"type":143,"value":331},"a",{"type":138,"tag":187,"props":333,"children":334},{"class":200},[335],{"type":143,"value":336},", ",{"type":138,"tag":187,"props":338,"children":339},{"class":194},[340],{"type":143,"value":322},{"type":138,"tag":187,"props":342,"children":343},{"class":200},[344],{"type":143,"value":203},{"type":138,"tag":187,"props":346,"children":347},{"class":215},[348],{"type":143,"value":349},"b",{"type":138,"tag":187,"props":351,"children":352},{"class":200},[353],{"type":143,"value":354},"){\n",{"type":138,"tag":187,"props":356,"children":358},{"class":189,"line":357},5,[359,364,369,373,378,382,387,392,397],{"type":138,"tag":187,"props":360,"children":361},{"class":200},[362],{"type":143,"value":363},"        ",{"type":138,"tag":187,"props":365,"children":366},{"class":194},[367],{"type":143,"value":368},"var",{"type":138,"tag":187,"props":370,"children":371},{"class":200},[372],{"type":143,"value":203},{"type":138,"tag":187,"props":374,"children":375},{"class":215},[376],{"type":143,"value":377},"sum",{"type":138,"tag":187,"props":379,"children":380},{"class":200},[381],{"type":143,"value":203},{"type":138,"tag":187,"props":383,"children":384},{"class":194},[385],{"type":143,"value":386},"=",{"type":138,"tag":187,"props":388,"children":389},{"class":200},[390],{"type":143,"value":391}," a",{"type":138,"tag":187,"props":393,"children":394},{"class":194},[395],{"type":143,"value":396},"+",{"type":138,"tag":187,"props":398,"children":399},{"class":200},[400],{"type":143,"value":401},"b;\n",{"type":138,"tag":187,"props":403,"children":405},{"class":189,"line":404},6,[406,411,416],{"type":138,"tag":187,"props":407,"children":408},{"class":200},[409],{"type":143,"value":410},"        Printer.",{"type":138,"tag":187,"props":412,"children":413},{"class":215},[414],{"type":143,"value":415},"ConsoleOut",{"type":138,"tag":187,"props":417,"children":418},{"class":200},[419],{"type":143,"value":420},"(sum);\n",{"type":138,"tag":187,"props":422,"children":424},{"class":189,"line":423},7,[425],{"type":138,"tag":187,"props":426,"children":427},{"class":200},[428],{"type":143,"value":429},"    }\n",{"type":138,"tag":187,"props":431,"children":433},{"class":189,"line":432},8,[434,438,442,446,451,455,459,463,468],{"type":138,"tag":187,"props":435,"children":436},{"class":200},[437],{"type":143,"value":236},{"type":138,"tag":187,"props":439,"children":440},{"class":194},[441],{"type":143,"value":197},{"type":138,"tag":187,"props":443,"children":444},{"class":200},[445],{"type":143,"value":203},{"type":138,"tag":187,"props":447,"children":448},{"class":215},[449],{"type":143,"value":450},"Calculator",{"type":138,"tag":187,"props":452,"children":453},{"class":200},[454],{"type":143,"value":317},{"type":138,"tag":187,"props":456,"children":457},{"class":215},[458],{"type":143,"value":249},{"type":138,"tag":187,"props":460,"children":461},{"class":200},[462],{"type":143,"value":203},{"type":138,"tag":187,"props":464,"children":465},{"class":215},[466],{"type":143,"value":467},"printer",{"type":138,"tag":187,"props":469,"children":470},{"class":200},[471],{"type":143,"value":354},{"type":138,"tag":187,"props":473,"children":475},{"class":189,"line":474},9,[476,481,485],{"type":138,"tag":187,"props":477,"children":478},{"class":200},[479],{"type":143,"value":480},"        Printer ",{"type":138,"tag":187,"props":482,"children":483},{"class":194},[484],{"type":143,"value":386},{"type":138,"tag":187,"props":486,"children":487},{"class":200},[488],{"type":143,"value":489}," printer;\n",{"type":138,"tag":187,"props":491,"children":493},{"class":189,"line":492},10,[494],{"type":138,"tag":187,"props":495,"children":496},{"class":200},[497],{"type":143,"value":429},{"type":138,"tag":187,"props":499,"children":501},{"class":189,"line":500},11,[502],{"type":138,"tag":187,"props":503,"children":504},{"class":200},[505],{"type":143,"value":291},{"type":138,"tag":187,"props":507,"children":509},{"class":189,"line":508},12,[510,514,518,522,526],{"type":138,"tag":187,"props":511,"children":512},{"class":194},[513],{"type":143,"value":197},{"type":138,"tag":187,"props":515,"children":516},{"class":200},[517],{"type":143,"value":203},{"type":138,"tag":187,"props":519,"children":520},{"class":194},[521],{"type":143,"value":208},{"type":138,"tag":187,"props":523,"children":524},{"class":200},[525],{"type":143,"value":203},{"type":138,"tag":187,"props":527,"children":528},{"class":215},[529],{"type":143,"value":530},"Printer\n",{"type":138,"tag":187,"props":532,"children":534},{"class":189,"line":533},13,[535],{"type":138,"tag":187,"props":536,"children":537},{"class":200},[538],{"type":143,"value":227},{"type":138,"tag":187,"props":540,"children":542},{"class":189,"line":541},14,[543,547,551,555,560,564,568,572,577,581,586],{"type":138,"tag":187,"props":544,"children":545},{"class":200},[546],{"type":143,"value":236},{"type":138,"tag":187,"props":548,"children":549},{"class":194},[550],{"type":143,"value":197},{"type":138,"tag":187,"props":552,"children":553},{"class":200},[554],{"type":143,"value":203},{"type":138,"tag":187,"props":556,"children":557},{"class":194},[558],{"type":143,"value":559},"void",{"type":138,"tag":187,"props":561,"children":562},{"class":200},[563],{"type":143,"value":203},{"type":138,"tag":187,"props":565,"children":566},{"class":215},[567],{"type":143,"value":415},{"type":138,"tag":187,"props":569,"children":570},{"class":200},[571],{"type":143,"value":317},{"type":138,"tag":187,"props":573,"children":574},{"class":194},[575],{"type":143,"value":576},"string",{"type":138,"tag":187,"props":578,"children":579},{"class":200},[580],{"type":143,"value":203},{"type":138,"tag":187,"props":582,"children":583},{"class":215},[584],{"type":143,"value":585},"txt",{"type":138,"tag":187,"props":587,"children":588},{"class":200},[589],{"type":143,"value":590},") \n",{"type":138,"tag":187,"props":592,"children":594},{"class":189,"line":593},15,[595],{"type":138,"tag":187,"props":596,"children":597},{"class":200},[598],{"type":143,"value":599},"    {\n",{"type":138,"tag":187,"props":601,"children":603},{"class":189,"line":602},16,[604,609,614],{"type":138,"tag":187,"props":605,"children":606},{"class":200},[607],{"type":143,"value":608},"        Console.",{"type":138,"tag":187,"props":610,"children":611},{"class":215},[612],{"type":143,"value":613},"WriteLine",{"type":138,"tag":187,"props":615,"children":616},{"class":200},[617],{"type":143,"value":618},"(txt);\n",{"type":138,"tag":187,"props":620,"children":622},{"class":189,"line":621},17,[623],{"type":138,"tag":187,"props":624,"children":625},{"class":200},[626],{"type":143,"value":429},{"type":138,"tag":187,"props":628,"children":630},{"class":189,"line":629},18,[631],{"type":138,"tag":187,"props":632,"children":633},{"class":200},[634],{"type":143,"value":291},{"type":138,"tag":187,"props":636,"children":638},{"class":189,"line":637},19,[639,644,648,652,656],{"type":138,"tag":187,"props":640,"children":641},{"class":194},[642],{"type":143,"value":643},"static",{"type":138,"tag":187,"props":645,"children":646},{"class":200},[647],{"type":143,"value":203},{"type":138,"tag":187,"props":649,"children":650},{"class":194},[651],{"type":143,"value":208},{"type":138,"tag":187,"props":653,"children":654},{"class":200},[655],{"type":143,"value":203},{"type":138,"tag":187,"props":657,"children":658},{"class":215},[659],{"type":143,"value":660},"Program\n",{"type":138,"tag":187,"props":662,"children":664},{"class":189,"line":663},20,[665],{"type":138,"tag":187,"props":666,"children":667},{"class":200},[668],{"type":143,"value":227},{"type":138,"tag":187,"props":670,"children":672},{"class":189,"line":671},21,[673,677,681,685,689,693,698],{"type":138,"tag":187,"props":674,"children":675},{"class":200},[676],{"type":143,"value":236},{"type":138,"tag":187,"props":678,"children":679},{"class":194},[680],{"type":143,"value":643},{"type":138,"tag":187,"props":682,"children":683},{"class":200},[684],{"type":143,"value":203},{"type":138,"tag":187,"props":686,"children":687},{"class":194},[688],{"type":143,"value":559},{"type":138,"tag":187,"props":690,"children":691},{"class":200},[692],{"type":143,"value":203},{"type":138,"tag":187,"props":694,"children":695},{"class":215},[696],{"type":143,"value":697},"Main",{"type":138,"tag":187,"props":699,"children":700},{"class":200},[701],{"type":143,"value":702},"()\n",{"type":138,"tag":187,"props":704,"children":706},{"class":189,"line":705},22,[707],{"type":138,"tag":187,"props":708,"children":709},{"class":200},[710],{"type":143,"value":599},{"type":138,"tag":187,"props":712,"children":714},{"class":189,"line":713},23,[715,719,723,727,731,735,739,743,748,752,756],{"type":138,"tag":187,"props":716,"children":717},{"class":200},[718],{"type":143,"value":363},{"type":138,"tag":187,"props":720,"children":721},{"class":194},[722],{"type":143,"value":368},{"type":138,"tag":187,"props":724,"children":725},{"class":200},[726],{"type":143,"value":203},{"type":138,"tag":187,"props":728,"children":729},{"class":215},[730],{"type":143,"value":467},{"type":138,"tag":187,"props":732,"children":733},{"class":200},[734],{"type":143,"value":203},{"type":138,"tag":187,"props":736,"children":737},{"class":194},[738],{"type":143,"value":386},{"type":138,"tag":187,"props":740,"children":741},{"class":200},[742],{"type":143,"value":203},{"type":138,"tag":187,"props":744,"children":745},{"class":194},[746],{"type":143,"value":747},"new",{"type":138,"tag":187,"props":749,"children":750},{"class":200},[751],{"type":143,"value":203},{"type":138,"tag":187,"props":753,"children":754},{"class":215},[755],{"type":143,"value":249},{"type":138,"tag":187,"props":757,"children":758},{"class":200},[759],{"type":143,"value":760},"();\n",{"type":138,"tag":187,"props":762,"children":764},{"class":189,"line":763},24,[765,769,773,777,782,786,790,794,798,802,806],{"type":138,"tag":187,"props":766,"children":767},{"class":200},[768],{"type":143,"value":363},{"type":138,"tag":187,"props":770,"children":771},{"class":194},[772],{"type":143,"value":368},{"type":138,"tag":187,"props":774,"children":775},{"class":200},[776],{"type":143,"value":203},{"type":138,"tag":187,"props":778,"children":779},{"class":215},[780],{"type":143,"value":781},"calculator",{"type":138,"tag":187,"props":783,"children":784},{"class":200},[785],{"type":143,"value":203},{"type":138,"tag":187,"props":787,"children":788},{"class":194},[789],{"type":143,"value":386},{"type":138,"tag":187,"props":791,"children":792},{"class":200},[793],{"type":143,"value":203},{"type":138,"tag":187,"props":795,"children":796},{"class":194},[797],{"type":143,"value":747},{"type":138,"tag":187,"props":799,"children":800},{"class":200},[801],{"type":143,"value":203},{"type":138,"tag":187,"props":803,"children":804},{"class":215},[805],{"type":143,"value":450},{"type":138,"tag":187,"props":807,"children":808},{"class":200},[809],{"type":143,"value":810},"(printer);\n",{"type":138,"tag":187,"props":812,"children":814},{"class":189,"line":813},25,[815,820,824,828,834,838,842],{"type":138,"tag":187,"props":816,"children":817},{"class":200},[818],{"type":143,"value":819},"        calculator.",{"type":138,"tag":187,"props":821,"children":822},{"class":215},[823],{"type":143,"value":312},{"type":138,"tag":187,"props":825,"children":826},{"class":200},[827],{"type":143,"value":317},{"type":138,"tag":187,"props":829,"children":831},{"class":830},"ct-617022",[832],{"type":143,"value":833},"1",{"type":138,"tag":187,"props":835,"children":836},{"class":194},[837],{"type":143,"value":396},{"type":138,"tag":187,"props":839,"children":840},{"class":830},[841],{"type":143,"value":833},{"type":138,"tag":187,"props":843,"children":844},{"class":200},[845],{"type":143,"value":846},"); \n",{"type":138,"tag":187,"props":848,"children":850},{"class":189,"line":849},26,[851],{"type":138,"tag":187,"props":852,"children":853},{"class":200},[854],{"type":143,"value":429},{"type":138,"tag":187,"props":856,"children":858},{"class":189,"line":857},27,[859],{"type":138,"tag":187,"props":860,"children":861},{"class":200},[862],{"type":143,"value":863},"}",{"type":138,"tag":139,"props":865,"children":866},{},[867],{"type":143,"value":868},"這例子為Calculator依賴Printer，所以控制權不是在Printer身上。什麼意思? 簡單來說當Printer有異動時，會有一定程度是影響到Calculator的。",{"type":138,"tag":139,"props":870,"children":871},{},[872],{"type":143,"value":873},"對於物件依賴這件事情我在網上看到一個例子描述還蠻貼切的，今天有一名8+9在吸食毒品如下。8+9 以為自己吸食毒品只是滿足自己的快感，他還以為他自己的意志行為是被自己所掌控",{"type":138,"tag":139,"props":875,"children":876},{},[877],{"type":143,"value":878},"錯!!!",{"type":138,"tag":139,"props":880,"children":881},{},[882],{"type":143,"value":883},"其實8+9這時候所有的行為已經被毒品所控制，再也離不開毒品了。",{"type":138,"tag":139,"props":885,"children":886},{},[887],{"type":138,"tag":171,"props":888,"children":891},{"alt":889,"src":890},"8+9","/blog/images/00/02/002.png",[],{"type":138,"tag":156,"props":893,"children":895},{"id":894},"b-dependency-with-interface",[896],{"type":143,"value":897},"b. Dependency With Interface",{"type":138,"tag":139,"props":899,"children":900},{},[901],{"type":143,"value":902},"那我們該如何解除依賴關係? 一般來說，在實作方法時，我們會讓物件去相依介面，讓物件彼此因介面而解偶，如下圖",{"type":138,"tag":139,"props":904,"children":905},{},[906],{"type":138,"tag":171,"props":907,"children":910},{"alt":908,"src":909},"Dependency With Interface","/blog/images/00/02/003.png",[],{"type":138,"tag":177,"props":912,"children":914},{"className":179,"code":913,"language":181,"meta":9},"public class Calculator\n{\n    public IPrinter Printer {get;private set}\n    public Add(int a, int b){\n        var sum = a+b;\n        Printer.ConsoleOut(sum);\n    }\n    public Calculator(IPrinter printer){\n        Printer = printer;\n    }\n}\npublic class Printer:IPrinter\n{\n    public void ConsoleOut(string txt) \n    {\n        Console.WriteLine(txt);\n    }\n}\n\npublic interface IPrinter{\n    void ConsoleOut(string txt);\n}\n\nstatic class Program\n{\n    static void Main()\n    {\n        IPrinter printer = new Printer();\n        var calculator = new Calculator(printer);\n        calculator.Add(1+1); \n    }\n}\n",[915],{"type":138,"tag":7,"props":916,"children":917},{"__ignoreMap":9},[918,941,948,1004,1059,1098,1113,1120,1159,1174,1181,1188,1221,1228,1275,1282,1297,1304,1311,1317,1345,1385,1392,1398,1421,1428,1459,1466,1514,1562,1594,1602],{"type":138,"tag":187,"props":919,"children":920},{"class":189,"line":190},[921,925,929,933,937],{"type":138,"tag":187,"props":922,"children":923},{"class":194},[924],{"type":143,"value":197},{"type":138,"tag":187,"props":926,"children":927},{"class":200},[928],{"type":143,"value":203},{"type":138,"tag":187,"props":930,"children":931},{"class":194},[932],{"type":143,"value":208},{"type":138,"tag":187,"props":934,"children":935},{"class":200},[936],{"type":143,"value":203},{"type":138,"tag":187,"props":938,"children":939},{"class":215},[940],{"type":143,"value":218},{"type":138,"tag":187,"props":942,"children":943},{"class":189,"line":221},[944],{"type":138,"tag":187,"props":945,"children":946},{"class":200},[947],{"type":143,"value":227},{"type":138,"tag":187,"props":949,"children":950},{"class":189,"line":230},[951,955,959,963,968,972,976,980,984,988,992,996,1000],{"type":138,"tag":187,"props":952,"children":953},{"class":200},[954],{"type":143,"value":236},{"type":138,"tag":187,"props":956,"children":957},{"class":194},[958],{"type":143,"value":197},{"type":138,"tag":187,"props":960,"children":961},{"class":200},[962],{"type":143,"value":203},{"type":138,"tag":187,"props":964,"children":965},{"class":215},[966],{"type":143,"value":967},"IPrinter",{"type":138,"tag":187,"props":969,"children":970},{"class":200},[971],{"type":143,"value":203},{"type":138,"tag":187,"props":973,"children":974},{"class":215},[975],{"type":143,"value":249},{"type":138,"tag":187,"props":977,"children":978},{"class":200},[979],{"type":143,"value":262},{"type":138,"tag":187,"props":981,"children":982},{"class":194},[983],{"type":143,"value":267},{"type":138,"tag":187,"props":985,"children":986},{"class":200},[987],{"type":143,"value":272},{"type":138,"tag":187,"props":989,"children":990},{"class":194},[991],{"type":143,"value":277},{"type":138,"tag":187,"props":993,"children":994},{"class":200},[995],{"type":143,"value":203},{"type":138,"tag":187,"props":997,"children":998},{"class":194},[999],{"type":143,"value":286},{"type":138,"tag":187,"props":1001,"children":1002},{"class":200},[1003],{"type":143,"value":291},{"type":138,"tag":187,"props":1005,"children":1006},{"class":189,"line":294},[1007,1011,1015,1019,1023,1027,1031,1035,1039,1043,1047,1051,1055],{"type":138,"tag":187,"props":1008,"children":1009},{"class":200},[1010],{"type":143,"value":236},{"type":138,"tag":187,"props":1012,"children":1013},{"class":194},[1014],{"type":143,"value":197},{"type":138,"tag":187,"props":1016,"children":1017},{"class":200},[1018],{"type":143,"value":203},{"type":138,"tag":187,"props":1020,"children":1021},{"class":215},[1022],{"type":143,"value":312},{"type":138,"tag":187,"props":1024,"children":1025},{"class":200},[1026],{"type":143,"value":317},{"type":138,"tag":187,"props":1028,"children":1029},{"class":194},[1030],{"type":143,"value":322},{"type":138,"tag":187,"props":1032,"children":1033},{"class":200},[1034],{"type":143,"value":203},{"type":138,"tag":187,"props":1036,"children":1037},{"class":215},[1038],{"type":143,"value":331},{"type":138,"tag":187,"props":1040,"children":1041},{"class":200},[1042],{"type":143,"value":336},{"type":138,"tag":187,"props":1044,"children":1045},{"class":194},[1046],{"type":143,"value":322},{"type":138,"tag":187,"props":1048,"children":1049},{"class":200},[1050],{"type":143,"value":203},{"type":138,"tag":187,"props":1052,"children":1053},{"class":215},[1054],{"type":143,"value":349},{"type":138,"tag":187,"props":1056,"children":1057},{"class":200},[1058],{"type":143,"value":354},{"type":138,"tag":187,"props":1060,"children":1061},{"class":189,"line":357},[1062,1066,1070,1074,1078,1082,1086,1090,1094],{"type":138,"tag":187,"props":1063,"children":1064},{"class":200},[1065],{"type":143,"value":363},{"type":138,"tag":187,"props":1067,"children":1068},{"class":194},[1069],{"type":143,"value":368},{"type":138,"tag":187,"props":1071,"children":1072},{"class":200},[1073],{"type":143,"value":203},{"type":138,"tag":187,"props":1075,"children":1076},{"class":215},[1077],{"type":143,"value":377},{"type":138,"tag":187,"props":1079,"children":1080},{"class":200},[1081],{"type":143,"value":203},{"type":138,"tag":187,"props":1083,"children":1084},{"class":194},[1085],{"type":143,"value":386},{"type":138,"tag":187,"props":1087,"children":1088},{"class":200},[1089],{"type":143,"value":391},{"type":138,"tag":187,"props":1091,"children":1092},{"class":194},[1093],{"type":143,"value":396},{"type":138,"tag":187,"props":1095,"children":1096},{"class":200},[1097],{"type":143,"value":401},{"type":138,"tag":187,"props":1099,"children":1100},{"class":189,"line":404},[1101,1105,1109],{"type":138,"tag":187,"props":1102,"children":1103},{"class":200},[1104],{"type":143,"value":410},{"type":138,"tag":187,"props":1106,"children":1107},{"class":215},[1108],{"type":143,"value":415},{"type":138,"tag":187,"props":1110,"children":1111},{"class":200},[1112],{"type":143,"value":420},{"type":138,"tag":187,"props":1114,"children":1115},{"class":189,"line":423},[1116],{"type":138,"tag":187,"props":1117,"children":1118},{"class":200},[1119],{"type":143,"value":429},{"type":138,"tag":187,"props":1121,"children":1122},{"class":189,"line":432},[1123,1127,1131,1135,1139,1143,1147,1151,1155],{"type":138,"tag":187,"props":1124,"children":1125},{"class":200},[1126],{"type":143,"value":236},{"type":138,"tag":187,"props":1128,"children":1129},{"class":194},[1130],{"type":143,"value":197},{"type":138,"tag":187,"props":1132,"children":1133},{"class":200},[1134],{"type":143,"value":203},{"type":138,"tag":187,"props":1136,"children":1137},{"class":215},[1138],{"type":143,"value":450},{"type":138,"tag":187,"props":1140,"children":1141},{"class":200},[1142],{"type":143,"value":317},{"type":138,"tag":187,"props":1144,"children":1145},{"class":215},[1146],{"type":143,"value":967},{"type":138,"tag":187,"props":1148,"children":1149},{"class":200},[1150],{"type":143,"value":203},{"type":138,"tag":187,"props":1152,"children":1153},{"class":215},[1154],{"type":143,"value":467},{"type":138,"tag":187,"props":1156,"children":1157},{"class":200},[1158],{"type":143,"value":354},{"type":138,"tag":187,"props":1160,"children":1161},{"class":189,"line":474},[1162,1166,1170],{"type":138,"tag":187,"props":1163,"children":1164},{"class":200},[1165],{"type":143,"value":480},{"type":138,"tag":187,"props":1167,"children":1168},{"class":194},[1169],{"type":143,"value":386},{"type":138,"tag":187,"props":1171,"children":1172},{"class":200},[1173],{"type":143,"value":489},{"type":138,"tag":187,"props":1175,"children":1176},{"class":189,"line":492},[1177],{"type":138,"tag":187,"props":1178,"children":1179},{"class":200},[1180],{"type":143,"value":429},{"type":138,"tag":187,"props":1182,"children":1183},{"class":189,"line":500},[1184],{"type":138,"tag":187,"props":1185,"children":1186},{"class":200},[1187],{"type":143,"value":291},{"type":138,"tag":187,"props":1189,"children":1190},{"class":189,"line":508},[1191,1195,1199,1203,1207,1211,1216],{"type":138,"tag":187,"props":1192,"children":1193},{"class":194},[1194],{"type":143,"value":197},{"type":138,"tag":187,"props":1196,"children":1197},{"class":200},[1198],{"type":143,"value":203},{"type":138,"tag":187,"props":1200,"children":1201},{"class":194},[1202],{"type":143,"value":208},{"type":138,"tag":187,"props":1204,"children":1205},{"class":200},[1206],{"type":143,"value":203},{"type":138,"tag":187,"props":1208,"children":1209},{"class":215},[1210],{"type":143,"value":249},{"type":138,"tag":187,"props":1212,"children":1213},{"class":200},[1214],{"type":143,"value":1215},":",{"type":138,"tag":187,"props":1217,"children":1218},{"class":215},[1219],{"type":143,"value":1220},"IPrinter\n",{"type":138,"tag":187,"props":1222,"children":1223},{"class":189,"line":533},[1224],{"type":138,"tag":187,"props":1225,"children":1226},{"class":200},[1227],{"type":143,"value":227},{"type":138,"tag":187,"props":1229,"children":1230},{"class":189,"line":541},[1231,1235,1239,1243,1247,1251,1255,1259,1263,1267,1271],{"type":138,"tag":187,"props":1232,"children":1233},{"class":200},[1234],{"type":143,"value":236},{"type":138,"tag":187,"props":1236,"children":1237},{"class":194},[1238],{"type":143,"value":197},{"type":138,"tag":187,"props":1240,"children":1241},{"class":200},[1242],{"type":143,"value":203},{"type":138,"tag":187,"props":1244,"children":1245},{"class":194},[1246],{"type":143,"value":559},{"type":138,"tag":187,"props":1248,"children":1249},{"class":200},[1250],{"type":143,"value":203},{"type":138,"tag":187,"props":1252,"children":1253},{"class":215},[1254],{"type":143,"value":415},{"type":138,"tag":187,"props":1256,"children":1257},{"class":200},[1258],{"type":143,"value":317},{"type":138,"tag":187,"props":1260,"children":1261},{"class":194},[1262],{"type":143,"value":576},{"type":138,"tag":187,"props":1264,"children":1265},{"class":200},[1266],{"type":143,"value":203},{"type":138,"tag":187,"props":1268,"children":1269},{"class":215},[1270],{"type":143,"value":585},{"type":138,"tag":187,"props":1272,"children":1273},{"class":200},[1274],{"type":143,"value":590},{"type":138,"tag":187,"props":1276,"children":1277},{"class":189,"line":593},[1278],{"type":138,"tag":187,"props":1279,"children":1280},{"class":200},[1281],{"type":143,"value":599},{"type":138,"tag":187,"props":1283,"children":1284},{"class":189,"line":602},[1285,1289,1293],{"type":138,"tag":187,"props":1286,"children":1287},{"class":200},[1288],{"type":143,"value":608},{"type":138,"tag":187,"props":1290,"children":1291},{"class":215},[1292],{"type":143,"value":613},{"type":138,"tag":187,"props":1294,"children":1295},{"class":200},[1296],{"type":143,"value":618},{"type":138,"tag":187,"props":1298,"children":1299},{"class":189,"line":621},[1300],{"type":138,"tag":187,"props":1301,"children":1302},{"class":200},[1303],{"type":143,"value":429},{"type":138,"tag":187,"props":1305,"children":1306},{"class":189,"line":629},[1307],{"type":138,"tag":187,"props":1308,"children":1309},{"class":200},[1310],{"type":143,"value":291},{"type":138,"tag":187,"props":1312,"children":1313},{"class":189,"line":637},[1314],{"type":138,"tag":187,"props":1315,"children":1316},{},[],{"type":138,"tag":187,"props":1318,"children":1319},{"class":189,"line":663},[1320,1324,1328,1333,1337,1341],{"type":138,"tag":187,"props":1321,"children":1322},{"class":194},[1323],{"type":143,"value":197},{"type":138,"tag":187,"props":1325,"children":1326},{"class":200},[1327],{"type":143,"value":203},{"type":138,"tag":187,"props":1329,"children":1330},{"class":194},[1331],{"type":143,"value":1332},"interface",{"type":138,"tag":187,"props":1334,"children":1335},{"class":200},[1336],{"type":143,"value":203},{"type":138,"tag":187,"props":1338,"children":1339},{"class":215},[1340],{"type":143,"value":967},{"type":138,"tag":187,"props":1342,"children":1343},{"class":200},[1344],{"type":143,"value":227},{"type":138,"tag":187,"props":1346,"children":1347},{"class":189,"line":671},[1348,1352,1356,1360,1364,1368,1372,1376,1380],{"type":138,"tag":187,"props":1349,"children":1350},{"class":200},[1351],{"type":143,"value":236},{"type":138,"tag":187,"props":1353,"children":1354},{"class":194},[1355],{"type":143,"value":559},{"type":138,"tag":187,"props":1357,"children":1358},{"class":200},[1359],{"type":143,"value":203},{"type":138,"tag":187,"props":1361,"children":1362},{"class":215},[1363],{"type":143,"value":415},{"type":138,"tag":187,"props":1365,"children":1366},{"class":200},[1367],{"type":143,"value":317},{"type":138,"tag":187,"props":1369,"children":1370},{"class":194},[1371],{"type":143,"value":576},{"type":138,"tag":187,"props":1373,"children":1374},{"class":200},[1375],{"type":143,"value":203},{"type":138,"tag":187,"props":1377,"children":1378},{"class":215},[1379],{"type":143,"value":585},{"type":138,"tag":187,"props":1381,"children":1382},{"class":200},[1383],{"type":143,"value":1384},");\n",{"type":138,"tag":187,"props":1386,"children":1387},{"class":189,"line":705},[1388],{"type":138,"tag":187,"props":1389,"children":1390},{"class":200},[1391],{"type":143,"value":291},{"type":138,"tag":187,"props":1393,"children":1394},{"class":189,"line":713},[1395],{"type":138,"tag":187,"props":1396,"children":1397},{},[],{"type":138,"tag":187,"props":1399,"children":1400},{"class":189,"line":763},[1401,1405,1409,1413,1417],{"type":138,"tag":187,"props":1402,"children":1403},{"class":194},[1404],{"type":143,"value":643},{"type":138,"tag":187,"props":1406,"children":1407},{"class":200},[1408],{"type":143,"value":203},{"type":138,"tag":187,"props":1410,"children":1411},{"class":194},[1412],{"type":143,"value":208},{"type":138,"tag":187,"props":1414,"children":1415},{"class":200},[1416],{"type":143,"value":203},{"type":138,"tag":187,"props":1418,"children":1419},{"class":215},[1420],{"type":143,"value":660},{"type":138,"tag":187,"props":1422,"children":1423},{"class":189,"line":813},[1424],{"type":138,"tag":187,"props":1425,"children":1426},{"class":200},[1427],{"type":143,"value":227},{"type":138,"tag":187,"props":1429,"children":1430},{"class":189,"line":849},[1431,1435,1439,1443,1447,1451,1455],{"type":138,"tag":187,"props":1432,"children":1433},{"class":200},[1434],{"type":143,"value":236},{"type":138,"tag":187,"props":1436,"children":1437},{"class":194},[1438],{"type":143,"value":643},{"type":138,"tag":187,"props":1440,"children":1441},{"class":200},[1442],{"type":143,"value":203},{"type":138,"tag":187,"props":1444,"children":1445},{"class":194},[1446],{"type":143,"value":559},{"type":138,"tag":187,"props":1448,"children":1449},{"class":200},[1450],{"type":143,"value":203},{"type":138,"tag":187,"props":1452,"children":1453},{"class":215},[1454],{"type":143,"value":697},{"type":138,"tag":187,"props":1456,"children":1457},{"class":200},[1458],{"type":143,"value":702},{"type":138,"tag":187,"props":1460,"children":1461},{"class":189,"line":857},[1462],{"type":138,"tag":187,"props":1463,"children":1464},{"class":200},[1465],{"type":143,"value":599},{"type":138,"tag":187,"props":1467,"children":1469},{"class":189,"line":1468},28,[1470,1474,1478,1482,1486,1490,1494,1498,1502,1506,1510],{"type":138,"tag":187,"props":1471,"children":1472},{"class":200},[1473],{"type":143,"value":363},{"type":138,"tag":187,"props":1475,"children":1476},{"class":215},[1477],{"type":143,"value":967},{"type":138,"tag":187,"props":1479,"children":1480},{"class":200},[1481],{"type":143,"value":203},{"type":138,"tag":187,"props":1483,"children":1484},{"class":215},[1485],{"type":143,"value":467},{"type":138,"tag":187,"props":1487,"children":1488},{"class":200},[1489],{"type":143,"value":203},{"type":138,"tag":187,"props":1491,"children":1492},{"class":194},[1493],{"type":143,"value":386},{"type":138,"tag":187,"props":1495,"children":1496},{"class":200},[1497],{"type":143,"value":203},{"type":138,"tag":187,"props":1499,"children":1500},{"class":194},[1501],{"type":143,"value":747},{"type":138,"tag":187,"props":1503,"children":1504},{"class":200},[1505],{"type":143,"value":203},{"type":138,"tag":187,"props":1507,"children":1508},{"class":215},[1509],{"type":143,"value":249},{"type":138,"tag":187,"props":1511,"children":1512},{"class":200},[1513],{"type":143,"value":760},{"type":138,"tag":187,"props":1515,"children":1517},{"class":189,"line":1516},29,[1518,1522,1526,1530,1534,1538,1542,1546,1550,1554,1558],{"type":138,"tag":187,"props":1519,"children":1520},{"class":200},[1521],{"type":143,"value":363},{"type":138,"tag":187,"props":1523,"children":1524},{"class":194},[1525],{"type":143,"value":368},{"type":138,"tag":187,"props":1527,"children":1528},{"class":200},[1529],{"type":143,"value":203},{"type":138,"tag":187,"props":1531,"children":1532},{"class":215},[1533],{"type":143,"value":781},{"type":138,"tag":187,"props":1535,"children":1536},{"class":200},[1537],{"type":143,"value":203},{"type":138,"tag":187,"props":1539,"children":1540},{"class":194},[1541],{"type":143,"value":386},{"type":138,"tag":187,"props":1543,"children":1544},{"class":200},[1545],{"type":143,"value":203},{"type":138,"tag":187,"props":1547,"children":1548},{"class":194},[1549],{"type":143,"value":747},{"type":138,"tag":187,"props":1551,"children":1552},{"class":200},[1553],{"type":143,"value":203},{"type":138,"tag":187,"props":1555,"children":1556},{"class":215},[1557],{"type":143,"value":450},{"type":138,"tag":187,"props":1559,"children":1560},{"class":200},[1561],{"type":143,"value":810},{"type":138,"tag":187,"props":1563,"children":1565},{"class":189,"line":1564},30,[1566,1570,1574,1578,1582,1586,1590],{"type":138,"tag":187,"props":1567,"children":1568},{"class":200},[1569],{"type":143,"value":819},{"type":138,"tag":187,"props":1571,"children":1572},{"class":215},[1573],{"type":143,"value":312},{"type":138,"tag":187,"props":1575,"children":1576},{"class":200},[1577],{"type":143,"value":317},{"type":138,"tag":187,"props":1579,"children":1580},{"class":830},[1581],{"type":143,"value":833},{"type":138,"tag":187,"props":1583,"children":1584},{"class":194},[1585],{"type":143,"value":396},{"type":138,"tag":187,"props":1587,"children":1588},{"class":830},[1589],{"type":143,"value":833},{"type":138,"tag":187,"props":1591,"children":1592},{"class":200},[1593],{"type":143,"value":846},{"type":138,"tag":187,"props":1595,"children":1597},{"class":189,"line":1596},31,[1598],{"type":138,"tag":187,"props":1599,"children":1600},{"class":200},[1601],{"type":143,"value":429},{"type":138,"tag":187,"props":1603,"children":1605},{"class":189,"line":1604},32,[1606],{"type":138,"tag":187,"props":1607,"children":1608},{"class":200},[1609],{"type":143,"value":863},{"type":138,"tag":139,"props":1611,"children":1612},{},[1613],{"type":143,"value":1614},"因相依介面，若我們要抽換功能，例如原本的Console輸出改成輸出至記事本。只需要在新增一個記事本輸出方法，替換掉原本的28行的printer即可。而這狀況我們稱為Dependency Inversion Principle(DIP)，依賴倒轉原則。簡單來說就是解除高階模組和低階模組的依賴關係。",{"type":138,"tag":1616,"props":1617,"children":1618},"blockquote",{},[1619],{"type":138,"tag":139,"props":1620,"children":1621},{},[1622],{"type":143,"value":1623},"高低階模組定義",{"type":138,"tag":1616,"props":1625,"children":1626},{},[1627],{"type":138,"tag":139,"props":1628,"children":1629},{},[1630],{"type":143,"value":1631},"高階模組指的是呼叫者(Caller)-Calculator",{"type":138,"tag":1616,"props":1633,"children":1634},{},[1635],{"type":138,"tag":139,"props":1636,"children":1637},{},[1638],{"type":143,"value":1639},"低階模組就是被呼叫者(Callee)-Printer",{"type":138,"tag":139,"props":1641,"children":1642},{},[1643],{"type":143,"value":1644},"我們再回到8+9例子，今天想要讓8+9改過向上，戒毒成為奮發向上的好青年。因為現在8+9直接依賴著毒品，我們讓8+9改成依賴藥品這個介面。",{"type":138,"tag":139,"props":1646,"children":1647},{},[1648],{"type":138,"tag":171,"props":1649,"children":1652},{"alt":1650,"src":1651},"Dependency With Interface 8+9","/blog/images/00/02/004.png",[],{"type":138,"tag":139,"props":1654,"children":1655},{},[1656],{"type":143,"value":1657},"現在我們成功讓8+9依賴藥品而不是毒品。然後再將做一個健康食品的類別實作藥品，然後偷偷把毒品換成健康食品。這樣子8+9以為自己吃的藥品是毒品，實際上卻是每天吃健康食品，於是8+9頭腦變好了 走路也不晃了 考試也考100分成為國家的棟樑。",{"type":138,"tag":156,"props":1659,"children":1661},{"id":1660},"c-injection",[1662],{"type":143,"value":1663},"c. Injection",{"type":138,"tag":139,"props":1665,"children":1666},{},[1667],{"type":143,"value":1668},"接著講注入，上述Calculator例子注入方式稱為建構子注入，其實注入平常我們就有在使用。一般人比較不會注意到這些行為其實就是一種注入。常見的注入模式有三種",{"type":138,"tag":1670,"props":1671,"children":1672},"ul",{},[1673,1679,1684],{"type":138,"tag":1674,"props":1675,"children":1676},"li",{},[1677],{"type":143,"value":1678},"建構子注入(Constructor Injection)",{"type":138,"tag":1674,"props":1680,"children":1681},{},[1682],{"type":143,"value":1683},"屬性注入(Property Injection)",{"type":138,"tag":1674,"props":1685,"children":1686},{},[1687],{"type":143,"value":1688},"方法注入(Method Injection)",{"type":138,"tag":1690,"props":1691,"children":1693},"h4",{"id":1692},"建構子注入constructor-injection",[1694],{"type":143,"value":1678},{"type":138,"tag":177,"props":1696,"children":1700},{"className":1697,"code":1698,"language":1699,"meta":9},"language-java github-light_github-dark","// 汽車的抽象介面\npublic interface ICar {\n    // 行駛汽車\n    void run();\n}\n\n// 司機的抽象介面\npublic interface IDriver {\n    // 司機駕駛汽車\n    void drive();\n}\n\n// 實作司機的抽象類別\npublic class Driver implements IDriver {\n    private ICar car;\n    // 建構子方式注入抽象類別\n    public Driver(ICar car){\n        this.car = car;\n    }    \n    @Override\n    public void drive() {\n        car.run();\n    }\n}\n","java",[1701],{"type":138,"tag":7,"props":1702,"children":1703},{"__ignoreMap":9},[1704,1713,1742,1754,1778,1785,1791,1799,1827,1839,1863,1870,1876,1884,1929,1945,1957,1991,2017,2025,2038,2070,2086,2093],{"type":138,"tag":187,"props":1705,"children":1706},{"class":189,"line":190},[1707],{"type":138,"tag":187,"props":1708,"children":1710},{"class":1709},"ct-086898",[1711],{"type":143,"value":1712},"// 汽車的抽象介面\n",{"type":138,"tag":187,"props":1714,"children":1715},{"class":189,"line":221},[1716,1720,1724,1728,1732,1737],{"type":138,"tag":187,"props":1717,"children":1718},{"class":194},[1719],{"type":143,"value":197},{"type":138,"tag":187,"props":1721,"children":1722},{"class":200},[1723],{"type":143,"value":203},{"type":138,"tag":187,"props":1725,"children":1726},{"class":194},[1727],{"type":143,"value":1332},{"type":138,"tag":187,"props":1729,"children":1730},{"class":200},[1731],{"type":143,"value":203},{"type":138,"tag":187,"props":1733,"children":1734},{"class":215},[1735],{"type":143,"value":1736},"ICar",{"type":138,"tag":187,"props":1738,"children":1739},{"class":200},[1740],{"type":143,"value":1741}," {\n",{"type":138,"tag":187,"props":1743,"children":1744},{"class":189,"line":230},[1745,1749],{"type":138,"tag":187,"props":1746,"children":1747},{"class":200},[1748],{"type":143,"value":236},{"type":138,"tag":187,"props":1750,"children":1751},{"class":1709},[1752],{"type":143,"value":1753},"// 行駛汽車\n",{"type":138,"tag":187,"props":1755,"children":1756},{"class":189,"line":294},[1757,1761,1765,1769,1774],{"type":138,"tag":187,"props":1758,"children":1759},{"class":200},[1760],{"type":143,"value":236},{"type":138,"tag":187,"props":1762,"children":1763},{"class":194},[1764],{"type":143,"value":559},{"type":138,"tag":187,"props":1766,"children":1767},{"class":200},[1768],{"type":143,"value":203},{"type":138,"tag":187,"props":1770,"children":1771},{"class":215},[1772],{"type":143,"value":1773},"run",{"type":138,"tag":187,"props":1775,"children":1776},{"class":200},[1777],{"type":143,"value":760},{"type":138,"tag":187,"props":1779,"children":1780},{"class":189,"line":357},[1781],{"type":138,"tag":187,"props":1782,"children":1783},{"class":200},[1784],{"type":143,"value":291},{"type":138,"tag":187,"props":1786,"children":1787},{"class":189,"line":404},[1788],{"type":138,"tag":187,"props":1789,"children":1790},{},[],{"type":138,"tag":187,"props":1792,"children":1793},{"class":189,"line":423},[1794],{"type":138,"tag":187,"props":1795,"children":1796},{"class":1709},[1797],{"type":143,"value":1798},"// 司機的抽象介面\n",{"type":138,"tag":187,"props":1800,"children":1801},{"class":189,"line":432},[1802,1806,1810,1814,1818,1823],{"type":138,"tag":187,"props":1803,"children":1804},{"class":194},[1805],{"type":143,"value":197},{"type":138,"tag":187,"props":1807,"children":1808},{"class":200},[1809],{"type":143,"value":203},{"type":138,"tag":187,"props":1811,"children":1812},{"class":194},[1813],{"type":143,"value":1332},{"type":138,"tag":187,"props":1815,"children":1816},{"class":200},[1817],{"type":143,"value":203},{"type":138,"tag":187,"props":1819,"children":1820},{"class":215},[1821],{"type":143,"value":1822},"IDriver",{"type":138,"tag":187,"props":1824,"children":1825},{"class":200},[1826],{"type":143,"value":1741},{"type":138,"tag":187,"props":1828,"children":1829},{"class":189,"line":474},[1830,1834],{"type":138,"tag":187,"props":1831,"children":1832},{"class":200},[1833],{"type":143,"value":236},{"type":138,"tag":187,"props":1835,"children":1836},{"class":1709},[1837],{"type":143,"value":1838},"// 司機駕駛汽車\n",{"type":138,"tag":187,"props":1840,"children":1841},{"class":189,"line":492},[1842,1846,1850,1854,1859],{"type":138,"tag":187,"props":1843,"children":1844},{"class":200},[1845],{"type":143,"value":236},{"type":138,"tag":187,"props":1847,"children":1848},{"class":194},[1849],{"type":143,"value":559},{"type":138,"tag":187,"props":1851,"children":1852},{"class":200},[1853],{"type":143,"value":203},{"type":138,"tag":187,"props":1855,"children":1856},{"class":215},[1857],{"type":143,"value":1858},"drive",{"type":138,"tag":187,"props":1860,"children":1861},{"class":200},[1862],{"type":143,"value":760},{"type":138,"tag":187,"props":1864,"children":1865},{"class":189,"line":500},[1866],{"type":138,"tag":187,"props":1867,"children":1868},{"class":200},[1869],{"type":143,"value":291},{"type":138,"tag":187,"props":1871,"children":1872},{"class":189,"line":508},[1873],{"type":138,"tag":187,"props":1874,"children":1875},{},[],{"type":138,"tag":187,"props":1877,"children":1878},{"class":189,"line":533},[1879],{"type":138,"tag":187,"props":1880,"children":1881},{"class":1709},[1882],{"type":143,"value":1883},"// 實作司機的抽象類別\n",{"type":138,"tag":187,"props":1885,"children":1886},{"class":189,"line":541},[1887,1891,1895,1899,1903,1908,1912,1917,1921,1925],{"type":138,"tag":187,"props":1888,"children":1889},{"class":194},[1890],{"type":143,"value":197},{"type":138,"tag":187,"props":1892,"children":1893},{"class":200},[1894],{"type":143,"value":203},{"type":138,"tag":187,"props":1896,"children":1897},{"class":194},[1898],{"type":143,"value":208},{"type":138,"tag":187,"props":1900,"children":1901},{"class":200},[1902],{"type":143,"value":203},{"type":138,"tag":187,"props":1904,"children":1905},{"class":215},[1906],{"type":143,"value":1907},"Driver",{"type":138,"tag":187,"props":1909,"children":1910},{"class":200},[1911],{"type":143,"value":203},{"type":138,"tag":187,"props":1913,"children":1914},{"class":194},[1915],{"type":143,"value":1916},"implements",{"type":138,"tag":187,"props":1918,"children":1919},{"class":200},[1920],{"type":143,"value":203},{"type":138,"tag":187,"props":1922,"children":1923},{"class":215},[1924],{"type":143,"value":1822},{"type":138,"tag":187,"props":1926,"children":1927},{"class":200},[1928],{"type":143,"value":1741},{"type":138,"tag":187,"props":1930,"children":1931},{"class":189,"line":593},[1932,1936,1940],{"type":138,"tag":187,"props":1933,"children":1934},{"class":200},[1935],{"type":143,"value":236},{"type":138,"tag":187,"props":1937,"children":1938},{"class":194},[1939],{"type":143,"value":277},{"type":138,"tag":187,"props":1941,"children":1942},{"class":200},[1943],{"type":143,"value":1944}," ICar car;\n",{"type":138,"tag":187,"props":1946,"children":1947},{"class":189,"line":602},[1948,1952],{"type":138,"tag":187,"props":1949,"children":1950},{"class":200},[1951],{"type":143,"value":236},{"type":138,"tag":187,"props":1953,"children":1954},{"class":1709},[1955],{"type":143,"value":1956},"// 建構子方式注入抽象類別\n",{"type":138,"tag":187,"props":1958,"children":1959},{"class":189,"line":621},[1960,1964,1968,1972,1976,1981,1987],{"type":138,"tag":187,"props":1961,"children":1962},{"class":200},[1963],{"type":143,"value":236},{"type":138,"tag":187,"props":1965,"children":1966},{"class":194},[1967],{"type":143,"value":197},{"type":138,"tag":187,"props":1969,"children":1970},{"class":200},[1971],{"type":143,"value":203},{"type":138,"tag":187,"props":1973,"children":1974},{"class":215},[1975],{"type":143,"value":1907},{"type":138,"tag":187,"props":1977,"children":1978},{"class":200},[1979],{"type":143,"value":1980},"(ICar ",{"type":138,"tag":187,"props":1982,"children":1984},{"class":1983},"ct-157101",[1985],{"type":143,"value":1986},"car",{"type":138,"tag":187,"props":1988,"children":1989},{"class":200},[1990],{"type":143,"value":354},{"type":138,"tag":187,"props":1992,"children":1993},{"class":189,"line":629},[1994,1998,2003,2008,2012],{"type":138,"tag":187,"props":1995,"children":1996},{"class":200},[1997],{"type":143,"value":363},{"type":138,"tag":187,"props":1999,"children":2000},{"class":830},[2001],{"type":143,"value":2002},"this",{"type":138,"tag":187,"props":2004,"children":2005},{"class":200},[2006],{"type":143,"value":2007},".car ",{"type":138,"tag":187,"props":2009,"children":2010},{"class":194},[2011],{"type":143,"value":386},{"type":138,"tag":187,"props":2013,"children":2014},{"class":200},[2015],{"type":143,"value":2016}," car;\n",{"type":138,"tag":187,"props":2018,"children":2019},{"class":189,"line":637},[2020],{"type":138,"tag":187,"props":2021,"children":2022},{"class":200},[2023],{"type":143,"value":2024},"    }    \n",{"type":138,"tag":187,"props":2026,"children":2027},{"class":189,"line":663},[2028,2033],{"type":138,"tag":187,"props":2029,"children":2030},{"class":200},[2031],{"type":143,"value":2032},"    @",{"type":138,"tag":187,"props":2034,"children":2035},{"class":194},[2036],{"type":143,"value":2037},"Override\n",{"type":138,"tag":187,"props":2039,"children":2040},{"class":189,"line":671},[2041,2045,2049,2053,2057,2061,2065],{"type":138,"tag":187,"props":2042,"children":2043},{"class":200},[2044],{"type":143,"value":236},{"type":138,"tag":187,"props":2046,"children":2047},{"class":194},[2048],{"type":143,"value":197},{"type":138,"tag":187,"props":2050,"children":2051},{"class":200},[2052],{"type":143,"value":203},{"type":138,"tag":187,"props":2054,"children":2055},{"class":194},[2056],{"type":143,"value":559},{"type":138,"tag":187,"props":2058,"children":2059},{"class":200},[2060],{"type":143,"value":203},{"type":138,"tag":187,"props":2062,"children":2063},{"class":215},[2064],{"type":143,"value":1858},{"type":138,"tag":187,"props":2066,"children":2067},{"class":200},[2068],{"type":143,"value":2069},"() {\n",{"type":138,"tag":187,"props":2071,"children":2072},{"class":189,"line":705},[2073,2078,2082],{"type":138,"tag":187,"props":2074,"children":2075},{"class":200},[2076],{"type":143,"value":2077},"        car.",{"type":138,"tag":187,"props":2079,"children":2080},{"class":215},[2081],{"type":143,"value":1773},{"type":138,"tag":187,"props":2083,"children":2084},{"class":200},[2085],{"type":143,"value":760},{"type":138,"tag":187,"props":2087,"children":2088},{"class":189,"line":713},[2089],{"type":138,"tag":187,"props":2090,"children":2091},{"class":200},[2092],{"type":143,"value":429},{"type":138,"tag":187,"props":2094,"children":2095},{"class":189,"line":763},[2096],{"type":138,"tag":187,"props":2097,"children":2098},{"class":200},[2099],{"type":143,"value":863},{"type":138,"tag":1690,"props":2101,"children":2103},{"id":2102},"屬性注入property-injection",[2104],{"type":143,"value":1683},{"type":138,"tag":177,"props":2106,"children":2108},{"className":1697,"code":2107,"language":1699,"meta":9},"// 汽車的抽象介面\npublic interface ICar {\n    // 行駛汽車\n    void run();\n}\n\n// 司機的抽象介面\npublic interface IDriver {\n    // 司機駕駛汽車\n    void drive();\n}\n\n// 實作司機的抽象類別\npublic class Driver implements IDriver {\n    private ICar car;\n    // 使用setter來傳遞物件 (c# get set)\n    public setCar(ICar car){\n        this.car = car;\n    }\n      \n    @Override\n    public void drive() {\n        car.run();\n    }\n}\n",[2109],{"type":138,"tag":7,"props":2110,"children":2111},{"__ignoreMap":9},[2112,2119,2146,2157,2180,2187,2193,2200,2227,2238,2261,2268,2274,2281,2324,2339,2351,2383,2406,2413,2421,2432,2463,2478,2485],{"type":138,"tag":187,"props":2113,"children":2114},{"class":189,"line":190},[2115],{"type":138,"tag":187,"props":2116,"children":2117},{"class":1709},[2118],{"type":143,"value":1712},{"type":138,"tag":187,"props":2120,"children":2121},{"class":189,"line":221},[2122,2126,2130,2134,2138,2142],{"type":138,"tag":187,"props":2123,"children":2124},{"class":194},[2125],{"type":143,"value":197},{"type":138,"tag":187,"props":2127,"children":2128},{"class":200},[2129],{"type":143,"value":203},{"type":138,"tag":187,"props":2131,"children":2132},{"class":194},[2133],{"type":143,"value":1332},{"type":138,"tag":187,"props":2135,"children":2136},{"class":200},[2137],{"type":143,"value":203},{"type":138,"tag":187,"props":2139,"children":2140},{"class":215},[2141],{"type":143,"value":1736},{"type":138,"tag":187,"props":2143,"children":2144},{"class":200},[2145],{"type":143,"value":1741},{"type":138,"tag":187,"props":2147,"children":2148},{"class":189,"line":230},[2149,2153],{"type":138,"tag":187,"props":2150,"children":2151},{"class":200},[2152],{"type":143,"value":236},{"type":138,"tag":187,"props":2154,"children":2155},{"class":1709},[2156],{"type":143,"value":1753},{"type":138,"tag":187,"props":2158,"children":2159},{"class":189,"line":294},[2160,2164,2168,2172,2176],{"type":138,"tag":187,"props":2161,"children":2162},{"class":200},[2163],{"type":143,"value":236},{"type":138,"tag":187,"props":2165,"children":2166},{"class":194},[2167],{"type":143,"value":559},{"type":138,"tag":187,"props":2169,"children":2170},{"class":200},[2171],{"type":143,"value":203},{"type":138,"tag":187,"props":2173,"children":2174},{"class":215},[2175],{"type":143,"value":1773},{"type":138,"tag":187,"props":2177,"children":2178},{"class":200},[2179],{"type":143,"value":760},{"type":138,"tag":187,"props":2181,"children":2182},{"class":189,"line":357},[2183],{"type":138,"tag":187,"props":2184,"children":2185},{"class":200},[2186],{"type":143,"value":291},{"type":138,"tag":187,"props":2188,"children":2189},{"class":189,"line":404},[2190],{"type":138,"tag":187,"props":2191,"children":2192},{},[],{"type":138,"tag":187,"props":2194,"children":2195},{"class":189,"line":423},[2196],{"type":138,"tag":187,"props":2197,"children":2198},{"class":1709},[2199],{"type":143,"value":1798},{"type":138,"tag":187,"props":2201,"children":2202},{"class":189,"line":432},[2203,2207,2211,2215,2219,2223],{"type":138,"tag":187,"props":2204,"children":2205},{"class":194},[2206],{"type":143,"value":197},{"type":138,"tag":187,"props":2208,"children":2209},{"class":200},[2210],{"type":143,"value":203},{"type":138,"tag":187,"props":2212,"children":2213},{"class":194},[2214],{"type":143,"value":1332},{"type":138,"tag":187,"props":2216,"children":2217},{"class":200},[2218],{"type":143,"value":203},{"type":138,"tag":187,"props":2220,"children":2221},{"class":215},[2222],{"type":143,"value":1822},{"type":138,"tag":187,"props":2224,"children":2225},{"class":200},[2226],{"type":143,"value":1741},{"type":138,"tag":187,"props":2228,"children":2229},{"class":189,"line":474},[2230,2234],{"type":138,"tag":187,"props":2231,"children":2232},{"class":200},[2233],{"type":143,"value":236},{"type":138,"tag":187,"props":2235,"children":2236},{"class":1709},[2237],{"type":143,"value":1838},{"type":138,"tag":187,"props":2239,"children":2240},{"class":189,"line":492},[2241,2245,2249,2253,2257],{"type":138,"tag":187,"props":2242,"children":2243},{"class":200},[2244],{"type":143,"value":236},{"type":138,"tag":187,"props":2246,"children":2247},{"class":194},[2248],{"type":143,"value":559},{"type":138,"tag":187,"props":2250,"children":2251},{"class":200},[2252],{"type":143,"value":203},{"type":138,"tag":187,"props":2254,"children":2255},{"class":215},[2256],{"type":143,"value":1858},{"type":138,"tag":187,"props":2258,"children":2259},{"class":200},[2260],{"type":143,"value":760},{"type":138,"tag":187,"props":2262,"children":2263},{"class":189,"line":500},[2264],{"type":138,"tag":187,"props":2265,"children":2266},{"class":200},[2267],{"type":143,"value":291},{"type":138,"tag":187,"props":2269,"children":2270},{"class":189,"line":508},[2271],{"type":138,"tag":187,"props":2272,"children":2273},{},[],{"type":138,"tag":187,"props":2275,"children":2276},{"class":189,"line":533},[2277],{"type":138,"tag":187,"props":2278,"children":2279},{"class":1709},[2280],{"type":143,"value":1883},{"type":138,"tag":187,"props":2282,"children":2283},{"class":189,"line":541},[2284,2288,2292,2296,2300,2304,2308,2312,2316,2320],{"type":138,"tag":187,"props":2285,"children":2286},{"class":194},[2287],{"type":143,"value":197},{"type":138,"tag":187,"props":2289,"children":2290},{"class":200},[2291],{"type":143,"value":203},{"type":138,"tag":187,"props":2293,"children":2294},{"class":194},[2295],{"type":143,"value":208},{"type":138,"tag":187,"props":2297,"children":2298},{"class":200},[2299],{"type":143,"value":203},{"type":138,"tag":187,"props":2301,"children":2302},{"class":215},[2303],{"type":143,"value":1907},{"type":138,"tag":187,"props":2305,"children":2306},{"class":200},[2307],{"type":143,"value":203},{"type":138,"tag":187,"props":2309,"children":2310},{"class":194},[2311],{"type":143,"value":1916},{"type":138,"tag":187,"props":2313,"children":2314},{"class":200},[2315],{"type":143,"value":203},{"type":138,"tag":187,"props":2317,"children":2318},{"class":215},[2319],{"type":143,"value":1822},{"type":138,"tag":187,"props":2321,"children":2322},{"class":200},[2323],{"type":143,"value":1741},{"type":138,"tag":187,"props":2325,"children":2326},{"class":189,"line":593},[2327,2331,2335],{"type":138,"tag":187,"props":2328,"children":2329},{"class":200},[2330],{"type":143,"value":236},{"type":138,"tag":187,"props":2332,"children":2333},{"class":194},[2334],{"type":143,"value":277},{"type":138,"tag":187,"props":2336,"children":2337},{"class":200},[2338],{"type":143,"value":1944},{"type":138,"tag":187,"props":2340,"children":2341},{"class":189,"line":602},[2342,2346],{"type":138,"tag":187,"props":2343,"children":2344},{"class":200},[2345],{"type":143,"value":236},{"type":138,"tag":187,"props":2347,"children":2348},{"class":1709},[2349],{"type":143,"value":2350},"// 使用setter來傳遞物件 (c# get set)\n",{"type":138,"tag":187,"props":2352,"children":2353},{"class":189,"line":621},[2354,2358,2362,2366,2371,2375,2379],{"type":138,"tag":187,"props":2355,"children":2356},{"class":200},[2357],{"type":143,"value":236},{"type":138,"tag":187,"props":2359,"children":2360},{"class":194},[2361],{"type":143,"value":197},{"type":138,"tag":187,"props":2363,"children":2364},{"class":200},[2365],{"type":143,"value":203},{"type":138,"tag":187,"props":2367,"children":2368},{"class":215},[2369],{"type":143,"value":2370},"setCar",{"type":138,"tag":187,"props":2372,"children":2373},{"class":200},[2374],{"type":143,"value":1980},{"type":138,"tag":187,"props":2376,"children":2377},{"class":1983},[2378],{"type":143,"value":1986},{"type":138,"tag":187,"props":2380,"children":2381},{"class":200},[2382],{"type":143,"value":354},{"type":138,"tag":187,"props":2384,"children":2385},{"class":189,"line":629},[2386,2390,2394,2398,2402],{"type":138,"tag":187,"props":2387,"children":2388},{"class":200},[2389],{"type":143,"value":363},{"type":138,"tag":187,"props":2391,"children":2392},{"class":830},[2393],{"type":143,"value":2002},{"type":138,"tag":187,"props":2395,"children":2396},{"class":200},[2397],{"type":143,"value":2007},{"type":138,"tag":187,"props":2399,"children":2400},{"class":194},[2401],{"type":143,"value":386},{"type":138,"tag":187,"props":2403,"children":2404},{"class":200},[2405],{"type":143,"value":2016},{"type":138,"tag":187,"props":2407,"children":2408},{"class":189,"line":637},[2409],{"type":138,"tag":187,"props":2410,"children":2411},{"class":200},[2412],{"type":143,"value":429},{"type":138,"tag":187,"props":2414,"children":2415},{"class":189,"line":663},[2416],{"type":138,"tag":187,"props":2417,"children":2418},{"class":200},[2419],{"type":143,"value":2420},"      \n",{"type":138,"tag":187,"props":2422,"children":2423},{"class":189,"line":671},[2424,2428],{"type":138,"tag":187,"props":2425,"children":2426},{"class":200},[2427],{"type":143,"value":2032},{"type":138,"tag":187,"props":2429,"children":2430},{"class":194},[2431],{"type":143,"value":2037},{"type":138,"tag":187,"props":2433,"children":2434},{"class":189,"line":705},[2435,2439,2443,2447,2451,2455,2459],{"type":138,"tag":187,"props":2436,"children":2437},{"class":200},[2438],{"type":143,"value":236},{"type":138,"tag":187,"props":2440,"children":2441},{"class":194},[2442],{"type":143,"value":197},{"type":138,"tag":187,"props":2444,"children":2445},{"class":200},[2446],{"type":143,"value":203},{"type":138,"tag":187,"props":2448,"children":2449},{"class":194},[2450],{"type":143,"value":559},{"type":138,"tag":187,"props":2452,"children":2453},{"class":200},[2454],{"type":143,"value":203},{"type":138,"tag":187,"props":2456,"children":2457},{"class":215},[2458],{"type":143,"value":1858},{"type":138,"tag":187,"props":2460,"children":2461},{"class":200},[2462],{"type":143,"value":2069},{"type":138,"tag":187,"props":2464,"children":2465},{"class":189,"line":713},[2466,2470,2474],{"type":138,"tag":187,"props":2467,"children":2468},{"class":200},[2469],{"type":143,"value":2077},{"type":138,"tag":187,"props":2471,"children":2472},{"class":215},[2473],{"type":143,"value":1773},{"type":138,"tag":187,"props":2475,"children":2476},{"class":200},[2477],{"type":143,"value":760},{"type":138,"tag":187,"props":2479,"children":2480},{"class":189,"line":763},[2481],{"type":138,"tag":187,"props":2482,"children":2483},{"class":200},[2484],{"type":143,"value":429},{"type":138,"tag":187,"props":2486,"children":2487},{"class":189,"line":813},[2488],{"type":138,"tag":187,"props":2489,"children":2490},{"class":200},[2491],{"type":143,"value":863},{"type":138,"tag":1690,"props":2493,"children":2495},{"id":2494},"方法注入property-injection",[2496],{"type":143,"value":2497},"方法注入(Property Injection)",{"type":138,"tag":177,"props":2499,"children":2501},{"className":1697,"code":2500,"language":1699,"meta":9},"// 汽車的抽象介面\npublic interface ICar {\n    // 行駛汽車\n    void run();\n}\n \n// 司機的抽象介面\npublic interface IDriver {\n    // 司機駕駛汽車\n    void drive(ICar car);\n}\n\n\n// 實作司機的抽象類別\npublic class Driver implements IDriver {\n     // 使用介面來傳遞物件\n    @Override\n    public void drive(ICar car) {\n        car.run();\n    }\n}\n",[2502],{"type":138,"tag":7,"props":2503,"children":2504},{"__ignoreMap":9},[2505,2512,2539,2550,2573,2580,2588,2595,2622,2633,2664,2671,2677,2683,2690,2733,2746,2757,2797,2812,2819],{"type":138,"tag":187,"props":2506,"children":2507},{"class":189,"line":190},[2508],{"type":138,"tag":187,"props":2509,"children":2510},{"class":1709},[2511],{"type":143,"value":1712},{"type":138,"tag":187,"props":2513,"children":2514},{"class":189,"line":221},[2515,2519,2523,2527,2531,2535],{"type":138,"tag":187,"props":2516,"children":2517},{"class":194},[2518],{"type":143,"value":197},{"type":138,"tag":187,"props":2520,"children":2521},{"class":200},[2522],{"type":143,"value":203},{"type":138,"tag":187,"props":2524,"children":2525},{"class":194},[2526],{"type":143,"value":1332},{"type":138,"tag":187,"props":2528,"children":2529},{"class":200},[2530],{"type":143,"value":203},{"type":138,"tag":187,"props":2532,"children":2533},{"class":215},[2534],{"type":143,"value":1736},{"type":138,"tag":187,"props":2536,"children":2537},{"class":200},[2538],{"type":143,"value":1741},{"type":138,"tag":187,"props":2540,"children":2541},{"class":189,"line":230},[2542,2546],{"type":138,"tag":187,"props":2543,"children":2544},{"class":200},[2545],{"type":143,"value":236},{"type":138,"tag":187,"props":2547,"children":2548},{"class":1709},[2549],{"type":143,"value":1753},{"type":138,"tag":187,"props":2551,"children":2552},{"class":189,"line":294},[2553,2557,2561,2565,2569],{"type":138,"tag":187,"props":2554,"children":2555},{"class":200},[2556],{"type":143,"value":236},{"type":138,"tag":187,"props":2558,"children":2559},{"class":194},[2560],{"type":143,"value":559},{"type":138,"tag":187,"props":2562,"children":2563},{"class":200},[2564],{"type":143,"value":203},{"type":138,"tag":187,"props":2566,"children":2567},{"class":215},[2568],{"type":143,"value":1773},{"type":138,"tag":187,"props":2570,"children":2571},{"class":200},[2572],{"type":143,"value":760},{"type":138,"tag":187,"props":2574,"children":2575},{"class":189,"line":357},[2576],{"type":138,"tag":187,"props":2577,"children":2578},{"class":200},[2579],{"type":143,"value":291},{"type":138,"tag":187,"props":2581,"children":2582},{"class":189,"line":404},[2583],{"type":138,"tag":187,"props":2584,"children":2585},{"class":200},[2586],{"type":143,"value":2587}," \n",{"type":138,"tag":187,"props":2589,"children":2590},{"class":189,"line":423},[2591],{"type":138,"tag":187,"props":2592,"children":2593},{"class":1709},[2594],{"type":143,"value":1798},{"type":138,"tag":187,"props":2596,"children":2597},{"class":189,"line":432},[2598,2602,2606,2610,2614,2618],{"type":138,"tag":187,"props":2599,"children":2600},{"class":194},[2601],{"type":143,"value":197},{"type":138,"tag":187,"props":2603,"children":2604},{"class":200},[2605],{"type":143,"value":203},{"type":138,"tag":187,"props":2607,"children":2608},{"class":194},[2609],{"type":143,"value":1332},{"type":138,"tag":187,"props":2611,"children":2612},{"class":200},[2613],{"type":143,"value":203},{"type":138,"tag":187,"props":2615,"children":2616},{"class":215},[2617],{"type":143,"value":1822},{"type":138,"tag":187,"props":2619,"children":2620},{"class":200},[2621],{"type":143,"value":1741},{"type":138,"tag":187,"props":2623,"children":2624},{"class":189,"line":474},[2625,2629],{"type":138,"tag":187,"props":2626,"children":2627},{"class":200},[2628],{"type":143,"value":236},{"type":138,"tag":187,"props":2630,"children":2631},{"class":1709},[2632],{"type":143,"value":1838},{"type":138,"tag":187,"props":2634,"children":2635},{"class":189,"line":492},[2636,2640,2644,2648,2652,2656,2660],{"type":138,"tag":187,"props":2637,"children":2638},{"class":200},[2639],{"type":143,"value":236},{"type":138,"tag":187,"props":2641,"children":2642},{"class":194},[2643],{"type":143,"value":559},{"type":138,"tag":187,"props":2645,"children":2646},{"class":200},[2647],{"type":143,"value":203},{"type":138,"tag":187,"props":2649,"children":2650},{"class":215},[2651],{"type":143,"value":1858},{"type":138,"tag":187,"props":2653,"children":2654},{"class":200},[2655],{"type":143,"value":1980},{"type":138,"tag":187,"props":2657,"children":2658},{"class":1983},[2659],{"type":143,"value":1986},{"type":138,"tag":187,"props":2661,"children":2662},{"class":200},[2663],{"type":143,"value":1384},{"type":138,"tag":187,"props":2665,"children":2666},{"class":189,"line":500},[2667],{"type":138,"tag":187,"props":2668,"children":2669},{"class":200},[2670],{"type":143,"value":291},{"type":138,"tag":187,"props":2672,"children":2673},{"class":189,"line":508},[2674],{"type":138,"tag":187,"props":2675,"children":2676},{},[],{"type":138,"tag":187,"props":2678,"children":2679},{"class":189,"line":533},[2680],{"type":138,"tag":187,"props":2681,"children":2682},{},[],{"type":138,"tag":187,"props":2684,"children":2685},{"class":189,"line":541},[2686],{"type":138,"tag":187,"props":2687,"children":2688},{"class":1709},[2689],{"type":143,"value":1883},{"type":138,"tag":187,"props":2691,"children":2692},{"class":189,"line":593},[2693,2697,2701,2705,2709,2713,2717,2721,2725,2729],{"type":138,"tag":187,"props":2694,"children":2695},{"class":194},[2696],{"type":143,"value":197},{"type":138,"tag":187,"props":2698,"children":2699},{"class":200},[2700],{"type":143,"value":203},{"type":138,"tag":187,"props":2702,"children":2703},{"class":194},[2704],{"type":143,"value":208},{"type":138,"tag":187,"props":2706,"children":2707},{"class":200},[2708],{"type":143,"value":203},{"type":138,"tag":187,"props":2710,"children":2711},{"class":215},[2712],{"type":143,"value":1907},{"type":138,"tag":187,"props":2714,"children":2715},{"class":200},[2716],{"type":143,"value":203},{"type":138,"tag":187,"props":2718,"children":2719},{"class":194},[2720],{"type":143,"value":1916},{"type":138,"tag":187,"props":2722,"children":2723},{"class":200},[2724],{"type":143,"value":203},{"type":138,"tag":187,"props":2726,"children":2727},{"class":215},[2728],{"type":143,"value":1822},{"type":138,"tag":187,"props":2730,"children":2731},{"class":200},[2732],{"type":143,"value":1741},{"type":138,"tag":187,"props":2734,"children":2735},{"class":189,"line":602},[2736,2741],{"type":138,"tag":187,"props":2737,"children":2738},{"class":200},[2739],{"type":143,"value":2740},"     ",{"type":138,"tag":187,"props":2742,"children":2743},{"class":1709},[2744],{"type":143,"value":2745},"// 使用介面來傳遞物件\n",{"type":138,"tag":187,"props":2747,"children":2748},{"class":189,"line":621},[2749,2753],{"type":138,"tag":187,"props":2750,"children":2751},{"class":200},[2752],{"type":143,"value":2032},{"type":138,"tag":187,"props":2754,"children":2755},{"class":194},[2756],{"type":143,"value":2037},{"type":138,"tag":187,"props":2758,"children":2759},{"class":189,"line":629},[2760,2764,2768,2772,2776,2780,2784,2788,2792],{"type":138,"tag":187,"props":2761,"children":2762},{"class":200},[2763],{"type":143,"value":236},{"type":138,"tag":187,"props":2765,"children":2766},{"class":194},[2767],{"type":143,"value":197},{"type":138,"tag":187,"props":2769,"children":2770},{"class":200},[2771],{"type":143,"value":203},{"type":138,"tag":187,"props":2773,"children":2774},{"class":194},[2775],{"type":143,"value":559},{"type":138,"tag":187,"props":2777,"children":2778},{"class":200},[2779],{"type":143,"value":203},{"type":138,"tag":187,"props":2781,"children":2782},{"class":215},[2783],{"type":143,"value":1858},{"type":138,"tag":187,"props":2785,"children":2786},{"class":200},[2787],{"type":143,"value":1980},{"type":138,"tag":187,"props":2789,"children":2790},{"class":1983},[2791],{"type":143,"value":1986},{"type":138,"tag":187,"props":2793,"children":2794},{"class":200},[2795],{"type":143,"value":2796},") {\n",{"type":138,"tag":187,"props":2798,"children":2799},{"class":189,"line":637},[2800,2804,2808],{"type":138,"tag":187,"props":2801,"children":2802},{"class":200},[2803],{"type":143,"value":2077},{"type":138,"tag":187,"props":2805,"children":2806},{"class":215},[2807],{"type":143,"value":1773},{"type":138,"tag":187,"props":2809,"children":2810},{"class":200},[2811],{"type":143,"value":760},{"type":138,"tag":187,"props":2813,"children":2814},{"class":189,"line":663},[2815],{"type":138,"tag":187,"props":2816,"children":2817},{"class":200},[2818],{"type":143,"value":429},{"type":138,"tag":187,"props":2820,"children":2821},{"class":189,"line":671},[2822],{"type":138,"tag":187,"props":2823,"children":2824},{"class":200},[2825],{"type":143,"value":863},{"type":138,"tag":1616,"props":2827,"children":2828},{},[2829],{"type":138,"tag":139,"props":2830,"children":2831},{},[2832],{"type":143,"value":2833},"在了解Dependency與Injection後，應該就可以理解相依注入動作就在於在Instance物件後放置對應的相應物件中",{"type":138,"tag":145,"props":2835,"children":2837},{"id":2836},"b-容器概念",[2838],{"type":143,"value":20},{"type":138,"tag":139,"props":2840,"children":2841},{},[2842],{"type":143,"value":2843},"上述DI概念講完後，接著我們要述說容器的概念。A章節提到關於相依的問題，雖然我們可以透過介面去作解偶。但一般在大型專案物件複雜度及數量一定會是更複雜的狀態。因此有了容器的機制設計產生。",{"type":138,"tag":139,"props":2845,"children":2846},{},[2847],{"type":143,"value":2848},"容器的概念在於把物件全都收到一個盒子中，當要使用物件時再去盒子拿資料。有點像是打高爾夫球人員要打高爾夫時都會準備一個球袋把要用的球桿放進球袋中，並帶一個球僮陪伴在旁。當要使用哪一支高爾夫球桿時直接告訴球童即可。",{"type":138,"tag":156,"props":2850,"children":2852},{"id":2851},"a-窮人與有錢人的依賴注入方式",[2853],{"type":143,"value":2854},"a. 窮人與有錢人的依賴注入方式",{"type":138,"tag":139,"props":2856,"children":2857},{},[2858],{"type":143,"value":2859},"上述講解完後，相信目前對相依注入及容器有一定的概念。而注入部分一般分成窮人注入與有錢人注入。",{"type":138,"tag":1670,"props":2861,"children":2862},{},[2863,2868],{"type":138,"tag":1674,"props":2864,"children":2865},{},[2866],{"type":143,"value":2867},"我們一般稱為Poor DI(Dependency Injection)，由使用者手動創建以new物件的方式，各自注入，除了麻煩外而且會有傳遞注入等等的問題。",{"type":138,"tag":1674,"props":2869,"children":2870},{},[2871],{"type":143,"value":2872},"有錢人的注入方式，我們一般都會使用DI容器來完成，由框架或類別庫撰寫的容器，提供物件給予使用者使用，猶如上述所講的球童跟高爾夫球員關係一樣。使用者只需要在撰寫程式前設定好物件後，就不需要在手動注入。",{"type":138,"tag":145,"props":2874,"children":2876},{"id":2875},"c-iocinversion-of-control控制反轉",[2877],{"type":143,"value":21},{"type":138,"tag":139,"props":2879,"children":2880},{},[2881],{"type":143,"value":2882},"窮人跟有錢人，我們當然選擇當有錢人!(使用DI容器)。若我們使用DI容器去管理我們物件時，此時我們即可達到控制反轉的設計。",{"type":138,"tag":139,"props":2884,"children":2885},{},[2886],{"type":143,"value":2887},"簡單來說A物件程式內部需要使用B物件，程序需自行在A物件去new B物件。由程序主動去控制，有了容器，這一切交給容器去控制(新增物件流程)即可。",{"type":138,"tag":139,"props":2889,"children":2890},{},[2891],{"type":143,"value":2892},"如果說DIP 是解偶物件之間的依賴，IOC 就是對物件依賴流程控制的反轉。以常見的web框架而言，將監聽http 請求，解析請求等，包裝進框架，一般使用者並不用主動去處理解析請求，處理http請求的流程，由主動處理轉交給了框架，因此，所以框架其實也是一種IoC的設計。",{"type":138,"tag":1616,"props":2894,"children":2895},{},[2896],{"type":138,"tag":139,"props":2897,"children":2898},{},[2899],{"type":143,"value":2900},"你可以將IOC是一種設計模式，將流程控制重定向到外部處理程序或控制器來提供控制結果，而不是透過控制項(大多情境就是程序)來直接得到結果",{"type":138,"tag":145,"props":2902,"children":2904},{"id":2903},"d-c-di-框架-範例請點我",[2905,2907],{"type":143,"value":2906},"D. C# DI 框架 ",{"type":138,"tag":331,"props":2908,"children":2912},{"href":2909,"rel":2910},"https://github.com/spyua/DIWindowsFormSample.git",[2911],"nofollow",[2913],{"type":143,"value":2914},"[範例請點我]",{"type":138,"tag":139,"props":2916,"children":2917},{},[2918],{"type":143,"value":2919},"上述聊完後，相信對於DI、容器、DIP與IOC有一定認知。接著就需要進入實作部分。在.NET中最常見的DI有兩套如下",{"type":138,"tag":1670,"props":2921,"children":2922},{},[2923,2928],{"type":138,"tag":1674,"props":2924,"children":2925},{},[2926],{"type":143,"value":2927},"Microsoft.Extensions.DependencyInjection",{"type":138,"tag":1674,"props":2929,"children":2930},{},[2931],{"type":143,"value":2932},"Autofac",{"type":138,"tag":139,"props":2934,"children":2935},{},[2936],{"type":143,"value":2937},"上述提到注入三種方式(建構子、屬性與方法)，Autofac都有提供，而ASP.NET DI的目前只有建構子注入方式。網上大多是Web範例，在此使用這兩套DI工具使用在DeskTop Windows From。",{"type":138,"tag":156,"props":2939,"children":2941},{"id":2940},"microsoftextensionsdependencyinjection",[2942],{"type":143,"value":2927},{"type":138,"tag":139,"props":2944,"children":2945},{},[2946],{"type":143,"value":2947},"範例DI設定在DIServiceConfigure.cs",{"type":138,"tag":1690,"props":2949,"children":2951},{"id":2950},"注入服務生命週期型態",[2952],{"type":143,"value":2950},{"type":138,"tag":139,"props":2954,"children":2955},{},[2956],{"type":143,"value":2957},"服務生命週期指：透過 DI 取得某個元件時，是每次要求得建立一顆新物件，還是從頭到尾共用一個 Instance (執行個體-物件)。",{"type":138,"tag":1670,"props":2959,"children":2960},{},[2961,2966,2971],{"type":138,"tag":1674,"props":2962,"children":2963},{},[2964],{"type":143,"value":2965},"1.AddSingleton (單一性)",{"type":138,"tag":1674,"props":2967,"children":2968},{},[2969],{"type":143,"value":2970},"2.AddTransient (暫時性)",{"type":138,"tag":1674,"props":2972,"children":2973},{},[2974],{"type":143,"value":2975},"3.AddScoped (範圍性)",{"type":138,"tag":1690,"props":2977,"children":2979},{"id":2978},"_1-addsingleton-單一性",[2980],{"type":143,"value":2981},"1. AddSingleton (單一性)",{"type":138,"tag":139,"props":2983,"children":2984},{},[2985],{"type":143,"value":2986},"整個程序只建立一個 Instance，任何時候都共用它。簡單來說就是程序中不同流程使用此物件時，他都為同一份物件，有點像是Static，差在於使用DI可做物件設計及抽換。",{"type":138,"tag":139,"props":2988,"children":2989},{},[2990],{"type":143,"value":2991},"下圖為Asp.Net DI生命週期圖示，物件相依關係由左至右。",{"type":138,"tag":139,"props":2993,"children":2994},{},[2995],{"type":138,"tag":171,"props":2996,"children":2999},{"alt":2997,"src":2998},"Singleton","/blog/images/00/02/006.png",[],{"type":138,"tag":139,"props":3001,"children":3002},{},[3003],{"type":143,"value":3004},"而在範例模擬中設計，物件對應可視為",{"type":138,"tag":1670,"props":3006,"children":3007},{},[3008,3013,3018,3023],{"type":138,"tag":1674,"props":3009,"children":3010},{},[3011],{"type":143,"value":3012},"Rqeuest : Button_Singleton_Click 按下",{"type":138,"tag":1674,"props":3014,"children":3015},{},[3016],{"type":143,"value":3017},"第一個圈 : Call LogController",{"type":138,"tag":1674,"props":3019,"children":3020},{},[3021],{"type":143,"value":3022},"第二個圈 : Call LogController2",{"type":138,"tag":1674,"props":3024,"children":3025},{},[3026],{"type":143,"value":3027},"Instance : SingletonLogRepository",{"type":138,"tag":139,"props":3029,"children":3030},{},[3031],{"type":143,"value":3032},"Repository注入部分我們使用AddSingleton，而物件在Instance時，我們會建置Guid去觀察他是否為同一個物件。",{"type":138,"tag":177,"props":3034,"children":3036},{"className":179,"code":3035,"language":181,"meta":9},"  // 系統單一物件定義使用，或沒有異部與大量Request問題，可直接用Singleton\ncollection.AddSingleton\u003CISingletonLogRepository, LogRepository>();\n",[3037],{"type":138,"tag":7,"props":3038,"children":3039},{"__ignoreMap":9},[3040,3053],{"type":138,"tag":187,"props":3041,"children":3042},{"class":189,"line":190},[3043,3048],{"type":138,"tag":187,"props":3044,"children":3045},{"class":200},[3046],{"type":143,"value":3047},"  ",{"type":138,"tag":187,"props":3049,"children":3050},{"class":1709},[3051],{"type":143,"value":3052},"// 系統單一物件定義使用，或沒有異部與大量Request問題，可直接用Singleton\n",{"type":138,"tag":187,"props":3054,"children":3055},{"class":189,"line":221},[3056,3061,3066,3071,3076,3080,3085],{"type":138,"tag":187,"props":3057,"children":3058},{"class":200},[3059],{"type":143,"value":3060},"collection.",{"type":138,"tag":187,"props":3062,"children":3063},{"class":215},[3064],{"type":143,"value":3065},"AddSingleton",{"type":138,"tag":187,"props":3067,"children":3068},{"class":200},[3069],{"type":143,"value":3070},"\u003C",{"type":138,"tag":187,"props":3072,"children":3073},{"class":215},[3074],{"type":143,"value":3075},"ISingletonLogRepository",{"type":138,"tag":187,"props":3077,"children":3078},{"class":200},[3079],{"type":143,"value":336},{"type":138,"tag":187,"props":3081,"children":3082},{"class":215},[3083],{"type":143,"value":3084},"LogRepository",{"type":138,"tag":187,"props":3086,"children":3087},{"class":200},[3088],{"type":143,"value":3089},">();",{"type":138,"tag":139,"props":3091,"children":3092},{},[3093],{"type":143,"value":3094},"當我們按下Button_Singleton_Click時，會去呼叫LogController及LogController2裡的SingletonLogRepository物件。並印出Guid。",{"type":138,"tag":177,"props":3096,"children":3098},{"className":179,"code":3097,"language":181,"meta":9},"private void Button_Singleton_Click(object sender, EventArgs e)\n{\n    //var provider = DIServiceConfigure.GetProvider();\n    //var logController = provider.GetRequiredService\u003CILogController>();\n    var log = \"Log1(Singleton):\"+\"UUID-\"+LogController.OperationId(\"Singleton\");\n    var log2 = \"Log2(Singleton):\" + \"UUID-\" + LogController2.OperationId(\"Singleton\");\n    richTextBox_Info.AppendText(log+\"\\n\");\n    richTextBox_Info.AppendText(log2 + \"\\n\");\n    richTextBox_Info.AppendText(LogController.QueryLogCount());\n}\n",[3099],{"type":138,"tag":7,"props":3100,"children":3101},{"__ignoreMap":9},[3102,3167,3174,3186,3198,3272,3354,3394,3434,3460],{"type":138,"tag":187,"props":3103,"children":3104},{"class":189,"line":190},[3105,3109,3113,3117,3121,3126,3130,3135,3139,3144,3148,3153,3157,3162],{"type":138,"tag":187,"props":3106,"children":3107},{"class":194},[3108],{"type":143,"value":277},{"type":138,"tag":187,"props":3110,"children":3111},{"class":200},[3112],{"type":143,"value":203},{"type":138,"tag":187,"props":3114,"children":3115},{"class":194},[3116],{"type":143,"value":559},{"type":138,"tag":187,"props":3118,"children":3119},{"class":200},[3120],{"type":143,"value":203},{"type":138,"tag":187,"props":3122,"children":3123},{"class":215},[3124],{"type":143,"value":3125},"Button_Singleton_Click",{"type":138,"tag":187,"props":3127,"children":3128},{"class":200},[3129],{"type":143,"value":317},{"type":138,"tag":187,"props":3131,"children":3132},{"class":194},[3133],{"type":143,"value":3134},"object",{"type":138,"tag":187,"props":3136,"children":3137},{"class":200},[3138],{"type":143,"value":203},{"type":138,"tag":187,"props":3140,"children":3141},{"class":215},[3142],{"type":143,"value":3143},"sender",{"type":138,"tag":187,"props":3145,"children":3146},{"class":200},[3147],{"type":143,"value":336},{"type":138,"tag":187,"props":3149,"children":3150},{"class":215},[3151],{"type":143,"value":3152},"EventArgs",{"type":138,"tag":187,"props":3154,"children":3155},{"class":200},[3156],{"type":143,"value":203},{"type":138,"tag":187,"props":3158,"children":3159},{"class":215},[3160],{"type":143,"value":3161},"e",{"type":138,"tag":187,"props":3163,"children":3164},{"class":200},[3165],{"type":143,"value":3166},")\n",{"type":138,"tag":187,"props":3168,"children":3169},{"class":189,"line":221},[3170],{"type":138,"tag":187,"props":3171,"children":3172},{"class":200},[3173],{"type":143,"value":227},{"type":138,"tag":187,"props":3175,"children":3176},{"class":189,"line":230},[3177,3181],{"type":138,"tag":187,"props":3178,"children":3179},{"class":200},[3180],{"type":143,"value":236},{"type":138,"tag":187,"props":3182,"children":3183},{"class":1709},[3184],{"type":143,"value":3185},"//var provider = DIServiceConfigure.GetProvider();\n",{"type":138,"tag":187,"props":3187,"children":3188},{"class":189,"line":294},[3189,3193],{"type":138,"tag":187,"props":3190,"children":3191},{"class":200},[3192],{"type":143,"value":236},{"type":138,"tag":187,"props":3194,"children":3195},{"class":1709},[3196],{"type":143,"value":3197},"//var logController = provider.GetRequiredService\u003CILogController>();\n",{"type":138,"tag":187,"props":3199,"children":3200},{"class":189,"line":357},[3201,3205,3209,3213,3218,3222,3226,3230,3236,3240,3245,3249,3254,3259,3263,3268],{"type":138,"tag":187,"props":3202,"children":3203},{"class":200},[3204],{"type":143,"value":236},{"type":138,"tag":187,"props":3206,"children":3207},{"class":194},[3208],{"type":143,"value":368},{"type":138,"tag":187,"props":3210,"children":3211},{"class":200},[3212],{"type":143,"value":203},{"type":138,"tag":187,"props":3214,"children":3215},{"class":215},[3216],{"type":143,"value":3217},"log",{"type":138,"tag":187,"props":3219,"children":3220},{"class":200},[3221],{"type":143,"value":203},{"type":138,"tag":187,"props":3223,"children":3224},{"class":194},[3225],{"type":143,"value":386},{"type":138,"tag":187,"props":3227,"children":3228},{"class":200},[3229],{"type":143,"value":203},{"type":138,"tag":187,"props":3231,"children":3233},{"class":3232},"ct-952708",[3234],{"type":143,"value":3235},"\"Log1(Singleton):\"",{"type":138,"tag":187,"props":3237,"children":3238},{"class":194},[3239],{"type":143,"value":396},{"type":138,"tag":187,"props":3241,"children":3242},{"class":3232},[3243],{"type":143,"value":3244},"\"UUID-\"",{"type":138,"tag":187,"props":3246,"children":3247},{"class":194},[3248],{"type":143,"value":396},{"type":138,"tag":187,"props":3250,"children":3251},{"class":200},[3252],{"type":143,"value":3253},"LogController.",{"type":138,"tag":187,"props":3255,"children":3256},{"class":215},[3257],{"type":143,"value":3258},"OperationId",{"type":138,"tag":187,"props":3260,"children":3261},{"class":200},[3262],{"type":143,"value":317},{"type":138,"tag":187,"props":3264,"children":3265},{"class":3232},[3266],{"type":143,"value":3267},"\"Singleton\"",{"type":138,"tag":187,"props":3269,"children":3270},{"class":200},[3271],{"type":143,"value":1384},{"type":138,"tag":187,"props":3273,"children":3274},{"class":189,"line":404},[3275,3279,3283,3287,3292,3296,3300,3304,3309,3313,3317,3321,3325,3329,3333,3338,3342,3346,3350],{"type":138,"tag":187,"props":3276,"children":3277},{"class":200},[3278],{"type":143,"value":236},{"type":138,"tag":187,"props":3280,"children":3281},{"class":194},[3282],{"type":143,"value":368},{"type":138,"tag":187,"props":3284,"children":3285},{"class":200},[3286],{"type":143,"value":203},{"type":138,"tag":187,"props":3288,"children":3289},{"class":215},[3290],{"type":143,"value":3291},"log2",{"type":138,"tag":187,"props":3293,"children":3294},{"class":200},[3295],{"type":143,"value":203},{"type":138,"tag":187,"props":3297,"children":3298},{"class":194},[3299],{"type":143,"value":386},{"type":138,"tag":187,"props":3301,"children":3302},{"class":200},[3303],{"type":143,"value":203},{"type":138,"tag":187,"props":3305,"children":3306},{"class":3232},[3307],{"type":143,"value":3308},"\"Log2(Singleton):\"",{"type":138,"tag":187,"props":3310,"children":3311},{"class":200},[3312],{"type":143,"value":203},{"type":138,"tag":187,"props":3314,"children":3315},{"class":194},[3316],{"type":143,"value":396},{"type":138,"tag":187,"props":3318,"children":3319},{"class":200},[3320],{"type":143,"value":203},{"type":138,"tag":187,"props":3322,"children":3323},{"class":3232},[3324],{"type":143,"value":3244},{"type":138,"tag":187,"props":3326,"children":3327},{"class":200},[3328],{"type":143,"value":203},{"type":138,"tag":187,"props":3330,"children":3331},{"class":194},[3332],{"type":143,"value":396},{"type":138,"tag":187,"props":3334,"children":3335},{"class":200},[3336],{"type":143,"value":3337}," LogController2.",{"type":138,"tag":187,"props":3339,"children":3340},{"class":215},[3341],{"type":143,"value":3258},{"type":138,"tag":187,"props":3343,"children":3344},{"class":200},[3345],{"type":143,"value":317},{"type":138,"tag":187,"props":3347,"children":3348},{"class":3232},[3349],{"type":143,"value":3267},{"type":138,"tag":187,"props":3351,"children":3352},{"class":200},[3353],{"type":143,"value":1384},{"type":138,"tag":187,"props":3355,"children":3356},{"class":189,"line":423},[3357,3362,3367,3372,3376,3381,3386,3390],{"type":138,"tag":187,"props":3358,"children":3359},{"class":200},[3360],{"type":143,"value":3361},"    richTextBox_Info.",{"type":138,"tag":187,"props":3363,"children":3364},{"class":215},[3365],{"type":143,"value":3366},"AppendText",{"type":138,"tag":187,"props":3368,"children":3369},{"class":200},[3370],{"type":143,"value":3371},"(log",{"type":138,"tag":187,"props":3373,"children":3374},{"class":194},[3375],{"type":143,"value":396},{"type":138,"tag":187,"props":3377,"children":3378},{"class":3232},[3379],{"type":143,"value":3380},"\"",{"type":138,"tag":187,"props":3382,"children":3383},{"class":830},[3384],{"type":143,"value":3385},"\\n",{"type":138,"tag":187,"props":3387,"children":3388},{"class":3232},[3389],{"type":143,"value":3380},{"type":138,"tag":187,"props":3391,"children":3392},{"class":200},[3393],{"type":143,"value":1384},{"type":138,"tag":187,"props":3395,"children":3396},{"class":189,"line":432},[3397,3401,3405,3410,3414,3418,3422,3426,3430],{"type":138,"tag":187,"props":3398,"children":3399},{"class":200},[3400],{"type":143,"value":3361},{"type":138,"tag":187,"props":3402,"children":3403},{"class":215},[3404],{"type":143,"value":3366},{"type":138,"tag":187,"props":3406,"children":3407},{"class":200},[3408],{"type":143,"value":3409},"(log2 ",{"type":138,"tag":187,"props":3411,"children":3412},{"class":194},[3413],{"type":143,"value":396},{"type":138,"tag":187,"props":3415,"children":3416},{"class":200},[3417],{"type":143,"value":203},{"type":138,"tag":187,"props":3419,"children":3420},{"class":3232},[3421],{"type":143,"value":3380},{"type":138,"tag":187,"props":3423,"children":3424},{"class":830},[3425],{"type":143,"value":3385},{"type":138,"tag":187,"props":3427,"children":3428},{"class":3232},[3429],{"type":143,"value":3380},{"type":138,"tag":187,"props":3431,"children":3432},{"class":200},[3433],{"type":143,"value":1384},{"type":138,"tag":187,"props":3435,"children":3436},{"class":189,"line":474},[3437,3441,3445,3450,3455],{"type":138,"tag":187,"props":3438,"children":3439},{"class":200},[3440],{"type":143,"value":3361},{"type":138,"tag":187,"props":3442,"children":3443},{"class":215},[3444],{"type":143,"value":3366},{"type":138,"tag":187,"props":3446,"children":3447},{"class":200},[3448],{"type":143,"value":3449},"(LogController.",{"type":138,"tag":187,"props":3451,"children":3452},{"class":215},[3453],{"type":143,"value":3454},"QueryLogCount",{"type":138,"tag":187,"props":3456,"children":3457},{"class":200},[3458],{"type":143,"value":3459},"());\n",{"type":138,"tag":187,"props":3461,"children":3462},{"class":189,"line":492},[3463],{"type":138,"tag":187,"props":3464,"children":3465},{"class":200},[3466],{"type":143,"value":863},{"type":138,"tag":139,"props":3468,"children":3469},{},[3470],{"type":143,"value":3471},"此時我們可以看到兩個印出來的UUID會完全相同。代表在SingletonLogRepository在Controller與Controller2中為同一個物件。",{"type":138,"tag":139,"props":3473,"children":3474},{},[3475],{"type":138,"tag":171,"props":3476,"children":3479},{"alt":3477,"src":3478},"Singleton Result","/blog/images/00/02/007.png",[],{"type":138,"tag":1690,"props":3481,"children":3483},{"id":3482},"_2-addtransient-暫時性",[3484],{"type":143,"value":3485},"2. AddTransient (暫時性)",{"type":138,"tag":139,"props":3487,"children":3488},{},[3489],{"type":143,"value":3490},"定義上為程序中每次要求物件(包含物件要其他相依物件)時就建立一個新的，永不共用。",{"type":138,"tag":139,"props":3492,"children":3493},{},[3494],{"type":143,"value":3495},"下圖為 Asp.Net DI生命週期圖示，物件相依關係由左至右。",{"type":138,"tag":139,"props":3497,"children":3498},{},[3499],{"type":138,"tag":171,"props":3500,"children":3503},{"alt":3501,"src":3502},"Transient","/blog/images/00/02/008.png",[],{"type":138,"tag":139,"props":3505,"children":3506},{},[3507],{"type":143,"value":3004},{"type":138,"tag":1670,"props":3509,"children":3510},{},[3511,3516,3520,3524],{"type":138,"tag":1674,"props":3512,"children":3513},{},[3514],{"type":143,"value":3515},"Rqeuest : Button_Transient_Click 按下",{"type":138,"tag":1674,"props":3517,"children":3518},{},[3519],{"type":143,"value":3017},{"type":138,"tag":1674,"props":3521,"children":3522},{},[3523],{"type":143,"value":3022},{"type":138,"tag":1674,"props":3525,"children":3526},{},[3527],{"type":143,"value":3528},"Instance : TransientLogRepository",{"type":138,"tag":139,"props":3530,"children":3531},{},[3532],{"type":143,"value":3533},"Repository注入部分我們使用AddTransient，而物件在Instance時，我們會建置Guid去觀察他是否為同一個物件。",{"type":138,"tag":177,"props":3535,"children":3537},{"className":179,"code":3536,"language":181,"meta":9},"// 異步，且須大量Request的建議使用Transient (WundowsForm簡易Sample較難模擬)\ncollection.AddTransient\u003CITransientLogRepository, LogRepository>();\n",[3538],{"type":138,"tag":7,"props":3539,"children":3540},{"__ignoreMap":9},[3541,3549],{"type":138,"tag":187,"props":3542,"children":3543},{"class":189,"line":190},[3544],{"type":138,"tag":187,"props":3545,"children":3546},{"class":1709},[3547],{"type":143,"value":3548},"// 異步，且須大量Request的建議使用Transient (WundowsForm簡易Sample較難模擬)\n",{"type":138,"tag":187,"props":3550,"children":3551},{"class":189,"line":221},[3552,3556,3561,3565,3570,3574,3578],{"type":138,"tag":187,"props":3553,"children":3554},{"class":200},[3555],{"type":143,"value":3060},{"type":138,"tag":187,"props":3557,"children":3558},{"class":215},[3559],{"type":143,"value":3560},"AddTransient",{"type":138,"tag":187,"props":3562,"children":3563},{"class":200},[3564],{"type":143,"value":3070},{"type":138,"tag":187,"props":3566,"children":3567},{"class":215},[3568],{"type":143,"value":3569},"ITransientLogRepository",{"type":138,"tag":187,"props":3571,"children":3572},{"class":200},[3573],{"type":143,"value":336},{"type":138,"tag":187,"props":3575,"children":3576},{"class":215},[3577],{"type":143,"value":3084},{"type":138,"tag":187,"props":3579,"children":3580},{"class":200},[3581],{"type":143,"value":3089},{"type":138,"tag":139,"props":3583,"children":3584},{},[3585],{"type":143,"value":3586},"當我們按下Button_Transient_Click時，會去呼叫LogController及LogController2裡的SingletonLogRepository物件。並印出Guid。",{"type":138,"tag":177,"props":3588,"children":3590},{"className":179,"code":3589,"language":181,"meta":9},"private void Button_Transient_Click(object sender, EventArgs e)\n{\n   // 模擬多次Request\n   //var provider = DIServiceConfigure.GetProvider();\n   //var logController = provider.GetRequiredService\u003CLogController>();\n   //var log = \"Log1(Transient):\" + \"UUID-\" + logController.GUID.ToString();\n   //richTextBox_Info.AppendText(log + \"\\n\");\n\n       // 單次Request\n   var log = \"Log1(Transient):\" + \"UUID-\" + LogController.OperationId(\"Transient\");\n   var log2 = \"Log2(Transient):\" + \"UUID-\" + LogController2.OperationId(\"Transient\");\n   richTextBox_Info.AppendText(log + \"\\n\");\n   richTextBox_Info.AppendText(log2 + \"\\n\");\n\n   //richTextBox_Info.AppendText(LogController.QueryLogCount());\n}\n",[3591],{"type":138,"tag":7,"props":3592,"children":3593},{"__ignoreMap":9},[3594,3654,3661,3674,3685,3697,3709,3721,3727,3740,3822,3902,3943,3982,3988,4000],{"type":138,"tag":187,"props":3595,"children":3596},{"class":189,"line":190},[3597,3601,3605,3609,3613,3618,3622,3626,3630,3634,3638,3642,3646,3650],{"type":138,"tag":187,"props":3598,"children":3599},{"class":194},[3600],{"type":143,"value":277},{"type":138,"tag":187,"props":3602,"children":3603},{"class":200},[3604],{"type":143,"value":203},{"type":138,"tag":187,"props":3606,"children":3607},{"class":194},[3608],{"type":143,"value":559},{"type":138,"tag":187,"props":3610,"children":3611},{"class":200},[3612],{"type":143,"value":203},{"type":138,"tag":187,"props":3614,"children":3615},{"class":215},[3616],{"type":143,"value":3617},"Button_Transient_Click",{"type":138,"tag":187,"props":3619,"children":3620},{"class":200},[3621],{"type":143,"value":317},{"type":138,"tag":187,"props":3623,"children":3624},{"class":194},[3625],{"type":143,"value":3134},{"type":138,"tag":187,"props":3627,"children":3628},{"class":200},[3629],{"type":143,"value":203},{"type":138,"tag":187,"props":3631,"children":3632},{"class":215},[3633],{"type":143,"value":3143},{"type":138,"tag":187,"props":3635,"children":3636},{"class":200},[3637],{"type":143,"value":336},{"type":138,"tag":187,"props":3639,"children":3640},{"class":215},[3641],{"type":143,"value":3152},{"type":138,"tag":187,"props":3643,"children":3644},{"class":200},[3645],{"type":143,"value":203},{"type":138,"tag":187,"props":3647,"children":3648},{"class":215},[3649],{"type":143,"value":3161},{"type":138,"tag":187,"props":3651,"children":3652},{"class":200},[3653],{"type":143,"value":3166},{"type":138,"tag":187,"props":3655,"children":3656},{"class":189,"line":221},[3657],{"type":138,"tag":187,"props":3658,"children":3659},{"class":200},[3660],{"type":143,"value":227},{"type":138,"tag":187,"props":3662,"children":3663},{"class":189,"line":230},[3664,3669],{"type":138,"tag":187,"props":3665,"children":3666},{"class":200},[3667],{"type":143,"value":3668},"   ",{"type":138,"tag":187,"props":3670,"children":3671},{"class":1709},[3672],{"type":143,"value":3673},"// 模擬多次Request\n",{"type":138,"tag":187,"props":3675,"children":3676},{"class":189,"line":294},[3677,3681],{"type":138,"tag":187,"props":3678,"children":3679},{"class":200},[3680],{"type":143,"value":3668},{"type":138,"tag":187,"props":3682,"children":3683},{"class":1709},[3684],{"type":143,"value":3185},{"type":138,"tag":187,"props":3686,"children":3687},{"class":189,"line":357},[3688,3692],{"type":138,"tag":187,"props":3689,"children":3690},{"class":200},[3691],{"type":143,"value":3668},{"type":138,"tag":187,"props":3693,"children":3694},{"class":1709},[3695],{"type":143,"value":3696},"//var logController = provider.GetRequiredService\u003CLogController>();\n",{"type":138,"tag":187,"props":3698,"children":3699},{"class":189,"line":404},[3700,3704],{"type":138,"tag":187,"props":3701,"children":3702},{"class":200},[3703],{"type":143,"value":3668},{"type":138,"tag":187,"props":3705,"children":3706},{"class":1709},[3707],{"type":143,"value":3708},"//var log = \"Log1(Transient):\" + \"UUID-\" + logController.GUID.ToString();\n",{"type":138,"tag":187,"props":3710,"children":3711},{"class":189,"line":423},[3712,3716],{"type":138,"tag":187,"props":3713,"children":3714},{"class":200},[3715],{"type":143,"value":3668},{"type":138,"tag":187,"props":3717,"children":3718},{"class":1709},[3719],{"type":143,"value":3720},"//richTextBox_Info.AppendText(log + \"\\n\");\n",{"type":138,"tag":187,"props":3722,"children":3723},{"class":189,"line":432},[3724],{"type":138,"tag":187,"props":3725,"children":3726},{},[],{"type":138,"tag":187,"props":3728,"children":3729},{"class":189,"line":474},[3730,3735],{"type":138,"tag":187,"props":3731,"children":3732},{"class":200},[3733],{"type":143,"value":3734},"       ",{"type":138,"tag":187,"props":3736,"children":3737},{"class":1709},[3738],{"type":143,"value":3739},"// 單次Request\n",{"type":138,"tag":187,"props":3741,"children":3742},{"class":189,"line":492},[3743,3747,3751,3755,3759,3763,3767,3771,3776,3780,3784,3788,3792,3796,3800,3805,3809,3813,3818],{"type":138,"tag":187,"props":3744,"children":3745},{"class":200},[3746],{"type":143,"value":3668},{"type":138,"tag":187,"props":3748,"children":3749},{"class":194},[3750],{"type":143,"value":368},{"type":138,"tag":187,"props":3752,"children":3753},{"class":200},[3754],{"type":143,"value":203},{"type":138,"tag":187,"props":3756,"children":3757},{"class":215},[3758],{"type":143,"value":3217},{"type":138,"tag":187,"props":3760,"children":3761},{"class":200},[3762],{"type":143,"value":203},{"type":138,"tag":187,"props":3764,"children":3765},{"class":194},[3766],{"type":143,"value":386},{"type":138,"tag":187,"props":3768,"children":3769},{"class":200},[3770],{"type":143,"value":203},{"type":138,"tag":187,"props":3772,"children":3773},{"class":3232},[3774],{"type":143,"value":3775},"\"Log1(Transient):\"",{"type":138,"tag":187,"props":3777,"children":3778},{"class":200},[3779],{"type":143,"value":203},{"type":138,"tag":187,"props":3781,"children":3782},{"class":194},[3783],{"type":143,"value":396},{"type":138,"tag":187,"props":3785,"children":3786},{"class":200},[3787],{"type":143,"value":203},{"type":138,"tag":187,"props":3789,"children":3790},{"class":3232},[3791],{"type":143,"value":3244},{"type":138,"tag":187,"props":3793,"children":3794},{"class":200},[3795],{"type":143,"value":203},{"type":138,"tag":187,"props":3797,"children":3798},{"class":194},[3799],{"type":143,"value":396},{"type":138,"tag":187,"props":3801,"children":3802},{"class":200},[3803],{"type":143,"value":3804}," LogController.",{"type":138,"tag":187,"props":3806,"children":3807},{"class":215},[3808],{"type":143,"value":3258},{"type":138,"tag":187,"props":3810,"children":3811},{"class":200},[3812],{"type":143,"value":317},{"type":138,"tag":187,"props":3814,"children":3815},{"class":3232},[3816],{"type":143,"value":3817},"\"Transient\"",{"type":138,"tag":187,"props":3819,"children":3820},{"class":200},[3821],{"type":143,"value":1384},{"type":138,"tag":187,"props":3823,"children":3824},{"class":189,"line":500},[3825,3829,3833,3837,3841,3845,3849,3853,3858,3862,3866,3870,3874,3878,3882,3886,3890,3894,3898],{"type":138,"tag":187,"props":3826,"children":3827},{"class":200},[3828],{"type":143,"value":3668},{"type":138,"tag":187,"props":3830,"children":3831},{"class":194},[3832],{"type":143,"value":368},{"type":138,"tag":187,"props":3834,"children":3835},{"class":200},[3836],{"type":143,"value":203},{"type":138,"tag":187,"props":3838,"children":3839},{"class":215},[3840],{"type":143,"value":3291},{"type":138,"tag":187,"props":3842,"children":3843},{"class":200},[3844],{"type":143,"value":203},{"type":138,"tag":187,"props":3846,"children":3847},{"class":194},[3848],{"type":143,"value":386},{"type":138,"tag":187,"props":3850,"children":3851},{"class":200},[3852],{"type":143,"value":203},{"type":138,"tag":187,"props":3854,"children":3855},{"class":3232},[3856],{"type":143,"value":3857},"\"Log2(Transient):\"",{"type":138,"tag":187,"props":3859,"children":3860},{"class":200},[3861],{"type":143,"value":203},{"type":138,"tag":187,"props":3863,"children":3864},{"class":194},[3865],{"type":143,"value":396},{"type":138,"tag":187,"props":3867,"children":3868},{"class":200},[3869],{"type":143,"value":203},{"type":138,"tag":187,"props":3871,"children":3872},{"class":3232},[3873],{"type":143,"value":3244},{"type":138,"tag":187,"props":3875,"children":3876},{"class":200},[3877],{"type":143,"value":203},{"type":138,"tag":187,"props":3879,"children":3880},{"class":194},[3881],{"type":143,"value":396},{"type":138,"tag":187,"props":3883,"children":3884},{"class":200},[3885],{"type":143,"value":3337},{"type":138,"tag":187,"props":3887,"children":3888},{"class":215},[3889],{"type":143,"value":3258},{"type":138,"tag":187,"props":3891,"children":3892},{"class":200},[3893],{"type":143,"value":317},{"type":138,"tag":187,"props":3895,"children":3896},{"class":3232},[3897],{"type":143,"value":3817},{"type":138,"tag":187,"props":3899,"children":3900},{"class":200},[3901],{"type":143,"value":1384},{"type":138,"tag":187,"props":3903,"children":3904},{"class":189,"line":508},[3905,3910,3914,3919,3923,3927,3931,3935,3939],{"type":138,"tag":187,"props":3906,"children":3907},{"class":200},[3908],{"type":143,"value":3909},"   richTextBox_Info.",{"type":138,"tag":187,"props":3911,"children":3912},{"class":215},[3913],{"type":143,"value":3366},{"type":138,"tag":187,"props":3915,"children":3916},{"class":200},[3917],{"type":143,"value":3918},"(log ",{"type":138,"tag":187,"props":3920,"children":3921},{"class":194},[3922],{"type":143,"value":396},{"type":138,"tag":187,"props":3924,"children":3925},{"class":200},[3926],{"type":143,"value":203},{"type":138,"tag":187,"props":3928,"children":3929},{"class":3232},[3930],{"type":143,"value":3380},{"type":138,"tag":187,"props":3932,"children":3933},{"class":830},[3934],{"type":143,"value":3385},{"type":138,"tag":187,"props":3936,"children":3937},{"class":3232},[3938],{"type":143,"value":3380},{"type":138,"tag":187,"props":3940,"children":3941},{"class":200},[3942],{"type":143,"value":1384},{"type":138,"tag":187,"props":3944,"children":3945},{"class":189,"line":533},[3946,3950,3954,3958,3962,3966,3970,3974,3978],{"type":138,"tag":187,"props":3947,"children":3948},{"class":200},[3949],{"type":143,"value":3909},{"type":138,"tag":187,"props":3951,"children":3952},{"class":215},[3953],{"type":143,"value":3366},{"type":138,"tag":187,"props":3955,"children":3956},{"class":200},[3957],{"type":143,"value":3409},{"type":138,"tag":187,"props":3959,"children":3960},{"class":194},[3961],{"type":143,"value":396},{"type":138,"tag":187,"props":3963,"children":3964},{"class":200},[3965],{"type":143,"value":203},{"type":138,"tag":187,"props":3967,"children":3968},{"class":3232},[3969],{"type":143,"value":3380},{"type":138,"tag":187,"props":3971,"children":3972},{"class":830},[3973],{"type":143,"value":3385},{"type":138,"tag":187,"props":3975,"children":3976},{"class":3232},[3977],{"type":143,"value":3380},{"type":138,"tag":187,"props":3979,"children":3980},{"class":200},[3981],{"type":143,"value":1384},{"type":138,"tag":187,"props":3983,"children":3984},{"class":189,"line":541},[3985],{"type":138,"tag":187,"props":3986,"children":3987},{},[],{"type":138,"tag":187,"props":3989,"children":3990},{"class":189,"line":593},[3991,3995],{"type":138,"tag":187,"props":3992,"children":3993},{"class":200},[3994],{"type":143,"value":3668},{"type":138,"tag":187,"props":3996,"children":3997},{"class":1709},[3998],{"type":143,"value":3999},"//richTextBox_Info.AppendText(LogController.QueryLogCount());\n",{"type":138,"tag":187,"props":4001,"children":4002},{"class":189,"line":602},[4003],{"type":138,"tag":187,"props":4004,"children":4005},{"class":200},[4006],{"type":143,"value":863},{"type":138,"tag":139,"props":4008,"children":4009},{},[4010],{"type":143,"value":4011},"此時我們可以看到兩個印出來的UUID會不相同。代表在TransientLogRepository在Controller與Controller2中為不同物件。",{"type":138,"tag":139,"props":4013,"children":4014},{},[4015],{"type":138,"tag":171,"props":4016,"children":4019},{"alt":4017,"src":4018},"Transient Result","/blog/images/00/02/009.png",[],{"type":138,"tag":139,"props":4021,"children":4022},{},[4023],{"type":143,"value":4024},"上述模擬範例其實只模擬一個Request1的狀況。根據定義，程序中每次要求元件時就建立一個新的物件，對此我們已再按多次Button來做模擬。要模擬這狀況，就需要再跟Container拿取Controller物件，在範例中Controller與Controller2都是注入AddTransient，我們將模擬多次Request區塊註解打開，並註解單次Request程式碼",{"type":138,"tag":177,"props":4026,"children":4028},{"className":179,"code":4027,"language":181,"meta":9},"private void Button_Transient_Click(object sender, EventArgs e)\n{\n    // 模擬多次Request\n    var provider = DIServiceConfigure.GetProvider();\n    var logController = provider.GetRequiredService\u003CLogController>();\n    var log = \"Log1(Transient):\" + \"UUID-\" + logController.GUID.ToString();\n    richTextBox_Info.AppendText(log + \"\\n\");\n\n    // 模擬單次Request\n    //var log = \"Log1(Transient):\" + \"UUID-\" + LogController.OperationId(\"Transient\");\n    //var log2 = \"Log2(Transient):\" + \"UUID-\" + LogController2.OperationId(\"Transient\");\n    //richTextBox_Info.AppendText(log + \"\\n\");\n    //richTextBox_Info.AppendText(log2 + \"\\n\");\n\n    //richTextBox_Info.AppendText(LogController.QueryLogCount());\n}\n",[4029],{"type":138,"tag":7,"props":4030,"children":4031},{"__ignoreMap":9},[4032,4091,4098,4109,4151,4203,4276,4315,4321,4333,4345,4357,4368,4380,4386,4397],{"type":138,"tag":187,"props":4033,"children":4034},{"class":189,"line":190},[4035,4039,4043,4047,4051,4055,4059,4063,4067,4071,4075,4079,4083,4087],{"type":138,"tag":187,"props":4036,"children":4037},{"class":194},[4038],{"type":143,"value":277},{"type":138,"tag":187,"props":4040,"children":4041},{"class":200},[4042],{"type":143,"value":203},{"type":138,"tag":187,"props":4044,"children":4045},{"class":194},[4046],{"type":143,"value":559},{"type":138,"tag":187,"props":4048,"children":4049},{"class":200},[4050],{"type":143,"value":203},{"type":138,"tag":187,"props":4052,"children":4053},{"class":215},[4054],{"type":143,"value":3617},{"type":138,"tag":187,"props":4056,"children":4057},{"class":200},[4058],{"type":143,"value":317},{"type":138,"tag":187,"props":4060,"children":4061},{"class":194},[4062],{"type":143,"value":3134},{"type":138,"tag":187,"props":4064,"children":4065},{"class":200},[4066],{"type":143,"value":203},{"type":138,"tag":187,"props":4068,"children":4069},{"class":215},[4070],{"type":143,"value":3143},{"type":138,"tag":187,"props":4072,"children":4073},{"class":200},[4074],{"type":143,"value":336},{"type":138,"tag":187,"props":4076,"children":4077},{"class":215},[4078],{"type":143,"value":3152},{"type":138,"tag":187,"props":4080,"children":4081},{"class":200},[4082],{"type":143,"value":203},{"type":138,"tag":187,"props":4084,"children":4085},{"class":215},[4086],{"type":143,"value":3161},{"type":138,"tag":187,"props":4088,"children":4089},{"class":200},[4090],{"type":143,"value":3166},{"type":138,"tag":187,"props":4092,"children":4093},{"class":189,"line":221},[4094],{"type":138,"tag":187,"props":4095,"children":4096},{"class":200},[4097],{"type":143,"value":227},{"type":138,"tag":187,"props":4099,"children":4100},{"class":189,"line":230},[4101,4105],{"type":138,"tag":187,"props":4102,"children":4103},{"class":200},[4104],{"type":143,"value":236},{"type":138,"tag":187,"props":4106,"children":4107},{"class":1709},[4108],{"type":143,"value":3673},{"type":138,"tag":187,"props":4110,"children":4111},{"class":189,"line":294},[4112,4116,4120,4124,4129,4133,4137,4142,4147],{"type":138,"tag":187,"props":4113,"children":4114},{"class":200},[4115],{"type":143,"value":236},{"type":138,"tag":187,"props":4117,"children":4118},{"class":194},[4119],{"type":143,"value":368},{"type":138,"tag":187,"props":4121,"children":4122},{"class":200},[4123],{"type":143,"value":203},{"type":138,"tag":187,"props":4125,"children":4126},{"class":215},[4127],{"type":143,"value":4128},"provider",{"type":138,"tag":187,"props":4130,"children":4131},{"class":200},[4132],{"type":143,"value":203},{"type":138,"tag":187,"props":4134,"children":4135},{"class":194},[4136],{"type":143,"value":386},{"type":138,"tag":187,"props":4138,"children":4139},{"class":200},[4140],{"type":143,"value":4141}," DIServiceConfigure.",{"type":138,"tag":187,"props":4143,"children":4144},{"class":215},[4145],{"type":143,"value":4146},"GetProvider",{"type":138,"tag":187,"props":4148,"children":4149},{"class":200},[4150],{"type":143,"value":760},{"type":138,"tag":187,"props":4152,"children":4153},{"class":189,"line":357},[4154,4158,4162,4166,4171,4175,4179,4184,4189,4193,4198],{"type":138,"tag":187,"props":4155,"children":4156},{"class":200},[4157],{"type":143,"value":236},{"type":138,"tag":187,"props":4159,"children":4160},{"class":194},[4161],{"type":143,"value":368},{"type":138,"tag":187,"props":4163,"children":4164},{"class":200},[4165],{"type":143,"value":203},{"type":138,"tag":187,"props":4167,"children":4168},{"class":215},[4169],{"type":143,"value":4170},"logController",{"type":138,"tag":187,"props":4172,"children":4173},{"class":200},[4174],{"type":143,"value":203},{"type":138,"tag":187,"props":4176,"children":4177},{"class":194},[4178],{"type":143,"value":386},{"type":138,"tag":187,"props":4180,"children":4181},{"class":200},[4182],{"type":143,"value":4183}," provider.",{"type":138,"tag":187,"props":4185,"children":4186},{"class":215},[4187],{"type":143,"value":4188},"GetRequiredService",{"type":138,"tag":187,"props":4190,"children":4191},{"class":200},[4192],{"type":143,"value":3070},{"type":138,"tag":187,"props":4194,"children":4195},{"class":215},[4196],{"type":143,"value":4197},"LogController",{"type":138,"tag":187,"props":4199,"children":4200},{"class":200},[4201],{"type":143,"value":4202},">();\n",{"type":138,"tag":187,"props":4204,"children":4205},{"class":189,"line":404},[4206,4210,4214,4218,4222,4226,4230,4234,4238,4242,4246,4250,4254,4258,4262,4267,4272],{"type":138,"tag":187,"props":4207,"children":4208},{"class":200},[4209],{"type":143,"value":236},{"type":138,"tag":187,"props":4211,"children":4212},{"class":194},[4213],{"type":143,"value":368},{"type":138,"tag":187,"props":4215,"children":4216},{"class":200},[4217],{"type":143,"value":203},{"type":138,"tag":187,"props":4219,"children":4220},{"class":215},[4221],{"type":143,"value":3217},{"type":138,"tag":187,"props":4223,"children":4224},{"class":200},[4225],{"type":143,"value":203},{"type":138,"tag":187,"props":4227,"children":4228},{"class":194},[4229],{"type":143,"value":386},{"type":138,"tag":187,"props":4231,"children":4232},{"class":200},[4233],{"type":143,"value":203},{"type":138,"tag":187,"props":4235,"children":4236},{"class":3232},[4237],{"type":143,"value":3775},{"type":138,"tag":187,"props":4239,"children":4240},{"class":200},[4241],{"type":143,"value":203},{"type":138,"tag":187,"props":4243,"children":4244},{"class":194},[4245],{"type":143,"value":396},{"type":138,"tag":187,"props":4247,"children":4248},{"class":200},[4249],{"type":143,"value":203},{"type":138,"tag":187,"props":4251,"children":4252},{"class":3232},[4253],{"type":143,"value":3244},{"type":138,"tag":187,"props":4255,"children":4256},{"class":200},[4257],{"type":143,"value":203},{"type":138,"tag":187,"props":4259,"children":4260},{"class":194},[4261],{"type":143,"value":396},{"type":138,"tag":187,"props":4263,"children":4264},{"class":200},[4265],{"type":143,"value":4266}," logController.GUID.",{"type":138,"tag":187,"props":4268,"children":4269},{"class":215},[4270],{"type":143,"value":4271},"ToString",{"type":138,"tag":187,"props":4273,"children":4274},{"class":200},[4275],{"type":143,"value":760},{"type":138,"tag":187,"props":4277,"children":4278},{"class":189,"line":423},[4279,4283,4287,4291,4295,4299,4303,4307,4311],{"type":138,"tag":187,"props":4280,"children":4281},{"class":200},[4282],{"type":143,"value":3361},{"type":138,"tag":187,"props":4284,"children":4285},{"class":215},[4286],{"type":143,"value":3366},{"type":138,"tag":187,"props":4288,"children":4289},{"class":200},[4290],{"type":143,"value":3918},{"type":138,"tag":187,"props":4292,"children":4293},{"class":194},[4294],{"type":143,"value":396},{"type":138,"tag":187,"props":4296,"children":4297},{"class":200},[4298],{"type":143,"value":203},{"type":138,"tag":187,"props":4300,"children":4301},{"class":3232},[4302],{"type":143,"value":3380},{"type":138,"tag":187,"props":4304,"children":4305},{"class":830},[4306],{"type":143,"value":3385},{"type":138,"tag":187,"props":4308,"children":4309},{"class":3232},[4310],{"type":143,"value":3380},{"type":138,"tag":187,"props":4312,"children":4313},{"class":200},[4314],{"type":143,"value":1384},{"type":138,"tag":187,"props":4316,"children":4317},{"class":189,"line":432},[4318],{"type":138,"tag":187,"props":4319,"children":4320},{},[],{"type":138,"tag":187,"props":4322,"children":4323},{"class":189,"line":474},[4324,4328],{"type":138,"tag":187,"props":4325,"children":4326},{"class":200},[4327],{"type":143,"value":236},{"type":138,"tag":187,"props":4329,"children":4330},{"class":1709},[4331],{"type":143,"value":4332},"// 模擬單次Request\n",{"type":138,"tag":187,"props":4334,"children":4335},{"class":189,"line":492},[4336,4340],{"type":138,"tag":187,"props":4337,"children":4338},{"class":200},[4339],{"type":143,"value":236},{"type":138,"tag":187,"props":4341,"children":4342},{"class":1709},[4343],{"type":143,"value":4344},"//var log = \"Log1(Transient):\" + \"UUID-\" + LogController.OperationId(\"Transient\");\n",{"type":138,"tag":187,"props":4346,"children":4347},{"class":189,"line":500},[4348,4352],{"type":138,"tag":187,"props":4349,"children":4350},{"class":200},[4351],{"type":143,"value":236},{"type":138,"tag":187,"props":4353,"children":4354},{"class":1709},[4355],{"type":143,"value":4356},"//var log2 = \"Log2(Transient):\" + \"UUID-\" + LogController2.OperationId(\"Transient\");\n",{"type":138,"tag":187,"props":4358,"children":4359},{"class":189,"line":508},[4360,4364],{"type":138,"tag":187,"props":4361,"children":4362},{"class":200},[4363],{"type":143,"value":236},{"type":138,"tag":187,"props":4365,"children":4366},{"class":1709},[4367],{"type":143,"value":3720},{"type":138,"tag":187,"props":4369,"children":4370},{"class":189,"line":533},[4371,4375],{"type":138,"tag":187,"props":4372,"children":4373},{"class":200},[4374],{"type":143,"value":236},{"type":138,"tag":187,"props":4376,"children":4377},{"class":1709},[4378],{"type":143,"value":4379},"//richTextBox_Info.AppendText(log2 + \"\\n\");\n",{"type":138,"tag":187,"props":4381,"children":4382},{"class":189,"line":541},[4383],{"type":138,"tag":187,"props":4384,"children":4385},{},[],{"type":138,"tag":187,"props":4387,"children":4388},{"class":189,"line":593},[4389,4393],{"type":138,"tag":187,"props":4390,"children":4391},{"class":200},[4392],{"type":143,"value":236},{"type":138,"tag":187,"props":4394,"children":4395},{"class":1709},[4396],{"type":143,"value":3999},{"type":138,"tag":187,"props":4398,"children":4399},{"class":189,"line":602},[4400],{"type":138,"tag":187,"props":4401,"children":4402},{"class":200},[4403],{"type":143,"value":863},{"type":138,"tag":139,"props":4405,"children":4406},{},[4407],{"type":143,"value":4408},"此時我們可以看到每次的UUID就會不相同，代表在Controller在每次跟Container拿取時都為不同物件。相對的，注入其他物件時也是同一個狀況。",{"type":138,"tag":139,"props":4410,"children":4411},{},[4412],{"type":138,"tag":171,"props":4413,"children":4416},{"alt":4414,"src":4415},"Transient Result 2","/blog/images/00/02/010.png",[],{"type":138,"tag":1690,"props":4418,"children":4420},{"id":4419},"_3-addscope-範圍性",[4421],{"type":143,"value":4422},"3. AddScope  (範圍性)",{"type":138,"tag":139,"props":4424,"children":4425},{},[4426],{"type":143,"value":4427},"Scope我覺得是最難了解的，直接看 Asp.Net DI生命週期圖示，物件相依一樣關係由左至右。如圖所示，程序中要求物件(包含物件要其他相依物件)時，這個Flow處理過程中用到的物件則為同一個物件。而第二次再次要物件時，則會跟第一次的物件是不一樣的物件。",{"type":138,"tag":139,"props":4429,"children":4430},{},[4431],{"type":138,"tag":171,"props":4432,"children":4435},{"alt":4433,"src":4434},"Scope","/blog/images/00/02/011.png",[],{"type":138,"tag":139,"props":4437,"children":4438},{},[4439],{"type":143,"value":4440},"我們已Call Dialog方式去模擬多次Request，程式碼這邊不多做解釋，結果與物件對照如下圖，觀察Instance部分物件分別為",{"type":138,"tag":1670,"props":4442,"children":4443},{},[4444,4449,4454],{"type":138,"tag":1674,"props":4445,"children":4446},{},[4447],{"type":143,"value":4448},"SingletonLogRepository",{"type":138,"tag":1674,"props":4450,"children":4451},{},[4452],{"type":143,"value":4453},"TransientLogRepository",{"type":138,"tag":1674,"props":4455,"children":4456},{},[4457],{"type":143,"value":4458},"ScopedLogRepository",{"type":138,"tag":139,"props":4460,"children":4461},{},[4462],{"type":143,"value":4463},"可以看到ScopedLogRepository，在同一次的Request Flow，LogController與LogService的LogRepository UUID為一樣的，但在第二次打開Dialog時，則UUID會與第一次的不同。這點會跟Singleton有很大的不同。",{"type":138,"tag":139,"props":4465,"children":4466},{},[4467],{"type":143,"value":4468},"在此我們也可以看到Transaction則是在每個物件中，及每次Request都為不同UUID。",{"type":138,"tag":139,"props":4470,"children":4471},{},[4472],{"type":138,"tag":171,"props":4473,"children":4476},{"alt":4474,"src":4475},"Scope Result","/blog/images/00/02/012.png",[],{"type":138,"tag":139,"props":4478,"children":4479},{},[4480],{"type":143,"value":4481},"其實Scoped跟Transaction之間有時候蠻容易混淆的。對我來說比較好懂得在於Scoped在跟Container要物件時，若前一個物件還未dispose(生命週期還未結束)，則都是同一個物件。物件結束生命週期後在新的Request後才會在新增新的物件。而Transaction就無生命週期概念，在每一次要求物件時，都會New一個新的給他，有點像平常我們想用物件就New Instance的概念。",{"type":138,"tag":1690,"props":4483,"children":4485},{"id":4484},"生命週期小結論",[4486],{"type":143,"value":4484},{"type":138,"tag":139,"props":4488,"children":4489},{},[4490],{"type":143,"value":4491},"上述描述完後，沒意外應該會對注入的生命週期會有所了解。而在Web的世界中，這三種注入方式會很常被使用到。在每一次Http Request情境，Request具有連線即結束，在這狀況下的連線相關物件基本上就會使用Scoped，因此在Web情境，大多數物件都會使用Scoped注入。",{"type":138,"tag":139,"props":4493,"children":4494},{},[4495],{"type":143,"value":4496},"但WindowsForm App下，其實我們最常使用的會是Singleton居多，其次是Transaction，Scoped狀況就比較少，因為WindowsForm一開始畫面就那些就載入到 memory中，除非我們將畫面dispose掉，然後再重新開啟畫面，此時就會建議使用Scoped注入。",{"type":138,"tag":139,"props":4498,"children":4499},{},[4500],{"type":143,"value":4501},"Transaction使用場景比較會偏向用後就直接dispose，不過這種應用場景，我們很常直接手動去new物件.實際架構應用上目前我也沒太多經驗。",{"type":138,"tag":1690,"props":4503,"children":4505},{"id":4504},"注入抽換",[4506],{"type":143,"value":4504},{"type":138,"tag":139,"props":4508,"children":4509},{},[4510],{"type":143,"value":4511},"生命週期講完後，接著就是闡述關於抽換實體物件。範例中我們使用IPrinter注入抽換PrinterMethodA與PrinterMethodB。",{"type":138,"tag":139,"props":4513,"children":4514},{},[4515],{"type":143,"value":4516},"在一開始我們IPrinter注入為PrinterMethodA，在按下button_Printer_Click按鈕時，Console則會印出MethodA Print:Prionter Out",{"type":138,"tag":139,"props":4518,"children":4519},{},[4520],{"type":138,"tag":171,"props":4521,"children":4524},{"alt":4522,"src":4523},"抽換","/blog/images/00/02/013.png",[],{"type":138,"tag":139,"props":4526,"children":4527},{},[4528],{"type":143,"value":4529},"此時我們將PrinterMethodA改成PrinterMethodB",{"type":138,"tag":177,"props":4531,"children":4533},{"className":179,"code":4532,"language":181,"meta":9},"collection.AddTransient\u003CIPrinter, PrinterMethodB>();\n",[4534],{"type":138,"tag":7,"props":4535,"children":4536},{"__ignoreMap":9},[4537],{"type":138,"tag":187,"props":4538,"children":4539},{"class":189,"line":190},[4540,4544,4548,4552,4556,4560,4565],{"type":138,"tag":187,"props":4541,"children":4542},{"class":200},[4543],{"type":143,"value":3060},{"type":138,"tag":187,"props":4545,"children":4546},{"class":215},[4547],{"type":143,"value":3560},{"type":138,"tag":187,"props":4549,"children":4550},{"class":200},[4551],{"type":143,"value":3070},{"type":138,"tag":187,"props":4553,"children":4554},{"class":215},[4555],{"type":143,"value":967},{"type":138,"tag":187,"props":4557,"children":4558},{"class":200},[4559],{"type":143,"value":336},{"type":138,"tag":187,"props":4561,"children":4562},{"class":215},[4563],{"type":143,"value":4564},"PrinterMethodB",{"type":138,"tag":187,"props":4566,"children":4567},{"class":200},[4568],{"type":143,"value":3089},{"type":138,"tag":139,"props":4570,"children":4571},{},[4572],{"type":143,"value":4573},"此時在按下button_Printer_Click按鈕時，Console則會印出MethodB Print:Prionter Out",{"type":138,"tag":139,"props":4575,"children":4576},{},[4577],{"type":138,"tag":171,"props":4578,"children":4581},{"alt":4579,"src":4580},"抽換2","/blog/images/00/02/014.png",[],{"type":138,"tag":139,"props":4583,"children":4584},{},[4585],{"type":143,"value":4586},"另外我們也可以注入IPrinter List，只要注入多Concreate實體",{"type":138,"tag":177,"props":4588,"children":4590},{"className":179,"code":4589,"language":181,"meta":9},"collection.AddTransient\u003CIPrinter, PrinterMethodA>();\ncollection.AddTransient\u003CIPrinter, PrinterMethodB>();\n",[4591],{"type":138,"tag":7,"props":4592,"children":4593},{"__ignoreMap":9},[4594,4626],{"type":138,"tag":187,"props":4595,"children":4596},{"class":189,"line":190},[4597,4601,4605,4609,4613,4617,4622],{"type":138,"tag":187,"props":4598,"children":4599},{"class":200},[4600],{"type":143,"value":3060},{"type":138,"tag":187,"props":4602,"children":4603},{"class":215},[4604],{"type":143,"value":3560},{"type":138,"tag":187,"props":4606,"children":4607},{"class":200},[4608],{"type":143,"value":3070},{"type":138,"tag":187,"props":4610,"children":4611},{"class":215},[4612],{"type":143,"value":967},{"type":138,"tag":187,"props":4614,"children":4615},{"class":200},[4616],{"type":143,"value":336},{"type":138,"tag":187,"props":4618,"children":4619},{"class":215},[4620],{"type":143,"value":4621},"PrinterMethodA",{"type":138,"tag":187,"props":4623,"children":4624},{"class":200},[4625],{"type":143,"value":4202},{"type":138,"tag":187,"props":4627,"children":4628},{"class":189,"line":221},[4629,4633,4637,4641,4645,4649,4653],{"type":138,"tag":187,"props":4630,"children":4631},{"class":200},[4632],{"type":143,"value":3060},{"type":138,"tag":187,"props":4634,"children":4635},{"class":215},[4636],{"type":143,"value":3560},{"type":138,"tag":187,"props":4638,"children":4639},{"class":200},[4640],{"type":143,"value":3070},{"type":138,"tag":187,"props":4642,"children":4643},{"class":215},[4644],{"type":143,"value":967},{"type":138,"tag":187,"props":4646,"children":4647},{"class":200},[4648],{"type":143,"value":336},{"type":138,"tag":187,"props":4650,"children":4651},{"class":215},[4652],{"type":143,"value":4564},{"type":138,"tag":187,"props":4654,"children":4655},{"class":200},[4656],{"type":143,"value":3089},{"type":138,"tag":139,"props":4658,"children":4659},{},[4660],{"type":143,"value":4661},"就可注入多PrinterMethod方法",{"type":138,"tag":177,"props":4663,"children":4665},{"className":179,"code":4664,"language":181,"meta":9},"private LogController LogController;\nprivate LogController2 LogController2;\n\n// 多重注入\nprivate IEnumerable\u003CIPrinter> Printer;\n\npublic Form1(IEnumerable\u003CIPrinter> printer,\n             LogController logController, \n             LogController2 logController2)\n{\n    InitializeComponent();\n    LogController = logController;\n    LogController2 = logController2;\n    // 多重注入\n    Printer = printer;\n}\n",[4666],{"type":138,"tag":7,"props":4667,"children":4668},{"__ignoreMap":9},[4669,4697,4725,4731,4739,4776,4782,4827,4852,4876,4883,4899,4916,4933,4944,4960],{"type":138,"tag":187,"props":4670,"children":4671},{"class":189,"line":190},[4672,4676,4680,4684,4688,4692],{"type":138,"tag":187,"props":4673,"children":4674},{"class":194},[4675],{"type":143,"value":277},{"type":138,"tag":187,"props":4677,"children":4678},{"class":200},[4679],{"type":143,"value":203},{"type":138,"tag":187,"props":4681,"children":4682},{"class":215},[4683],{"type":143,"value":4197},{"type":138,"tag":187,"props":4685,"children":4686},{"class":200},[4687],{"type":143,"value":203},{"type":138,"tag":187,"props":4689,"children":4690},{"class":215},[4691],{"type":143,"value":4197},{"type":138,"tag":187,"props":4693,"children":4694},{"class":200},[4695],{"type":143,"value":4696},";\n",{"type":138,"tag":187,"props":4698,"children":4699},{"class":189,"line":221},[4700,4704,4708,4713,4717,4721],{"type":138,"tag":187,"props":4701,"children":4702},{"class":194},[4703],{"type":143,"value":277},{"type":138,"tag":187,"props":4705,"children":4706},{"class":200},[4707],{"type":143,"value":203},{"type":138,"tag":187,"props":4709,"children":4710},{"class":215},[4711],{"type":143,"value":4712},"LogController2",{"type":138,"tag":187,"props":4714,"children":4715},{"class":200},[4716],{"type":143,"value":203},{"type":138,"tag":187,"props":4718,"children":4719},{"class":215},[4720],{"type":143,"value":4712},{"type":138,"tag":187,"props":4722,"children":4723},{"class":200},[4724],{"type":143,"value":4696},{"type":138,"tag":187,"props":4726,"children":4727},{"class":189,"line":230},[4728],{"type":138,"tag":187,"props":4729,"children":4730},{},[],{"type":138,"tag":187,"props":4732,"children":4733},{"class":189,"line":294},[4734],{"type":138,"tag":187,"props":4735,"children":4736},{"class":1709},[4737],{"type":143,"value":4738},"// 多重注入\n",{"type":138,"tag":187,"props":4740,"children":4741},{"class":189,"line":357},[4742,4746,4750,4755,4759,4763,4768,4772],{"type":138,"tag":187,"props":4743,"children":4744},{"class":194},[4745],{"type":143,"value":277},{"type":138,"tag":187,"props":4747,"children":4748},{"class":200},[4749],{"type":143,"value":203},{"type":138,"tag":187,"props":4751,"children":4752},{"class":215},[4753],{"type":143,"value":4754},"IEnumerable",{"type":138,"tag":187,"props":4756,"children":4757},{"class":200},[4758],{"type":143,"value":3070},{"type":138,"tag":187,"props":4760,"children":4761},{"class":215},[4762],{"type":143,"value":967},{"type":138,"tag":187,"props":4764,"children":4765},{"class":200},[4766],{"type":143,"value":4767},"> ",{"type":138,"tag":187,"props":4769,"children":4770},{"class":215},[4771],{"type":143,"value":249},{"type":138,"tag":187,"props":4773,"children":4774},{"class":200},[4775],{"type":143,"value":4696},{"type":138,"tag":187,"props":4777,"children":4778},{"class":189,"line":404},[4779],{"type":138,"tag":187,"props":4780,"children":4781},{},[],{"type":138,"tag":187,"props":4783,"children":4784},{"class":189,"line":423},[4785,4789,4793,4798,4802,4806,4810,4814,4818,4822],{"type":138,"tag":187,"props":4786,"children":4787},{"class":194},[4788],{"type":143,"value":197},{"type":138,"tag":187,"props":4790,"children":4791},{"class":200},[4792],{"type":143,"value":203},{"type":138,"tag":187,"props":4794,"children":4795},{"class":215},[4796],{"type":143,"value":4797},"Form1",{"type":138,"tag":187,"props":4799,"children":4800},{"class":200},[4801],{"type":143,"value":317},{"type":138,"tag":187,"props":4803,"children":4804},{"class":215},[4805],{"type":143,"value":4754},{"type":138,"tag":187,"props":4807,"children":4808},{"class":200},[4809],{"type":143,"value":3070},{"type":138,"tag":187,"props":4811,"children":4812},{"class":215},[4813],{"type":143,"value":967},{"type":138,"tag":187,"props":4815,"children":4816},{"class":200},[4817],{"type":143,"value":4767},{"type":138,"tag":187,"props":4819,"children":4820},{"class":215},[4821],{"type":143,"value":467},{"type":138,"tag":187,"props":4823,"children":4824},{"class":200},[4825],{"type":143,"value":4826},",\n",{"type":138,"tag":187,"props":4828,"children":4829},{"class":189,"line":432},[4830,4835,4839,4843,4847],{"type":138,"tag":187,"props":4831,"children":4832},{"class":200},[4833],{"type":143,"value":4834},"             ",{"type":138,"tag":187,"props":4836,"children":4837},{"class":215},[4838],{"type":143,"value":4197},{"type":138,"tag":187,"props":4840,"children":4841},{"class":200},[4842],{"type":143,"value":203},{"type":138,"tag":187,"props":4844,"children":4845},{"class":215},[4846],{"type":143,"value":4170},{"type":138,"tag":187,"props":4848,"children":4849},{"class":200},[4850],{"type":143,"value":4851},", \n",{"type":138,"tag":187,"props":4853,"children":4854},{"class":189,"line":474},[4855,4859,4863,4867,4872],{"type":138,"tag":187,"props":4856,"children":4857},{"class":200},[4858],{"type":143,"value":4834},{"type":138,"tag":187,"props":4860,"children":4861},{"class":215},[4862],{"type":143,"value":4712},{"type":138,"tag":187,"props":4864,"children":4865},{"class":200},[4866],{"type":143,"value":203},{"type":138,"tag":187,"props":4868,"children":4869},{"class":215},[4870],{"type":143,"value":4871},"logController2",{"type":138,"tag":187,"props":4873,"children":4874},{"class":200},[4875],{"type":143,"value":3166},{"type":138,"tag":187,"props":4877,"children":4878},{"class":189,"line":492},[4879],{"type":138,"tag":187,"props":4880,"children":4881},{"class":200},[4882],{"type":143,"value":227},{"type":138,"tag":187,"props":4884,"children":4885},{"class":189,"line":500},[4886,4890,4895],{"type":138,"tag":187,"props":4887,"children":4888},{"class":200},[4889],{"type":143,"value":236},{"type":138,"tag":187,"props":4891,"children":4892},{"class":215},[4893],{"type":143,"value":4894},"InitializeComponent",{"type":138,"tag":187,"props":4896,"children":4897},{"class":200},[4898],{"type":143,"value":760},{"type":138,"tag":187,"props":4900,"children":4901},{"class":189,"line":508},[4902,4907,4911],{"type":138,"tag":187,"props":4903,"children":4904},{"class":200},[4905],{"type":143,"value":4906},"    LogController ",{"type":138,"tag":187,"props":4908,"children":4909},{"class":194},[4910],{"type":143,"value":386},{"type":138,"tag":187,"props":4912,"children":4913},{"class":200},[4914],{"type":143,"value":4915}," logController;\n",{"type":138,"tag":187,"props":4917,"children":4918},{"class":189,"line":533},[4919,4924,4928],{"type":138,"tag":187,"props":4920,"children":4921},{"class":200},[4922],{"type":143,"value":4923},"    LogController2 ",{"type":138,"tag":187,"props":4925,"children":4926},{"class":194},[4927],{"type":143,"value":386},{"type":138,"tag":187,"props":4929,"children":4930},{"class":200},[4931],{"type":143,"value":4932}," logController2;\n",{"type":138,"tag":187,"props":4934,"children":4935},{"class":189,"line":541},[4936,4940],{"type":138,"tag":187,"props":4937,"children":4938},{"class":200},[4939],{"type":143,"value":236},{"type":138,"tag":187,"props":4941,"children":4942},{"class":1709},[4943],{"type":143,"value":4738},{"type":138,"tag":187,"props":4945,"children":4946},{"class":189,"line":593},[4947,4952,4956],{"type":138,"tag":187,"props":4948,"children":4949},{"class":200},[4950],{"type":143,"value":4951},"    Printer ",{"type":138,"tag":187,"props":4953,"children":4954},{"class":194},[4955],{"type":143,"value":386},{"type":138,"tag":187,"props":4957,"children":4958},{"class":200},[4959],{"type":143,"value":489},{"type":138,"tag":187,"props":4961,"children":4962},{"class":189,"line":602},[4963],{"type":138,"tag":187,"props":4964,"children":4965},{"class":200},[4966],{"type":143,"value":863},{"type":138,"tag":139,"props":4968,"children":4969},{},[4970],{"type":138,"tag":171,"props":4971,"children":4974},{"alt":4972,"src":4973},"抽換3","/blog/images/00/02/015.png",[],{"type":138,"tag":139,"props":4976,"children":4977},{},[4978],{"type":143,"value":4979},"我們只須改Container設定，主程式都不用更動，即可抽換程式中所有物件用到IPrinter的地方。",{"type":138,"tag":156,"props":4981,"children":4983},{"id":4982},"autofac",[4984],{"type":143,"value":4985},"AutoFac",{"type":138,"tag":139,"props":4987,"children":4988},{},[4989],{"type":143,"value":4990},"範例DI設定在AutofacConfig.cs",{"type":138,"tag":139,"props":4992,"children":4993},{},[4994,4996],{"type":143,"value":4995},"AutoFac與 ASP.NET DI 注入生命週期概念其實大同小異，下圖為對應表",{"type":138,"tag":331,"props":4997,"children":5000},{"href":4998,"rel":4999},"https://devblogs.microsoft.com/cesardelatorre/comparing-asp-net-core-ioc-service-life-times-and-autofac-ioc-instance-scopes/",[2911],[5001],{"type":143,"value":5002},"出處",{"type":138,"tag":139,"props":5004,"children":5005},{},[5006],{"type":138,"tag":171,"props":5007,"children":5009},{"alt":2932,"src":5008},"/blog/images/00/02/016.png",[],{"type":138,"tag":139,"props":5011,"children":5012},{},[5013],{"type":143,"value":5014},"根據對應表，在範例程式要換成Autofac範例，只需將Bootstrapper與Form.cs裡Button_Scoped_Click的Net DI程式碼註解掉，並解開Autofac註解相關程式碼。即可觀察注入物件生命週期的不同。",{"type":138,"tag":5016,"props":5017,"children":5018},"style",{},[5019],{"type":143,"value":5020},".github-light_github-dark{color:#24292e;background:#fff;}.dark .github-light_github-dark{color:#e1e4e8;background:#24292e;}.ct-149352{color:#D73A49;}.dark .ct-149352{color:#F97583;}.ct-553616{color:#24292E;}.dark .ct-553616{color:#E1E4E8;}.ct-762058{color:#6F42C1;}.dark .ct-762058{color:#B392F0;}.ct-617022{color:#005CC5;}.dark .ct-617022{color:#79B8FF;}.ct-086898{color:#6A737D;}.ct-157101{color:#E36209;}.dark .ct-157101{color:#FFAB70;}.ct-952708{color:#032F62;}.dark .ct-952708{color:#9ECBFF;}",{"title":9,"searchDepth":221,"depth":221,"links":5022},[5023,5028,5031,5032],{"id":147,"depth":221,"text":19,"children":5024},[5025,5026,5027],{"id":158,"depth":230,"text":161},{"id":894,"depth":230,"text":897},{"id":1660,"depth":230,"text":1663},{"id":2836,"depth":221,"text":20,"children":5029},[5030],{"id":2851,"depth":230,"text":2854},{"id":2875,"depth":221,"text":21},{"id":2903,"depth":221,"text":22,"children":5033},[5034,5035],{"id":2940,"depth":230,"text":2927},{"id":4982,"depth":230,"text":4985},"markdown","content","0.code/2.依賴注入(DI).md","md","default",["ShallowRef",5042],["ShallowReactive",5043],{"/code/(di)":5044},[5045,5252],{"_path":6,"_dir":7,"_draft":133,"_partial":133,"_locale":9,"title":8,"description":9,"body":5046,"_type":5036,"_id":5,"_source":5037,"_file":5251,"_extension":5039},{"type":135,"children":5047,"toc":5248},[5048,5053,5058],{"type":138,"tag":5049,"props":5050,"children":5051},"h1",{"id":8},[5052],{"type":143,"value":8},{"type":138,"tag":145,"props":5054,"children":5056},{"id":5055},"_20191113",[5057],{"type":143,"value":11},{"type":138,"tag":1670,"props":5059,"children":5060},{},[5061,5074,5115,5128,5141,5154,5180,5196,5209,5222,5235],{"type":138,"tag":1674,"props":5062,"children":5063},{},[5064,5066],{"type":143,"value":5065},"Lazy Class",{"type":138,"tag":1670,"props":5067,"children":5068},{},[5069],{"type":138,"tag":1674,"props":5070,"children":5071},{},[5072],{"type":143,"value":5073},"別開創無所謂的Class(Ex 指宣告一個變數, Inline Class),邏輯資料相同可以使用繼承延伸,Super Class。要設計Class仙藥思考它的合理性。",{"type":138,"tag":1674,"props":5075,"children":5076},{},[5077,5079],{"type":143,"value":5078},"Speculative Generality",{"type":138,"tag":1670,"props":5080,"children":5081},{},[5082,5087],{"type":138,"tag":1674,"props":5083,"children":5084},{},[5085],{"type":143,"value":5086},"在設計時，預留太多未來可能會用的擴充點。彈性使用Template模式，然後寫成介面，ConcreateClass去設計跟Imp。",{"type":138,"tag":1674,"props":5088,"children":5089},{},[5090,5092],{"type":143,"value":5091},"遇到不能關閉的程式，要考慮好資源回收與OOM問題。\n",{"type":138,"tag":1670,"props":5093,"children":5094},{},[5095,5100,5105,5110],{"type":138,"tag":1674,"props":5096,"children":5097},{},[5098],{"type":143,"value":5099},"1.Collapse Hierachy",{"type":138,"tag":1674,"props":5101,"children":5102},{},[5103],{"type":143,"value":5104},"2.Inline Class",{"type":138,"tag":1674,"props":5106,"children":5107},{},[5108],{"type":143,"value":5109},"3.Remove Parameter",{"type":138,"tag":1674,"props":5111,"children":5112},{},[5113],{"type":143,"value":5114},"4.Remove Method",{"type":138,"tag":1674,"props":5116,"children":5117},{},[5118,5120],{"type":143,"value":5119},"Temporay Field",{"type":138,"tag":1670,"props":5121,"children":5122},{},[5123],{"type":138,"tag":1674,"props":5124,"children":5125},{},[5126],{"type":143,"value":5127},"Class欄位過多，在替代變數命名尚不清楚會讓開發者混淆，這是在開發過程中在需求還不清楚會常遇到，盡量避免這種狀況發生。",{"type":138,"tag":1674,"props":5129,"children":5130},{},[5131,5133],{"type":143,"value":5132},"Message Chains(過度耦合訊息練)",{"type":138,"tag":1670,"props":5134,"children":5135},{},[5136],{"type":138,"tag":1674,"props":5137,"children":5138},{},[5139],{"type":143,"value":5140},"Fun串Fun太多得意思....使用垂直折疊、提取或是使用委託與封裝，使用注入。",{"type":138,"tag":1674,"props":5142,"children":5143},{},[5144,5146],{"type":143,"value":5145},"Middle Man(中間轉手人)",{"type":138,"tag":1670,"props":5147,"children":5148},{},[5149],{"type":138,"tag":1674,"props":5150,"children":5151},{},[5152],{"type":143,"value":5153},"Class放與這個Class不相干的內容，邏輯提煉出來其他模組，或使用把功能寫成父類別繼承，或用注入盡量避免這件事情",{"type":138,"tag":1674,"props":5155,"children":5156},{},[5157,5159],{"type":143,"value":5158},"Inappropriate Intimacy(互相依賴)",{"type":138,"tag":1670,"props":5160,"children":5161},{},[5162],{"type":138,"tag":1674,"props":5163,"children":5164},{},[5165,5167],{"type":143,"value":5166},"過度互相依賴，或是沒邏輯性的互相依賴(亂使用繼承)。 讀卡機讀取票卡例子(讀卡機，票卡自己也需判斷黑名單)。\n",{"type":138,"tag":1670,"props":5168,"children":5169},{},[5170,5175],{"type":138,"tag":1674,"props":5171,"children":5172},{},[5173],{"type":143,"value":5174},"1.可以定義一個卡片Interface(鎖卡，解卡，判斷)。此Interface讓讀卡機繼承，讓讀卡機注入...(依賴注入,RW定義一個介面，再去實作)",{"type":138,"tag":1674,"props":5176,"children":5177},{},[5178],{"type":143,"value":5179},"2.使用委託註冊介面. Call Back方式把有註冊過的方式拉進Class做處理。",{"type":138,"tag":1674,"props":5181,"children":5182},{},[5183,5185],{"type":143,"value":5184},"Alternative Class with different Interface(異曲同工的類別)",{"type":138,"tag":1670,"props":5186,"children":5187},{},[5188,5193],{"type":138,"tag":1674,"props":5189,"children":5190},{},[5191],{"type":143,"value":5192},"做Extract SuperClass",{"type":138,"tag":1674,"props":5194,"children":5195},{},[],{"type":138,"tag":1674,"props":5197,"children":5198},{},[5199,5201],{"type":143,"value":5200},"Incomplete Libary Class(不完美程式庫類別)",{"type":138,"tag":1670,"props":5202,"children":5203},{},[5204],{"type":138,"tag":1674,"props":5205,"children":5206},{},[5207],{"type":143,"value":5208},"如果要改一點類別庫直接修改，大改套模式..EX:套裝飾者模式,或使用繼承~~~ New程式碼直接延接",{"type":138,"tag":1674,"props":5210,"children":5211},{},[5212,5214],{"type":143,"value":5213},"Data Class(純稚資料類別)",{"type":138,"tag":1670,"props":5215,"children":5216},{},[5217],{"type":138,"tag":1674,"props":5218,"children":5219},{},[5220],{"type":143,"value":5221},"如果你有資料結構Class專門存取，很多Class會使用他，建議寫Get Set(c#直接產生)。",{"type":138,"tag":1674,"props":5223,"children":5224},{},[5225,5227],{"type":143,"value":5226},"Refuesed Bequest(被拒絕的遺贈)",{"type":138,"tag":1670,"props":5228,"children":5229},{},[5230],{"type":138,"tag":1674,"props":5231,"children":5232},{},[5233],{"type":143,"value":5234},"繼承錯誤.",{"type":138,"tag":1674,"props":5236,"children":5237},{},[5238,5240],{"type":143,"value":5239},"Comments(過多的註釋)",{"type":138,"tag":1670,"props":5241,"children":5242},{},[5243],{"type":138,"tag":1674,"props":5244,"children":5245},{},[5246],{"type":143,"value":5247},"包Package或好的命名可以避免",{"title":9,"searchDepth":221,"depth":221,"links":5249},[5250],{"id":5055,"depth":221,"text":11},"0.code/1.Refcotr閱讀.md",{"_path":5253,"_dir":7,"_draft":133,"_partial":5254,"_locale":9,"title":5255,"icon":5256,"_id":5257,"_type":5258,"_source":5037,"_file":5259,"_extension":5260},"/code/_dir",true,"Codesnese","🧑‍💻","content:0.code:_dir.yml","yaml","0.code/_dir.yml","yml",["ShallowRef",5262],{},{"preference":5264,"value":5264,"unknown":5254,"forced":133},"system",[5266,5271,5277,5283,5289,5294,5303,5309],{"title":5255,"_path":5267,"children":5268,"icon":5256},"/code",[5269,5270],{"title":8,"_path":6},{"title":16,"_path":15},{"title":5272,"_path":5273,"children":5274,"icon":5256},"Architecture","/architecture",[5275,5276],{"title":34,"_path":32},{"title":48,"_path":47},{"title":5278,"_path":5279,"children":5280,"icon":5282},"Desktop","/desktop",[5281],{"title":60,"_path":58},"🖥️",{"title":5284,"_path":5285,"children":5286,"icon":5288},"Cloud-GCP","/cloud-gcp",[5287],{"title":70,"_path":68},"🛢️",{"title":5290,"_path":5291,"children":5292,"icon":5288},"Database","/database",[5293],{"title":78,"_path":76},{"title":5295,"_path":5296,"children":5297,"icon":5302},"Keycloak","/keycloak",[5298,5299,5300,5301],{"title":87,"_path":85},{"title":94,"_path":93},{"title":102,"_path":101},{"title":109,"_path":108},"🔒",{"title":5304,"_path":5305,"children":5306,"icon":5308},"Iron Man - 雲端之路養成","/ironman-gcp",[5307],{"title":118,"_path":116},"🦸🏻",{"title":5310,"_path":5311,"children":5312,"icon":5308},"證照考試準備","/license",[5313],{"title":124,"_path":122},{"🧑‍💻":-1,"🖥️":-1,"🛢️":-1,"🔒":-1,"🦸🏻":-1,"heroicons-outline:menu":5315,"fa-brands:github":5318,"lucide:chevrons-down-up":5322,"heroicons-outline:search":5324,"heroicons-outline:arrow-sm-left":5326,"heroicons-outline:arrow-sm-right":5328,"heroicons-outline:chevron-right":5330,"ph:copy":5332},{"left":5316,"top":5316,"width":763,"height":763,"rotate":5316,"vFlip":133,"hFlip":133,"body":5317},0,"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 6h16M4 12h16M4 18h16\"/>",{"left":5316,"top":5316,"width":5319,"height":5320,"rotate":5316,"vFlip":133,"hFlip":133,"body":5321},496,512,"\u003Cpath fill=\"currentColor\" d=\"M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9c1.6 2.3 4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2\"/>",{"left":5316,"top":5316,"width":763,"height":763,"rotate":5316,"vFlip":133,"hFlip":133,"body":5323},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m7 20l5-5l5 5M7 4l5 5l5-5\"/>",{"left":5316,"top":5316,"width":763,"height":763,"rotate":5316,"vFlip":133,"hFlip":133,"body":5325},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m21 21l-6-6m2-5a7 7 0 1 1-14 0a7 7 0 0 1 14 0\"/>",{"left":5316,"top":5316,"width":763,"height":763,"rotate":5316,"vFlip":133,"hFlip":133,"body":5327},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m11 17l-5-5m0 0l5-5m-5 5h12\"/>",{"left":5316,"top":5316,"width":763,"height":763,"rotate":5316,"vFlip":133,"hFlip":133,"body":5329},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m13 7l5 5m0 0l-5 5m5-5H6\"/>",{"left":5316,"top":5316,"width":763,"height":763,"rotate":5316,"vFlip":133,"hFlip":133,"body":5331},"\u003Cpath fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m9 5l7 7l-7 7\"/>",{"left":5316,"top":5316,"width":5333,"height":5333,"rotate":5316,"vFlip":133,"hFlip":133,"body":5334},256,"\u003Cpath fill=\"currentColor\" d=\"M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z\"/>",{"parentPath":5267,"scrollTop":5316},{},{},{},{},{},{},{},{},{},{"search-api":5346},null]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{baseURL:"/blog",plausible:{hashMode:false,trackLocalhost:false,domain:"",apiHost:"https://plausible.io",autoPageviews:true,autoOutboundTracking:false},studio:{apiURL:"https://api.nuxt.studio"},mdc:{components:{prose:true,map:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"}},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}}},content:{locales:[],defaultLocale:"",integrity:1708421861464,experimental:{stripQueryParameters:false,advanceQuery:false,clientDB:false},respectPathCase:false,api:{baseURL:"/api/_content"},navigation:{fields:["icon","titleTemplate","header","main","aside","footer","layout"]},tags:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},highlight:{theme:{dark:"github-dark",default:"github-light"},preload:["json","js","ts","html","css","vue","diff","shell","markdown","yaml","bash","ini"]},wsUrl:"",documentDriven:{page:true,navigation:true,surround:true,globals:{},layoutFallbacks:["theme"],injectPage:true},host:"",trailingSlash:false,contentHead:true,anchorLinks:{depth:4,exclude:[1]}}},app:{baseURL:"/blog",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body>
</html>